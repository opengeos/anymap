{"config":{"lang":["en"],"separator":"[\\s\\-]+","pipeline":["stopWordFilter"]},"docs":[{"location":"","title":"AnyMap","text":"<p>A Python package for creating interactive maps with anywidget and JavaScript mapping libraries</p> <ul> <li>GitHub repo: https://github.com/opengeos/anymap</li> <li>Documentation: https://anymap.dev</li> <li>PyPI: https://pypi.org/project/anymap</li> <li>Conda-forge: https://anaconda.org/conda-forge/anymap</li> <li>Free software: MIT License</li> </ul>"},{"location":"#features","title":"Features","text":"<ul> <li>\ud83d\uddfa\ufe0f Interactive Maps: Create beautiful, interactive maps in Jupyter notebooks</li> <li>\ud83d\udd04 Bidirectional Communication: Full Python \u2194 JavaScript communication</li> <li>\ud83d\udcf1 Multi-cell Support: Render maps in multiple notebook cells without conflicts</li> <li>\ud83c\udfaf MapLibre Integration: Built-in support for MapLibre GL JS</li> <li>\ud83d\udee0\ufe0f Extensible: Easy to add support for other mapping libraries</li> <li>\ud83d\ude80 Familiar API: Similar to ipyleaflet for easy migration</li> </ul>"},{"location":"#installation","title":"Installation","text":"<pre><code>pip install anymap\n</code></pre> <pre><code>conda install -c conda-forge anymap\n</code></pre>"},{"location":"#quick-start","title":"Quick Start","text":"<pre><code>from anymap import MapLibreMap\n\n# Create a basic map\nm = MapLibreMap(\n    center=[-122.4194, 37.7749],  # San Francisco\n    zoom=12,\n    height=\"600px\"\n)\nm\n</code></pre>"},{"location":"#basic-usage","title":"Basic Usage","text":""},{"location":"#creating-maps","title":"Creating Maps","text":"<pre><code>from anymap import MapLibreMap\n\n# Create a map with custom settings\nm = MapLibreMap(\n    center=[-74.0060, 40.7128],  # New York City\n    zoom=13,\n    height=\"500px\",\n    bearing=45,  # Map rotation\n    pitch=60     # 3D tilt\n)\n</code></pre>"},{"location":"#adding-markers","title":"Adding Markers","text":"<pre><code># Add a marker with popup\nm.add_marker(\n    lat=40.7128,\n    lng=-74.0060,\n    popup=\"&lt;h3&gt;New York City&lt;/h3&gt;&lt;p&gt;The Big Apple&lt;/p&gt;\"\n)\n</code></pre>"},{"location":"#working-with-geojson","title":"Working with GeoJSON","text":"<pre><code># Add GeoJSON data\ngeojson_data = {\n    \"type\": \"FeatureCollection\",\n    \"features\": [\n        {\n            \"type\": \"Feature\",\n            \"geometry\": {\n                \"type\": \"Point\",\n                \"coordinates\": [-74.0060, 40.7128]\n            },\n            \"properties\": {\"name\": \"NYC\"}\n        }\n    ]\n}\n\nm.add_geojson_layer(\n    layer_id=\"cities\",\n    geojson_data=geojson_data,\n    layer_type=\"circle\",\n    paint={\n        \"circle-radius\": 8,\n        \"circle-color\": \"#ff0000\"\n    }\n)\n</code></pre>"},{"location":"#event-handling","title":"Event Handling","text":"<pre><code>def handle_click(event):\n    lat, lng = event['lngLat']\n    print(f\"Clicked at: {lat:.4f}, {lng:.4f}\")\n\nm.on_map_event('click', handle_click)\n</code></pre>"},{"location":"#dynamic-updates","title":"Dynamic Updates","text":"<pre><code># Change map properties\nm.set_center(-0.1278, 51.5074)  # London\nm.set_zoom(14)\n\n# Animate to a location\nm.fly_to(2.3522, 48.8566, zoom=15)  # Paris\n</code></pre>"},{"location":"#multi-cell-rendering","title":"Multi-Cell Rendering","text":"<p>AnyMap is designed to work seamlessly across multiple notebook cells:</p> <pre><code># Cell 1\nm = MapLibreMap(center=[0, 0], zoom=2)\nm\n\n# Cell 2 - Same map instance\nm.add_marker(0, 0, popup=\"Origin\")\n\n# Cell 3 - Display again\nm\n</code></pre>"},{"location":"#advanced-features","title":"Advanced Features","text":""},{"location":"#layer-management","title":"Layer Management","text":"<pre><code># Add and remove layers\nm.add_source(\"my-source\", {\n    \"type\": \"geojson\",\n    \"data\": geojson_data\n})\n\nm.add_layer(\"my-layer\", {\n    \"id\": \"my-layer\",\n    \"type\": \"circle\",\n    \"source\": \"my-source\",\n    \"paint\": {\"circle-radius\": 5}\n})\n\n# Remove layers\nm.remove_layer(\"my-layer\")\nm.remove_source(\"my-source\")\n</code></pre>"},{"location":"#custom-javascript-methods","title":"Custom JavaScript Methods","text":"<pre><code># Call any MapLibre GL JS method\nm.call_js_method('easeTo', {\n    'center': [lng, lat],\n    'zoom': 14,\n    'duration': 2000\n})\n</code></pre>"},{"location":"#examples","title":"Examples","text":"<p>Check out the example notebooks in the <code>examples/</code> directory:</p> <ul> <li><code>basic_usage.ipynb</code> - Basic map creation and interaction</li> <li><code>advanced_features.ipynb</code> - Advanced layer management and styling</li> <li><code>multi_cell_test.ipynb</code> - Multi-cell rendering tests</li> </ul>"},{"location":"#development","title":"Development","text":"<p>To set up for development:</p> <pre><code>git clone https://github.com/opengeos/anymap.git\ncd anymap\npip install -e .\n</code></pre> <p>Run tests:</p> <pre><code>python -m unittest tests.test_anymap -v\n</code></pre>"},{"location":"#roadmap","title":"Roadmap","text":"<ul> <li>\u2705 MapLibre GL JS backend</li> <li>\u2705 Mapbox GL JS backend</li> <li>\u2705 Leaflet backend</li> <li>\u2705 OpenLayers backend</li> <li>\u2705 DeckGL backend</li> <li>\u2705 KeplerGL backend</li> <li>\ud83d\udd32 Cesium backend</li> <li>\ud83d\udd32 Potree backend</li> </ul>"},{"location":"#contributing","title":"Contributing","text":"<p>Contributions are welcome! Please feel free to submit a Pull Request.</p>"},{"location":"#license","title":"License","text":"<p>This project is licensed under the MIT License - see the LICENSE file for details.</p>"},{"location":"anymap/","title":"anymap module","text":"<p>Main module for anymap interactive mapping widgets.</p> <p>This module provides backward compatibility by re-exporting all classes from their new dedicated modules. All classes have been moved to separate modules for better organization and maintainability.</p> <p>For new code, consider importing directly from the specific modules: - from anymap.base import MapWidget - from anymap.maplibre import MapLibreMap - from anymap.mapbox import MapboxMap - from anymap.cesium import CesiumMap - from anymap.potree import PotreeMap - from anymap.deckgl import DeckGLMap - from anymap.compare import MapCompare</p>"},{"location":"base/","title":"base module","text":"<p>Base class for interactive map widgets using anywidget.</p> <p>This module provides the core MapWidget class that serves as the foundation for all mapping backends in the anymap library. It handles JavaScript communication, state management, and provides common mapping functionality.</p>"},{"location":"base/#anymap.base.MapWidget","title":"<code> MapWidget            (AnyWidget)         </code>","text":"<p>Base class for interactive map widgets using anywidget.</p> <p>This class provides the core functionality for creating interactive maps using different JavaScript mapping libraries. It handles communication between Python and JavaScript, manages map state, and provides common mapping operations.</p> <p>Attributes:</p> Name Type Description <code>center</code> <p>Map center coordinates as [longitude, latitude].</p> <code>zoom</code> <p>Map zoom level.</p> <code>width</code> <p>Map container width as CSS string.</p> <code>height</code> <p>Map container height as CSS string.</p> <code>style</code> <p>Map style configuration.</p> Source code in <code>anymap/base.py</code> <pre><code>class MapWidget(anywidget.AnyWidget):\n    \"\"\"Base class for interactive map widgets using anywidget.\n\n    This class provides the core functionality for creating interactive maps\n    using different JavaScript mapping libraries. It handles communication\n    between Python and JavaScript, manages map state, and provides common\n    mapping operations.\n\n    Attributes:\n        center: Map center coordinates as [longitude, latitude].\n        zoom: Map zoom level.\n        width: Map container width as CSS string.\n        height: Map container height as CSS string.\n        style: Map style configuration.\n    \"\"\"\n\n    # Widget traits for communication with JavaScript\n    center = traitlets.List([0.0, 0.0]).tag(sync=True)\n    zoom = traitlets.Float(2.0).tag(sync=True)\n    width = traitlets.Unicode(\"100%\").tag(sync=True)\n    height = traitlets.Unicode(\"600px\").tag(sync=True)\n    style = traitlets.Unicode(\"\").tag(sync=True)\n\n    # Communication traits\n    _js_calls = traitlets.List([]).tag(sync=True)\n    _js_events = traitlets.List([]).tag(sync=True)\n\n    # Internal state\n    _layers = traitlets.Dict({}).tag(sync=True)\n    _sources = traitlets.Dict({}).tag(sync=True)\n    _controls = traitlets.Dict({}).tag(sync=True)\n    _projection = traitlets.Dict({}).tag(sync=True)\n    _terrain = traitlets.Dict({}).tag(sync=True)\n\n    def __init__(self, **kwargs: Any) -&gt; None:\n        \"\"\"Initialize the map widget.\n\n        Args:\n            **kwargs: Additional keyword arguments passed to parent class.\n        \"\"\"\n        super().__init__(**kwargs)\n        self._event_handlers = {}\n        self._js_method_counter = 0\n\n    def call_js_method(self, method_name: str, *args: Any, **kwargs: Any) -&gt; None:\n        \"\"\"Call a JavaScript method on the map instance.\n\n        Args:\n            method_name: Name of the JavaScript method to call.\n            *args: Positional arguments to pass to the method.\n            **kwargs: Keyword arguments to pass to the method.\n        \"\"\"\n        call_data = {\n            \"id\": self._js_method_counter,\n            \"method\": method_name,\n            \"args\": args,\n            \"kwargs\": kwargs,\n        }\n        self._js_method_counter += 1\n\n        # Trigger sync by creating new list\n        current_calls = list(self._js_calls)\n        current_calls.append(call_data)\n        self._js_calls = current_calls\n\n    def on_map_event(\n        self, event_type: str, callback: Callable[[Dict[str, Any]], None]\n    ) -&gt; None:\n        \"\"\"Register a callback for map events.\n\n        Args:\n            event_type: Type of event to listen for (e.g., 'click', 'zoom').\n            callback: Function to call when the event occurs. Should accept\n                     a dictionary containing event data.\n        \"\"\"\n        if event_type not in self._event_handlers:\n            self._event_handlers[event_type] = []\n        self._event_handlers[event_type].append(callback)\n\n    @traitlets.observe(\"_js_events\")\n    def _handle_js_events(self, change: Dict[str, Any]) -&gt; None:\n        \"\"\"Handle events from JavaScript.\n\n        Args:\n            change: Dictionary containing the change information from traitlets.\n        \"\"\"\n        events = change[\"new\"]\n        for event in events:\n            event_type = event.get(\"type\")\n            if event_type in self._event_handlers:\n                for handler in self._event_handlers[event_type]:\n                    handler(event)\n\n    def set_center(self, lng: float, lat: float) -&gt; None:\n        \"\"\"Set the map center coordinates.\n\n        Args:\n            lng: Longitude coordinate.\n            lat: Latitude coordinate.\n        \"\"\"\n        self.center = [lng, lat]\n\n    def set_zoom(self, zoom: float) -&gt; None:\n        \"\"\"Set the map zoom level.\n\n        Args:\n            zoom: Zoom level (typically 0-20, where higher values show more detail).\n        \"\"\"\n        self.zoom = zoom\n\n    def fly_to(\n        self, lat: float, lng: float, zoom: Optional[float] = None, **kwargs\n    ) -&gt; None:\n        \"\"\"Animate the map to fly to a specific location.\n\n        Args:\n            lat: Target latitude coordinate.\n            lng: Target longitude coordinate.\n            zoom: Optional target zoom level. If None, keeps current zoom.\n        \"\"\"\n        options = {\"center\": [lat, lng], **kwargs}\n        if zoom is not None:\n            options[\"zoom\"] = zoom\n        self.call_js_method(\"flyTo\", options)\n\n    def add_layer(\n        self,\n        layer_id: str,\n        layer_config: Dict[str, Any],\n    ) -&gt; None:\n        \"\"\"Add a layer to the map.\n\n        Args:\n            layer_id: Unique identifier for the layer.\n            layer_config: Dictionary containing layer configuration.\n        \"\"\"\n        # Store layer in local state for persistence\n        current_layers = dict(self._layers)\n        current_layers[layer_id] = layer_config\n        self._layers = current_layers\n\n        self.call_js_method(\"addLayer\", layer_config, layer_id)\n\n    def remove_layer(self, layer_id: str) -&gt; None:\n        \"\"\"Remove a layer from the map.\n\n        Args:\n            layer_id: Unique identifier of the layer to remove.\n        \"\"\"\n        # Remove from local state\n        current_layers = dict(self._layers)\n        if layer_id in current_layers:\n            del current_layers[layer_id]\n            self._layers = current_layers\n\n        self.call_js_method(\"removeLayer\", layer_id)\n\n    def add_source(self, source_id: str, source_config: Dict[str, Any]) -&gt; None:\n        \"\"\"Add a data source to the map.\n\n        Args:\n            source_id: Unique identifier for the data source.\n            source_config: Dictionary containing source configuration.\n        \"\"\"\n        # Store source in local state for persistence\n        current_sources = dict(self._sources)\n        current_sources[source_id] = source_config\n        self._sources = current_sources\n\n        self.call_js_method(\"addSource\", source_id, source_config)\n\n    def remove_source(self, source_id: str) -&gt; None:\n        \"\"\"Remove a data source from the map.\n\n        Args:\n            source_id: Unique identifier of the source to remove.\n        \"\"\"\n        # Remove from local state\n        current_sources = dict(self._sources)\n        if source_id in current_sources:\n            del current_sources[source_id]\n            self._sources = current_sources\n\n        self.call_js_method(\"removeSource\", source_id)\n\n    def get_layers(self) -&gt; Dict[str, Any]:\n        \"\"\"Get all layers currently on the map.\n\n        Returns:\n            Dictionary mapping layer IDs to their configurations.\n        \"\"\"\n        return dict(self._layers)\n\n    def get_sources(self) -&gt; Dict[str, Any]:\n        \"\"\"Get all sources currently on the map.\n\n        Returns:\n            Dictionary mapping source IDs to their configurations.\n        \"\"\"\n        return dict(self._sources)\n\n    def clear_layers(self) -&gt; None:\n        \"\"\"Clear all layers from the map.\n\n        Removes all layers that have been added to the map.\n        \"\"\"\n        layer_ids = list(self._layers.keys())\n        for layer_id in layer_ids:\n            self.remove_layer(layer_id)\n\n    def clear_sources(self) -&gt; None:\n        \"\"\"Clear all sources from the map.\n\n        Removes all data sources that have been added to the map.\n        \"\"\"\n        source_ids = list(self._sources.keys())\n        for source_id in source_ids:\n            self.remove_source(source_id)\n\n    def clear_all(self) -&gt; None:\n        \"\"\"Clear all layers and sources from the map.\n\n        Removes all layers and data sources from the map.\n        \"\"\"\n        self.clear_layers()\n        self.clear_sources()\n\n    def to_html(\n        self,\n        filename: Optional[str] = None,\n        title: str = \"Anymap Export\",\n        width: str = \"100%\",\n        height: str = \"600px\",\n        **kwargs: Any,\n    ) -&gt; str:\n        \"\"\"Export the map to a standalone HTML file.\n\n        Args:\n            filename: Optional filename to save the HTML. If None, returns HTML string.\n            title: Title for the HTML page.\n            width: Width of the map container as CSS string.\n            height: Height of the map container as CSS string.\n            **kwargs: Additional arguments passed to the HTML template.\n\n        Returns:\n            HTML string content of the exported map.\n        \"\"\"\n        # Get the current map state\n        map_state = {\n            \"center\": self.center,\n            \"zoom\": self.zoom,\n            \"width\": width,\n            \"height\": height,\n            \"style\": self.style,\n            \"_layers\": dict(self._layers),\n            \"_sources\": dict(self._sources),\n            \"_controls\": dict(self._controls),\n            \"_terrain\": dict(self._terrain),\n        }\n\n        # Add class-specific attributes\n        if hasattr(self, \"style\"):\n            map_state[\"style\"] = self.style\n        if hasattr(self, \"bearing\"):\n            map_state[\"bearing\"] = self.bearing\n        if hasattr(self, \"pitch\"):\n            map_state[\"pitch\"] = self.pitch\n        if hasattr(self, \"antialias\"):\n            map_state[\"antialias\"] = self.antialias\n        if hasattr(self, \"access_token\"):\n            map_state[\"access_token\"] = self.access_token\n        if hasattr(self, \"_draw_data\"):\n            map_state[\"_draw_data\"] = dict(self._draw_data)\n\n        # Generate HTML content\n        html_content = self._generate_html_template(map_state, title, **kwargs)\n\n        # Save to file if filename is provided\n        if filename:\n            with open(filename, \"w\", encoding=\"utf-8\") as f:\n                f.write(html_content)\n\n        return html_content\n\n    def _generate_html_template(\n        self, map_state: Dict[str, Any], title: str, **kwargs: Any\n    ) -&gt; str:\n        \"\"\"Generate the HTML template with map state.\n\n        This method should be overridden by subclasses to provide library-specific templates.\n\n        Args:\n            map_state: Dictionary containing the current map state.\n            title: Title for the HTML page.\n            **kwargs: Additional arguments for template generation.\n\n        Returns:\n            HTML string content.\n\n        Raises:\n            NotImplementedError: This method must be implemented by subclasses.\n        \"\"\"\n        raise NotImplementedError(\"Subclasses must implement _generate_html_template\")\n</code></pre>"},{"location":"base/#anymap.base.MapWidget.__init__","title":"<code>__init__(self, **kwargs)</code>  <code>special</code>","text":"<p>Initialize the map widget.</p> <p>Parameters:</p> Name Type Description Default <code>**kwargs</code> <code>Any</code> <p>Additional keyword arguments passed to parent class.</p> <code>{}</code> Source code in <code>anymap/base.py</code> <pre><code>def __init__(self, **kwargs: Any) -&gt; None:\n    \"\"\"Initialize the map widget.\n\n    Args:\n        **kwargs: Additional keyword arguments passed to parent class.\n    \"\"\"\n    super().__init__(**kwargs)\n    self._event_handlers = {}\n    self._js_method_counter = 0\n</code></pre>"},{"location":"base/#anymap.base.MapWidget.add_layer","title":"<code>add_layer(self, layer_id, layer_config)</code>","text":"<p>Add a layer to the map.</p> <p>Parameters:</p> Name Type Description Default <code>layer_id</code> <code>str</code> <p>Unique identifier for the layer.</p> required <code>layer_config</code> <code>Dict[str, Any]</code> <p>Dictionary containing layer configuration.</p> required Source code in <code>anymap/base.py</code> <pre><code>def add_layer(\n    self,\n    layer_id: str,\n    layer_config: Dict[str, Any],\n) -&gt; None:\n    \"\"\"Add a layer to the map.\n\n    Args:\n        layer_id: Unique identifier for the layer.\n        layer_config: Dictionary containing layer configuration.\n    \"\"\"\n    # Store layer in local state for persistence\n    current_layers = dict(self._layers)\n    current_layers[layer_id] = layer_config\n    self._layers = current_layers\n\n    self.call_js_method(\"addLayer\", layer_config, layer_id)\n</code></pre>"},{"location":"base/#anymap.base.MapWidget.add_source","title":"<code>add_source(self, source_id, source_config)</code>","text":"<p>Add a data source to the map.</p> <p>Parameters:</p> Name Type Description Default <code>source_id</code> <code>str</code> <p>Unique identifier for the data source.</p> required <code>source_config</code> <code>Dict[str, Any]</code> <p>Dictionary containing source configuration.</p> required Source code in <code>anymap/base.py</code> <pre><code>def add_source(self, source_id: str, source_config: Dict[str, Any]) -&gt; None:\n    \"\"\"Add a data source to the map.\n\n    Args:\n        source_id: Unique identifier for the data source.\n        source_config: Dictionary containing source configuration.\n    \"\"\"\n    # Store source in local state for persistence\n    current_sources = dict(self._sources)\n    current_sources[source_id] = source_config\n    self._sources = current_sources\n\n    self.call_js_method(\"addSource\", source_id, source_config)\n</code></pre>"},{"location":"base/#anymap.base.MapWidget.call_js_method","title":"<code>call_js_method(self, method_name, *args, **kwargs)</code>","text":"<p>Call a JavaScript method on the map instance.</p> <p>Parameters:</p> Name Type Description Default <code>method_name</code> <code>str</code> <p>Name of the JavaScript method to call.</p> required <code>*args</code> <code>Any</code> <p>Positional arguments to pass to the method.</p> <code>()</code> <code>**kwargs</code> <code>Any</code> <p>Keyword arguments to pass to the method.</p> <code>{}</code> Source code in <code>anymap/base.py</code> <pre><code>def call_js_method(self, method_name: str, *args: Any, **kwargs: Any) -&gt; None:\n    \"\"\"Call a JavaScript method on the map instance.\n\n    Args:\n        method_name: Name of the JavaScript method to call.\n        *args: Positional arguments to pass to the method.\n        **kwargs: Keyword arguments to pass to the method.\n    \"\"\"\n    call_data = {\n        \"id\": self._js_method_counter,\n        \"method\": method_name,\n        \"args\": args,\n        \"kwargs\": kwargs,\n    }\n    self._js_method_counter += 1\n\n    # Trigger sync by creating new list\n    current_calls = list(self._js_calls)\n    current_calls.append(call_data)\n    self._js_calls = current_calls\n</code></pre>"},{"location":"base/#anymap.base.MapWidget.clear_all","title":"<code>clear_all(self)</code>","text":"<p>Clear all layers and sources from the map.</p> <p>Removes all layers and data sources from the map.</p> Source code in <code>anymap/base.py</code> <pre><code>def clear_all(self) -&gt; None:\n    \"\"\"Clear all layers and sources from the map.\n\n    Removes all layers and data sources from the map.\n    \"\"\"\n    self.clear_layers()\n    self.clear_sources()\n</code></pre>"},{"location":"base/#anymap.base.MapWidget.clear_layers","title":"<code>clear_layers(self)</code>","text":"<p>Clear all layers from the map.</p> <p>Removes all layers that have been added to the map.</p> Source code in <code>anymap/base.py</code> <pre><code>def clear_layers(self) -&gt; None:\n    \"\"\"Clear all layers from the map.\n\n    Removes all layers that have been added to the map.\n    \"\"\"\n    layer_ids = list(self._layers.keys())\n    for layer_id in layer_ids:\n        self.remove_layer(layer_id)\n</code></pre>"},{"location":"base/#anymap.base.MapWidget.clear_sources","title":"<code>clear_sources(self)</code>","text":"<p>Clear all sources from the map.</p> <p>Removes all data sources that have been added to the map.</p> Source code in <code>anymap/base.py</code> <pre><code>def clear_sources(self) -&gt; None:\n    \"\"\"Clear all sources from the map.\n\n    Removes all data sources that have been added to the map.\n    \"\"\"\n    source_ids = list(self._sources.keys())\n    for source_id in source_ids:\n        self.remove_source(source_id)\n</code></pre>"},{"location":"base/#anymap.base.MapWidget.fly_to","title":"<code>fly_to(self, lat, lng, zoom=None, **kwargs)</code>","text":"<p>Animate the map to fly to a specific location.</p> <p>Parameters:</p> Name Type Description Default <code>lat</code> <code>float</code> <p>Target latitude coordinate.</p> required <code>lng</code> <code>float</code> <p>Target longitude coordinate.</p> required <code>zoom</code> <code>Optional[float]</code> <p>Optional target zoom level. If None, keeps current zoom.</p> <code>None</code> Source code in <code>anymap/base.py</code> <pre><code>def fly_to(\n    self, lat: float, lng: float, zoom: Optional[float] = None, **kwargs\n) -&gt; None:\n    \"\"\"Animate the map to fly to a specific location.\n\n    Args:\n        lat: Target latitude coordinate.\n        lng: Target longitude coordinate.\n        zoom: Optional target zoom level. If None, keeps current zoom.\n    \"\"\"\n    options = {\"center\": [lat, lng], **kwargs}\n    if zoom is not None:\n        options[\"zoom\"] = zoom\n    self.call_js_method(\"flyTo\", options)\n</code></pre>"},{"location":"base/#anymap.base.MapWidget.get_layers","title":"<code>get_layers(self)</code>","text":"<p>Get all layers currently on the map.</p> <p>Returns:</p> Type Description <code>Dict[str, Any]</code> <p>Dictionary mapping layer IDs to their configurations.</p> Source code in <code>anymap/base.py</code> <pre><code>def get_layers(self) -&gt; Dict[str, Any]:\n    \"\"\"Get all layers currently on the map.\n\n    Returns:\n        Dictionary mapping layer IDs to their configurations.\n    \"\"\"\n    return dict(self._layers)\n</code></pre>"},{"location":"base/#anymap.base.MapWidget.get_sources","title":"<code>get_sources(self)</code>","text":"<p>Get all sources currently on the map.</p> <p>Returns:</p> Type Description <code>Dict[str, Any]</code> <p>Dictionary mapping source IDs to their configurations.</p> Source code in <code>anymap/base.py</code> <pre><code>def get_sources(self) -&gt; Dict[str, Any]:\n    \"\"\"Get all sources currently on the map.\n\n    Returns:\n        Dictionary mapping source IDs to their configurations.\n    \"\"\"\n    return dict(self._sources)\n</code></pre>"},{"location":"base/#anymap.base.MapWidget.on_map_event","title":"<code>on_map_event(self, event_type, callback)</code>","text":"<p>Register a callback for map events.</p> <p>Parameters:</p> Name Type Description Default <code>event_type</code> <code>str</code> <p>Type of event to listen for (e.g., 'click', 'zoom').</p> required <code>callback</code> <code>Callable[[Dict[str, Any]], NoneType]</code> <p>Function to call when the event occurs. Should accept      a dictionary containing event data.</p> required Source code in <code>anymap/base.py</code> <pre><code>def on_map_event(\n    self, event_type: str, callback: Callable[[Dict[str, Any]], None]\n) -&gt; None:\n    \"\"\"Register a callback for map events.\n\n    Args:\n        event_type: Type of event to listen for (e.g., 'click', 'zoom').\n        callback: Function to call when the event occurs. Should accept\n                 a dictionary containing event data.\n    \"\"\"\n    if event_type not in self._event_handlers:\n        self._event_handlers[event_type] = []\n    self._event_handlers[event_type].append(callback)\n</code></pre>"},{"location":"base/#anymap.base.MapWidget.remove_layer","title":"<code>remove_layer(self, layer_id)</code>","text":"<p>Remove a layer from the map.</p> <p>Parameters:</p> Name Type Description Default <code>layer_id</code> <code>str</code> <p>Unique identifier of the layer to remove.</p> required Source code in <code>anymap/base.py</code> <pre><code>def remove_layer(self, layer_id: str) -&gt; None:\n    \"\"\"Remove a layer from the map.\n\n    Args:\n        layer_id: Unique identifier of the layer to remove.\n    \"\"\"\n    # Remove from local state\n    current_layers = dict(self._layers)\n    if layer_id in current_layers:\n        del current_layers[layer_id]\n        self._layers = current_layers\n\n    self.call_js_method(\"removeLayer\", layer_id)\n</code></pre>"},{"location":"base/#anymap.base.MapWidget.remove_source","title":"<code>remove_source(self, source_id)</code>","text":"<p>Remove a data source from the map.</p> <p>Parameters:</p> Name Type Description Default <code>source_id</code> <code>str</code> <p>Unique identifier of the source to remove.</p> required Source code in <code>anymap/base.py</code> <pre><code>def remove_source(self, source_id: str) -&gt; None:\n    \"\"\"Remove a data source from the map.\n\n    Args:\n        source_id: Unique identifier of the source to remove.\n    \"\"\"\n    # Remove from local state\n    current_sources = dict(self._sources)\n    if source_id in current_sources:\n        del current_sources[source_id]\n        self._sources = current_sources\n\n    self.call_js_method(\"removeSource\", source_id)\n</code></pre>"},{"location":"base/#anymap.base.MapWidget.set_center","title":"<code>set_center(self, lng, lat)</code>","text":"<p>Set the map center coordinates.</p> <p>Parameters:</p> Name Type Description Default <code>lng</code> <code>float</code> <p>Longitude coordinate.</p> required <code>lat</code> <code>float</code> <p>Latitude coordinate.</p> required Source code in <code>anymap/base.py</code> <pre><code>def set_center(self, lng: float, lat: float) -&gt; None:\n    \"\"\"Set the map center coordinates.\n\n    Args:\n        lng: Longitude coordinate.\n        lat: Latitude coordinate.\n    \"\"\"\n    self.center = [lng, lat]\n</code></pre>"},{"location":"base/#anymap.base.MapWidget.set_zoom","title":"<code>set_zoom(self, zoom)</code>","text":"<p>Set the map zoom level.</p> <p>Parameters:</p> Name Type Description Default <code>zoom</code> <code>float</code> <p>Zoom level (typically 0-20, where higher values show more detail).</p> required Source code in <code>anymap/base.py</code> <pre><code>def set_zoom(self, zoom: float) -&gt; None:\n    \"\"\"Set the map zoom level.\n\n    Args:\n        zoom: Zoom level (typically 0-20, where higher values show more detail).\n    \"\"\"\n    self.zoom = zoom\n</code></pre>"},{"location":"base/#anymap.base.MapWidget.to_html","title":"<code>to_html(self, filename=None, title='Anymap Export', width='100%', height='600px', **kwargs)</code>","text":"<p>Export the map to a standalone HTML file.</p> <p>Parameters:</p> Name Type Description Default <code>filename</code> <code>Optional[str]</code> <p>Optional filename to save the HTML. If None, returns HTML string.</p> <code>None</code> <code>title</code> <code>str</code> <p>Title for the HTML page.</p> <code>'Anymap Export'</code> <code>width</code> <code>str</code> <p>Width of the map container as CSS string.</p> <code>'100%'</code> <code>height</code> <code>str</code> <p>Height of the map container as CSS string.</p> <code>'600px'</code> <code>**kwargs</code> <code>Any</code> <p>Additional arguments passed to the HTML template.</p> <code>{}</code> <p>Returns:</p> Type Description <code>str</code> <p>HTML string content of the exported map.</p> Source code in <code>anymap/base.py</code> <pre><code>def to_html(\n    self,\n    filename: Optional[str] = None,\n    title: str = \"Anymap Export\",\n    width: str = \"100%\",\n    height: str = \"600px\",\n    **kwargs: Any,\n) -&gt; str:\n    \"\"\"Export the map to a standalone HTML file.\n\n    Args:\n        filename: Optional filename to save the HTML. If None, returns HTML string.\n        title: Title for the HTML page.\n        width: Width of the map container as CSS string.\n        height: Height of the map container as CSS string.\n        **kwargs: Additional arguments passed to the HTML template.\n\n    Returns:\n        HTML string content of the exported map.\n    \"\"\"\n    # Get the current map state\n    map_state = {\n        \"center\": self.center,\n        \"zoom\": self.zoom,\n        \"width\": width,\n        \"height\": height,\n        \"style\": self.style,\n        \"_layers\": dict(self._layers),\n        \"_sources\": dict(self._sources),\n        \"_controls\": dict(self._controls),\n        \"_terrain\": dict(self._terrain),\n    }\n\n    # Add class-specific attributes\n    if hasattr(self, \"style\"):\n        map_state[\"style\"] = self.style\n    if hasattr(self, \"bearing\"):\n        map_state[\"bearing\"] = self.bearing\n    if hasattr(self, \"pitch\"):\n        map_state[\"pitch\"] = self.pitch\n    if hasattr(self, \"antialias\"):\n        map_state[\"antialias\"] = self.antialias\n    if hasattr(self, \"access_token\"):\n        map_state[\"access_token\"] = self.access_token\n    if hasattr(self, \"_draw_data\"):\n        map_state[\"_draw_data\"] = dict(self._draw_data)\n\n    # Generate HTML content\n    html_content = self._generate_html_template(map_state, title, **kwargs)\n\n    # Save to file if filename is provided\n    if filename:\n        with open(filename, \"w\", encoding=\"utf-8\") as f:\n            f.write(html_content)\n\n    return html_content\n</code></pre>"},{"location":"cesium/","title":"cesium module","text":"<p>Cesium ion implementation of the map widget for 3D globe visualization.</p>"},{"location":"cesium/#anymap.cesium.CesiumMap","title":"<code> CesiumMap            (MapWidget)         </code>","text":"<p>Cesium ion implementation of the map widget for 3D globe visualization.</p> Source code in <code>anymap/cesium.py</code> <pre><code>class CesiumMap(MapWidget):\n    \"\"\"Cesium ion implementation of the map widget for 3D globe visualization.\"\"\"\n\n    # Cesium-specific traits\n    access_token = traitlets.Unicode(\"\").tag(sync=True)\n    camera_height = traitlets.Float(10000000.0).tag(sync=True)  # 10M meters default\n    heading = traitlets.Float(0.0).tag(sync=True)\n    pitch = traitlets.Float(-90.0).tag(sync=True)  # Looking down\n    roll = traitlets.Float(0.0).tag(sync=True)\n\n    # Cesium viewer options\n    base_layer_picker = traitlets.Bool(True).tag(sync=True)\n    fullscreen_button = traitlets.Bool(True).tag(sync=True)\n    vr_button = traitlets.Bool(False).tag(sync=True)\n    geocoder = traitlets.Bool(True).tag(sync=True)\n    home_button = traitlets.Bool(True).tag(sync=True)\n    info_box = traitlets.Bool(True).tag(sync=True)\n    scene_mode_picker = traitlets.Bool(True).tag(sync=True)\n    selection_indicator = traitlets.Bool(True).tag(sync=True)\n    timeline = traitlets.Bool(False).tag(sync=True)\n    navigation_help_button = traitlets.Bool(False).tag(\n        sync=True\n    )  # Disabled by default to prevent arrows\n    animation = traitlets.Bool(False).tag(sync=True)\n    should_animate = traitlets.Bool(False).tag(sync=True)\n\n    # Define the JavaScript module path\n    _esm = _esm_cesium\n    _css = _css_cesium\n\n    def __init__(\n        self,\n        center: List[float] = [0.0, 0.0],\n        zoom: float = 2.0,\n        width: str = \"100%\",\n        height: str = \"600px\",\n        camera_height: float = 10000000.0,\n        heading: float = 0.0,\n        pitch: float = -90.0,\n        roll: float = 0.0,\n        access_token: str = \"\",\n        base_layer_picker: bool = True,\n        fullscreen_button: bool = True,\n        vr_button: bool = False,\n        geocoder: bool = True,\n        home_button: bool = True,\n        info_box: bool = True,\n        scene_mode_picker: bool = True,\n        selection_indicator: bool = True,\n        timeline: bool = False,\n        navigation_help_button: bool = False,\n        animation: bool = False,\n        should_animate: bool = False,\n        **kwargs,\n    ):\n        \"\"\"Initialize Cesium map widget.\n\n        Args:\n            center: Map center as [latitude, longitude]\n            zoom: Initial zoom level (used for camera height calculation)\n            width: Widget width\n            height: Widget height\n            camera_height: Camera height above ground in meters\n            heading: Camera heading in degrees (0 = north, 90 = east)\n            pitch: Camera pitch in degrees (-90 = looking down, 0 = horizon)\n            roll: Camera roll in degrees\n            access_token: Cesium ion access token (required for Cesium services).\n                         Get a free token at https://cesium.com/ion/signup\n                         Can also be set via CESIUM_TOKEN environment variable.\n            base_layer_picker: Show base layer picker widget\n            fullscreen_button: Show fullscreen button\n            vr_button: Show VR button\n            geocoder: Show geocoder search widget\n            home_button: Show home button\n            info_box: Show info box when clicking entities\n            scene_mode_picker: Show 3D/2D/Columbus view picker\n            selection_indicator: Show selection indicator\n            timeline: Show timeline widget\n            navigation_help_button: Show navigation help button\n            animation: Show animation widget\n            should_animate: Enable automatic animation\n        \"\"\"\n        # Set default access token if not provided\n        if not access_token:\n            access_token = self._get_default_access_token()\n\n        super().__init__(\n            center=center,\n            zoom=zoom,\n            width=width,\n            height=height,\n            camera_height=camera_height,\n            heading=heading,\n            pitch=pitch,\n            roll=roll,\n            access_token=access_token,\n            base_layer_picker=base_layer_picker,\n            fullscreen_button=fullscreen_button,\n            vr_button=vr_button,\n            geocoder=geocoder,\n            home_button=home_button,\n            info_box=info_box,\n            scene_mode_picker=scene_mode_picker,\n            selection_indicator=selection_indicator,\n            timeline=timeline,\n            navigation_help_button=navigation_help_button,\n            animation=animation,\n            should_animate=should_animate,\n            **kwargs,\n        )\n\n    @staticmethod\n    def _get_default_access_token() -&gt; str:\n        \"\"\"Get default Cesium access token from environment.\"\"\"\n        import os\n\n        # Try to get from environment variable\n        token = os.environ.get(\"CESIUM_TOKEN\") or os.environ.get(\"CESIUM_ACCESS_TOKEN\")\n\n        # If no token found, return empty string - user must provide their own token\n        if not token:\n            import warnings\n\n            warnings.warn(\n                \"No Cesium access token found. Please set CESIUM_TOKEN environment variable \"\n                \"or pass access_token parameter. Get a free token at https://cesium.com/ion/signup\",\n                UserWarning,\n            )\n            token = \"\"\n\n        return token\n\n    def set_access_token(self, token: str) -&gt; None:\n        \"\"\"Set the Cesium ion access token.\"\"\"\n        self.access_token = token\n\n    def fly_to(\n        self,\n        latitude: float,\n        longitude: float,\n        height: Optional[float] = None,\n        heading: Optional[float] = None,\n        pitch: Optional[float] = None,\n        roll: Optional[float] = None,\n        duration: float = 3.0,\n    ) -&gt; None:\n        \"\"\"Fly the camera to a specific location.\"\"\"\n        options = {\"latitude\": latitude, \"longitude\": longitude, \"duration\": duration}\n        if height is not None:\n            options[\"height\"] = height\n        if heading is not None:\n            options[\"heading\"] = heading\n        if pitch is not None:\n            options[\"pitch\"] = pitch\n        if roll is not None:\n            options[\"roll\"] = roll\n\n        self.call_js_method(\"flyTo\", options)\n\n    def set_camera_position(\n        self,\n        latitude: float,\n        longitude: float,\n        height: float,\n        heading: float = 0.0,\n        pitch: float = -90.0,\n        roll: float = 0.0,\n    ) -&gt; None:\n        \"\"\"Set camera position immediately.\"\"\"\n        self.center = [latitude, longitude]\n        self.camera_height = height\n        self.heading = heading\n        self.pitch = pitch\n        self.roll = roll\n\n    def add_entity(self, entity_config: Dict[str, Any]) -&gt; None:\n        \"\"\"Add an entity to the globe.\"\"\"\n        self.call_js_method(\"addEntity\", entity_config)\n\n    def remove_entity(self, entity_id: str) -&gt; None:\n        \"\"\"Remove an entity from the globe.\"\"\"\n        self.call_js_method(\"removeEntity\", entity_id)\n\n    def add_point(\n        self,\n        latitude: float,\n        longitude: float,\n        height: float = 0.0,\n        name: Optional[str] = None,\n        description: Optional[str] = None,\n        color: str = \"#ffff00\",\n        pixel_size: int = 10,\n        entity_id: Optional[str] = None,\n    ) -&gt; str:\n        \"\"\"Add a point to the globe.\"\"\"\n        if entity_id is None:\n            entity_id = f\"point_{len(self._layers)}\"\n\n        entity_config = {\n            \"id\": entity_id,\n            \"position\": {\n                \"longitude\": longitude,\n                \"latitude\": latitude,\n                \"height\": height,\n            },\n            \"point\": {\n                \"pixelSize\": pixel_size,\n                \"color\": color,\n                \"outlineColor\": \"#000000\",\n                \"outlineWidth\": 2,\n                \"heightReference\": \"CLAMP_TO_GROUND\" if height == 0 else \"NONE\",\n            },\n        }\n\n        if name:\n            entity_config[\"name\"] = name\n        if description:\n            entity_config[\"description\"] = description\n\n        self.add_entity(entity_config)\n        return entity_id\n\n    def add_billboard(\n        self,\n        latitude: float,\n        longitude: float,\n        image_url: str,\n        height: float = 0.0,\n        scale: float = 1.0,\n        name: Optional[str] = None,\n        description: Optional[str] = None,\n        entity_id: Optional[str] = None,\n    ) -&gt; str:\n        \"\"\"Add a billboard (image marker) to the globe.\"\"\"\n        if entity_id is None:\n            entity_id = f\"billboard_{len(self._layers)}\"\n\n        entity_config = {\n            \"id\": entity_id,\n            \"position\": {\n                \"longitude\": longitude,\n                \"latitude\": latitude,\n                \"height\": height,\n            },\n            \"billboard\": {\n                \"image\": image_url,\n                \"scale\": scale,\n                \"heightReference\": \"CLAMP_TO_GROUND\" if height == 0 else \"NONE\",\n            },\n        }\n\n        if name:\n            entity_config[\"name\"] = name\n        if description:\n            entity_config[\"description\"] = description\n\n        self.add_entity(entity_config)\n        return entity_id\n\n    def add_polyline(\n        self,\n        coordinates: List[List[float]],\n        color: str = \"#ff0000\",\n        width: int = 2,\n        clamp_to_ground: bool = True,\n        name: Optional[str] = None,\n        description: Optional[str] = None,\n        entity_id: Optional[str] = None,\n    ) -&gt; str:\n        \"\"\"Add a polyline to the globe.\"\"\"\n        if entity_id is None:\n            entity_id = f\"polyline_{len(self._layers)}\"\n\n        # Convert coordinates to Cesium format\n        positions = []\n        for coord in coordinates:\n            if len(coord) &gt;= 2:\n                positions.extend(\n                    [coord[1], coord[0], coord[2] if len(coord) &gt; 2 else 0]\n                )\n\n        entity_config = {\n            \"id\": entity_id,\n            \"polyline\": {\n                \"positions\": positions,\n                \"width\": width,\n                \"material\": color,\n                \"clampToGround\": clamp_to_ground,\n            },\n        }\n\n        if name:\n            entity_config[\"name\"] = name\n        if description:\n            entity_config[\"description\"] = description\n\n        self.add_entity(entity_config)\n        return entity_id\n\n    def add_polygon(\n        self,\n        coordinates: List[List[float]],\n        color: str = \"#0000ff\",\n        outline_color: str = \"#000000\",\n        height: float = 0.0,\n        extrude_height: Optional[float] = None,\n        name: Optional[str] = None,\n        description: Optional[str] = None,\n        entity_id: Optional[str] = None,\n    ) -&gt; str:\n        \"\"\"Add a polygon to the globe.\"\"\"\n        if entity_id is None:\n            entity_id = f\"polygon_{len(self._layers)}\"\n\n        # Convert coordinates to Cesium format\n        positions = []\n        for coord in coordinates:\n            if len(coord) &gt;= 2:\n                positions.extend([coord[1], coord[0]])\n\n        entity_config = {\n            \"id\": entity_id,\n            \"polygon\": {\n                \"hierarchy\": positions,\n                \"material\": color,\n                \"outline\": True,\n                \"outlineColor\": outline_color,\n                \"height\": height,\n            },\n        }\n\n        if extrude_height is not None:\n            entity_config[\"polygon\"][\"extrudedHeight\"] = extrude_height\n\n        if name:\n            entity_config[\"name\"] = name\n        if description:\n            entity_config[\"description\"] = description\n\n        self.add_entity(entity_config)\n        return entity_id\n\n    def add_data_source(\n        self,\n        source_type: str,\n        data: Union[str, Dict[str, Any]],\n        options: Optional[Dict[str, Any]] = None,\n    ) -&gt; None:\n        \"\"\"Add a data source (GeoJSON, KML, CZML) to the globe.\"\"\"\n        config = {\"data\": data, \"options\": options or {}}\n        self.call_js_method(\"addDataSource\", source_type, config)\n\n    def add_geojson(\n        self, geojson_data: Dict[str, Any], options: Optional[Dict[str, Any]] = None\n    ) -&gt; None:\n        \"\"\"Add GeoJSON data to the globe.\"\"\"\n        self.add_data_source(\"geojson\", geojson_data, options)\n\n    def add_kml(self, kml_url: str, options: Optional[Dict[str, Any]] = None) -&gt; None:\n        \"\"\"Add KML data to the globe.\"\"\"\n        self.add_data_source(\"kml\", kml_url, options)\n\n    def add_czml(\n        self, czml_data: List[Dict[str, Any]], options: Optional[Dict[str, Any]] = None\n    ) -&gt; None:\n        \"\"\"Add CZML data to the globe.\"\"\"\n        self.add_data_source(\"czml\", czml_data, options)\n\n    def set_terrain(self, terrain_config: Optional[Dict[str, Any]] = None) -&gt; None:\n        \"\"\"Set terrain provider for the globe.\"\"\"\n        self.call_js_method(\"setTerrain\", terrain_config)\n\n    def set_cesium_world_terrain(\n        self, request_water_mask: bool = False, request_vertex_normals: bool = False\n    ) -&gt; None:\n        \"\"\"Set Cesium World Terrain as the terrain provider.\"\"\"\n        terrain_config = {\n            \"type\": \"cesium-world-terrain\",\n            \"requestWaterMask\": request_water_mask,\n            \"requestVertexNormals\": request_vertex_normals,\n        }\n        self.set_terrain(terrain_config)\n\n    def set_imagery(self, imagery_config: Dict[str, Any]) -&gt; None:\n        \"\"\"Set imagery provider for the globe.\"\"\"\n        self.call_js_method(\"setImagery\", imagery_config)\n\n    def set_scene_mode_3d(self) -&gt; None:\n        \"\"\"Set scene to 3D mode.\"\"\"\n        self.call_js_method(\"setScene3D\")\n\n    def set_scene_mode_2d(self) -&gt; None:\n        \"\"\"Set scene to 2D mode.\"\"\"\n        self.call_js_method(\"setScene2D\")\n\n    def set_scene_mode_columbus(self) -&gt; None:\n        \"\"\"Set scene to Columbus view (2.5D).\"\"\"\n        self.call_js_method(\"setSceneColumbusView\")\n\n    def enable_lighting(self, enabled: bool = True) -&gt; None:\n        \"\"\"Enable or disable globe lighting effects.\"\"\"\n        self.call_js_method(\"enableLighting\", enabled)\n\n    def enable_fog(self, enabled: bool = True) -&gt; None:\n        \"\"\"Enable or disable atmospheric fog.\"\"\"\n        self.call_js_method(\"enableFog\", enabled)\n\n    def zoom_to_entity(self, entity_id: str) -&gt; None:\n        \"\"\"Zoom the camera to focus on a specific entity.\"\"\"\n        self.call_js_method(\"zoomToEntity\", entity_id)\n\n    def home(self) -&gt; None:\n        \"\"\"Reset camera to home position.\"\"\"\n        self.call_js_method(\"home\")\n\n    def clear_entities(self) -&gt; None:\n        \"\"\"Clear all entities from the globe.\"\"\"\n        # This would require tracking entities, for now use clear_layers\n        self.clear_layers()\n\n    def clear_layers(self) -&gt; None:\n        \"\"\"Remove all layers from the map.\"\"\"\n        for layer_id in list(self._layers.keys()):\n            self.remove_layer(layer_id)\n\n    def clear_sources(self) -&gt; None:\n        \"\"\"Remove all sources from the map.\"\"\"\n        for source_id in list(self._sources.keys()):\n            self.remove_source(source_id)\n\n    def clear_all(self) -&gt; None:\n        \"\"\"Clear all layers and sources from the map.\"\"\"\n        self.clear_layers()\n        self.clear_sources()\n</code></pre>"},{"location":"cesium/#anymap.cesium.CesiumMap.__init__","title":"<code>__init__(self, center=[0.0, 0.0], zoom=2.0, width='100%', height='600px', camera_height=10000000.0, heading=0.0, pitch=-90.0, roll=0.0, access_token='', base_layer_picker=True, fullscreen_button=True, vr_button=False, geocoder=True, home_button=True, info_box=True, scene_mode_picker=True, selection_indicator=True, timeline=False, navigation_help_button=False, animation=False, should_animate=False, **kwargs)</code>  <code>special</code>","text":"<p>Initialize Cesium map widget.</p> <p>Parameters:</p> Name Type Description Default <code>center</code> <code>List[float]</code> <p>Map center as [latitude, longitude]</p> <code>[0.0, 0.0]</code> <code>zoom</code> <code>float</code> <p>Initial zoom level (used for camera height calculation)</p> <code>2.0</code> <code>width</code> <code>str</code> <p>Widget width</p> <code>'100%'</code> <code>height</code> <code>str</code> <p>Widget height</p> <code>'600px'</code> <code>camera_height</code> <code>float</code> <p>Camera height above ground in meters</p> <code>10000000.0</code> <code>heading</code> <code>float</code> <p>Camera heading in degrees (0 = north, 90 = east)</p> <code>0.0</code> <code>pitch</code> <code>float</code> <p>Camera pitch in degrees (-90 = looking down, 0 = horizon)</p> <code>-90.0</code> <code>roll</code> <code>float</code> <p>Camera roll in degrees</p> <code>0.0</code> <code>access_token</code> <code>str</code> <p>Cesium ion access token (required for Cesium services).          Get a free token at https://cesium.com/ion/signup          Can also be set via CESIUM_TOKEN environment variable.</p> <code>''</code> <code>base_layer_picker</code> <code>bool</code> <p>Show base layer picker widget</p> <code>True</code> <code>fullscreen_button</code> <code>bool</code> <p>Show fullscreen button</p> <code>True</code> <code>vr_button</code> <code>bool</code> <p>Show VR button</p> <code>False</code> <code>geocoder</code> <code>bool</code> <p>Show geocoder search widget</p> <code>True</code> <code>home_button</code> <code>bool</code> <p>Show home button</p> <code>True</code> <code>info_box</code> <code>bool</code> <p>Show info box when clicking entities</p> <code>True</code> <code>scene_mode_picker</code> <code>bool</code> <p>Show 3D/2D/Columbus view picker</p> <code>True</code> <code>selection_indicator</code> <code>bool</code> <p>Show selection indicator</p> <code>True</code> <code>timeline</code> <code>bool</code> <p>Show timeline widget</p> <code>False</code> <code>navigation_help_button</code> <code>bool</code> <p>Show navigation help button</p> <code>False</code> <code>animation</code> <code>bool</code> <p>Show animation widget</p> <code>False</code> <code>should_animate</code> <code>bool</code> <p>Enable automatic animation</p> <code>False</code> Source code in <code>anymap/cesium.py</code> <pre><code>def __init__(\n    self,\n    center: List[float] = [0.0, 0.0],\n    zoom: float = 2.0,\n    width: str = \"100%\",\n    height: str = \"600px\",\n    camera_height: float = 10000000.0,\n    heading: float = 0.0,\n    pitch: float = -90.0,\n    roll: float = 0.0,\n    access_token: str = \"\",\n    base_layer_picker: bool = True,\n    fullscreen_button: bool = True,\n    vr_button: bool = False,\n    geocoder: bool = True,\n    home_button: bool = True,\n    info_box: bool = True,\n    scene_mode_picker: bool = True,\n    selection_indicator: bool = True,\n    timeline: bool = False,\n    navigation_help_button: bool = False,\n    animation: bool = False,\n    should_animate: bool = False,\n    **kwargs,\n):\n    \"\"\"Initialize Cesium map widget.\n\n    Args:\n        center: Map center as [latitude, longitude]\n        zoom: Initial zoom level (used for camera height calculation)\n        width: Widget width\n        height: Widget height\n        camera_height: Camera height above ground in meters\n        heading: Camera heading in degrees (0 = north, 90 = east)\n        pitch: Camera pitch in degrees (-90 = looking down, 0 = horizon)\n        roll: Camera roll in degrees\n        access_token: Cesium ion access token (required for Cesium services).\n                     Get a free token at https://cesium.com/ion/signup\n                     Can also be set via CESIUM_TOKEN environment variable.\n        base_layer_picker: Show base layer picker widget\n        fullscreen_button: Show fullscreen button\n        vr_button: Show VR button\n        geocoder: Show geocoder search widget\n        home_button: Show home button\n        info_box: Show info box when clicking entities\n        scene_mode_picker: Show 3D/2D/Columbus view picker\n        selection_indicator: Show selection indicator\n        timeline: Show timeline widget\n        navigation_help_button: Show navigation help button\n        animation: Show animation widget\n        should_animate: Enable automatic animation\n    \"\"\"\n    # Set default access token if not provided\n    if not access_token:\n        access_token = self._get_default_access_token()\n\n    super().__init__(\n        center=center,\n        zoom=zoom,\n        width=width,\n        height=height,\n        camera_height=camera_height,\n        heading=heading,\n        pitch=pitch,\n        roll=roll,\n        access_token=access_token,\n        base_layer_picker=base_layer_picker,\n        fullscreen_button=fullscreen_button,\n        vr_button=vr_button,\n        geocoder=geocoder,\n        home_button=home_button,\n        info_box=info_box,\n        scene_mode_picker=scene_mode_picker,\n        selection_indicator=selection_indicator,\n        timeline=timeline,\n        navigation_help_button=navigation_help_button,\n        animation=animation,\n        should_animate=should_animate,\n        **kwargs,\n    )\n</code></pre>"},{"location":"cesium/#anymap.cesium.CesiumMap.add_billboard","title":"<code>add_billboard(self, latitude, longitude, image_url, height=0.0, scale=1.0, name=None, description=None, entity_id=None)</code>","text":"<p>Add a billboard (image marker) to the globe.</p> Source code in <code>anymap/cesium.py</code> <pre><code>def add_billboard(\n    self,\n    latitude: float,\n    longitude: float,\n    image_url: str,\n    height: float = 0.0,\n    scale: float = 1.0,\n    name: Optional[str] = None,\n    description: Optional[str] = None,\n    entity_id: Optional[str] = None,\n) -&gt; str:\n    \"\"\"Add a billboard (image marker) to the globe.\"\"\"\n    if entity_id is None:\n        entity_id = f\"billboard_{len(self._layers)}\"\n\n    entity_config = {\n        \"id\": entity_id,\n        \"position\": {\n            \"longitude\": longitude,\n            \"latitude\": latitude,\n            \"height\": height,\n        },\n        \"billboard\": {\n            \"image\": image_url,\n            \"scale\": scale,\n            \"heightReference\": \"CLAMP_TO_GROUND\" if height == 0 else \"NONE\",\n        },\n    }\n\n    if name:\n        entity_config[\"name\"] = name\n    if description:\n        entity_config[\"description\"] = description\n\n    self.add_entity(entity_config)\n    return entity_id\n</code></pre>"},{"location":"cesium/#anymap.cesium.CesiumMap.add_czml","title":"<code>add_czml(self, czml_data, options=None)</code>","text":"<p>Add CZML data to the globe.</p> Source code in <code>anymap/cesium.py</code> <pre><code>def add_czml(\n    self, czml_data: List[Dict[str, Any]], options: Optional[Dict[str, Any]] = None\n) -&gt; None:\n    \"\"\"Add CZML data to the globe.\"\"\"\n    self.add_data_source(\"czml\", czml_data, options)\n</code></pre>"},{"location":"cesium/#anymap.cesium.CesiumMap.add_data_source","title":"<code>add_data_source(self, source_type, data, options=None)</code>","text":"<p>Add a data source (GeoJSON, KML, CZML) to the globe.</p> Source code in <code>anymap/cesium.py</code> <pre><code>def add_data_source(\n    self,\n    source_type: str,\n    data: Union[str, Dict[str, Any]],\n    options: Optional[Dict[str, Any]] = None,\n) -&gt; None:\n    \"\"\"Add a data source (GeoJSON, KML, CZML) to the globe.\"\"\"\n    config = {\"data\": data, \"options\": options or {}}\n    self.call_js_method(\"addDataSource\", source_type, config)\n</code></pre>"},{"location":"cesium/#anymap.cesium.CesiumMap.add_entity","title":"<code>add_entity(self, entity_config)</code>","text":"<p>Add an entity to the globe.</p> Source code in <code>anymap/cesium.py</code> <pre><code>def add_entity(self, entity_config: Dict[str, Any]) -&gt; None:\n    \"\"\"Add an entity to the globe.\"\"\"\n    self.call_js_method(\"addEntity\", entity_config)\n</code></pre>"},{"location":"cesium/#anymap.cesium.CesiumMap.add_geojson","title":"<code>add_geojson(self, geojson_data, options=None)</code>","text":"<p>Add GeoJSON data to the globe.</p> Source code in <code>anymap/cesium.py</code> <pre><code>def add_geojson(\n    self, geojson_data: Dict[str, Any], options: Optional[Dict[str, Any]] = None\n) -&gt; None:\n    \"\"\"Add GeoJSON data to the globe.\"\"\"\n    self.add_data_source(\"geojson\", geojson_data, options)\n</code></pre>"},{"location":"cesium/#anymap.cesium.CesiumMap.add_kml","title":"<code>add_kml(self, kml_url, options=None)</code>","text":"<p>Add KML data to the globe.</p> Source code in <code>anymap/cesium.py</code> <pre><code>def add_kml(self, kml_url: str, options: Optional[Dict[str, Any]] = None) -&gt; None:\n    \"\"\"Add KML data to the globe.\"\"\"\n    self.add_data_source(\"kml\", kml_url, options)\n</code></pre>"},{"location":"cesium/#anymap.cesium.CesiumMap.add_point","title":"<code>add_point(self, latitude, longitude, height=0.0, name=None, description=None, color='#ffff00', pixel_size=10, entity_id=None)</code>","text":"<p>Add a point to the globe.</p> Source code in <code>anymap/cesium.py</code> <pre><code>def add_point(\n    self,\n    latitude: float,\n    longitude: float,\n    height: float = 0.0,\n    name: Optional[str] = None,\n    description: Optional[str] = None,\n    color: str = \"#ffff00\",\n    pixel_size: int = 10,\n    entity_id: Optional[str] = None,\n) -&gt; str:\n    \"\"\"Add a point to the globe.\"\"\"\n    if entity_id is None:\n        entity_id = f\"point_{len(self._layers)}\"\n\n    entity_config = {\n        \"id\": entity_id,\n        \"position\": {\n            \"longitude\": longitude,\n            \"latitude\": latitude,\n            \"height\": height,\n        },\n        \"point\": {\n            \"pixelSize\": pixel_size,\n            \"color\": color,\n            \"outlineColor\": \"#000000\",\n            \"outlineWidth\": 2,\n            \"heightReference\": \"CLAMP_TO_GROUND\" if height == 0 else \"NONE\",\n        },\n    }\n\n    if name:\n        entity_config[\"name\"] = name\n    if description:\n        entity_config[\"description\"] = description\n\n    self.add_entity(entity_config)\n    return entity_id\n</code></pre>"},{"location":"cesium/#anymap.cesium.CesiumMap.add_polygon","title":"<code>add_polygon(self, coordinates, color='#0000ff', outline_color='#000000', height=0.0, extrude_height=None, name=None, description=None, entity_id=None)</code>","text":"<p>Add a polygon to the globe.</p> Source code in <code>anymap/cesium.py</code> <pre><code>def add_polygon(\n    self,\n    coordinates: List[List[float]],\n    color: str = \"#0000ff\",\n    outline_color: str = \"#000000\",\n    height: float = 0.0,\n    extrude_height: Optional[float] = None,\n    name: Optional[str] = None,\n    description: Optional[str] = None,\n    entity_id: Optional[str] = None,\n) -&gt; str:\n    \"\"\"Add a polygon to the globe.\"\"\"\n    if entity_id is None:\n        entity_id = f\"polygon_{len(self._layers)}\"\n\n    # Convert coordinates to Cesium format\n    positions = []\n    for coord in coordinates:\n        if len(coord) &gt;= 2:\n            positions.extend([coord[1], coord[0]])\n\n    entity_config = {\n        \"id\": entity_id,\n        \"polygon\": {\n            \"hierarchy\": positions,\n            \"material\": color,\n            \"outline\": True,\n            \"outlineColor\": outline_color,\n            \"height\": height,\n        },\n    }\n\n    if extrude_height is not None:\n        entity_config[\"polygon\"][\"extrudedHeight\"] = extrude_height\n\n    if name:\n        entity_config[\"name\"] = name\n    if description:\n        entity_config[\"description\"] = description\n\n    self.add_entity(entity_config)\n    return entity_id\n</code></pre>"},{"location":"cesium/#anymap.cesium.CesiumMap.add_polyline","title":"<code>add_polyline(self, coordinates, color='#ff0000', width=2, clamp_to_ground=True, name=None, description=None, entity_id=None)</code>","text":"<p>Add a polyline to the globe.</p> Source code in <code>anymap/cesium.py</code> <pre><code>def add_polyline(\n    self,\n    coordinates: List[List[float]],\n    color: str = \"#ff0000\",\n    width: int = 2,\n    clamp_to_ground: bool = True,\n    name: Optional[str] = None,\n    description: Optional[str] = None,\n    entity_id: Optional[str] = None,\n) -&gt; str:\n    \"\"\"Add a polyline to the globe.\"\"\"\n    if entity_id is None:\n        entity_id = f\"polyline_{len(self._layers)}\"\n\n    # Convert coordinates to Cesium format\n    positions = []\n    for coord in coordinates:\n        if len(coord) &gt;= 2:\n            positions.extend(\n                [coord[1], coord[0], coord[2] if len(coord) &gt; 2 else 0]\n            )\n\n    entity_config = {\n        \"id\": entity_id,\n        \"polyline\": {\n            \"positions\": positions,\n            \"width\": width,\n            \"material\": color,\n            \"clampToGround\": clamp_to_ground,\n        },\n    }\n\n    if name:\n        entity_config[\"name\"] = name\n    if description:\n        entity_config[\"description\"] = description\n\n    self.add_entity(entity_config)\n    return entity_id\n</code></pre>"},{"location":"cesium/#anymap.cesium.CesiumMap.clear_all","title":"<code>clear_all(self)</code>","text":"<p>Clear all layers and sources from the map.</p> Source code in <code>anymap/cesium.py</code> <pre><code>def clear_all(self) -&gt; None:\n    \"\"\"Clear all layers and sources from the map.\"\"\"\n    self.clear_layers()\n    self.clear_sources()\n</code></pre>"},{"location":"cesium/#anymap.cesium.CesiumMap.clear_entities","title":"<code>clear_entities(self)</code>","text":"<p>Clear all entities from the globe.</p> Source code in <code>anymap/cesium.py</code> <pre><code>def clear_entities(self) -&gt; None:\n    \"\"\"Clear all entities from the globe.\"\"\"\n    # This would require tracking entities, for now use clear_layers\n    self.clear_layers()\n</code></pre>"},{"location":"cesium/#anymap.cesium.CesiumMap.clear_layers","title":"<code>clear_layers(self)</code>","text":"<p>Remove all layers from the map.</p> Source code in <code>anymap/cesium.py</code> <pre><code>def clear_layers(self) -&gt; None:\n    \"\"\"Remove all layers from the map.\"\"\"\n    for layer_id in list(self._layers.keys()):\n        self.remove_layer(layer_id)\n</code></pre>"},{"location":"cesium/#anymap.cesium.CesiumMap.clear_sources","title":"<code>clear_sources(self)</code>","text":"<p>Remove all sources from the map.</p> Source code in <code>anymap/cesium.py</code> <pre><code>def clear_sources(self) -&gt; None:\n    \"\"\"Remove all sources from the map.\"\"\"\n    for source_id in list(self._sources.keys()):\n        self.remove_source(source_id)\n</code></pre>"},{"location":"cesium/#anymap.cesium.CesiumMap.enable_fog","title":"<code>enable_fog(self, enabled=True)</code>","text":"<p>Enable or disable atmospheric fog.</p> Source code in <code>anymap/cesium.py</code> <pre><code>def enable_fog(self, enabled: bool = True) -&gt; None:\n    \"\"\"Enable or disable atmospheric fog.\"\"\"\n    self.call_js_method(\"enableFog\", enabled)\n</code></pre>"},{"location":"cesium/#anymap.cesium.CesiumMap.enable_lighting","title":"<code>enable_lighting(self, enabled=True)</code>","text":"<p>Enable or disable globe lighting effects.</p> Source code in <code>anymap/cesium.py</code> <pre><code>def enable_lighting(self, enabled: bool = True) -&gt; None:\n    \"\"\"Enable or disable globe lighting effects.\"\"\"\n    self.call_js_method(\"enableLighting\", enabled)\n</code></pre>"},{"location":"cesium/#anymap.cesium.CesiumMap.fly_to","title":"<code>fly_to(self, latitude, longitude, height=None, heading=None, pitch=None, roll=None, duration=3.0)</code>","text":"<p>Fly the camera to a specific location.</p> Source code in <code>anymap/cesium.py</code> <pre><code>def fly_to(\n    self,\n    latitude: float,\n    longitude: float,\n    height: Optional[float] = None,\n    heading: Optional[float] = None,\n    pitch: Optional[float] = None,\n    roll: Optional[float] = None,\n    duration: float = 3.0,\n) -&gt; None:\n    \"\"\"Fly the camera to a specific location.\"\"\"\n    options = {\"latitude\": latitude, \"longitude\": longitude, \"duration\": duration}\n    if height is not None:\n        options[\"height\"] = height\n    if heading is not None:\n        options[\"heading\"] = heading\n    if pitch is not None:\n        options[\"pitch\"] = pitch\n    if roll is not None:\n        options[\"roll\"] = roll\n\n    self.call_js_method(\"flyTo\", options)\n</code></pre>"},{"location":"cesium/#anymap.cesium.CesiumMap.home","title":"<code>home(self)</code>","text":"<p>Reset camera to home position.</p> Source code in <code>anymap/cesium.py</code> <pre><code>def home(self) -&gt; None:\n    \"\"\"Reset camera to home position.\"\"\"\n    self.call_js_method(\"home\")\n</code></pre>"},{"location":"cesium/#anymap.cesium.CesiumMap.remove_entity","title":"<code>remove_entity(self, entity_id)</code>","text":"<p>Remove an entity from the globe.</p> Source code in <code>anymap/cesium.py</code> <pre><code>def remove_entity(self, entity_id: str) -&gt; None:\n    \"\"\"Remove an entity from the globe.\"\"\"\n    self.call_js_method(\"removeEntity\", entity_id)\n</code></pre>"},{"location":"cesium/#anymap.cesium.CesiumMap.set_access_token","title":"<code>set_access_token(self, token)</code>","text":"<p>Set the Cesium ion access token.</p> Source code in <code>anymap/cesium.py</code> <pre><code>def set_access_token(self, token: str) -&gt; None:\n    \"\"\"Set the Cesium ion access token.\"\"\"\n    self.access_token = token\n</code></pre>"},{"location":"cesium/#anymap.cesium.CesiumMap.set_camera_position","title":"<code>set_camera_position(self, latitude, longitude, height, heading=0.0, pitch=-90.0, roll=0.0)</code>","text":"<p>Set camera position immediately.</p> Source code in <code>anymap/cesium.py</code> <pre><code>def set_camera_position(\n    self,\n    latitude: float,\n    longitude: float,\n    height: float,\n    heading: float = 0.0,\n    pitch: float = -90.0,\n    roll: float = 0.0,\n) -&gt; None:\n    \"\"\"Set camera position immediately.\"\"\"\n    self.center = [latitude, longitude]\n    self.camera_height = height\n    self.heading = heading\n    self.pitch = pitch\n    self.roll = roll\n</code></pre>"},{"location":"cesium/#anymap.cesium.CesiumMap.set_cesium_world_terrain","title":"<code>set_cesium_world_terrain(self, request_water_mask=False, request_vertex_normals=False)</code>","text":"<p>Set Cesium World Terrain as the terrain provider.</p> Source code in <code>anymap/cesium.py</code> <pre><code>def set_cesium_world_terrain(\n    self, request_water_mask: bool = False, request_vertex_normals: bool = False\n) -&gt; None:\n    \"\"\"Set Cesium World Terrain as the terrain provider.\"\"\"\n    terrain_config = {\n        \"type\": \"cesium-world-terrain\",\n        \"requestWaterMask\": request_water_mask,\n        \"requestVertexNormals\": request_vertex_normals,\n    }\n    self.set_terrain(terrain_config)\n</code></pre>"},{"location":"cesium/#anymap.cesium.CesiumMap.set_imagery","title":"<code>set_imagery(self, imagery_config)</code>","text":"<p>Set imagery provider for the globe.</p> Source code in <code>anymap/cesium.py</code> <pre><code>def set_imagery(self, imagery_config: Dict[str, Any]) -&gt; None:\n    \"\"\"Set imagery provider for the globe.\"\"\"\n    self.call_js_method(\"setImagery\", imagery_config)\n</code></pre>"},{"location":"cesium/#anymap.cesium.CesiumMap.set_scene_mode_2d","title":"<code>set_scene_mode_2d(self)</code>","text":"<p>Set scene to 2D mode.</p> Source code in <code>anymap/cesium.py</code> <pre><code>def set_scene_mode_2d(self) -&gt; None:\n    \"\"\"Set scene to 2D mode.\"\"\"\n    self.call_js_method(\"setScene2D\")\n</code></pre>"},{"location":"cesium/#anymap.cesium.CesiumMap.set_scene_mode_3d","title":"<code>set_scene_mode_3d(self)</code>","text":"<p>Set scene to 3D mode.</p> Source code in <code>anymap/cesium.py</code> <pre><code>def set_scene_mode_3d(self) -&gt; None:\n    \"\"\"Set scene to 3D mode.\"\"\"\n    self.call_js_method(\"setScene3D\")\n</code></pre>"},{"location":"cesium/#anymap.cesium.CesiumMap.set_scene_mode_columbus","title":"<code>set_scene_mode_columbus(self)</code>","text":"<p>Set scene to Columbus view (2.5D).</p> Source code in <code>anymap/cesium.py</code> <pre><code>def set_scene_mode_columbus(self) -&gt; None:\n    \"\"\"Set scene to Columbus view (2.5D).\"\"\"\n    self.call_js_method(\"setSceneColumbusView\")\n</code></pre>"},{"location":"cesium/#anymap.cesium.CesiumMap.set_terrain","title":"<code>set_terrain(self, terrain_config=None)</code>","text":"<p>Set terrain provider for the globe.</p> Source code in <code>anymap/cesium.py</code> <pre><code>def set_terrain(self, terrain_config: Optional[Dict[str, Any]] = None) -&gt; None:\n    \"\"\"Set terrain provider for the globe.\"\"\"\n    self.call_js_method(\"setTerrain\", terrain_config)\n</code></pre>"},{"location":"cesium/#anymap.cesium.CesiumMap.zoom_to_entity","title":"<code>zoom_to_entity(self, entity_id)</code>","text":"<p>Zoom the camera to focus on a specific entity.</p> Source code in <code>anymap/cesium.py</code> <pre><code>def zoom_to_entity(self, entity_id: str) -&gt; None:\n    \"\"\"Zoom the camera to focus on a specific entity.\"\"\"\n    self.call_js_method(\"zoomToEntity\", entity_id)\n</code></pre>"},{"location":"changelog/","title":"Changelog","text":""},{"location":"changelog/#v001-date","title":"v0.0.1 - Date","text":"<p>Improvement:</p> <ul> <li>TBD</li> </ul> <p>New Features:</p> <ul> <li>TBD</li> </ul>"},{"location":"compare/","title":"compare module","text":"<p>Map comparison widget for side-by-side comparison of two maps.</p>"},{"location":"compare/#anymap.compare.MapCompare","title":"<code> MapCompare            (AnyWidget)         </code>","text":"<p>Map comparison widget for side-by-side comparison of two maps.</p> Source code in <code>anymap/compare.py</code> <pre><code>class MapCompare(anywidget.AnyWidget):\n    \"\"\"Map comparison widget for side-by-side comparison of two maps.\"\"\"\n\n    # Map configuration traits\n    left_map_config = traitlets.Dict({}).tag(sync=True)\n    right_map_config = traitlets.Dict({}).tag(sync=True)\n\n    # Widget dimensions\n    width = traitlets.Unicode(\"100%\").tag(sync=True)\n    height = traitlets.Unicode(\"600px\").tag(sync=True)\n\n    # Comparison options\n    orientation = traitlets.Unicode(\"vertical\").tag(\n        sync=True\n    )  # \"vertical\" or \"horizontal\"\n    mousemove = traitlets.Bool(False).tag(sync=True)  # Enable swipe on mouse move\n    slider_position = traitlets.Float(0.5).tag(sync=True)  # Slider position (0-1)\n\n    # Backend type\n    backend = traitlets.Unicode(\"maplibre\").tag(sync=True)  # \"maplibre\" or \"mapbox\"\n\n    # Synchronization options\n    sync_center = traitlets.Bool(True).tag(sync=True)\n    sync_zoom = traitlets.Bool(True).tag(sync=True)\n    sync_bearing = traitlets.Bool(True).tag(sync=True)\n    sync_pitch = traitlets.Bool(True).tag(sync=True)\n\n    # Communication traits\n    _js_calls = traitlets.List([]).tag(sync=True)\n    _js_events = traitlets.List([]).tag(sync=True)\n\n    def __init__(\n        self,\n        left_map: Optional[Dict[str, Any]] = None,\n        right_map: Optional[Dict[str, Any]] = None,\n        backend: str = \"maplibre\",\n        orientation: str = \"vertical\",\n        mousemove: bool = False,\n        width: str = \"100%\",\n        height: str = \"600px\",\n        sync_center: bool = True,\n        sync_zoom: bool = True,\n        sync_bearing: bool = True,\n        sync_pitch: bool = True,\n        **kwargs,\n    ):\n        \"\"\"Initialize MapCompare widget.\n\n        Args:\n            left_map: Configuration for the left/before map\n            right_map: Configuration for the right/after map\n            backend: Map backend to use (\"maplibre\" or \"mapbox\")\n            orientation: Comparison orientation (\"vertical\" or \"horizontal\")\n            mousemove: Enable swipe on mouse move\n            width: Widget width\n            height: Widget height\n            sync_center: Synchronize map center\n            sync_zoom: Synchronize map zoom\n            sync_bearing: Synchronize map bearing\n            sync_pitch: Synchronize map pitch\n        \"\"\"\n        # Set default map configurations\n        if left_map is None:\n            left_map = {\n                \"center\": [0.0, 0.0],\n                \"zoom\": 2.0,\n                \"style\": (\n                    \"https://demotiles.maplibre.org/style.json\"\n                    if backend == \"maplibre\"\n                    else \"mapbox://styles/mapbox/streets-v12\"\n                ),\n            }\n        if right_map is None:\n            right_map = {\n                \"center\": [0.0, 0.0],\n                \"zoom\": 2.0,\n                \"style\": (\n                    \"https://demotiles.maplibre.org/style.json\"\n                    if backend == \"maplibre\"\n                    else \"mapbox://styles/mapbox/satellite-v9\"\n                ),\n            }\n\n        super().__init__(\n            left_map_config=left_map,\n            right_map_config=right_map,\n            backend=backend,\n            orientation=orientation,\n            mousemove=mousemove,\n            width=width,\n            height=height,\n            sync_center=sync_center,\n            sync_zoom=sync_zoom,\n            sync_bearing=sync_bearing,\n            sync_pitch=sync_pitch,\n            **kwargs,\n        )\n\n        self._event_handlers = {}\n        self._js_method_counter = 0\n\n        # Set JavaScript and CSS based on backend\n        if backend == \"maplibre\":\n            self._esm = self._load_maplibre_compare_js()\n            self._css = self._load_maplibre_compare_css()\n        else:  # mapbox\n            self._esm = self._load_mapbox_compare_js()\n            self._css = self._load_mapbox_compare_css()\n\n    def _load_maplibre_compare_js(self) -&gt; str:\n        \"\"\"Load MapLibre comparison JavaScript code.\"\"\"\n        # This will be implemented when we create the JS file\n        try:\n            with open(\n                pathlib.Path(__file__).parent / \"static\" / \"maplibre_compare_widget.js\",\n                \"r\",\n            ) as f:\n                return f.read()\n        except FileNotFoundError:\n            return \"\"\n\n    def _load_maplibre_compare_css(self) -&gt; str:\n        \"\"\"Load MapLibre comparison CSS styles.\"\"\"\n        try:\n            with open(\n                pathlib.Path(__file__).parent\n                / \"static\"\n                / \"maplibre_compare_widget.css\",\n                \"r\",\n            ) as f:\n                return f.read()\n        except FileNotFoundError:\n            return \"\"\n\n    def _load_mapbox_compare_js(self) -&gt; str:\n        \"\"\"Load Mapbox comparison JavaScript code.\"\"\"\n        try:\n            with open(\n                pathlib.Path(__file__).parent / \"static\" / \"mapbox_compare_widget.js\",\n                \"r\",\n            ) as f:\n                return f.read()\n        except FileNotFoundError:\n            return \"\"\n\n    def _load_mapbox_compare_css(self) -&gt; str:\n        \"\"\"Load Mapbox comparison CSS styles.\"\"\"\n        try:\n            with open(\n                pathlib.Path(__file__).parent / \"static\" / \"mapbox_compare_widget.css\",\n                \"r\",\n            ) as f:\n                return f.read()\n        except FileNotFoundError:\n            return \"\"\n\n    def call_js_method(self, method_name: str, *args, **kwargs) -&gt; None:\n        \"\"\"Call a JavaScript method on the compare instance.\"\"\"\n        call_data = {\n            \"id\": self._js_method_counter,\n            \"method\": method_name,\n            \"args\": args,\n            \"kwargs\": kwargs,\n        }\n        self._js_method_counter += 1\n\n        # Trigger sync by creating new list\n        current_calls = list(self._js_calls)\n        current_calls.append(call_data)\n        self._js_calls = current_calls\n\n    def on_event(self, event_type: str, callback):\n        \"\"\"Register a callback for comparison events.\"\"\"\n        if event_type not in self._event_handlers:\n            self._event_handlers[event_type] = []\n        self._event_handlers[event_type].append(callback)\n\n    @traitlets.observe(\"_js_events\")\n    def _handle_js_events(self, change):\n        \"\"\"Handle events from JavaScript.\"\"\"\n        events = change[\"new\"]\n        for event in events:\n            event_type = event.get(\"type\")\n            if event_type in self._event_handlers:\n                for handler in self._event_handlers[event_type]:\n                    handler(event)\n\n    def set_slider_position(self, position: float) -&gt; None:\n        \"\"\"Set the slider position.\n\n        Args:\n            position: Slider position (0.0 to 1.0)\n        \"\"\"\n        if not 0.0 &lt;= position &lt;= 1.0:\n            raise ValueError(\"Position must be between 0.0 and 1.0\")\n        self.slider_position = position\n        self.call_js_method(\"setSlider\", position)\n\n    def set_orientation(self, orientation: str) -&gt; None:\n        \"\"\"Set the comparison orientation.\n\n        Args:\n            orientation: \"vertical\" or \"horizontal\"\n        \"\"\"\n        if orientation not in [\"vertical\", \"horizontal\"]:\n            raise ValueError(\"Orientation must be 'vertical' or 'horizontal'\")\n        self.orientation = orientation\n        self.call_js_method(\"setOrientation\", orientation)\n\n    def enable_mousemove(self, enabled: bool = True) -&gt; None:\n        \"\"\"Enable or disable swipe on mouse move.\n\n        Args:\n            enabled: Whether to enable mousemove\n        \"\"\"\n        self.mousemove = enabled\n        self.call_js_method(\"setMousemove\", enabled)\n\n    def set_sync_options(\n        self,\n        center: Optional[bool] = None,\n        zoom: Optional[bool] = None,\n        bearing: Optional[bool] = None,\n        pitch: Optional[bool] = None,\n    ) -&gt; None:\n        \"\"\"Set synchronization options.\n\n        Args:\n            center: Synchronize map center\n            zoom: Synchronize map zoom\n            bearing: Synchronize map bearing\n            pitch: Synchronize map pitch\n        \"\"\"\n        if center is not None:\n            self.sync_center = center\n        if zoom is not None:\n            self.sync_zoom = zoom\n        if bearing is not None:\n            self.sync_bearing = bearing\n        if pitch is not None:\n            self.sync_pitch = pitch\n\n        sync_options = {\n            \"center\": self.sync_center,\n            \"zoom\": self.sync_zoom,\n            \"bearing\": self.sync_bearing,\n            \"pitch\": self.sync_pitch,\n        }\n        self.call_js_method(\"setSyncOptions\", sync_options)\n\n    def update_left_map(self, config: Dict[str, Any]) -&gt; None:\n        \"\"\"Update the left map configuration.\n\n        Args:\n            config: New configuration for the left map\n        \"\"\"\n        self.left_map_config = config\n        self.call_js_method(\"updateLeftMap\", config)\n\n    def update_right_map(self, config: Dict[str, Any]) -&gt; None:\n        \"\"\"Update the right map configuration.\n\n        Args:\n            config: New configuration for the right map\n        \"\"\"\n        self.right_map_config = config\n        self.call_js_method(\"updateRightMap\", config)\n\n    def fly_to(self, lat: float, lng: float, zoom: Optional[float] = None) -&gt; None:\n        \"\"\"Fly both maps to a specific location.\n\n        Args:\n            lat: Latitude\n            lng: Longitude\n            zoom: Zoom level (optional)\n        \"\"\"\n        options = {\"center\": [lat, lng]}\n        if zoom is not None:\n            options[\"zoom\"] = zoom\n        self.call_js_method(\"flyTo\", options)\n\n    def to_html(\n        self,\n        filename: Optional[str] = None,\n        title: str = \"Map Comparison\",\n        **kwargs,\n    ) -&gt; str:\n        \"\"\"Export the comparison widget to a standalone HTML file.\n\n        Args:\n            filename: Optional filename to save the HTML. If None, returns HTML string.\n            title: Title for the HTML page\n            **kwargs: Additional arguments passed to the HTML template\n\n        Returns:\n            HTML string content\n        \"\"\"\n        # Get the current widget state\n        widget_state = {\n            \"left_map_config\": dict(self.left_map_config),\n            \"right_map_config\": dict(self.right_map_config),\n            \"backend\": self.backend,\n            \"orientation\": self.orientation,\n            \"mousemove\": self.mousemove,\n            \"slider_position\": self.slider_position,\n            \"sync_center\": self.sync_center,\n            \"sync_zoom\": self.sync_zoom,\n            \"sync_bearing\": self.sync_bearing,\n            \"sync_pitch\": self.sync_pitch,\n            \"width\": self.width,\n            \"height\": self.height,\n        }\n\n        # Generate HTML content\n        html_content = self._generate_html_template(widget_state, title, **kwargs)\n\n        # Save to file if filename is provided\n        if filename:\n            with open(filename, \"w\", encoding=\"utf-8\") as f:\n                f.write(html_content)\n\n        return html_content\n\n    def _generate_html_template(\n        self, widget_state: Dict[str, Any], title: str, **kwargs\n    ) -&gt; str:\n        \"\"\"Generate the HTML template for map comparison.\"\"\"\n        # Serialize widget state for JavaScript\n        widget_state_json = json.dumps(widget_state, indent=2)\n\n        # Choose CDN URLs based on backend\n        if widget_state[\"backend\"] == \"maplibre\":\n            map_js_url = \"https://unpkg.com/maplibre-gl@5.10.0/dist/maplibre-gl.js\"\n            map_css_url = \"https://unpkg.com/maplibre-gl@5.10.0/dist/maplibre-gl.css\"\n            global_var = \"maplibregl\"\n        else:  # mapbox\n            map_js_url = \"https://api.mapbox.com/mapbox-gl-js/v3.13.0/mapbox-gl.js\"\n            map_css_url = \"https://api.mapbox.com/mapbox-gl-js/v3.13.0/mapbox-gl.css\"\n            global_var = \"mapboxgl\"\n\n        # Generate access token warning for Mapbox\n        access_token_warning = \"\"\n        if widget_state[\"backend\"] == \"mapbox\":\n            left_token = widget_state[\"left_map_config\"].get(\"access_token\", \"\")\n            right_token = widget_state[\"right_map_config\"].get(\"access_token\", \"\")\n            if not left_token and not right_token:\n                access_token_warning = \"\"\"\n                    &lt;div class=\"access-token-warning\"&gt;\n                        &lt;strong&gt;Warning:&lt;/strong&gt; This map requires a Mapbox access token.\n                        Get a free token at &lt;a href=\"https://account.mapbox.com/access-tokens/\" target=\"_blank\"&gt;Mapbox&lt;/a&gt;\n                        and set it in the JavaScript code below.\n                    &lt;/div&gt;\n                \"\"\"\n\n        html_template = f\"\"\"&lt;!DOCTYPE html&gt;\n&lt;html&gt;\n&lt;head&gt;\n    &lt;title&gt;{title}&lt;/title&gt;\n    &lt;meta charset=\"utf-8\"&gt;\n    &lt;meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\"&gt;\n    &lt;script src=\"{map_js_url}\"&gt;&lt;/script&gt;\n    &lt;link href=\"{map_css_url}\" rel=\"stylesheet\"&gt;\n    &lt;script src=\"https://unpkg.com/@maplibre/maplibre-gl-compare@0.5.0/dist/maplibre-gl-compare.js\"&gt;&lt;/script&gt;\n    &lt;link href=\"https://unpkg.com/@maplibre/maplibre-gl-compare@0.5.0/dist/maplibre-gl-compare.css\" rel=\"stylesheet\"&gt;\n    &lt;style&gt;\n        body {{\n            margin: 0;\n            padding: 20px;\n            font-family: Arial, sans-serif;\n            background-color: #f5f5f5;\n        }}\n        .container {{\n            max-width: 1200px;\n            margin: 0 auto;\n            background-color: white;\n            border-radius: 8px;\n            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);\n            overflow: hidden;\n        }}\n        .header {{\n            padding: 20px;\n            background-color: #fff;\n            border-bottom: 1px solid #eee;\n        }}\n        h1 {{\n            margin: 0;\n            color: #333;\n            font-size: 24px;\n        }}\n        .map-container {{\n            position: relative;\n            width: {widget_state['width']};\n            height: {widget_state['height']};\n            margin: 20px;\n        }}\n        #comparison-container {{\n            position: relative;\n            width: 100%;\n            height: 100%;\n            overflow: hidden;\n            border: 1px solid #ccc;\n            border-radius: 4px;\n        }}\n        #before, #after {{\n            position: absolute;\n            top: 0;\n            bottom: 0;\n            width: 100%;\n            height: 100%;\n        }}\n        .access-token-warning {{\n            background-color: #fff3cd;\n            border: 1px solid #ffeaa7;\n            color: #856404;\n            padding: 15px;\n            margin: 20px;\n            border-radius: 4px;\n        }}\n        .access-token-warning a {{\n            color: #856404;\n            text-decoration: underline;\n        }}\n        .controls {{\n            padding: 20px;\n            background-color: #f8f9fa;\n            border-top: 1px solid #eee;\n        }}\n        .control-group {{\n            margin-bottom: 15px;\n        }}\n        .control-group label {{\n            display: inline-block;\n            width: 120px;\n            font-weight: bold;\n            color: #333;\n        }}\n        .control-group input, .control-group select {{\n            padding: 5px 10px;\n            border: 1px solid #ccc;\n            border-radius: 4px;\n            font-size: 14px;\n        }}\n        .control-group button {{\n            padding: 8px 16px;\n            background-color: #007cba;\n            color: white;\n            border: none;\n            border-radius: 4px;\n            cursor: pointer;\n            font-size: 14px;\n        }}\n        .control-group button:hover {{\n            background-color: #005a8b;\n        }}\n    &lt;/style&gt;\n&lt;/head&gt;\n&lt;body&gt;\n    &lt;div class=\"container\"&gt;\n        &lt;div class=\"header\"&gt;\n            &lt;h1&gt;{title}&lt;/h1&gt;\n            &lt;p&gt;Interactive map comparison powered by anymap&lt;/p&gt;\n        &lt;/div&gt;\n\n        {access_token_warning}\n\n        &lt;div class=\"map-container\"&gt;\n            &lt;div id=\"comparison-container\"&gt;\n                &lt;div id=\"before\"&gt;&lt;/div&gt;\n                &lt;div id=\"after\"&gt;&lt;/div&gt;\n            &lt;/div&gt;\n        &lt;/div&gt;\n\n        &lt;div class=\"controls\"&gt;\n            &lt;div class=\"control-group\"&gt;\n                &lt;label&gt;Note:&lt;/label&gt;\n                &lt;span&gt;Use the slider on the map to adjust position&lt;/span&gt;\n            &lt;/div&gt;\n\n            &lt;div class=\"control-group\"&gt;\n                &lt;label for=\"orientation\"&gt;Orientation:&lt;/label&gt;\n                &lt;select id=\"orientation\"&gt;\n                    &lt;option value=\"vertical\" {\"selected\" if widget_state['orientation'] == 'vertical' else \"\"}&gt;Vertical&lt;/option&gt;\n                    &lt;option value=\"horizontal\" {\"selected\" if widget_state['orientation'] == 'horizontal' else \"\"}&gt;Horizontal&lt;/option&gt;\n                &lt;/select&gt;\n            &lt;/div&gt;\n\n            &lt;div class=\"control-group\"&gt;\n                &lt;label for=\"mousemove\"&gt;Mouse Move:&lt;/label&gt;\n                &lt;input type=\"checkbox\" id=\"mousemove\" {\"checked\" if widget_state['mousemove'] else \"\"}&gt;\n                &lt;span&gt;Enable swipe on mouse move&lt;/span&gt;\n            &lt;/div&gt;\n\n            &lt;div class=\"control-group\"&gt;\n                &lt;button onclick=\"flyToSanFrancisco()\"&gt;Fly to San Francisco&lt;/button&gt;\n                &lt;button onclick=\"flyToNewYork()\"&gt;Fly to New York&lt;/button&gt;\n                &lt;button onclick=\"flyToLondon()\"&gt;Fly to London&lt;/button&gt;\n                &lt;button onclick=\"flyToTokyo()\"&gt;Fly to Tokyo&lt;/button&gt;\n            &lt;/div&gt;\n        &lt;/div&gt;\n    &lt;/div&gt;\n\n    &lt;script&gt;\n        // Widget state from Python\n        const widgetState = {widget_state_json};\n\n        // Set access token for Mapbox if needed\n        if (widgetState.backend === 'mapbox') {{\n            const accessToken = widgetState.left_map_config.access_token || widgetState.right_map_config.access_token || '';\n            if (accessToken) {{\n                {global_var}.accessToken = accessToken;\n            }}\n        }}\n\n        // Initialize maps\n        let beforeMap, afterMap, compare;\n\n        function initializeMaps() {{\n            const leftConfig = widgetState.left_map_config;\n            const rightConfig = widgetState.right_map_config;\n\n            // Create before map\n            beforeMap = new {global_var}.Map({{\n                container: 'before',\n                style: leftConfig.style,\n                center: leftConfig.center ? [leftConfig.center[1], leftConfig.center[0]] : [0, 0],\n                zoom: leftConfig.zoom || 2,\n                bearing: leftConfig.bearing || 0,\n                pitch: leftConfig.pitch || 0,\n                antialias: leftConfig.antialias !== undefined ? leftConfig.antialias : true\n            }});\n\n            // Create after map\n            afterMap = new {global_var}.Map({{\n                container: 'after',\n                style: rightConfig.style,\n                center: rightConfig.center ? [rightConfig.center[1], rightConfig.center[0]] : [0, 0],\n                zoom: rightConfig.zoom || 2,\n                bearing: rightConfig.bearing || 0,\n                pitch: rightConfig.pitch || 0,\n                antialias: rightConfig.antialias !== undefined ? rightConfig.antialias : true\n            }});\n\n            // Wait for both maps to load\n            Promise.all([\n                new Promise(resolve =&gt; beforeMap.on('load', resolve)),\n                new Promise(resolve =&gt; afterMap.on('load', resolve))\n            ]).then(() =&gt; {{\n                createComparison();\n                setupEventListeners();\n                // Note: MapLibre Compare plugin handles synchronization internally\n                // Custom synchronization disabled to prevent conflicts and improve performance\n            }});\n        }}\n\n        function createComparison() {{\n            if (compare) {{\n                compare.remove();\n            }}\n\n            compare = new {global_var}.Compare(beforeMap, afterMap, \"#comparison-container\", {{\n                orientation: widgetState.orientation,\n                mousemove: widgetState.mousemove\n            }});\n\n            console.log('Compare widget created successfully');\n            console.log('Before map scrollZoom enabled:', beforeMap.scrollZoom.isEnabled());\n            console.log('After map scrollZoom enabled:', afterMap.scrollZoom.isEnabled());\n        }}\n\n        function setupSynchronization() {{\n            if (widgetState.sync_center || widgetState.sync_zoom || widgetState.sync_bearing || widgetState.sync_pitch) {{\n                let isSync = false;\n\n                function syncMaps(sourceMap, targetMap) {{\n                    if (isSync) return; // Prevent infinite loops\n                    isSync = true;\n\n                    try {{\n                        if (widgetState.sync_center) {{\n                            targetMap.setCenter(sourceMap.getCenter());\n                        }}\n                        if (widgetState.sync_zoom) {{\n                            targetMap.setZoom(sourceMap.getZoom());\n                        }}\n                        if (widgetState.sync_bearing) {{\n                            targetMap.setBearing(sourceMap.getBearing());\n                        }}\n                        if (widgetState.sync_pitch) {{\n                            targetMap.setPitch(sourceMap.getPitch());\n                        }}\n                    }} finally {{\n                        // Use requestAnimationFrame to reset flag after current event loop\n                        requestAnimationFrame(() =&gt; {{\n                            isSync = false;\n                        }});\n                    }}\n                }}\n\n                // Use 'moveend' instead of 'move' to avoid interfering with scroll zoom\n                beforeMap.on('moveend', () =&gt; syncMaps(beforeMap, afterMap));\n                afterMap.on('moveend', () =&gt; syncMaps(afterMap, beforeMap));\n            }}\n        }}\n\n        function setupEventListeners() {{\n            // Orientation control\n            document.getElementById('orientation').addEventListener('change', function(e) {{\n                widgetState.orientation = e.target.value;\n                createComparison();\n            }});\n\n            // Mousemove control\n            document.getElementById('mousemove').addEventListener('change', function(e) {{\n                widgetState.mousemove = e.target.checked;\n                createComparison();\n            }});\n        }}\n\n        // Navigation functions\n        function flyToSanFrancisco() {{\n            const center = [-122.4194, 37.7749];\n            const zoom = 12;\n            beforeMap.flyTo({{ center: center, zoom: zoom, essential: true }});\n            afterMap.flyTo({{ center: center, zoom: zoom, essential: true }});\n        }}\n\n        function flyToNewYork() {{\n            const center = [-74.0060, 40.7128];\n            const zoom = 12;\n            beforeMap.flyTo({{ center: center, zoom: zoom, essential: true }});\n            afterMap.flyTo({{ center: center, zoom: zoom, essential: true }});\n        }}\n\n        function flyToLondon() {{\n            const center = [-0.1278, 51.5074];\n            const zoom = 12;\n            beforeMap.flyTo({{ center: center, zoom: zoom, essential: true }});\n            afterMap.flyTo({{ center: center, zoom: zoom, essential: true }});\n        }}\n\n        function flyToTokyo() {{\n            const center = [139.6917, 35.6895];\n            const zoom = 12;\n            beforeMap.flyTo({{ center: center, zoom: zoom, essential: true }});\n            afterMap.flyTo({{ center: center, zoom: zoom, essential: true }});\n        }}\n\n        // Initialize the comparison\n        initializeMaps();\n\n        // Log successful initialization\n        console.log('Map comparison initialized successfully');\n    &lt;/script&gt;\n&lt;/body&gt;\n&lt;/html&gt;\"\"\"\n\n        return html_template\n</code></pre>"},{"location":"compare/#anymap.compare.MapCompare.__init__","title":"<code>__init__(self, left_map=None, right_map=None, backend='maplibre', orientation='vertical', mousemove=False, width='100%', height='600px', sync_center=True, sync_zoom=True, sync_bearing=True, sync_pitch=True, **kwargs)</code>  <code>special</code>","text":"<p>Initialize MapCompare widget.</p> <p>Parameters:</p> Name Type Description Default <code>left_map</code> <code>Optional[Dict[str, Any]]</code> <p>Configuration for the left/before map</p> <code>None</code> <code>right_map</code> <code>Optional[Dict[str, Any]]</code> <p>Configuration for the right/after map</p> <code>None</code> <code>backend</code> <code>str</code> <p>Map backend to use (\"maplibre\" or \"mapbox\")</p> <code>'maplibre'</code> <code>orientation</code> <code>str</code> <p>Comparison orientation (\"vertical\" or \"horizontal\")</p> <code>'vertical'</code> <code>mousemove</code> <code>bool</code> <p>Enable swipe on mouse move</p> <code>False</code> <code>width</code> <code>str</code> <p>Widget width</p> <code>'100%'</code> <code>height</code> <code>str</code> <p>Widget height</p> <code>'600px'</code> <code>sync_center</code> <code>bool</code> <p>Synchronize map center</p> <code>True</code> <code>sync_zoom</code> <code>bool</code> <p>Synchronize map zoom</p> <code>True</code> <code>sync_bearing</code> <code>bool</code> <p>Synchronize map bearing</p> <code>True</code> <code>sync_pitch</code> <code>bool</code> <p>Synchronize map pitch</p> <code>True</code> Source code in <code>anymap/compare.py</code> <pre><code>def __init__(\n    self,\n    left_map: Optional[Dict[str, Any]] = None,\n    right_map: Optional[Dict[str, Any]] = None,\n    backend: str = \"maplibre\",\n    orientation: str = \"vertical\",\n    mousemove: bool = False,\n    width: str = \"100%\",\n    height: str = \"600px\",\n    sync_center: bool = True,\n    sync_zoom: bool = True,\n    sync_bearing: bool = True,\n    sync_pitch: bool = True,\n    **kwargs,\n):\n    \"\"\"Initialize MapCompare widget.\n\n    Args:\n        left_map: Configuration for the left/before map\n        right_map: Configuration for the right/after map\n        backend: Map backend to use (\"maplibre\" or \"mapbox\")\n        orientation: Comparison orientation (\"vertical\" or \"horizontal\")\n        mousemove: Enable swipe on mouse move\n        width: Widget width\n        height: Widget height\n        sync_center: Synchronize map center\n        sync_zoom: Synchronize map zoom\n        sync_bearing: Synchronize map bearing\n        sync_pitch: Synchronize map pitch\n    \"\"\"\n    # Set default map configurations\n    if left_map is None:\n        left_map = {\n            \"center\": [0.0, 0.0],\n            \"zoom\": 2.0,\n            \"style\": (\n                \"https://demotiles.maplibre.org/style.json\"\n                if backend == \"maplibre\"\n                else \"mapbox://styles/mapbox/streets-v12\"\n            ),\n        }\n    if right_map is None:\n        right_map = {\n            \"center\": [0.0, 0.0],\n            \"zoom\": 2.0,\n            \"style\": (\n                \"https://demotiles.maplibre.org/style.json\"\n                if backend == \"maplibre\"\n                else \"mapbox://styles/mapbox/satellite-v9\"\n            ),\n        }\n\n    super().__init__(\n        left_map_config=left_map,\n        right_map_config=right_map,\n        backend=backend,\n        orientation=orientation,\n        mousemove=mousemove,\n        width=width,\n        height=height,\n        sync_center=sync_center,\n        sync_zoom=sync_zoom,\n        sync_bearing=sync_bearing,\n        sync_pitch=sync_pitch,\n        **kwargs,\n    )\n\n    self._event_handlers = {}\n    self._js_method_counter = 0\n\n    # Set JavaScript and CSS based on backend\n    if backend == \"maplibre\":\n        self._esm = self._load_maplibre_compare_js()\n        self._css = self._load_maplibre_compare_css()\n    else:  # mapbox\n        self._esm = self._load_mapbox_compare_js()\n        self._css = self._load_mapbox_compare_css()\n</code></pre>"},{"location":"compare/#anymap.compare.MapCompare.call_js_method","title":"<code>call_js_method(self, method_name, *args, **kwargs)</code>","text":"<p>Call a JavaScript method on the compare instance.</p> Source code in <code>anymap/compare.py</code> <pre><code>def call_js_method(self, method_name: str, *args, **kwargs) -&gt; None:\n    \"\"\"Call a JavaScript method on the compare instance.\"\"\"\n    call_data = {\n        \"id\": self._js_method_counter,\n        \"method\": method_name,\n        \"args\": args,\n        \"kwargs\": kwargs,\n    }\n    self._js_method_counter += 1\n\n    # Trigger sync by creating new list\n    current_calls = list(self._js_calls)\n    current_calls.append(call_data)\n    self._js_calls = current_calls\n</code></pre>"},{"location":"compare/#anymap.compare.MapCompare.enable_mousemove","title":"<code>enable_mousemove(self, enabled=True)</code>","text":"<p>Enable or disable swipe on mouse move.</p> <p>Parameters:</p> Name Type Description Default <code>enabled</code> <code>bool</code> <p>Whether to enable mousemove</p> <code>True</code> Source code in <code>anymap/compare.py</code> <pre><code>def enable_mousemove(self, enabled: bool = True) -&gt; None:\n    \"\"\"Enable or disable swipe on mouse move.\n\n    Args:\n        enabled: Whether to enable mousemove\n    \"\"\"\n    self.mousemove = enabled\n    self.call_js_method(\"setMousemove\", enabled)\n</code></pre>"},{"location":"compare/#anymap.compare.MapCompare.fly_to","title":"<code>fly_to(self, lat, lng, zoom=None)</code>","text":"<p>Fly both maps to a specific location.</p> <p>Parameters:</p> Name Type Description Default <code>lat</code> <code>float</code> <p>Latitude</p> required <code>lng</code> <code>float</code> <p>Longitude</p> required <code>zoom</code> <code>Optional[float]</code> <p>Zoom level (optional)</p> <code>None</code> Source code in <code>anymap/compare.py</code> <pre><code>def fly_to(self, lat: float, lng: float, zoom: Optional[float] = None) -&gt; None:\n    \"\"\"Fly both maps to a specific location.\n\n    Args:\n        lat: Latitude\n        lng: Longitude\n        zoom: Zoom level (optional)\n    \"\"\"\n    options = {\"center\": [lat, lng]}\n    if zoom is not None:\n        options[\"zoom\"] = zoom\n    self.call_js_method(\"flyTo\", options)\n</code></pre>"},{"location":"compare/#anymap.compare.MapCompare.on_event","title":"<code>on_event(self, event_type, callback)</code>","text":"<p>Register a callback for comparison events.</p> Source code in <code>anymap/compare.py</code> <pre><code>def on_event(self, event_type: str, callback):\n    \"\"\"Register a callback for comparison events.\"\"\"\n    if event_type not in self._event_handlers:\n        self._event_handlers[event_type] = []\n    self._event_handlers[event_type].append(callback)\n</code></pre>"},{"location":"compare/#anymap.compare.MapCompare.set_orientation","title":"<code>set_orientation(self, orientation)</code>","text":"<p>Set the comparison orientation.</p> <p>Parameters:</p> Name Type Description Default <code>orientation</code> <code>str</code> <p>\"vertical\" or \"horizontal\"</p> required Source code in <code>anymap/compare.py</code> <pre><code>def set_orientation(self, orientation: str) -&gt; None:\n    \"\"\"Set the comparison orientation.\n\n    Args:\n        orientation: \"vertical\" or \"horizontal\"\n    \"\"\"\n    if orientation not in [\"vertical\", \"horizontal\"]:\n        raise ValueError(\"Orientation must be 'vertical' or 'horizontal'\")\n    self.orientation = orientation\n    self.call_js_method(\"setOrientation\", orientation)\n</code></pre>"},{"location":"compare/#anymap.compare.MapCompare.set_slider_position","title":"<code>set_slider_position(self, position)</code>","text":"<p>Set the slider position.</p> <p>Parameters:</p> Name Type Description Default <code>position</code> <code>float</code> <p>Slider position (0.0 to 1.0)</p> required Source code in <code>anymap/compare.py</code> <pre><code>def set_slider_position(self, position: float) -&gt; None:\n    \"\"\"Set the slider position.\n\n    Args:\n        position: Slider position (0.0 to 1.0)\n    \"\"\"\n    if not 0.0 &lt;= position &lt;= 1.0:\n        raise ValueError(\"Position must be between 0.0 and 1.0\")\n    self.slider_position = position\n    self.call_js_method(\"setSlider\", position)\n</code></pre>"},{"location":"compare/#anymap.compare.MapCompare.set_sync_options","title":"<code>set_sync_options(self, center=None, zoom=None, bearing=None, pitch=None)</code>","text":"<p>Set synchronization options.</p> <p>Parameters:</p> Name Type Description Default <code>center</code> <code>Optional[bool]</code> <p>Synchronize map center</p> <code>None</code> <code>zoom</code> <code>Optional[bool]</code> <p>Synchronize map zoom</p> <code>None</code> <code>bearing</code> <code>Optional[bool]</code> <p>Synchronize map bearing</p> <code>None</code> <code>pitch</code> <code>Optional[bool]</code> <p>Synchronize map pitch</p> <code>None</code> Source code in <code>anymap/compare.py</code> <pre><code>def set_sync_options(\n    self,\n    center: Optional[bool] = None,\n    zoom: Optional[bool] = None,\n    bearing: Optional[bool] = None,\n    pitch: Optional[bool] = None,\n) -&gt; None:\n    \"\"\"Set synchronization options.\n\n    Args:\n        center: Synchronize map center\n        zoom: Synchronize map zoom\n        bearing: Synchronize map bearing\n        pitch: Synchronize map pitch\n    \"\"\"\n    if center is not None:\n        self.sync_center = center\n    if zoom is not None:\n        self.sync_zoom = zoom\n    if bearing is not None:\n        self.sync_bearing = bearing\n    if pitch is not None:\n        self.sync_pitch = pitch\n\n    sync_options = {\n        \"center\": self.sync_center,\n        \"zoom\": self.sync_zoom,\n        \"bearing\": self.sync_bearing,\n        \"pitch\": self.sync_pitch,\n    }\n    self.call_js_method(\"setSyncOptions\", sync_options)\n</code></pre>"},{"location":"compare/#anymap.compare.MapCompare.to_html","title":"<code>to_html(self, filename=None, title='Map Comparison', **kwargs)</code>","text":"<p>Export the comparison widget to a standalone HTML file.</p> <p>Parameters:</p> Name Type Description Default <code>filename</code> <code>Optional[str]</code> <p>Optional filename to save the HTML. If None, returns HTML string.</p> <code>None</code> <code>title</code> <code>str</code> <p>Title for the HTML page</p> <code>'Map Comparison'</code> <code>**kwargs</code> <p>Additional arguments passed to the HTML template</p> <code>{}</code> <p>Returns:</p> Type Description <code>str</code> <p>HTML string content</p> Source code in <code>anymap/compare.py</code> <pre><code>def to_html(\n    self,\n    filename: Optional[str] = None,\n    title: str = \"Map Comparison\",\n    **kwargs,\n) -&gt; str:\n    \"\"\"Export the comparison widget to a standalone HTML file.\n\n    Args:\n        filename: Optional filename to save the HTML. If None, returns HTML string.\n        title: Title for the HTML page\n        **kwargs: Additional arguments passed to the HTML template\n\n    Returns:\n        HTML string content\n    \"\"\"\n    # Get the current widget state\n    widget_state = {\n        \"left_map_config\": dict(self.left_map_config),\n        \"right_map_config\": dict(self.right_map_config),\n        \"backend\": self.backend,\n        \"orientation\": self.orientation,\n        \"mousemove\": self.mousemove,\n        \"slider_position\": self.slider_position,\n        \"sync_center\": self.sync_center,\n        \"sync_zoom\": self.sync_zoom,\n        \"sync_bearing\": self.sync_bearing,\n        \"sync_pitch\": self.sync_pitch,\n        \"width\": self.width,\n        \"height\": self.height,\n    }\n\n    # Generate HTML content\n    html_content = self._generate_html_template(widget_state, title, **kwargs)\n\n    # Save to file if filename is provided\n    if filename:\n        with open(filename, \"w\", encoding=\"utf-8\") as f:\n            f.write(html_content)\n\n    return html_content\n</code></pre>"},{"location":"compare/#anymap.compare.MapCompare.update_left_map","title":"<code>update_left_map(self, config)</code>","text":"<p>Update the left map configuration.</p> <p>Parameters:</p> Name Type Description Default <code>config</code> <code>Dict[str, Any]</code> <p>New configuration for the left map</p> required Source code in <code>anymap/compare.py</code> <pre><code>def update_left_map(self, config: Dict[str, Any]) -&gt; None:\n    \"\"\"Update the left map configuration.\n\n    Args:\n        config: New configuration for the left map\n    \"\"\"\n    self.left_map_config = config\n    self.call_js_method(\"updateLeftMap\", config)\n</code></pre>"},{"location":"compare/#anymap.compare.MapCompare.update_right_map","title":"<code>update_right_map(self, config)</code>","text":"<p>Update the right map configuration.</p> <p>Parameters:</p> Name Type Description Default <code>config</code> <code>Dict[str, Any]</code> <p>New configuration for the right map</p> required Source code in <code>anymap/compare.py</code> <pre><code>def update_right_map(self, config: Dict[str, Any]) -&gt; None:\n    \"\"\"Update the right map configuration.\n\n    Args:\n        config: New configuration for the right map\n    \"\"\"\n    self.right_map_config = config\n    self.call_js_method(\"updateRightMap\", config)\n</code></pre>"},{"location":"contributing/","title":"Contributing","text":"<p>Contributions are welcome, and they are greatly appreciated! Every little bit helps, and credit will always be given.</p> <p>You can contribute in many ways:</p>"},{"location":"contributing/#types-of-contributions","title":"Types of Contributions","text":""},{"location":"contributing/#report-bugs","title":"Report Bugs","text":"<p>Report bugs at https://github.com/opengeos/anymap/issues.</p> <p>If you are reporting a bug, please include:</p> <ul> <li>Your operating system name and version.</li> <li>Any details about your local setup that might be helpful in troubleshooting.</li> <li>Detailed steps to reproduce the bug.</li> </ul>"},{"location":"contributing/#fix-bugs","title":"Fix Bugs","text":"<p>Look through the GitHub issues for bugs. Anything tagged with <code>bug</code> and <code>help wanted</code> is open to whoever wants to implement it.</p>"},{"location":"contributing/#implement-features","title":"Implement Features","text":"<p>Look through the GitHub issues for features. Anything tagged with <code>enhancement</code> and <code>help wanted</code> is open to whoever wants to implement it.</p>"},{"location":"contributing/#write-documentation","title":"Write Documentation","text":"<p>anymap could always use more documentation, whether as part of the official anymap docs, in docstrings, or even on the web in blog posts, articles, and such.</p>"},{"location":"contributing/#submit-feedback","title":"Submit Feedback","text":"<p>The best way to send feedback is to file an issue at https://github.com/opengeos/anymap/issues.</p> <p>If you are proposing a feature:</p> <ul> <li>Explain in detail how it would work.</li> <li>Keep the scope as narrow as possible, to make it easier to implement.</li> <li>Remember that this is a volunteer-driven project, and that contributions are welcome :)</li> </ul>"},{"location":"contributing/#get-started","title":"Get Started!","text":"<p>Ready to contribute? Here's how to set up anymap for local development.</p> <ol> <li> <p>Fork the anymap repo on GitHub.</p> </li> <li> <p>Clone your fork locally:</p> <pre><code>$ git clone git@github.com:your_name_here/anymap.git\n</code></pre> </li> <li> <p>Install your local copy into a virtualenv. Assuming you have     virtualenvwrapper installed, this is how you set up your fork for     local development:</p> <pre><code>$ mkvirtualenv anymap\n$ cd anymap/\n$ python setup.py develop\n</code></pre> </li> <li> <p>Create a branch for local development:</p> <pre><code>$ git checkout -b name-of-your-bugfix-or-feature\n</code></pre> <p>Now you can make your changes locally.</p> </li> <li> <p>When you're done making changes, check that your changes pass flake8     and the tests, including testing other Python versions with tox:</p> <pre><code>$ flake8 anymap tests\n$ python setup.py test or pytest\n$ tox\n</code></pre> <p>To get flake8 and tox, just pip install them into your virtualenv.</p> </li> <li> <p>Commit your changes and push your branch to GitHub:</p> <pre><code>$ git add .\n$ git commit -m \"Your detailed description of your changes.\"\n$ git push origin name-of-your-bugfix-or-feature\n</code></pre> </li> <li> <p>Submit a pull request through the GitHub website.</p> </li> </ol>"},{"location":"contributing/#pull-request-guidelines","title":"Pull Request Guidelines","text":"<p>Before you submit a pull request, check that it meets these guidelines:</p> <ol> <li>The pull request should include tests.</li> <li>If the pull request adds functionality, the docs should be updated.     Put your new functionality into a function with a docstring, and add     the feature to the list in README.rst.</li> <li>The pull request should work for Python 3.8 and later, and     for PyPy. Check https://github.com/opengeos/anymap/pull_requests and make sure that the tests pass for all     supported Python versions.</li> </ol>"},{"location":"deckgl/","title":"deckgl module","text":"<p>DeckGL implementation of the map widget that extends MapLibre.</p>"},{"location":"deckgl/#anymap.deckgl.DeckGLMap","title":"<code> DeckGLMap            (MapLibreMap)         </code>","text":"<p>DeckGL implementation of the map widget that extends MapLibre.</p> Source code in <code>anymap/deckgl.py</code> <pre><code>class DeckGLMap(MapLibreMap):\n    \"\"\"DeckGL implementation of the map widget that extends MapLibre.\"\"\"\n\n    # DeckGL-specific traits\n    deckgl_layers = traitlets.List([]).tag(sync=True)\n    controller_options = traitlets.Dict({}).tag(sync=True)\n\n    # Override the JavaScript module\n    _esm = _esm_deckgl\n    _css = _css_deckgl\n\n    def __init__(\n        self,\n        center: List[float] = [0.0, 0.0],\n        zoom: float = 2.0,\n        style: str = \"https://basemaps.cartocdn.com/gl/positron-nolabels-gl-style/style.json\",\n        width: str = \"100%\",\n        height: str = \"600px\",\n        bearing: float = 0.0,\n        pitch: float = 0.0,\n        controller_options: Dict[str, Any] = None,\n        **kwargs,\n    ):\n        \"\"\"Initialize DeckGL map widget.\n\n        Args:\n            center: Map center as [latitude, longitude]\n            zoom: Initial zoom level\n            style: MapLibre style URL or style object\n            width: Widget width\n            height: Widget height\n            bearing: Map bearing (rotation) in degrees\n            pitch: Map pitch (tilt) in degrees\n            controller_options: DeckGL controller options\n        \"\"\"\n        super().__init__(\n            center=center,\n            zoom=zoom,\n            style=style,\n            width=width,\n            height=height,\n            bearing=bearing,\n            pitch=pitch,\n            **kwargs,\n        )\n\n        if controller_options is None:\n            controller_options = {\"doubleClickZoom\": False}\n        self.controller_options = controller_options\n\n    def add_deckgl_layer(self, layer_config: Dict[str, Any]) -&gt; None:\n        \"\"\"Add a DeckGL layer to the map.\n\n        Args:\n            layer_config: DeckGL layer configuration dictionary\n        \"\"\"\n        current_layers = list(self.deckgl_layers)\n        current_layers.append(layer_config)\n        self.deckgl_layers = current_layers\n\n    def remove_deckgl_layer(self, layer_id: str) -&gt; None:\n        \"\"\"Remove a DeckGL layer from the map.\n\n        Args:\n            layer_id: ID of the layer to remove\n        \"\"\"\n        current_layers = [\n            layer for layer in self.deckgl_layers if layer.get(\"id\") != layer_id\n        ]\n        self.deckgl_layers = current_layers\n\n    def clear_deckgl_layers(self) -&gt; None:\n        \"\"\"Clear all DeckGL layers from the map.\"\"\"\n        self.deckgl_layers = []\n\n    def add_geojson_layer(\n        self,\n        layer_id: str,\n        geojson_data: Dict[str, Any],\n        layer_type: str = \"GeoJsonLayer\",\n        **layer_props,\n    ) -&gt; None:\n        \"\"\"Add a GeoJSON layer using DeckGL.\n\n        Args:\n            layer_id: Unique identifier for the layer\n            geojson_data: GeoJSON data\n            layer_type: DeckGL layer type (e.g., 'GeoJsonLayer')\n            **layer_props: Additional DeckGL layer properties\n        \"\"\"\n        layer_config = {\n            \"@@type\": layer_type,\n            \"id\": layer_id,\n            \"data\": geojson_data,\n            \"pickable\": True,\n            \"autoHighlight\": True,\n            **layer_props,\n        }\n        self.add_deckgl_layer(layer_config)\n\n    def add_arc_layer(\n        self,\n        layer_id: str,\n        data: Union[str, List[Dict[str, Any]]],\n        get_source_position: Union[List[float], str] = None,\n        get_target_position: Union[List[float], str] = None,\n        **layer_props,\n    ) -&gt; None:\n        \"\"\"Add an Arc layer using DeckGL.\n\n        Args:\n            layer_id: Unique identifier for the layer\n            data: Data source (URL or array of objects)\n            get_source_position: Source position accessor (coordinates or accessor function)\n            get_target_position: Target position accessor (coordinates or accessor function)\n            **layer_props: Additional DeckGL layer properties\n        \"\"\"\n        layer_config = {\n            \"@@type\": \"ArcLayer\",\n            \"id\": layer_id,\n            \"data\": data,\n            \"pickable\": True,\n            \"autoHighlight\": True,\n            **layer_props,\n        }\n\n        if get_source_position:\n            layer_config[\"getSourcePosition\"] = get_source_position\n        if get_target_position:\n            layer_config[\"getTargetPosition\"] = get_target_position\n\n        self.add_deckgl_layer(layer_config)\n\n    def add_scatterplot_layer(\n        self,\n        layer_id: str,\n        data: Union[str, List[Dict[str, Any]]],\n        get_position: List[float] = None,\n        get_radius: Union[int, List[int]] = 100,\n        get_fill_color: List[int] = [255, 140, 0, 160],\n        **layer_props,\n    ) -&gt; None:\n        \"\"\"Add a Scatterplot layer using DeckGL.\n\n        Args:\n            layer_id: Unique identifier for the layer\n            data: Data source (URL or array of objects)\n            get_position: Position accessor\n            get_radius: Radius accessor\n            get_fill_color: Fill color accessor\n            **layer_props: Additional DeckGL layer properties\n        \"\"\"\n        layer_config = {\n            \"@@type\": \"ScatterplotLayer\",\n            \"id\": layer_id,\n            \"data\": data,\n            \"pickable\": True,\n            \"autoHighlight\": True,\n            \"radiusMinPixels\": 2,\n            \"radiusMaxPixels\": 100,\n            \"getRadius\": get_radius,\n            \"getFillColor\": get_fill_color,\n            **layer_props,\n        }\n\n        if get_position:\n            layer_config[\"getPosition\"] = get_position\n\n        self.add_deckgl_layer(layer_config)\n\n    def to_html(\n        self,\n        filename: Optional[str] = None,\n        title: str = \"DeckGL Map Export\",\n        width: str = \"100%\",\n        height: str = \"600px\",\n        **kwargs,\n    ) -&gt; str:\n        \"\"\"Export the DeckGL map to a standalone HTML file.\n\n        Args:\n            filename: Optional filename to save the HTML. If None, returns HTML string.\n            title: Title for the HTML page\n            width: Width of the map container\n            height: Height of the map container\n            **kwargs: Additional arguments passed to the HTML template\n\n        Returns:\n            HTML string content\n        \"\"\"\n        # Get the current map state\n        map_state = {\n            \"center\": self.center,\n            \"zoom\": self.zoom,\n            \"width\": width,\n            \"height\": height,\n            \"style\": self.style,\n            \"_layers\": dict(self._layers),\n            \"_sources\": dict(self._sources),\n            \"deckgl_layers\": list(self.deckgl_layers),  # Include DeckGL layers\n            \"controller_options\": dict(self.controller_options),\n        }\n\n        # Add class-specific attributes\n        if hasattr(self, \"style\"):\n            map_state[\"style\"] = self.style\n        if hasattr(self, \"bearing\"):\n            map_state[\"bearing\"] = self.bearing\n        if hasattr(self, \"pitch\"):\n            map_state[\"pitch\"] = self.pitch\n        if hasattr(self, \"antialias\"):\n            map_state[\"antialias\"] = self.antialias\n\n        # Generate HTML content\n        html_content = self._generate_html_template(map_state, title, **kwargs)\n\n        # Save to file if filename is provided\n        if filename:\n            with open(filename, \"w\", encoding=\"utf-8\") as f:\n                f.write(html_content)\n\n        return html_content\n\n    def _generate_html_template(\n        self, map_state: Dict[str, Any], title: str, **kwargs\n    ) -&gt; str:\n        \"\"\"Generate HTML template for DeckGL.\"\"\"\n        # Serialize map state for JavaScript\n        map_state_json = json.dumps(map_state, indent=2)\n\n        html_template = f\"\"\"&lt;!DOCTYPE html&gt;\n&lt;html&gt;\n&lt;head&gt;\n    &lt;title&gt;{title}&lt;/title&gt;\n    &lt;meta charset=\"utf-8\"&gt;\n    &lt;meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\"&gt;\n    &lt;script src=\"https://unpkg.com/deck.gl@9.1.12/dist.min.js\"&gt;&lt;/script&gt;\n    &lt;script src=\"https://unpkg.com/maplibre-gl@5.10.0/dist/maplibre-gl.js\"&gt;&lt;/script&gt;\n    &lt;link href=\"https://unpkg.com/maplibre-gl@5.10.0/dist/maplibre-gl.css\" rel=\"stylesheet\"&gt;\n    &lt;style&gt;\n        body {{\n            margin: 0;\n            padding: 20px;\n            font-family: Arial, sans-serif;\n        }}\n        #map {{\n            width: {map_state['width']};\n            height: {map_state['height']};\n            border: 1px solid #ccc;\n        }}\n        h1 {{\n            margin-top: 0;\n            color: #333;\n        }}\n    &lt;/style&gt;\n&lt;/head&gt;\n&lt;body&gt;\n    &lt;h1&gt;{title}&lt;/h1&gt;\n    &lt;div id=\"map\"&gt;&lt;/div&gt;\n\n    &lt;script&gt;\n        // Map state from Python\n        const mapState = {map_state_json};\n\n        // Parse DeckGL layers from configuration\n        function parseDeckGLLayers(layerConfigs) {{\n            // Helper function to convert accessor expressions to functions\n            function parseAccessor(accessor) {{\n                if (typeof accessor === 'string' &amp;&amp; accessor.startsWith('@@=')) {{\n                    const expression = accessor.substring(3); // Remove '@@=' prefix\n\n                    try {{\n                        // Handle arrow function expressions directly\n                        if (expression.includes('=&gt;')) {{\n                            // This is already an arrow function, just evaluate it\n                            return eval(`(${{expression}})`);\n                        }}\n                        // Create a function from the expression\n                        // Handle different variable contexts (d = data item, f = feature, etc.)\n                        else if (expression.includes('f.geometry.coordinates')) {{\n                            return new Function('f', `return ${{expression}}`);\n                        }} else if (expression.includes('f.properties')) {{\n                            return new Function('f', `return ${{expression}}`);\n                        }} else if (expression.includes('d.features')) {{\n                            // For dataTransform functions\n                            return new Function('d', `return ${{expression}}`);\n                        }} else if (expression.includes('d.')) {{\n                            return new Function('d', `return ${{expression}}`);\n                        }} else {{\n                            // Default context\n                            return new Function('d', `return ${{expression}}`);\n                        }}\n                    }} catch (error) {{\n                        console.warn('Failed to parse accessor expression:', accessor, error);\n                        return accessor; // Return original if parsing fails\n                    }}\n                }}\n                return accessor;\n            }}\n\n            // Helper function to process layer properties and convert accessors\n            function processLayerProps(props) {{\n                const processed = {{ ...props }};\n\n                // List of properties that should be treated as accessors\n                const accessorProps = [\n                    'getSourcePosition', 'getTargetPosition', 'getPosition',\n                    'getRadius', 'getFillColor', 'getLineColor', 'getWidth',\n                    'getPointRadius', 'dataTransform'\n                ];\n\n                accessorProps.forEach(prop =&gt; {{\n                    if (prop in processed) {{\n                        processed[prop] = parseAccessor(processed[prop]);\n                    }}\n                }});\n\n                return processed;\n            }}\n\n            return layerConfigs.map(config =&gt; {{\n                const layerType = config[\"@@type\"];\n                const layerProps = processLayerProps({{ ...config }});\n                delete layerProps[\"@@type\"];\n\n                try {{\n                    switch (layerType) {{\n                        case \"GeoJsonLayer\":\n                            return new deck.GeoJsonLayer(layerProps);\n                        case \"ArcLayer\":\n                            return new deck.ArcLayer(layerProps);\n                        case \"ScatterplotLayer\":\n                            return new deck.ScatterplotLayer(layerProps);\n                        default:\n                            console.warn(`Unknown DeckGL layer type: ${{layerType}}`);\n                            return null;\n                    }}\n                }} catch (error) {{\n                    console.error(`Error creating ${{layerType}}:`, error, layerProps);\n                    return null;\n                }}\n            }}).filter(layer =&gt; layer !== null);\n        }}\n\n        // Initialize DeckGL with MapLibre\n        const deckgl = new deck.DeckGL({{\n            container: 'map',\n            mapStyle: mapState.style || 'https://basemaps.cartocdn.com/gl/positron-nolabels-gl-style/style.json',\n            initialViewState: {{\n                latitude: mapState.center[0],\n                longitude: mapState.center[1],\n                zoom: mapState.zoom || 2,\n                bearing: mapState.bearing || 0,\n                pitch: mapState.pitch || 0\n            }},\n            controller: true,\n            layers: parseDeckGLLayers(mapState.deckgl_layers || []),\n            onViewStateChange: ({{viewState}}) =&gt; {{\n                console.log('View state changed:', viewState);\n            }},\n            onClick: (info) =&gt; {{\n                if (info.object) {{\n                    console.log('Clicked object:', info.object);\n                    if (info.object.properties &amp;&amp; info.object.properties.name) {{\n                        alert(`${{info.object.properties.name}} (${{info.object.properties.abbrev || 'N/A'}})`);\n                    }}\n                }}\n            }}\n        }});\n\n        // Add navigation controls styling\n        const mapContainer = document.getElementById('map');\n        mapContainer.style.position = 'relative';\n\n        console.log('DeckGL map initialized successfully');\n        console.log('Loaded layers:', mapState.deckgl_layers ? mapState.deckgl_layers.length : 0);\n    &lt;/script&gt;\n&lt;/body&gt;\n&lt;/html&gt;\"\"\"\n\n        return html_template\n</code></pre>"},{"location":"deckgl/#anymap.deckgl.DeckGLMap.__init__","title":"<code>__init__(self, center=[0.0, 0.0], zoom=2.0, style='https://basemaps.cartocdn.com/gl/positron-nolabels-gl-style/style.json', width='100%', height='600px', bearing=0.0, pitch=0.0, controller_options=None, **kwargs)</code>  <code>special</code>","text":"<p>Initialize DeckGL map widget.</p> <p>Parameters:</p> Name Type Description Default <code>center</code> <code>List[float]</code> <p>Map center as [latitude, longitude]</p> <code>[0.0, 0.0]</code> <code>zoom</code> <code>float</code> <p>Initial zoom level</p> <code>2.0</code> <code>style</code> <code>str</code> <p>MapLibre style URL or style object</p> <code>'https://basemaps.cartocdn.com/gl/positron-nolabels-gl-style/style.json'</code> <code>width</code> <code>str</code> <p>Widget width</p> <code>'100%'</code> <code>height</code> <code>str</code> <p>Widget height</p> <code>'600px'</code> <code>bearing</code> <code>float</code> <p>Map bearing (rotation) in degrees</p> <code>0.0</code> <code>pitch</code> <code>float</code> <p>Map pitch (tilt) in degrees</p> <code>0.0</code> <code>controller_options</code> <code>Dict[str, Any]</code> <p>DeckGL controller options</p> <code>None</code> Source code in <code>anymap/deckgl.py</code> <pre><code>def __init__(\n    self,\n    center: List[float] = [0.0, 0.0],\n    zoom: float = 2.0,\n    style: str = \"https://basemaps.cartocdn.com/gl/positron-nolabels-gl-style/style.json\",\n    width: str = \"100%\",\n    height: str = \"600px\",\n    bearing: float = 0.0,\n    pitch: float = 0.0,\n    controller_options: Dict[str, Any] = None,\n    **kwargs,\n):\n    \"\"\"Initialize DeckGL map widget.\n\n    Args:\n        center: Map center as [latitude, longitude]\n        zoom: Initial zoom level\n        style: MapLibre style URL or style object\n        width: Widget width\n        height: Widget height\n        bearing: Map bearing (rotation) in degrees\n        pitch: Map pitch (tilt) in degrees\n        controller_options: DeckGL controller options\n    \"\"\"\n    super().__init__(\n        center=center,\n        zoom=zoom,\n        style=style,\n        width=width,\n        height=height,\n        bearing=bearing,\n        pitch=pitch,\n        **kwargs,\n    )\n\n    if controller_options is None:\n        controller_options = {\"doubleClickZoom\": False}\n    self.controller_options = controller_options\n</code></pre>"},{"location":"deckgl/#anymap.deckgl.DeckGLMap.add_arc_layer","title":"<code>add_arc_layer(self, layer_id, data, get_source_position=None, get_target_position=None, **layer_props)</code>","text":"<p>Add an Arc layer using DeckGL.</p> <p>Parameters:</p> Name Type Description Default <code>layer_id</code> <code>str</code> <p>Unique identifier for the layer</p> required <code>data</code> <code>Union[str, List[Dict[str, Any]]]</code> <p>Data source (URL or array of objects)</p> required <code>get_source_position</code> <code>Union[List[float], str]</code> <p>Source position accessor (coordinates or accessor function)</p> <code>None</code> <code>get_target_position</code> <code>Union[List[float], str]</code> <p>Target position accessor (coordinates or accessor function)</p> <code>None</code> <code>**layer_props</code> <p>Additional DeckGL layer properties</p> <code>{}</code> Source code in <code>anymap/deckgl.py</code> <pre><code>def add_arc_layer(\n    self,\n    layer_id: str,\n    data: Union[str, List[Dict[str, Any]]],\n    get_source_position: Union[List[float], str] = None,\n    get_target_position: Union[List[float], str] = None,\n    **layer_props,\n) -&gt; None:\n    \"\"\"Add an Arc layer using DeckGL.\n\n    Args:\n        layer_id: Unique identifier for the layer\n        data: Data source (URL or array of objects)\n        get_source_position: Source position accessor (coordinates or accessor function)\n        get_target_position: Target position accessor (coordinates or accessor function)\n        **layer_props: Additional DeckGL layer properties\n    \"\"\"\n    layer_config = {\n        \"@@type\": \"ArcLayer\",\n        \"id\": layer_id,\n        \"data\": data,\n        \"pickable\": True,\n        \"autoHighlight\": True,\n        **layer_props,\n    }\n\n    if get_source_position:\n        layer_config[\"getSourcePosition\"] = get_source_position\n    if get_target_position:\n        layer_config[\"getTargetPosition\"] = get_target_position\n\n    self.add_deckgl_layer(layer_config)\n</code></pre>"},{"location":"deckgl/#anymap.deckgl.DeckGLMap.add_deckgl_layer","title":"<code>add_deckgl_layer(self, layer_config)</code>","text":"<p>Add a DeckGL layer to the map.</p> <p>Parameters:</p> Name Type Description Default <code>layer_config</code> <code>Dict[str, Any]</code> <p>DeckGL layer configuration dictionary</p> required Source code in <code>anymap/deckgl.py</code> <pre><code>def add_deckgl_layer(self, layer_config: Dict[str, Any]) -&gt; None:\n    \"\"\"Add a DeckGL layer to the map.\n\n    Args:\n        layer_config: DeckGL layer configuration dictionary\n    \"\"\"\n    current_layers = list(self.deckgl_layers)\n    current_layers.append(layer_config)\n    self.deckgl_layers = current_layers\n</code></pre>"},{"location":"deckgl/#anymap.deckgl.DeckGLMap.add_geojson_layer","title":"<code>add_geojson_layer(self, layer_id, geojson_data, layer_type='GeoJsonLayer', **layer_props)</code>","text":"<p>Add a GeoJSON layer using DeckGL.</p> <p>Parameters:</p> Name Type Description Default <code>layer_id</code> <code>str</code> <p>Unique identifier for the layer</p> required <code>geojson_data</code> <code>Dict[str, Any]</code> <p>GeoJSON data</p> required <code>layer_type</code> <code>str</code> <p>DeckGL layer type (e.g., 'GeoJsonLayer')</p> <code>'GeoJsonLayer'</code> <code>**layer_props</code> <p>Additional DeckGL layer properties</p> <code>{}</code> Source code in <code>anymap/deckgl.py</code> <pre><code>def add_geojson_layer(\n    self,\n    layer_id: str,\n    geojson_data: Dict[str, Any],\n    layer_type: str = \"GeoJsonLayer\",\n    **layer_props,\n) -&gt; None:\n    \"\"\"Add a GeoJSON layer using DeckGL.\n\n    Args:\n        layer_id: Unique identifier for the layer\n        geojson_data: GeoJSON data\n        layer_type: DeckGL layer type (e.g., 'GeoJsonLayer')\n        **layer_props: Additional DeckGL layer properties\n    \"\"\"\n    layer_config = {\n        \"@@type\": layer_type,\n        \"id\": layer_id,\n        \"data\": geojson_data,\n        \"pickable\": True,\n        \"autoHighlight\": True,\n        **layer_props,\n    }\n    self.add_deckgl_layer(layer_config)\n</code></pre>"},{"location":"deckgl/#anymap.deckgl.DeckGLMap.add_scatterplot_layer","title":"<code>add_scatterplot_layer(self, layer_id, data, get_position=None, get_radius=100, get_fill_color=[255, 140, 0, 160], **layer_props)</code>","text":"<p>Add a Scatterplot layer using DeckGL.</p> <p>Parameters:</p> Name Type Description Default <code>layer_id</code> <code>str</code> <p>Unique identifier for the layer</p> required <code>data</code> <code>Union[str, List[Dict[str, Any]]]</code> <p>Data source (URL or array of objects)</p> required <code>get_position</code> <code>List[float]</code> <p>Position accessor</p> <code>None</code> <code>get_radius</code> <code>Union[int, List[int]]</code> <p>Radius accessor</p> <code>100</code> <code>get_fill_color</code> <code>List[int]</code> <p>Fill color accessor</p> <code>[255, 140, 0, 160]</code> <code>**layer_props</code> <p>Additional DeckGL layer properties</p> <code>{}</code> Source code in <code>anymap/deckgl.py</code> <pre><code>def add_scatterplot_layer(\n    self,\n    layer_id: str,\n    data: Union[str, List[Dict[str, Any]]],\n    get_position: List[float] = None,\n    get_radius: Union[int, List[int]] = 100,\n    get_fill_color: List[int] = [255, 140, 0, 160],\n    **layer_props,\n) -&gt; None:\n    \"\"\"Add a Scatterplot layer using DeckGL.\n\n    Args:\n        layer_id: Unique identifier for the layer\n        data: Data source (URL or array of objects)\n        get_position: Position accessor\n        get_radius: Radius accessor\n        get_fill_color: Fill color accessor\n        **layer_props: Additional DeckGL layer properties\n    \"\"\"\n    layer_config = {\n        \"@@type\": \"ScatterplotLayer\",\n        \"id\": layer_id,\n        \"data\": data,\n        \"pickable\": True,\n        \"autoHighlight\": True,\n        \"radiusMinPixels\": 2,\n        \"radiusMaxPixels\": 100,\n        \"getRadius\": get_radius,\n        \"getFillColor\": get_fill_color,\n        **layer_props,\n    }\n\n    if get_position:\n        layer_config[\"getPosition\"] = get_position\n\n    self.add_deckgl_layer(layer_config)\n</code></pre>"},{"location":"deckgl/#anymap.deckgl.DeckGLMap.clear_deckgl_layers","title":"<code>clear_deckgl_layers(self)</code>","text":"<p>Clear all DeckGL layers from the map.</p> Source code in <code>anymap/deckgl.py</code> <pre><code>def clear_deckgl_layers(self) -&gt; None:\n    \"\"\"Clear all DeckGL layers from the map.\"\"\"\n    self.deckgl_layers = []\n</code></pre>"},{"location":"deckgl/#anymap.deckgl.DeckGLMap.remove_deckgl_layer","title":"<code>remove_deckgl_layer(self, layer_id)</code>","text":"<p>Remove a DeckGL layer from the map.</p> <p>Parameters:</p> Name Type Description Default <code>layer_id</code> <code>str</code> <p>ID of the layer to remove</p> required Source code in <code>anymap/deckgl.py</code> <pre><code>def remove_deckgl_layer(self, layer_id: str) -&gt; None:\n    \"\"\"Remove a DeckGL layer from the map.\n\n    Args:\n        layer_id: ID of the layer to remove\n    \"\"\"\n    current_layers = [\n        layer for layer in self.deckgl_layers if layer.get(\"id\") != layer_id\n    ]\n    self.deckgl_layers = current_layers\n</code></pre>"},{"location":"deckgl/#anymap.deckgl.DeckGLMap.to_html","title":"<code>to_html(self, filename=None, title='DeckGL Map Export', width='100%', height='600px', **kwargs)</code>","text":"<p>Export the DeckGL map to a standalone HTML file.</p> <p>Parameters:</p> Name Type Description Default <code>filename</code> <code>Optional[str]</code> <p>Optional filename to save the HTML. If None, returns HTML string.</p> <code>None</code> <code>title</code> <code>str</code> <p>Title for the HTML page</p> <code>'DeckGL Map Export'</code> <code>width</code> <code>str</code> <p>Width of the map container</p> <code>'100%'</code> <code>height</code> <code>str</code> <p>Height of the map container</p> <code>'600px'</code> <code>**kwargs</code> <p>Additional arguments passed to the HTML template</p> <code>{}</code> <p>Returns:</p> Type Description <code>str</code> <p>HTML string content</p> Source code in <code>anymap/deckgl.py</code> <pre><code>def to_html(\n    self,\n    filename: Optional[str] = None,\n    title: str = \"DeckGL Map Export\",\n    width: str = \"100%\",\n    height: str = \"600px\",\n    **kwargs,\n) -&gt; str:\n    \"\"\"Export the DeckGL map to a standalone HTML file.\n\n    Args:\n        filename: Optional filename to save the HTML. If None, returns HTML string.\n        title: Title for the HTML page\n        width: Width of the map container\n        height: Height of the map container\n        **kwargs: Additional arguments passed to the HTML template\n\n    Returns:\n        HTML string content\n    \"\"\"\n    # Get the current map state\n    map_state = {\n        \"center\": self.center,\n        \"zoom\": self.zoom,\n        \"width\": width,\n        \"height\": height,\n        \"style\": self.style,\n        \"_layers\": dict(self._layers),\n        \"_sources\": dict(self._sources),\n        \"deckgl_layers\": list(self.deckgl_layers),  # Include DeckGL layers\n        \"controller_options\": dict(self.controller_options),\n    }\n\n    # Add class-specific attributes\n    if hasattr(self, \"style\"):\n        map_state[\"style\"] = self.style\n    if hasattr(self, \"bearing\"):\n        map_state[\"bearing\"] = self.bearing\n    if hasattr(self, \"pitch\"):\n        map_state[\"pitch\"] = self.pitch\n    if hasattr(self, \"antialias\"):\n        map_state[\"antialias\"] = self.antialias\n\n    # Generate HTML content\n    html_content = self._generate_html_template(map_state, title, **kwargs)\n\n    # Save to file if filename is provided\n    if filename:\n        with open(filename, \"w\", encoding=\"utf-8\") as f:\n            f.write(html_content)\n\n    return html_content\n</code></pre>"},{"location":"draw_styles/","title":"draw_styles module","text":"<p>Draw control styling utilities for AnyMap.</p> <p>This module provides utilities for creating and managing draw control styles for MapLibre GL JS and other mapping backends.</p>"},{"location":"draw_styles/#anymap.draw_styles.create_draw_styles","title":"<code>create_draw_styles(point_color='#3bb2d0', line_color='#3bb2d0', polygon_fill_color='#3bb2d0', polygon_stroke_color='#3bb2d0', active_color='#fbb03b', point_radius=3, line_width=2, polygon_opacity=0.1)</code>","text":"<p>Create custom draw control styles.</p> <p>Parameters:</p> Name Type Description Default <code>point_color</code> <code>str</code> <p>Color for point features</p> <code>'#3bb2d0'</code> <code>line_color</code> <code>str</code> <p>Color for line features</p> <code>'#3bb2d0'</code> <code>polygon_fill_color</code> <code>str</code> <p>Fill color for polygon features</p> <code>'#3bb2d0'</code> <code>polygon_stroke_color</code> <code>str</code> <p>Stroke color for polygon features</p> <code>'#3bb2d0'</code> <code>active_color</code> <code>str</code> <p>Color for active/selected features</p> <code>'#fbb03b'</code> <code>point_radius</code> <code>float</code> <p>Radius for point features</p> <code>3</code> <code>line_width</code> <code>float</code> <p>Width for line features</p> <code>2</code> <code>polygon_opacity</code> <code>float</code> <p>Opacity for polygon fill</p> <code>0.1</code> <p>Returns:</p> Type Description <code>List[Dict[str, Any]]</code> <p>List of style definitions for MapLibre draw control</p> Source code in <code>anymap/draw_styles.py</code> <pre><code>def create_draw_styles(\n    point_color: str = \"#3bb2d0\",\n    line_color: str = \"#3bb2d0\",\n    polygon_fill_color: str = \"#3bb2d0\",\n    polygon_stroke_color: str = \"#3bb2d0\",\n    active_color: str = \"#fbb03b\",\n    point_radius: float = 3,\n    line_width: float = 2,\n    polygon_opacity: float = 0.1,\n) -&gt; List[Dict[str, Any]]:\n    \"\"\"Create custom draw control styles.\n\n    Args:\n        point_color: Color for point features\n        line_color: Color for line features\n        polygon_fill_color: Fill color for polygon features\n        polygon_stroke_color: Stroke color for polygon features\n        active_color: Color for active/selected features\n        point_radius: Radius for point features\n        line_width: Width for line features\n        polygon_opacity: Opacity for polygon fill\n\n    Returns:\n        List of style definitions for MapLibre draw control\n    \"\"\"\n    return [\n        # Point styles\n        {\n            \"id\": \"gl-draw-point\",\n            \"type\": \"circle\",\n            \"filter\": [\"all\", [\"==\", \"$type\", \"Point\"], [\"!=\", \"meta\", \"midpoint\"]],\n            \"paint\": {\"circle-radius\": point_radius, \"circle-color\": point_color},\n        },\n        # Line styles\n        {\n            \"id\": \"gl-draw-line\",\n            \"type\": \"line\",\n            \"filter\": [\"all\", [\"==\", \"$type\", \"LineString\"], [\"!=\", \"mode\", \"static\"]],\n            \"layout\": {\"line-cap\": \"round\", \"line-join\": \"round\"},\n            \"paint\": {\"line-color\": line_color, \"line-width\": line_width},\n        },\n        # Polygon fill\n        {\n            \"id\": \"gl-draw-polygon-fill\",\n            \"type\": \"fill\",\n            \"filter\": [\"all\", [\"==\", \"$type\", \"Polygon\"], [\"!=\", \"mode\", \"static\"]],\n            \"paint\": {\n                \"fill-color\": polygon_fill_color,\n                \"fill-outline-color\": polygon_stroke_color,\n                \"fill-opacity\": polygon_opacity,\n            },\n        },\n        # Polygon stroke\n        {\n            \"id\": \"gl-draw-polygon-stroke\",\n            \"type\": \"line\",\n            \"filter\": [\"all\", [\"==\", \"$type\", \"Polygon\"], [\"!=\", \"mode\", \"static\"]],\n            \"layout\": {\"line-cap\": \"round\", \"line-join\": \"round\"},\n            \"paint\": {\"line-color\": polygon_stroke_color, \"line-width\": line_width},\n        },\n        # Active point\n        {\n            \"id\": \"gl-draw-point-active\",\n            \"type\": \"circle\",\n            \"filter\": [\"all\", [\"==\", \"$type\", \"Point\"], [\"==\", \"active\", \"true\"]],\n            \"paint\": {\"circle-radius\": point_radius + 1, \"circle-color\": active_color},\n        },\n        # Active line\n        {\n            \"id\": \"gl-draw-line-active\",\n            \"type\": \"line\",\n            \"filter\": [\"all\", [\"==\", \"$type\", \"LineString\"], [\"==\", \"active\", \"true\"]],\n            \"layout\": {\"line-cap\": \"round\", \"line-join\": \"round\"},\n            \"paint\": {\"line-color\": active_color, \"line-width\": line_width + 1},\n        },\n        # Active polygon fill\n        {\n            \"id\": \"gl-draw-polygon-fill-active\",\n            \"type\": \"fill\",\n            \"filter\": [\"all\", [\"==\", \"$type\", \"Polygon\"], [\"==\", \"active\", \"true\"]],\n            \"paint\": {\n                \"fill-color\": active_color,\n                \"fill-outline-color\": active_color,\n                \"fill-opacity\": polygon_opacity,\n            },\n        },\n        # Active polygon stroke\n        {\n            \"id\": \"gl-draw-polygon-stroke-active\",\n            \"type\": \"line\",\n            \"filter\": [\"all\", [\"==\", \"$type\", \"Polygon\"], [\"==\", \"active\", \"true\"]],\n            \"layout\": {\"line-cap\": \"round\", \"line-join\": \"round\"},\n            \"paint\": {\"line-color\": active_color, \"line-width\": line_width + 1},\n        },\n        # Static styles (for completed features)\n        {\n            \"id\": \"gl-draw-point-static\",\n            \"type\": \"circle\",\n            \"filter\": [\"all\", [\"==\", \"$type\", \"Point\"], [\"==\", \"mode\", \"static\"]],\n            \"paint\": {\"circle-radius\": point_radius, \"circle-color\": point_color},\n        },\n        {\n            \"id\": \"gl-draw-line-static\",\n            \"type\": \"line\",\n            \"filter\": [\"all\", [\"==\", \"$type\", \"LineString\"], [\"==\", \"mode\", \"static\"]],\n            \"layout\": {\"line-cap\": \"round\", \"line-join\": \"round\"},\n            \"paint\": {\"line-color\": line_color, \"line-width\": line_width},\n        },\n        {\n            \"id\": \"gl-draw-polygon-fill-static\",\n            \"type\": \"fill\",\n            \"filter\": [\"all\", [\"==\", \"$type\", \"Polygon\"], [\"==\", \"mode\", \"static\"]],\n            \"paint\": {\n                \"fill-color\": polygon_fill_color,\n                \"fill-outline-color\": polygon_stroke_color,\n                \"fill-opacity\": polygon_opacity,\n            },\n        },\n        {\n            \"id\": \"gl-draw-polygon-stroke-static\",\n            \"type\": \"line\",\n            \"filter\": [\"all\", [\"==\", \"$type\", \"Polygon\"], [\"==\", \"mode\", \"static\"]],\n            \"layout\": {\"line-cap\": \"round\", \"line-join\": \"round\"},\n            \"paint\": {\"line-color\": polygon_stroke_color, \"line-width\": line_width},\n        },\n        # Midpoint styles (for adding vertices)\n        {\n            \"id\": \"gl-draw-polygon-midpoint\",\n            \"type\": \"circle\",\n            \"filter\": [\"all\", [\"==\", \"$type\", \"Point\"], [\"==\", \"meta\", \"midpoint\"]],\n            \"paint\": {\"circle-radius\": 3, \"circle-color\": active_color},\n        },\n        # Vertex styles for editing\n        {\n            \"id\": \"gl-draw-polygon-and-line-vertex-stroke-inactive\",\n            \"type\": \"circle\",\n            \"filter\": [\n                \"all\",\n                [\"==\", \"$type\", \"Point\"],\n                [\"==\", \"meta\", \"vertex\"],\n                [\"!=\", \"meta\", \"midpoint\"],\n                [\"!=\", \"active\", \"true\"],\n            ],\n            \"paint\": {\"circle-radius\": 5, \"circle-color\": \"#fff\"},\n        },\n        {\n            \"id\": \"gl-draw-polygon-and-line-vertex-inactive\",\n            \"type\": \"circle\",\n            \"filter\": [\n                \"all\",\n                [\"==\", \"$type\", \"Point\"],\n                [\"==\", \"meta\", \"vertex\"],\n                [\"!=\", \"meta\", \"midpoint\"],\n                [\"!=\", \"active\", \"true\"],\n            ],\n            \"paint\": {\"circle-radius\": 3, \"circle-color\": active_color},\n        },\n        # Active vertex styles\n        {\n            \"id\": \"gl-draw-point-point-stroke-inactive\",\n            \"type\": \"circle\",\n            \"filter\": [\n                \"all\",\n                [\"==\", \"$type\", \"Point\"],\n                [\"==\", \"active\", \"false\"],\n                [\"!=\", \"meta\", \"midpoint\"],\n            ],\n            \"paint\": {\"circle-radius\": 5, \"circle-color\": \"#fff\"},\n        },\n        {\n            \"id\": \"gl-draw-point-inactive\",\n            \"type\": \"circle\",\n            \"filter\": [\n                \"all\",\n                [\"==\", \"$type\", \"Point\"],\n                [\"==\", \"active\", \"false\"],\n                [\"!=\", \"meta\", \"midpoint\"],\n            ],\n            \"paint\": {\"circle-radius\": 3, \"circle-color\": point_color},\n        },\n        {\n            \"id\": \"gl-draw-point-stroke-active\",\n            \"type\": \"circle\",\n            \"filter\": [\n                \"all\",\n                [\"==\", \"$type\", \"Point\"],\n                [\"!=\", \"meta\", \"midpoint\"],\n                [\"==\", \"active\", \"true\"],\n            ],\n            \"paint\": {\"circle-radius\": 7, \"circle-color\": \"#fff\"},\n        },\n        {\n            \"id\": \"gl-draw-polygon-fill-inactive\",\n            \"type\": \"fill\",\n            \"filter\": [\"all\", [\"==\", \"$type\", \"Polygon\"], [\"==\", \"active\", \"false\"]],\n            \"paint\": {\n                \"fill-color\": polygon_fill_color,\n                \"fill-outline-color\": polygon_stroke_color,\n                \"fill-opacity\": polygon_opacity,\n            },\n        },\n        {\n            \"id\": \"gl-draw-polygon-stroke-inactive\",\n            \"type\": \"line\",\n            \"filter\": [\"all\", [\"==\", \"$type\", \"Polygon\"], [\"==\", \"active\", \"false\"]],\n            \"layout\": {\"line-cap\": \"round\", \"line-join\": \"round\"},\n            \"paint\": {\"line-color\": polygon_stroke_color, \"line-width\": line_width},\n        },\n        {\n            \"id\": \"gl-draw-line-inactive\",\n            \"type\": \"line\",\n            \"filter\": [\n                \"all\",\n                [\"==\", \"$type\", \"LineString\"],\n                [\"==\", \"active\", \"false\"],\n            ],\n            \"layout\": {\"line-cap\": \"round\", \"line-join\": \"round\"},\n            \"paint\": {\"line-color\": line_color, \"line-width\": line_width},\n        },\n        # Line vertex styles\n        {\n            \"id\": \"gl-draw-line-vertex-stroke-active\",\n            \"type\": \"circle\",\n            \"filter\": [\n                \"all\",\n                [\"==\", \"$type\", \"Point\"],\n                [\"==\", \"meta\", \"vertex\"],\n                [\"!=\", \"meta\", \"midpoint\"],\n            ],\n            \"paint\": {\"circle-radius\": 5, \"circle-color\": active_color},\n        },\n        {\n            \"id\": \"gl-draw-polygon-vertex-active\",\n            \"type\": \"circle\",\n            \"filter\": [\n                \"all\",\n                [\"==\", \"$type\", \"Point\"],\n                [\"==\", \"meta\", \"vertex\"],\n                [\"!=\", \"meta\", \"midpoint\"],\n            ],\n            \"paint\": {\"circle-radius\": 5, \"circle-color\": active_color},\n        },\n    ]\n</code></pre>"},{"location":"faq/","title":"FAQ","text":""},{"location":"installation/","title":"Installation","text":""},{"location":"installation/#stable-release","title":"Stable release","text":"<p>To install anymap, run this command in your terminal:</p> <pre><code>pip install anymap\n</code></pre> <p>This is the preferred method to install anymap, as it will always install the most recent stable release.</p> <p>If you don't have pip installed, this Python installation guide can guide you through the process.</p>"},{"location":"installation/#from-sources","title":"From sources","text":"<p>To install anymap from sources, run this command in your terminal:</p> <pre><code>pip install git+https://github.com/opengeos/anymap\n</code></pre>"},{"location":"keplergl/","title":"keplergl module","text":"<p>KeplerGL implementation of the map widget.</p>"},{"location":"keplergl/#anymap.keplergl.KeplerGLMap","title":"<code> KeplerGLMap            (MapWidget)         </code>","text":"<p>KeplerGL implementation of the map widget.</p> Source code in <code>anymap/keplergl.py</code> <pre><code>class KeplerGLMap(MapWidget):\n    \"\"\"KeplerGL implementation of the map widget.\"\"\"\n\n    # KeplerGL-specific traits\n    map_config = traitlets.Dict({}).tag(sync=True)\n    show_docs = traitlets.Bool(False).tag(sync=True)\n    read_only = traitlets.Bool(False).tag(sync=True)\n    _data = traitlets.Dict({}).tag(sync=True)\n\n    # Define the JavaScript module path\n    _esm = _esm_keplergl\n    _css = _css_keplergl\n\n    def __init__(\n        self,\n        center: List[float] = [37.7749, -122.4194],\n        zoom: float = 9.0,\n        width: str = \"100%\",\n        height: str = \"600px\",\n        show_docs: bool = False,\n        read_only: bool = False,\n        **kwargs,\n    ):\n        \"\"\"Initialize KeplerGL map widget.\n\n        Args:\n            center: Map center as [latitude, longitude]\n            zoom: Initial zoom level\n            width: Widget width\n            height: Widget height\n            show_docs: Whether to show documentation panel\n            read_only: Whether the map is read-only\n            **kwargs: Additional widget arguments\n        \"\"\"\n        super().__init__(\n            center=center,\n            zoom=zoom,\n            width=width,\n            height=height,\n            **kwargs,\n        )\n        self.show_docs = show_docs\n        self.read_only = read_only\n        self._initialize_config()\n\n    def _initialize_config(self):\n        \"\"\"Initialize the KeplerGL configuration.\"\"\"\n        self.map_config = {\n            \"version\": \"v1\",\n            \"config\": {\n                \"mapState\": {\n                    \"latitude\": self.center[0],\n                    \"longitude\": self.center[1],\n                    \"zoom\": self.zoom,\n                    \"bearing\": 0,\n                    \"pitch\": 0,\n                    \"dragRotate\": False,\n                    \"width\": self.width,\n                    \"height\": self.height,\n                    \"isSplit\": False,\n                },\n                \"mapStyle\": {\n                    \"styleType\": \"dark\",\n                    \"topLayerGroups\": {},\n                    \"visibleLayerGroups\": {\n                        \"label\": True,\n                        \"road\": True,\n                        \"border\": False,\n                        \"building\": True,\n                        \"water\": True,\n                        \"land\": True,\n                        \"3d building\": False,\n                    },\n                    \"mapStyles\": {},\n                },\n                \"visState\": {\n                    \"layers\": [],\n                    \"interactionConfig\": {\n                        \"tooltip\": {\"fieldsToShow\": {}, \"enabled\": True},\n                        \"brush\": {\"size\": 0.5, \"enabled\": False},\n                        \"geocoder\": {\"enabled\": False},\n                        \"coordinate\": {\"enabled\": False},\n                    },\n                    \"filters\": [],\n                    \"layerBlending\": \"normal\",\n                    \"splitMaps\": [],\n                    \"animationConfig\": {\"currentTime\": None, \"speed\": 1},\n                },\n            },\n        }\n\n    def add_data(self, data: Union[Dict, List], name: str = \"dataset\") -&gt; None:\n        \"\"\"Add data to the map.\n\n        Args:\n            data: Data to add (GeoJSON, DataFrame, etc.)\n            name: Name for the dataset\n        \"\"\"\n        # Determine data type and format\n        if isinstance(data, dict) and data.get(\"type\") == \"FeatureCollection\":\n            # GeoJSON data\n            data_type = \"geojson\"\n        elif isinstance(data, list):\n            # Array of objects (CSV-like data)\n            data_type = \"csv\"\n        else:\n            # Default to geojson\n            data_type = \"geojson\"\n\n        # Store the data in the widget's internal data structure\n        current_data = dict(self._data)\n        current_data[name] = {\"type\": data_type, \"data\": data}\n        self._data = current_data\n\n    def add_geojson(\n        self, geojson: Union[str, Dict], layer_name: str = \"geojson_layer\", **kwargs\n    ) -&gt; None:\n        \"\"\"Add GeoJSON data to the map.\n\n        Args:\n            geojson: GeoJSON data (dict or file path)\n            layer_name: Name for the layer\n            **kwargs: Additional layer configuration\n        \"\"\"\n        if isinstance(geojson, str):\n            # Load from file\n            with open(geojson, \"r\") as f:\n                geojson_data = json.load(f)\n        else:\n            geojson_data = geojson\n\n        # Store the data in the widget's internal data structure\n        current_data = dict(self._data)\n        current_data[layer_name] = {\"type\": \"geojson\", \"data\": geojson_data}\n        self._data = current_data\n\n    def add_csv(\n        self, csv_data: Union[str, List[Dict]], layer_name: str = \"csv_layer\", **kwargs\n    ) -&gt; None:\n        \"\"\"Add CSV data to the map.\n\n        Args:\n            csv_data: CSV data (file path or list of dictionaries)\n            layer_name: Name for the layer\n            **kwargs: Additional layer configuration\n        \"\"\"\n        if isinstance(csv_data, str):\n            # Load from file\n            import pandas as pd\n\n            df = pd.read_csv(csv_data)\n            csv_data = df.to_dict(\"records\")\n        elif isinstance(csv_data, list):\n            # Data is already in the correct format (list of dictionaries)\n            pass\n        else:\n            # Convert other formats to list of dictionaries\n            csv_data = [csv_data]\n\n        # Store the data in the widget's internal data structure\n        current_data = dict(self._data)\n        current_data[layer_name] = {\"type\": \"csv\", \"data\": csv_data}\n        self._data = current_data\n\n    def set_filter(self, filter_config: Dict[str, Any]) -&gt; None:\n        \"\"\"Set filter configuration.\n\n        Args:\n            filter_config: Filter configuration\n        \"\"\"\n        self.call_js_method(\"setFilter\", filter_config)\n\n    def update_map_config(self, config: Dict[str, Any]) -&gt; None:\n        \"\"\"Update the map configuration.\n\n        Args:\n            config: New configuration to merge\n        \"\"\"\n\n        # Deep merge the configuration\n        def deep_merge(dict1, dict2):\n            result = dict1.copy()\n            for key, value in dict2.items():\n                if (\n                    key in result\n                    and isinstance(result[key], dict)\n                    and isinstance(value, dict)\n                ):\n                    result[key] = deep_merge(result[key], value)\n                else:\n                    result[key] = value\n            return result\n\n        self.map_config = deep_merge(self.map_config, config)\n\n    def get_map_state(self) -&gt; Dict[str, Any]:\n        \"\"\"Get the current map state.\n\n        Returns:\n            Current map state dictionary\n        \"\"\"\n        return self.map_config\n\n    def save_config(self, filename: str) -&gt; None:\n        \"\"\"Save the current configuration to a file.\n\n        Args:\n            filename: Path to save the configuration\n        \"\"\"\n        with open(filename, \"w\") as f:\n            json.dump(self.map_config, f, indent=2)\n\n    def load_config(self, filename: str) -&gt; None:\n        \"\"\"Load configuration from a file.\n\n        Args:\n            filename: Path to the configuration file\n        \"\"\"\n        with open(filename, \"r\") as f:\n            config = json.load(f)\n        self.update_map_config(config)\n\n    def _generate_html_template(\n        self, map_state: Dict[str, Any], title: str, **kwargs\n    ) -&gt; str:\n        \"\"\"Generate HTML template for KeplerGL.\"\"\"\n        # Serialize map state for JavaScript\n        map_state_json = json.dumps(map_state, indent=2)\n\n        # Get the current configuration\n        config_json = json.dumps(self.map_config, indent=2)\n\n        html_template = f\"\"\"&lt;!DOCTYPE html&gt;\n&lt;html&gt;\n&lt;head&gt;\n    &lt;title&gt;{title}&lt;/title&gt;\n    &lt;meta charset=\"utf-8\"&gt;\n    &lt;meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\"&gt;\n    &lt;style&gt;\n        body {{\n            margin: 0;\n            padding: 0;\n            font-family: sans-serif;\n        }}\n        #map {{\n            width: {map_state.get('width', '100%')};\n            height: {map_state.get('height', '600px')};\n        }}\n        .loading {{\n            display: flex;\n            justify-content: center;\n            align-items: center;\n            height: 100%;\n            font-size: 18px;\n            color: #555;\n        }}\n    &lt;/style&gt;\n&lt;/head&gt;\n&lt;body&gt;\n    &lt;div id=\"map\"&gt;\n        &lt;div class=\"loading\"&gt;Loading KeplerGL Map...&lt;/div&gt;\n    &lt;/div&gt;\n\n    &lt;script src=\"https://unpkg.com/react@16/umd/react.production.min.js\"&gt;&lt;/script&gt;\n    &lt;script src=\"https://unpkg.com/react-dom@16/umd/react-dom.production.min.js\"&gt;&lt;/script&gt;\n    &lt;script src=\"https://unpkg.com/redux@3.7.2/dist/redux.js\"&gt;&lt;/script&gt;\n    &lt;script src=\"https://unpkg.com/react-redux@5.1.1/dist/react-redux.min.js\"&gt;&lt;/script&gt;\n    &lt;script src=\"https://unpkg.com/kepler.gl@3.0.0/umd/keplergl.min.js\"&gt;&lt;/script&gt;\n\n    &lt;script&gt;\n        // Initialize KeplerGL\n        const {{ KeplerGl, injectComponents }} = window.KeplerGl;\n\n        // Map configuration\n        const mapConfig = {config_json};\n        const mapState = {map_state_json};\n\n        // Create KeplerGL instance\n        const App = () =&gt; {{\n            return React.createElement(KeplerGl, {{\n                id: \"map\",\n                width: mapState.width || \"100%\",\n                height: mapState.height || \"600px\",\n                mapboxApiAccessToken: undefined, // Use default map tiles\n                initialUiState: mapConfig.config || {{}},\n                getMapboxRef: () =&gt; {{}},\n                onSaveMap: () =&gt; {{}},\n                onViewStateChange: () =&gt; {{}},\n                onInteractionStateChange: () =&gt; {{}}\n            }});\n        }};\n\n        // Render the app\n        ReactDOM.render(React.createElement(App), document.getElementById('map'));\n\n        // Initialize with data if available\n        if (mapState._layers &amp;&amp; Object.keys(mapState._layers).length &gt; 0) {{\n            // Add layers to the map\n            console.log('Adding layers:', mapState._layers);\n        }}\n    &lt;/script&gt;\n&lt;/body&gt;\n&lt;/html&gt;\"\"\"\n\n        return html_template\n</code></pre>"},{"location":"keplergl/#anymap.keplergl.KeplerGLMap.__init__","title":"<code>__init__(self, center=[37.7749, -122.4194], zoom=9.0, width='100%', height='600px', show_docs=False, read_only=False, **kwargs)</code>  <code>special</code>","text":"<p>Initialize KeplerGL map widget.</p> <p>Parameters:</p> Name Type Description Default <code>center</code> <code>List[float]</code> <p>Map center as [latitude, longitude]</p> <code>[37.7749, -122.4194]</code> <code>zoom</code> <code>float</code> <p>Initial zoom level</p> <code>9.0</code> <code>width</code> <code>str</code> <p>Widget width</p> <code>'100%'</code> <code>height</code> <code>str</code> <p>Widget height</p> <code>'600px'</code> <code>show_docs</code> <code>bool</code> <p>Whether to show documentation panel</p> <code>False</code> <code>read_only</code> <code>bool</code> <p>Whether the map is read-only</p> <code>False</code> <code>**kwargs</code> <p>Additional widget arguments</p> <code>{}</code> Source code in <code>anymap/keplergl.py</code> <pre><code>def __init__(\n    self,\n    center: List[float] = [37.7749, -122.4194],\n    zoom: float = 9.0,\n    width: str = \"100%\",\n    height: str = \"600px\",\n    show_docs: bool = False,\n    read_only: bool = False,\n    **kwargs,\n):\n    \"\"\"Initialize KeplerGL map widget.\n\n    Args:\n        center: Map center as [latitude, longitude]\n        zoom: Initial zoom level\n        width: Widget width\n        height: Widget height\n        show_docs: Whether to show documentation panel\n        read_only: Whether the map is read-only\n        **kwargs: Additional widget arguments\n    \"\"\"\n    super().__init__(\n        center=center,\n        zoom=zoom,\n        width=width,\n        height=height,\n        **kwargs,\n    )\n    self.show_docs = show_docs\n    self.read_only = read_only\n    self._initialize_config()\n</code></pre>"},{"location":"keplergl/#anymap.keplergl.KeplerGLMap.add_csv","title":"<code>add_csv(self, csv_data, layer_name='csv_layer', **kwargs)</code>","text":"<p>Add CSV data to the map.</p> <p>Parameters:</p> Name Type Description Default <code>csv_data</code> <code>Union[str, List[Dict]]</code> <p>CSV data (file path or list of dictionaries)</p> required <code>layer_name</code> <code>str</code> <p>Name for the layer</p> <code>'csv_layer'</code> <code>**kwargs</code> <p>Additional layer configuration</p> <code>{}</code> Source code in <code>anymap/keplergl.py</code> <pre><code>def add_csv(\n    self, csv_data: Union[str, List[Dict]], layer_name: str = \"csv_layer\", **kwargs\n) -&gt; None:\n    \"\"\"Add CSV data to the map.\n\n    Args:\n        csv_data: CSV data (file path or list of dictionaries)\n        layer_name: Name for the layer\n        **kwargs: Additional layer configuration\n    \"\"\"\n    if isinstance(csv_data, str):\n        # Load from file\n        import pandas as pd\n\n        df = pd.read_csv(csv_data)\n        csv_data = df.to_dict(\"records\")\n    elif isinstance(csv_data, list):\n        # Data is already in the correct format (list of dictionaries)\n        pass\n    else:\n        # Convert other formats to list of dictionaries\n        csv_data = [csv_data]\n\n    # Store the data in the widget's internal data structure\n    current_data = dict(self._data)\n    current_data[layer_name] = {\"type\": \"csv\", \"data\": csv_data}\n    self._data = current_data\n</code></pre>"},{"location":"keplergl/#anymap.keplergl.KeplerGLMap.add_data","title":"<code>add_data(self, data, name='dataset')</code>","text":"<p>Add data to the map.</p> <p>Parameters:</p> Name Type Description Default <code>data</code> <code>Union[Dict, List]</code> <p>Data to add (GeoJSON, DataFrame, etc.)</p> required <code>name</code> <code>str</code> <p>Name for the dataset</p> <code>'dataset'</code> Source code in <code>anymap/keplergl.py</code> <pre><code>def add_data(self, data: Union[Dict, List], name: str = \"dataset\") -&gt; None:\n    \"\"\"Add data to the map.\n\n    Args:\n        data: Data to add (GeoJSON, DataFrame, etc.)\n        name: Name for the dataset\n    \"\"\"\n    # Determine data type and format\n    if isinstance(data, dict) and data.get(\"type\") == \"FeatureCollection\":\n        # GeoJSON data\n        data_type = \"geojson\"\n    elif isinstance(data, list):\n        # Array of objects (CSV-like data)\n        data_type = \"csv\"\n    else:\n        # Default to geojson\n        data_type = \"geojson\"\n\n    # Store the data in the widget's internal data structure\n    current_data = dict(self._data)\n    current_data[name] = {\"type\": data_type, \"data\": data}\n    self._data = current_data\n</code></pre>"},{"location":"keplergl/#anymap.keplergl.KeplerGLMap.add_geojson","title":"<code>add_geojson(self, geojson, layer_name='geojson_layer', **kwargs)</code>","text":"<p>Add GeoJSON data to the map.</p> <p>Parameters:</p> Name Type Description Default <code>geojson</code> <code>Union[str, Dict]</code> <p>GeoJSON data (dict or file path)</p> required <code>layer_name</code> <code>str</code> <p>Name for the layer</p> <code>'geojson_layer'</code> <code>**kwargs</code> <p>Additional layer configuration</p> <code>{}</code> Source code in <code>anymap/keplergl.py</code> <pre><code>def add_geojson(\n    self, geojson: Union[str, Dict], layer_name: str = \"geojson_layer\", **kwargs\n) -&gt; None:\n    \"\"\"Add GeoJSON data to the map.\n\n    Args:\n        geojson: GeoJSON data (dict or file path)\n        layer_name: Name for the layer\n        **kwargs: Additional layer configuration\n    \"\"\"\n    if isinstance(geojson, str):\n        # Load from file\n        with open(geojson, \"r\") as f:\n            geojson_data = json.load(f)\n    else:\n        geojson_data = geojson\n\n    # Store the data in the widget's internal data structure\n    current_data = dict(self._data)\n    current_data[layer_name] = {\"type\": \"geojson\", \"data\": geojson_data}\n    self._data = current_data\n</code></pre>"},{"location":"keplergl/#anymap.keplergl.KeplerGLMap.get_map_state","title":"<code>get_map_state(self)</code>","text":"<p>Get the current map state.</p> <p>Returns:</p> Type Description <code>Dict[str, Any]</code> <p>Current map state dictionary</p> Source code in <code>anymap/keplergl.py</code> <pre><code>def get_map_state(self) -&gt; Dict[str, Any]:\n    \"\"\"Get the current map state.\n\n    Returns:\n        Current map state dictionary\n    \"\"\"\n    return self.map_config\n</code></pre>"},{"location":"keplergl/#anymap.keplergl.KeplerGLMap.load_config","title":"<code>load_config(self, filename)</code>","text":"<p>Load configuration from a file.</p> <p>Parameters:</p> Name Type Description Default <code>filename</code> <code>str</code> <p>Path to the configuration file</p> required Source code in <code>anymap/keplergl.py</code> <pre><code>def load_config(self, filename: str) -&gt; None:\n    \"\"\"Load configuration from a file.\n\n    Args:\n        filename: Path to the configuration file\n    \"\"\"\n    with open(filename, \"r\") as f:\n        config = json.load(f)\n    self.update_map_config(config)\n</code></pre>"},{"location":"keplergl/#anymap.keplergl.KeplerGLMap.save_config","title":"<code>save_config(self, filename)</code>","text":"<p>Save the current configuration to a file.</p> <p>Parameters:</p> Name Type Description Default <code>filename</code> <code>str</code> <p>Path to save the configuration</p> required Source code in <code>anymap/keplergl.py</code> <pre><code>def save_config(self, filename: str) -&gt; None:\n    \"\"\"Save the current configuration to a file.\n\n    Args:\n        filename: Path to save the configuration\n    \"\"\"\n    with open(filename, \"w\") as f:\n        json.dump(self.map_config, f, indent=2)\n</code></pre>"},{"location":"keplergl/#anymap.keplergl.KeplerGLMap.set_filter","title":"<code>set_filter(self, filter_config)</code>","text":"<p>Set filter configuration.</p> <p>Parameters:</p> Name Type Description Default <code>filter_config</code> <code>Dict[str, Any]</code> <p>Filter configuration</p> required Source code in <code>anymap/keplergl.py</code> <pre><code>def set_filter(self, filter_config: Dict[str, Any]) -&gt; None:\n    \"\"\"Set filter configuration.\n\n    Args:\n        filter_config: Filter configuration\n    \"\"\"\n    self.call_js_method(\"setFilter\", filter_config)\n</code></pre>"},{"location":"keplergl/#anymap.keplergl.KeplerGLMap.update_map_config","title":"<code>update_map_config(self, config)</code>","text":"<p>Update the map configuration.</p> <p>Parameters:</p> Name Type Description Default <code>config</code> <code>Dict[str, Any]</code> <p>New configuration to merge</p> required Source code in <code>anymap/keplergl.py</code> <pre><code>def update_map_config(self, config: Dict[str, Any]) -&gt; None:\n    \"\"\"Update the map configuration.\n\n    Args:\n        config: New configuration to merge\n    \"\"\"\n\n    # Deep merge the configuration\n    def deep_merge(dict1, dict2):\n        result = dict1.copy()\n        for key, value in dict2.items():\n            if (\n                key in result\n                and isinstance(result[key], dict)\n                and isinstance(value, dict)\n            ):\n                result[key] = deep_merge(result[key], value)\n            else:\n                result[key] = value\n        return result\n\n    self.map_config = deep_merge(self.map_config, config)\n</code></pre>"},{"location":"leaflet/","title":"leaflet module","text":"<p>Leaflet implementation of the map widget.</p>"},{"location":"leaflet/#anymap.leaflet.LeafletMap","title":"<code> LeafletMap            (MapWidget)         </code>","text":"<p>Leaflet implementation of the map widget.</p> Source code in <code>anymap/leaflet.py</code> <pre><code>class LeafletMap(MapWidget):\n    \"\"\"Leaflet implementation of the map widget.\"\"\"\n\n    # Leaflet-specific traits\n    tile_layer = traitlets.Unicode(\"OpenStreetMap\").tag(sync=True)\n    attribution = traitlets.Unicode(\"\").tag(sync=True)\n    map_options = traitlets.Dict(default_value={}).tag(sync=True)\n\n    # Define the JavaScript module path\n    _esm = _esm_leaflet\n    _css = _css_leaflet\n\n    def __init__(\n        self,\n        center: List[float] = [51.505, -0.09],\n        zoom: float = 13.0,\n        tile_layer: str = \"OpenStreetMap\",\n        width: str = \"100%\",\n        height: str = \"600px\",\n        **kwargs,\n    ):\n        \"\"\"Initialize Leaflet map widget.\n\n        Args:\n            center: Map center as [latitude, longitude]\n            zoom: Initial zoom level\n            tile_layer: Tile layer provider name or URL template\n            width: Widget width\n            height: Widget height\n            map_options: Leaflet Map Options (see https://leafletjs.com/reference.html#map-option)\n            **kwargs: Additional widget arguments\n        \"\"\"\n        super().__init__(\n            center=center,\n            zoom=zoom,\n            width=width,\n            height=height,\n            **kwargs,\n        )\n        self.tile_layer = tile_layer\n\n    def add_tile_layer(\n        self,\n        url_template: str,\n        attribution: str = \"\",\n        layer_id: str = None,\n        **options,\n    ) -&gt; None:\n        \"\"\"Add a tile layer to the map.\n\n        Args:\n            url_template: URL template for the tile layer\n            attribution: Attribution text for the layer\n            layer_id: Unique identifier for the layer\n            **options: Additional layer options\n        \"\"\"\n        if layer_id is None:\n            layer_id = f\"tile_layer_{len(self._layers)}\"\n\n        layer_config = {\n            \"type\": \"tile\",\n            \"url\": url_template,\n            \"attribution\": attribution,\n            **options,\n        }\n        self.add_layer(layer_id, layer_config)\n\n    def add_marker(\n        self,\n        latlng: List[float],\n        popup: str = \"\",\n        tooltip: str = \"\",\n        tooltip_options: Optional[Dict] = None,\n        icon: Optional[Dict[str, Any]] = None,\n        draggable: bool = False,\n        **options,\n    ) -&gt; str:\n        \"\"\"Add a marker to the map.\n\n        Args:\n            latlng: Marker position as [latitude, longitude]\n            popup: Popup text\n            tooltip: Tooltip text\n            tooltip_options: Tooltip options\n            icon: Icon configuration\n            draggable: Whether the marker is draggable\n            **options: Additional marker options\n\n        Returns:\n            Marker ID\n        \"\"\"\n        marker_id = f\"marker_{len(self._layers)}\"\n\n        marker_config = {\n            \"type\": \"marker\",\n            \"latlng\": latlng,\n            \"popup\": popup,\n            \"tooltip\": tooltip,\n            \"tooltip_options\": tooltip_options,\n            \"draggable\": draggable,\n            **options,\n        }\n\n        if icon:\n            marker_config[\"icon\"] = icon\n\n        self.add_layer(marker_id, marker_config)\n        return marker_id\n\n    def add_circle(\n        self,\n        latlng: List[float],\n        radius: float,\n        color: str = \"blue\",\n        fillColor: str = \"blue\",\n        fillOpacity: float = 0.2,\n        tooltip: str = \"\",\n        tooltip_options: Optional[Dict] = None,\n        **options,\n    ) -&gt; str:\n        \"\"\"Add a circle to the map.\n\n        Args:\n            latlng: Circle center as [latitude, longitude]\n            radius: Circle radius in meters\n            color: Circle stroke color\n            fillColor: Circle fill color\n            fillOpacity: Circle fill opacity\n            tooltip: Tooltip text\n            tooltip_options: Tooltip options\n            **options: Additional circle options\n\n        Returns:\n            Circle ID\n        \"\"\"\n        circle_id = f\"circle_{len(self._layers)}\"\n\n        circle_config = {\n            \"type\": \"circle\",\n            \"latlng\": latlng,\n            \"radius\": radius,\n            \"color\": color,\n            \"fillColor\": fillColor,\n            \"fillOpacity\": fillOpacity,\n            \"tooltip\": tooltip,\n            \"tooltip_options\": tooltip_options,\n            **options,\n        }\n\n        self.add_layer(circle_id, circle_config)\n        return circle_id\n\n    def add_polygon(\n        self,\n        latlngs: List[List[float]],\n        color: str = \"blue\",\n        fillColor: str = \"blue\",\n        fillOpacity: float = 0.2,\n        tooltip: str = \"\",\n        tooltip_options: Optional[Dict] = None,\n        **options,\n    ) -&gt; str:\n        \"\"\"Add a polygon to the map.\n\n        Args:\n            latlngs: Polygon vertices as [[lat, lng], [lat, lng], ...]\n            color: Polygon stroke color\n            fillColor: Polygon fill color\n            fillOpacity: Polygon fill opacity\n            **options: Additional polygon options\n\n        Returns:\n            Polygon ID\n        \"\"\"\n        polygon_id = f\"polygon_{len(self._layers)}\"\n\n        polygon_config = {\n            \"type\": \"polygon\",\n            \"latlngs\": latlngs,\n            \"color\": color,\n            \"fillColor\": fillColor,\n            \"fillOpacity\": fillOpacity,\n            \"tooltip\": tooltip,\n            \"tooltip_options\": tooltip_options,\n            **options,\n        }\n\n        self.add_layer(polygon_id, polygon_config)\n        return polygon_id\n\n    def add_polyline(\n        self,\n        latlngs: List[List[float]],\n        color: str = \"blue\",\n        weight: float = 3,\n        tooltip: str = \"\",\n        tooltip_options: Optional[Dict] = None,\n        **options,\n    ) -&gt; str:\n        \"\"\"Add a polyline to the map.\n\n        Args:\n            latlngs: Polyline vertices as [[lat, lng], [lat, lng], ...]\n            color: Polyline color\n            weight: Polyline weight\n            **options: Additional polyline options\n\n        Returns:\n            Polyline ID\n        \"\"\"\n        polyline_id = f\"polyline_{len(self._layers)}\"\n\n        polyline_config = {\n            \"type\": \"polyline\",\n            \"latlngs\": latlngs,\n            \"color\": color,\n            \"weight\": weight,\n            \"tooltip\": tooltip,\n            \"tooltip_options\": tooltip_options,\n            **options,\n        }\n\n        self.add_layer(polyline_id, polyline_config)\n        return polyline_id\n\n    def add_geojson(\n        self,\n        data: Union[str, Dict[str, Any]],\n        style: Optional[Dict[str, Any]] = None,\n        **options,\n    ) -&gt; str:\n        \"\"\"Add GeoJSON data to the map.\n\n        Args:\n            data: GeoJSON data as string or dict\n            style: Style configuration\n            **options: Additional GeoJSON options\n\n        Returns:\n            GeoJSON layer ID\n        \"\"\"\n        geojson_id = f\"geojson_{len(self._layers)}\"\n\n        geojson_config = {\n            \"type\": \"geojson\",\n            \"data\": data,\n            **options,\n        }\n\n        if style:\n            geojson_config[\"style\"] = style\n\n        self.add_layer(geojson_id, geojson_config)\n        return geojson_id\n\n    def add_geotiff(\n        self,\n        url: str,\n        layer_id: Optional[str] = None,\n        fit_bounds: bool = True,\n        **options: Any,\n    ) -&gt; str:\n        \"\"\"Add a Cloud Optimized GeoTIFF (COG) to the map without TiTiler.\n\n        This method uses georaster-layer-for-leaflet in the frontend to stream and\n        render a COG directly in the browser via HTTP range requests.\n\n        Args:\n            url: URL to the Cloud Optimized GeoTIFF.\n            layer_id: Optional unique identifier for the layer. If not provided,\n                one will be generated.\n            fit_bounds: Whether to fit the map to the layer's bounds after it\n                loads on the client.\n            **options: Additional options forwarded to GeoRasterLayer (e.g.,\n                ``opacity``, ``resolution``, ``debugLevel``).\n\n        Returns:\n            The layer ID used to add the layer.\n        \"\"\"\n        if layer_id is None:\n            layer_id = f\"geotiff_{len(self._layers)}\"\n\n        # Use minimal defaults matching the reference example exactly\n        default_options = {\n            \"resolution\": 128,  # Match reference example exactly\n        }\n\n        layer_config = {\n            \"type\": \"geotiff\",\n            \"url\": url,\n            \"fit_bounds\": fit_bounds,\n            **{k: v for k, v in default_options.items() if k not in options},\n            **options,\n        }\n\n        self.add_layer(layer_id, layer_config)\n        return layer_id\n\n    def fit_bounds(self, bounds: List[List[float]]) -&gt; None:\n        \"\"\"Fit the map view to given bounds.\n\n        Args:\n            bounds: Bounds as [[south, west], [north, east]]\n        \"\"\"\n        self.call_js_method(\"fitBounds\", bounds)\n\n    def _generate_html_template(\n        self, map_state: Dict[str, Any], title: str, **kwargs\n    ) -&gt; str:\n        \"\"\"Generate the HTML template with map state for Leaflet.\"\"\"\n\n        # Get tile layer URL template\n        tile_providers = {\n            \"OpenStreetMap\": \"https://tile.openstreetmap.org/{z}/{x}/{y}.png\",\n            \"CartoDB.Positron\": \"https://cartodb-basemaps-{s}.global.ssl.fastly.net/light_all/{z}/{x}/{y}.png\",\n            \"CartoDB.DarkMatter\": \"https://cartodb-basemaps-{s}.global.ssl.fastly.net/dark_all/{z}/{x}/{y}.png\",\n            \"Stamen.Terrain\": \"https://stamen-tiles-{s}.a.ssl.fastly.net/terrain/{z}/{x}/{y}.jpg\",\n            \"Stamen.Watercolor\": \"https://stamen-tiles-{s}.a.ssl.fastly.net/watercolor/{z}/{x}/{y}.jpg\",\n        }\n\n        tile_url = tile_providers.get(map_state.get(\"tile_layer\", \"OpenStreetMap\"))\n        if not tile_url:\n            tile_url = map_state.get(\"tile_layer\", tile_providers[\"OpenStreetMap\"])\n\n        html_template = f\"\"\"\n&lt;!DOCTYPE html&gt;\n&lt;html&gt;\n&lt;head&gt;\n    &lt;title&gt;{title}&lt;/title&gt;\n    &lt;meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\"&gt;\n    &lt;link rel=\"stylesheet\" href=\"https://unpkg.com/leaflet@1.9.4/dist/leaflet.css\"/&gt;\n    &lt;style&gt;\n        body {{\n            margin: 0;\n            padding: 0;\n            font-family: Arial, sans-serif;\n        }}\n        #map {{\n            width: {map_state.get('width', '100%')};\n            height: {map_state.get('height', '600px')};\n        }}\n    &lt;/style&gt;\n&lt;/head&gt;\n&lt;body&gt;\n    &lt;div id=\"map\"&gt;&lt;/div&gt;\n\n    &lt;script src=\"https://unpkg.com/leaflet@1.9.4/dist/leaflet.js\"&gt;&lt;/script&gt;\n    &lt;script&gt;\n        // Initialize the map\n        var map = L.map('map', {{\n            center: {map_state.get('center', [51.505, -0.09])},\n            zoom: {map_state.get('zoom', 13)}\n        }});\n\n        // Add tile layer\n        L.tileLayer('{tile_url}', {{\n            attribution: '\u00a9 OpenStreetMap contributors'\n        }}).addTo(map);\n\n        // Add layers\n        var layers = {json.dumps(map_state.get('_layers', {}))};\n        for (var layerId in layers) {{\n            var layer = layers[layerId];\n            var leafletLayer = null;\n\n            if (layer.type === 'tile') {{\n                leafletLayer = L.tileLayer(layer.url, {{\n                    attribution: layer.attribution || ''\n                }});\n            }} else if (layer.type === 'marker') {{\n                leafletLayer = L.marker(layer.latlng, {{\n                    draggable: layer.draggable || false\n                }});\n                if (layer.popup) {{\n                    leafletLayer.bindPopup(layer.popup);\n                }}\n                if (layer.tooltip) {{\n                    leafletLayer.bindTooltip(layer.tooltip);\n                }}\n            }} else if (layer.type === 'circle') {{\n                leafletLayer = L.circle(layer.latlng, {{\n                    radius: layer.radius,\n                    color: layer.color || 'blue',\n                    fillColor: layer.fillColor || 'blue',\n                    fillOpacity: layer.fillOpacity || 0.2\n                }});\n            }} else if (layer.type === 'polygon') {{\n                leafletLayer = L.polygon(layer.latlngs, {{\n                    color: layer.color || 'blue',\n                    fillColor: layer.fillColor || 'blue',\n                    fillOpacity: layer.fillOpacity || 0.2\n                }});\n            }} else if (layer.type === 'polyline') {{\n                leafletLayer = L.polyline(layer.latlngs, {{\n                    color: layer.color || 'blue',\n                    weight: layer.weight || 3\n                }});\n            }} else if (layer.type === 'geojson') {{\n                leafletLayer = L.geoJSON(layer.data, layer.style || {{}});\n            }} else if (layer.type === 'geotiff') {{\n                // Load COG via georaster-layer-for-leaflet - simplified to match reference example\n                (function(layerCfg) {{\n                    // Simple script loading function\n                    var loadScript = function(src) {{\n                        return new Promise(function(resolve, reject) {{\n                            var script = document.createElement('script');\n                            script.src = src;\n                            script.onload = resolve;\n                            script.onerror = reject;\n                            document.head.appendChild(script);\n                        }});\n                    }};\n\n                    // Load scripts in sequence exactly like the reference example\n                    var loadScripts = function() {{\n                        if (window.GeoRasterLayer &amp;&amp; window.parseGeoraster) return Promise.resolve();\n\n                        return loadScript('https://unpkg.com/proj4')\n                            .then(function() {{ return loadScript('https://unpkg.com/georaster'); }})\n                            .then(function() {{ return loadScript('https://unpkg.com/georaster-layer-for-leaflet'); }});\n                    }};\n\n                    loadScripts().then(function() {{\n                        console.log('Loading GeoTIFF:', layerCfg.url);\n                        return window.parseGeoraster(layerCfg.url);\n                    }}).then(function(georaster) {{\n                        console.log('georaster:', georaster);\n\n                        // Create options EXACTLY like the reference example\n                        var opts = {{\n                            attribution: layerCfg.attribution || \"Planet\",\n                            georaster: georaster,\n                            resolution: layerCfg.resolution || 128\n                        }};\n\n                        // Only add additional options if explicitly provided\n                        if (layerCfg.opacity !== undefined) opts.opacity = layerCfg.opacity;\n\n                        var grLayer = new GeoRasterLayer(opts);\n                        grLayer.addTo(map);\n\n                        if (layerCfg.fit_bounds !== false &amp;&amp; grLayer.getBounds) {{\n                            try {{\n                                map.fitBounds(grLayer.getBounds());\n                            }} catch (e) {{\n                                console.warn('Could not fit bounds:', e);\n                            }}\n                        }}\n                    }}).catch(function(err) {{\n                        console.error('Failed to load GeoTIFF:', err);\n                    }});\n                }})(layer);\n            }}\n\n            if (leafletLayer) {{\n                leafletLayer.addTo(map);\n            }}\n        }}\n    &lt;/script&gt;\n&lt;/body&gt;\n&lt;/html&gt;\n\"\"\"\n        return html_template\n</code></pre>"},{"location":"leaflet/#anymap.leaflet.LeafletMap.__init__","title":"<code>__init__(self, center=[51.505, -0.09], zoom=13.0, tile_layer='OpenStreetMap', width='100%', height='600px', **kwargs)</code>  <code>special</code>","text":"<p>Initialize Leaflet map widget.</p> <p>Parameters:</p> Name Type Description Default <code>center</code> <code>List[float]</code> <p>Map center as [latitude, longitude]</p> <code>[51.505, -0.09]</code> <code>zoom</code> <code>float</code> <p>Initial zoom level</p> <code>13.0</code> <code>tile_layer</code> <code>str</code> <p>Tile layer provider name or URL template</p> <code>'OpenStreetMap'</code> <code>width</code> <code>str</code> <p>Widget width</p> <code>'100%'</code> <code>height</code> <code>str</code> <p>Widget height</p> <code>'600px'</code> <code>map_options</code> <p>Leaflet Map Options (see https://leafletjs.com/reference.html#map-option)</p> required <code>**kwargs</code> <p>Additional widget arguments</p> <code>{}</code> Source code in <code>anymap/leaflet.py</code> <pre><code>def __init__(\n    self,\n    center: List[float] = [51.505, -0.09],\n    zoom: float = 13.0,\n    tile_layer: str = \"OpenStreetMap\",\n    width: str = \"100%\",\n    height: str = \"600px\",\n    **kwargs,\n):\n    \"\"\"Initialize Leaflet map widget.\n\n    Args:\n        center: Map center as [latitude, longitude]\n        zoom: Initial zoom level\n        tile_layer: Tile layer provider name or URL template\n        width: Widget width\n        height: Widget height\n        map_options: Leaflet Map Options (see https://leafletjs.com/reference.html#map-option)\n        **kwargs: Additional widget arguments\n    \"\"\"\n    super().__init__(\n        center=center,\n        zoom=zoom,\n        width=width,\n        height=height,\n        **kwargs,\n    )\n    self.tile_layer = tile_layer\n</code></pre>"},{"location":"leaflet/#anymap.leaflet.LeafletMap.add_circle","title":"<code>add_circle(self, latlng, radius, color='blue', fillColor='blue', fillOpacity=0.2, tooltip='', tooltip_options=None, **options)</code>","text":"<p>Add a circle to the map.</p> <p>Parameters:</p> Name Type Description Default <code>latlng</code> <code>List[float]</code> <p>Circle center as [latitude, longitude]</p> required <code>radius</code> <code>float</code> <p>Circle radius in meters</p> required <code>color</code> <code>str</code> <p>Circle stroke color</p> <code>'blue'</code> <code>fillColor</code> <code>str</code> <p>Circle fill color</p> <code>'blue'</code> <code>fillOpacity</code> <code>float</code> <p>Circle fill opacity</p> <code>0.2</code> <code>tooltip</code> <code>str</code> <p>Tooltip text</p> <code>''</code> <code>tooltip_options</code> <code>Optional[Dict]</code> <p>Tooltip options</p> <code>None</code> <code>**options</code> <p>Additional circle options</p> <code>{}</code> <p>Returns:</p> Type Description <code>str</code> <p>Circle ID</p> Source code in <code>anymap/leaflet.py</code> <pre><code>def add_circle(\n    self,\n    latlng: List[float],\n    radius: float,\n    color: str = \"blue\",\n    fillColor: str = \"blue\",\n    fillOpacity: float = 0.2,\n    tooltip: str = \"\",\n    tooltip_options: Optional[Dict] = None,\n    **options,\n) -&gt; str:\n    \"\"\"Add a circle to the map.\n\n    Args:\n        latlng: Circle center as [latitude, longitude]\n        radius: Circle radius in meters\n        color: Circle stroke color\n        fillColor: Circle fill color\n        fillOpacity: Circle fill opacity\n        tooltip: Tooltip text\n        tooltip_options: Tooltip options\n        **options: Additional circle options\n\n    Returns:\n        Circle ID\n    \"\"\"\n    circle_id = f\"circle_{len(self._layers)}\"\n\n    circle_config = {\n        \"type\": \"circle\",\n        \"latlng\": latlng,\n        \"radius\": radius,\n        \"color\": color,\n        \"fillColor\": fillColor,\n        \"fillOpacity\": fillOpacity,\n        \"tooltip\": tooltip,\n        \"tooltip_options\": tooltip_options,\n        **options,\n    }\n\n    self.add_layer(circle_id, circle_config)\n    return circle_id\n</code></pre>"},{"location":"leaflet/#anymap.leaflet.LeafletMap.add_geojson","title":"<code>add_geojson(self, data, style=None, **options)</code>","text":"<p>Add GeoJSON data to the map.</p> <p>Parameters:</p> Name Type Description Default <code>data</code> <code>Union[str, Dict[str, Any]]</code> <p>GeoJSON data as string or dict</p> required <code>style</code> <code>Optional[Dict[str, Any]]</code> <p>Style configuration</p> <code>None</code> <code>**options</code> <p>Additional GeoJSON options</p> <code>{}</code> <p>Returns:</p> Type Description <code>str</code> <p>GeoJSON layer ID</p> Source code in <code>anymap/leaflet.py</code> <pre><code>def add_geojson(\n    self,\n    data: Union[str, Dict[str, Any]],\n    style: Optional[Dict[str, Any]] = None,\n    **options,\n) -&gt; str:\n    \"\"\"Add GeoJSON data to the map.\n\n    Args:\n        data: GeoJSON data as string or dict\n        style: Style configuration\n        **options: Additional GeoJSON options\n\n    Returns:\n        GeoJSON layer ID\n    \"\"\"\n    geojson_id = f\"geojson_{len(self._layers)}\"\n\n    geojson_config = {\n        \"type\": \"geojson\",\n        \"data\": data,\n        **options,\n    }\n\n    if style:\n        geojson_config[\"style\"] = style\n\n    self.add_layer(geojson_id, geojson_config)\n    return geojson_id\n</code></pre>"},{"location":"leaflet/#anymap.leaflet.LeafletMap.add_geotiff","title":"<code>add_geotiff(self, url, layer_id=None, fit_bounds=True, **options)</code>","text":"<p>Add a Cloud Optimized GeoTIFF (COG) to the map without TiTiler.</p> <p>This method uses georaster-layer-for-leaflet in the frontend to stream and render a COG directly in the browser via HTTP range requests.</p> <p>Parameters:</p> Name Type Description Default <code>url</code> <code>str</code> <p>URL to the Cloud Optimized GeoTIFF.</p> required <code>layer_id</code> <code>Optional[str]</code> <p>Optional unique identifier for the layer. If not provided, one will be generated.</p> <code>None</code> <code>fit_bounds</code> <code>bool</code> <p>Whether to fit the map to the layer's bounds after it loads on the client.</p> <code>True</code> <code>**options</code> <code>Any</code> <p>Additional options forwarded to GeoRasterLayer (e.g., <code>opacity</code>, <code>resolution</code>, <code>debugLevel</code>).</p> <code>{}</code> <p>Returns:</p> Type Description <code>str</code> <p>The layer ID used to add the layer.</p> Source code in <code>anymap/leaflet.py</code> <pre><code>def add_geotiff(\n    self,\n    url: str,\n    layer_id: Optional[str] = None,\n    fit_bounds: bool = True,\n    **options: Any,\n) -&gt; str:\n    \"\"\"Add a Cloud Optimized GeoTIFF (COG) to the map without TiTiler.\n\n    This method uses georaster-layer-for-leaflet in the frontend to stream and\n    render a COG directly in the browser via HTTP range requests.\n\n    Args:\n        url: URL to the Cloud Optimized GeoTIFF.\n        layer_id: Optional unique identifier for the layer. If not provided,\n            one will be generated.\n        fit_bounds: Whether to fit the map to the layer's bounds after it\n            loads on the client.\n        **options: Additional options forwarded to GeoRasterLayer (e.g.,\n            ``opacity``, ``resolution``, ``debugLevel``).\n\n    Returns:\n        The layer ID used to add the layer.\n    \"\"\"\n    if layer_id is None:\n        layer_id = f\"geotiff_{len(self._layers)}\"\n\n    # Use minimal defaults matching the reference example exactly\n    default_options = {\n        \"resolution\": 128,  # Match reference example exactly\n    }\n\n    layer_config = {\n        \"type\": \"geotiff\",\n        \"url\": url,\n        \"fit_bounds\": fit_bounds,\n        **{k: v for k, v in default_options.items() if k not in options},\n        **options,\n    }\n\n    self.add_layer(layer_id, layer_config)\n    return layer_id\n</code></pre>"},{"location":"leaflet/#anymap.leaflet.LeafletMap.add_marker","title":"<code>add_marker(self, latlng, popup='', tooltip='', tooltip_options=None, icon=None, draggable=False, **options)</code>","text":"<p>Add a marker to the map.</p> <p>Parameters:</p> Name Type Description Default <code>latlng</code> <code>List[float]</code> <p>Marker position as [latitude, longitude]</p> required <code>popup</code> <code>str</code> <p>Popup text</p> <code>''</code> <code>tooltip</code> <code>str</code> <p>Tooltip text</p> <code>''</code> <code>tooltip_options</code> <code>Optional[Dict]</code> <p>Tooltip options</p> <code>None</code> <code>icon</code> <code>Optional[Dict[str, Any]]</code> <p>Icon configuration</p> <code>None</code> <code>draggable</code> <code>bool</code> <p>Whether the marker is draggable</p> <code>False</code> <code>**options</code> <p>Additional marker options</p> <code>{}</code> <p>Returns:</p> Type Description <code>str</code> <p>Marker ID</p> Source code in <code>anymap/leaflet.py</code> <pre><code>def add_marker(\n    self,\n    latlng: List[float],\n    popup: str = \"\",\n    tooltip: str = \"\",\n    tooltip_options: Optional[Dict] = None,\n    icon: Optional[Dict[str, Any]] = None,\n    draggable: bool = False,\n    **options,\n) -&gt; str:\n    \"\"\"Add a marker to the map.\n\n    Args:\n        latlng: Marker position as [latitude, longitude]\n        popup: Popup text\n        tooltip: Tooltip text\n        tooltip_options: Tooltip options\n        icon: Icon configuration\n        draggable: Whether the marker is draggable\n        **options: Additional marker options\n\n    Returns:\n        Marker ID\n    \"\"\"\n    marker_id = f\"marker_{len(self._layers)}\"\n\n    marker_config = {\n        \"type\": \"marker\",\n        \"latlng\": latlng,\n        \"popup\": popup,\n        \"tooltip\": tooltip,\n        \"tooltip_options\": tooltip_options,\n        \"draggable\": draggable,\n        **options,\n    }\n\n    if icon:\n        marker_config[\"icon\"] = icon\n\n    self.add_layer(marker_id, marker_config)\n    return marker_id\n</code></pre>"},{"location":"leaflet/#anymap.leaflet.LeafletMap.add_polygon","title":"<code>add_polygon(self, latlngs, color='blue', fillColor='blue', fillOpacity=0.2, tooltip='', tooltip_options=None, **options)</code>","text":"<p>Add a polygon to the map.</p> <p>Parameters:</p> Name Type Description Default <code>latlngs</code> <code>List[List[float]]</code> <p>Polygon vertices as [[lat, lng], [lat, lng], ...]</p> required <code>color</code> <code>str</code> <p>Polygon stroke color</p> <code>'blue'</code> <code>fillColor</code> <code>str</code> <p>Polygon fill color</p> <code>'blue'</code> <code>fillOpacity</code> <code>float</code> <p>Polygon fill opacity</p> <code>0.2</code> <code>**options</code> <p>Additional polygon options</p> <code>{}</code> <p>Returns:</p> Type Description <code>str</code> <p>Polygon ID</p> Source code in <code>anymap/leaflet.py</code> <pre><code>def add_polygon(\n    self,\n    latlngs: List[List[float]],\n    color: str = \"blue\",\n    fillColor: str = \"blue\",\n    fillOpacity: float = 0.2,\n    tooltip: str = \"\",\n    tooltip_options: Optional[Dict] = None,\n    **options,\n) -&gt; str:\n    \"\"\"Add a polygon to the map.\n\n    Args:\n        latlngs: Polygon vertices as [[lat, lng], [lat, lng], ...]\n        color: Polygon stroke color\n        fillColor: Polygon fill color\n        fillOpacity: Polygon fill opacity\n        **options: Additional polygon options\n\n    Returns:\n        Polygon ID\n    \"\"\"\n    polygon_id = f\"polygon_{len(self._layers)}\"\n\n    polygon_config = {\n        \"type\": \"polygon\",\n        \"latlngs\": latlngs,\n        \"color\": color,\n        \"fillColor\": fillColor,\n        \"fillOpacity\": fillOpacity,\n        \"tooltip\": tooltip,\n        \"tooltip_options\": tooltip_options,\n        **options,\n    }\n\n    self.add_layer(polygon_id, polygon_config)\n    return polygon_id\n</code></pre>"},{"location":"leaflet/#anymap.leaflet.LeafletMap.add_polyline","title":"<code>add_polyline(self, latlngs, color='blue', weight=3, tooltip='', tooltip_options=None, **options)</code>","text":"<p>Add a polyline to the map.</p> <p>Parameters:</p> Name Type Description Default <code>latlngs</code> <code>List[List[float]]</code> <p>Polyline vertices as [[lat, lng], [lat, lng], ...]</p> required <code>color</code> <code>str</code> <p>Polyline color</p> <code>'blue'</code> <code>weight</code> <code>float</code> <p>Polyline weight</p> <code>3</code> <code>**options</code> <p>Additional polyline options</p> <code>{}</code> <p>Returns:</p> Type Description <code>str</code> <p>Polyline ID</p> Source code in <code>anymap/leaflet.py</code> <pre><code>def add_polyline(\n    self,\n    latlngs: List[List[float]],\n    color: str = \"blue\",\n    weight: float = 3,\n    tooltip: str = \"\",\n    tooltip_options: Optional[Dict] = None,\n    **options,\n) -&gt; str:\n    \"\"\"Add a polyline to the map.\n\n    Args:\n        latlngs: Polyline vertices as [[lat, lng], [lat, lng], ...]\n        color: Polyline color\n        weight: Polyline weight\n        **options: Additional polyline options\n\n    Returns:\n        Polyline ID\n    \"\"\"\n    polyline_id = f\"polyline_{len(self._layers)}\"\n\n    polyline_config = {\n        \"type\": \"polyline\",\n        \"latlngs\": latlngs,\n        \"color\": color,\n        \"weight\": weight,\n        \"tooltip\": tooltip,\n        \"tooltip_options\": tooltip_options,\n        **options,\n    }\n\n    self.add_layer(polyline_id, polyline_config)\n    return polyline_id\n</code></pre>"},{"location":"leaflet/#anymap.leaflet.LeafletMap.add_tile_layer","title":"<code>add_tile_layer(self, url_template, attribution='', layer_id=None, **options)</code>","text":"<p>Add a tile layer to the map.</p> <p>Parameters:</p> Name Type Description Default <code>url_template</code> <code>str</code> <p>URL template for the tile layer</p> required <code>attribution</code> <code>str</code> <p>Attribution text for the layer</p> <code>''</code> <code>layer_id</code> <code>str</code> <p>Unique identifier for the layer</p> <code>None</code> <code>**options</code> <p>Additional layer options</p> <code>{}</code> Source code in <code>anymap/leaflet.py</code> <pre><code>def add_tile_layer(\n    self,\n    url_template: str,\n    attribution: str = \"\",\n    layer_id: str = None,\n    **options,\n) -&gt; None:\n    \"\"\"Add a tile layer to the map.\n\n    Args:\n        url_template: URL template for the tile layer\n        attribution: Attribution text for the layer\n        layer_id: Unique identifier for the layer\n        **options: Additional layer options\n    \"\"\"\n    if layer_id is None:\n        layer_id = f\"tile_layer_{len(self._layers)}\"\n\n    layer_config = {\n        \"type\": \"tile\",\n        \"url\": url_template,\n        \"attribution\": attribution,\n        **options,\n    }\n    self.add_layer(layer_id, layer_config)\n</code></pre>"},{"location":"leaflet/#anymap.leaflet.LeafletMap.fit_bounds","title":"<code>fit_bounds(self, bounds)</code>","text":"<p>Fit the map view to given bounds.</p> <p>Parameters:</p> Name Type Description Default <code>bounds</code> <code>List[List[float]]</code> <p>Bounds as [[south, west], [north, east]]</p> required Source code in <code>anymap/leaflet.py</code> <pre><code>def fit_bounds(self, bounds: List[List[float]]) -&gt; None:\n    \"\"\"Fit the map view to given bounds.\n\n    Args:\n        bounds: Bounds as [[south, west], [north, east]]\n    \"\"\"\n    self.call_js_method(\"fitBounds\", bounds)\n</code></pre>"},{"location":"mapbox/","title":"mapbox module","text":"<p>Mapbox GL JS implementation of the map widget.</p> <p>This module provides the MapboxMap class which implements an interactive map widget using the Mapbox GL JS library. Mapbox GL JS provides fast vector map rendering with WebGL and requires an access token for Mapbox services.</p> <p>Classes</p> <p>MapboxMap: Main map widget class for Mapbox GL JS.</p> <p>Note</p> <p>Mapbox services require an access token. You can get a free token at https://account.mapbox.com/access-tokens/</p> <p>Examples:</p> <p>Basic usage of MapboxMap:</p> <pre><code>&gt;&gt;&gt; from anymap.mapbox import MapboxMap\n&gt;&gt;&gt; m = MapboxMap(\n...     center=[40.7, -74.0],\n...     zoom=10,\n...     access_token=\"your_mapbox_token\"\n... )\n&gt;&gt;&gt; m.add_basemap(\"OpenStreetMap.Mapnik\")\n&gt;&gt;&gt; m\n</code></pre>"},{"location":"mapbox/#anymap.mapbox.MapboxMap","title":"<code> MapboxMap            (MapWidget)         </code>","text":"<p>Mapbox GL JS implementation of the map widget.</p> Source code in <code>anymap/mapbox.py</code> <pre><code>class MapboxMap(MapWidget):\n    \"\"\"Mapbox GL JS implementation of the map widget.\"\"\"\n\n    # Mapbox-specific traits\n    style = traitlets.Unicode(\"mapbox://styles/mapbox/streets-v12\").tag(sync=True)\n    bearing = traitlets.Float(0.0).tag(sync=True)\n    pitch = traitlets.Float(0.0).tag(sync=True)\n    antialias = traitlets.Bool(True).tag(sync=True)\n    access_token = traitlets.Unicode(\"\").tag(sync=True)\n\n    # Define the JavaScript module path\n    _esm = _esm_mapbox\n    _css = _css_mapbox\n\n    def __init__(\n        self,\n        center: List[float] = [0.0, 0.0],\n        zoom: float = 2.0,\n        style: str = \"mapbox://styles/mapbox/streets-v12\",\n        width: str = \"100%\",\n        height: str = \"600px\",\n        bearing: float = 0.0,\n        pitch: float = 0.0,\n        access_token: str = \"\",\n        **kwargs,\n    ):\n        \"\"\"Initialize Mapbox map widget.\n\n        Args:\n            center: Map center as [latitude, longitude]\n            zoom: Initial zoom level\n            style: Mapbox style URL or style object\n            width: Widget width\n            height: Widget height\n            bearing: Map bearing (rotation) in degrees\n            pitch: Map pitch (tilt) in degrees\n            access_token: Mapbox access token (required for Mapbox services).\n                         Get a free token at https://account.mapbox.com/access-tokens/\n                         Can also be set via MAPBOX_TOKEN environment variable.\n        \"\"\"\n        # Set default access token if not provided\n        if not access_token:\n            access_token = self._get_default_access_token()\n\n        super().__init__(\n            center=center,\n            zoom=zoom,\n            width=width,\n            height=height,\n            style=style,\n            bearing=bearing,\n            pitch=pitch,\n            access_token=access_token,\n            **kwargs,\n        )\n\n    @staticmethod\n    def _get_default_access_token() -&gt; str:\n        \"\"\"Get default Mapbox access token from environment or return demo token.\"\"\"\n        import os\n\n        # Try to get from environment variable\n        token = os.environ.get(\"MAPBOX_TOKEN\") or os.environ.get(\"MAPBOX_ACCESS_TOKEN\")\n\n        # If no token found, return empty string - user must provide their own token\n        if not token:\n            import warnings\n\n            warnings.warn(\n                \"No Mapbox access token found. Please set MAPBOX_ACCESS_TOKEN environment variable \"\n                \"or pass access_token parameter. Get a free token at https://account.mapbox.com/access-tokens/\",\n                UserWarning,\n            )\n            token = \"\"\n\n        return token\n\n    def set_access_token(self, token: str) -&gt; None:\n        \"\"\"Set the Mapbox access token.\"\"\"\n        self.access_token = token\n\n    def set_style(self, style: Union[str, Dict[str, Any]]) -&gt; None:\n        \"\"\"Set the map style.\"\"\"\n        if isinstance(style, str):\n            self.style = style\n        else:\n            self.call_js_method(\"setStyle\", style)\n\n    def set_bearing(self, bearing: float) -&gt; None:\n        \"\"\"Set the map bearing (rotation).\"\"\"\n        self.bearing = bearing\n\n    def set_pitch(self, pitch: float) -&gt; None:\n        \"\"\"Set the map pitch (tilt).\"\"\"\n        self.pitch = pitch\n\n    def add_geojson_layer(\n        self,\n        layer_id: str,\n        geojson_data: Dict[str, Any],\n        layer_type: str = \"fill\",\n        paint: Optional[Dict[str, Any]] = None,\n    ) -&gt; None:\n        \"\"\"Add a GeoJSON layer to the map.\"\"\"\n        source_id = f\"{layer_id}_source\"\n\n        # Add source\n        self.add_source(source_id, {\"type\": \"geojson\", \"data\": geojson_data})\n\n        # Add layer\n        layer_config = {\"id\": layer_id, \"type\": layer_type, \"source\": source_id}\n\n        if paint:\n            layer_config[\"paint\"] = paint\n\n        self.add_layer(layer_id, layer_config)\n\n    def add_marker(self, lat: float, lng: float, popup: Optional[str] = None) -&gt; None:\n        \"\"\"Add a marker to the map.\"\"\"\n        marker_data = {\"coordinates\": [lng, lat], \"popup\": popup}\n        self.call_js_method(\"addMarker\", marker_data)\n\n    def fit_bounds(self, bounds: List[List[float]], padding: int = 50) -&gt; None:\n        \"\"\"Fit the map to given bounds.\"\"\"\n        self.call_js_method(\"fitBounds\", bounds, {\"padding\": padding})\n\n    def add_tile_layer(\n        self,\n        layer_id: str,\n        source_url: str,\n        paint: Optional[Dict[str, Any]] = None,\n        layout: Optional[Dict[str, Any]] = None,\n    ) -&gt; None:\n        \"\"\"Add a raster layer to the map.\"\"\"\n        source_id = f\"{layer_id}_source\"\n\n        # Add raster source\n        self.add_source(\n            source_id, {\"type\": \"raster\", \"tiles\": [source_url], \"tileSize\": 256}\n        )\n\n        # Add raster layer\n        layer_config = {\"id\": layer_id, \"type\": \"raster\", \"source\": source_id}\n\n        if paint:\n            layer_config[\"paint\"] = paint\n        if layout:\n            layer_config[\"layout\"] = layout\n\n        self.add_layer(layer_id, layer_config)\n\n    def add_vector_layer(\n        self,\n        layer_id: str,\n        source_url: str,\n        source_layer: str,\n        layer_type: str = \"fill\",\n        paint: Optional[Dict[str, Any]] = None,\n        layout: Optional[Dict[str, Any]] = None,\n    ) -&gt; None:\n        \"\"\"Add a vector tile layer to the map.\"\"\"\n        source_id = f\"{layer_id}_source\"\n\n        # Add vector source\n        self.add_source(source_id, {\"type\": \"vector\", \"url\": source_url})\n\n        # Add vector layer\n        layer_config = {\n            \"id\": layer_id,\n            \"type\": layer_type,\n            \"source\": source_id,\n            \"source-layer\": source_layer,\n        }\n\n        if paint:\n            layer_config[\"paint\"] = paint\n        if layout:\n            layer_config[\"layout\"] = layout\n\n        self.add_layer(layer_id, layer_config)\n\n    def add_image_layer(\n        self,\n        layer_id: str,\n        image_url: str,\n        coordinates: List[List[float]],\n        paint: Optional[Dict[str, Any]] = None,\n    ) -&gt; None:\n        \"\"\"Add an image layer to the map.\"\"\"\n        source_id = f\"{layer_id}_source\"\n\n        # Add image source\n        self.add_source(\n            source_id, {\"type\": \"image\", \"url\": image_url, \"coordinates\": coordinates}\n        )\n\n        # Add raster layer for the image\n        layer_config = {\"id\": layer_id, \"type\": \"raster\", \"source\": source_id}\n\n        if paint:\n            layer_config[\"paint\"] = paint\n\n        self.add_layer(layer_id, layer_config)\n\n    def add_control(\n        self,\n        control_type: str,\n        position: str = \"top-right\",\n        options: Optional[Dict[str, Any]] = None,\n    ) -&gt; None:\n        \"\"\"Add a control to the map.\n\n        Args:\n            control_type: Type of control ('navigation', 'scale', 'fullscreen', 'geolocate')\n            position: Position on map ('top-left', 'top-right', 'bottom-left', 'bottom-right')\n            options: Additional options for the control\n        \"\"\"\n        control_options = options or {}\n        control_options[\"position\"] = position\n        self.call_js_method(\"addControl\", control_type, control_options)\n\n    def set_terrain(self, terrain_config: Optional[Dict[str, Any]] = None) -&gt; None:\n        \"\"\"Set 3D terrain on the map.\n\n        Args:\n            terrain_config: Terrain configuration dict, or None to remove terrain\n        \"\"\"\n        self.call_js_method(\"setTerrain\", terrain_config)\n\n    def set_fog(self, fog_config: Optional[Dict[str, Any]] = None) -&gt; None:\n        \"\"\"Set atmospheric fog on the map.\n\n        Args:\n            fog_config: Fog configuration dict, or None to remove fog\n        \"\"\"\n        self.call_js_method(\"setFog\", fog_config)\n\n    def add_3d_buildings(self, layer_id: str = \"3d-buildings\") -&gt; None:\n        \"\"\"Add 3D buildings layer to the map.\"\"\"\n        # Add the layer for 3D buildings\n        layer_config = {\n            \"id\": layer_id,\n            \"source\": \"composite\",\n            \"source-layer\": \"building\",\n            \"filter\": [\"==\", \"extrude\", \"true\"],\n            \"type\": \"fill-extrusion\",\n            \"minzoom\": 15,\n            \"paint\": {\n                \"fill-extrusion-color\": \"#aaa\",\n                \"fill-extrusion-height\": [\n                    \"interpolate\",\n                    [\"linear\"],\n                    [\"zoom\"],\n                    15,\n                    0,\n                    15.05,\n                    [\"get\", \"height\"],\n                ],\n                \"fill-extrusion-base\": [\n                    \"interpolate\",\n                    [\"linear\"],\n                    [\"zoom\"],\n                    15,\n                    0,\n                    15.05,\n                    [\"get\", \"min_height\"],\n                ],\n                \"fill-extrusion-opacity\": 0.6,\n            },\n        }\n        self.add_layer(layer_id, layer_config)\n\n    def add_basemap(self, basemap: str, layer_id: str = \"basemap\") -&gt; None:\n        \"\"\"Add a basemap to the map using xyzservices providers.\n\n        Args:\n            basemap: Name of the basemap from xyzservices (e.g., \"Esri.WorldImagery\")\n            layer_id: ID for the basemap layer (default: \"basemap\")\n        \"\"\"\n        if basemap not in available_basemaps:\n            available_names = list(available_basemaps.keys())\n            raise ValueError(\n                f\"Basemap '{basemap}' not found. Available basemaps: {available_names}\"\n            )\n\n        basemap_config = available_basemaps[basemap]\n\n        # Convert xyzservices URL template to tile URL\n        tile_url = basemap_config.build_url()\n\n        # Get attribution if available\n        attribution = basemap_config.get(\"attribution\", \"\")\n\n        # Add as raster layer\n        self.add_tile_layer(\n            layer_id=layer_id, source_url=tile_url, paint={\"raster-opacity\": 1.0}\n        )\n\n    def _generate_html_template(\n        self, map_state: Dict[str, Any], title: str, **kwargs\n    ) -&gt; str:\n        \"\"\"Generate HTML template for Mapbox GL JS.\"\"\"\n        # Serialize map state for JavaScript\n        map_state_json = json.dumps(map_state, indent=2)\n\n        html_template = f\"\"\"&lt;!DOCTYPE html&gt;\n&lt;html&gt;\n&lt;head&gt;\n    &lt;title&gt;{title}&lt;/title&gt;\n    &lt;meta charset=\"utf-8\"&gt;\n    &lt;meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\"&gt;\n    &lt;script src=\"https://api.mapbox.com/mapbox-gl-js/v3.13.0/mapbox-gl.js\"&gt;&lt;/script&gt;\n    &lt;link href=\"https://api.mapbox.com/mapbox-gl-js/v3.13.0/mapbox-gl.css\" rel=\"stylesheet\"&gt;\n    &lt;style&gt;\n        body {{\n            margin: 0;\n            padding: 20px;\n            font-family: Arial, sans-serif;\n        }}\n        #map {{\n            width: {map_state['width']};\n            height: {map_state['height']};\n            border: 1px solid #ccc;\n        }}\n        h1 {{\n            margin-top: 0;\n            color: #333;\n        }}\n        .access-token-warning {{\n            background-color: #fff3cd;\n            border: 1px solid #ffeaa7;\n            color: #856404;\n            padding: 10px;\n            margin-bottom: 20px;\n            border-radius: 4px;\n        }}\n    &lt;/style&gt;\n&lt;/head&gt;\n&lt;body&gt;\n    &lt;h1&gt;{title}&lt;/h1&gt;\n    {\"&lt;div class='access-token-warning'&gt;Warning: This map requires a Mapbox access token. Please add your token to the mapboxgl.accessToken property.&lt;/div&gt;\" if not map_state.get('access_token') else \"\"}\n    &lt;div id=\"map\"&gt;&lt;/div&gt;\n\n    &lt;script&gt;\n        // Map state from Python\n        const mapState = {map_state_json};\n\n        // Set Mapbox access token\n        mapboxgl.accessToken = mapState.access_token || '';\n\n        // Initialize Mapbox map\n        const map = new mapboxgl.Map({{\n            container: 'map',\n            style: mapState.style || 'mapbox://styles/mapbox/streets-v12',\n            center: [mapState.center[1], mapState.center[0]], // Convert [lat, lng] to [lng, lat]\n            zoom: mapState.zoom || 2,\n            bearing: mapState.bearing || 0,\n            pitch: mapState.pitch || 0,\n            antialias: mapState.antialias !== undefined ? mapState.antialias : true\n        }});\n\n        // Restore layers and sources after map loads\n        map.on('load', function() {{\n            // Add sources first\n            const sources = mapState._sources || {{}};\n            Object.entries(sources).forEach(([sourceId, sourceConfig]) =&gt; {{\n                try {{\n                    map.addSource(sourceId, sourceConfig);\n                }} catch (error) {{\n                    console.warn(`Failed to add source ${{sourceId}}:`, error);\n                }}\n            }});\n\n            // Then add layers\n            const layers = mapState._layers || {{}};\n            Object.entries(layers).forEach(([layerId, layerConfig]) =&gt; {{\n                try {{\n                    map.addLayer(layerConfig);\n                }} catch (error) {{\n                    console.warn(`Failed to add layer ${{layerId}}:`, error);\n                }}\n            }});\n        }});\n\n        // Add navigation controls\n        map.addControl(new mapboxgl.NavigationControl());\n\n        // Add scale control\n        map.addControl(new mapboxgl.ScaleControl());\n\n        // Log map events for debugging\n        map.on('click', function(e) {{\n            console.log('Map clicked at:', e.lngLat);\n        }});\n\n        map.on('load', function() {{\n            console.log('Map loaded successfully');\n        }});\n\n        map.on('error', function(e) {{\n            console.error('Map error:', e);\n        }});\n    &lt;/script&gt;\n&lt;/body&gt;\n&lt;/html&gt;\"\"\"\n\n        return html_template\n</code></pre>"},{"location":"mapbox/#anymap.mapbox.MapboxMap.__init__","title":"<code>__init__(self, center=[0.0, 0.0], zoom=2.0, style='mapbox://styles/mapbox/streets-v12', width='100%', height='600px', bearing=0.0, pitch=0.0, access_token='', **kwargs)</code>  <code>special</code>","text":"<p>Initialize Mapbox map widget.</p> <p>Parameters:</p> Name Type Description Default <code>center</code> <code>List[float]</code> <p>Map center as [latitude, longitude]</p> <code>[0.0, 0.0]</code> <code>zoom</code> <code>float</code> <p>Initial zoom level</p> <code>2.0</code> <code>style</code> <code>str</code> <p>Mapbox style URL or style object</p> <code>'mapbox://styles/mapbox/streets-v12'</code> <code>width</code> <code>str</code> <p>Widget width</p> <code>'100%'</code> <code>height</code> <code>str</code> <p>Widget height</p> <code>'600px'</code> <code>bearing</code> <code>float</code> <p>Map bearing (rotation) in degrees</p> <code>0.0</code> <code>pitch</code> <code>float</code> <p>Map pitch (tilt) in degrees</p> <code>0.0</code> <code>access_token</code> <code>str</code> <p>Mapbox access token (required for Mapbox services).          Get a free token at https://account.mapbox.com/access-tokens/          Can also be set via MAPBOX_TOKEN environment variable.</p> <code>''</code> Source code in <code>anymap/mapbox.py</code> <pre><code>def __init__(\n    self,\n    center: List[float] = [0.0, 0.0],\n    zoom: float = 2.0,\n    style: str = \"mapbox://styles/mapbox/streets-v12\",\n    width: str = \"100%\",\n    height: str = \"600px\",\n    bearing: float = 0.0,\n    pitch: float = 0.0,\n    access_token: str = \"\",\n    **kwargs,\n):\n    \"\"\"Initialize Mapbox map widget.\n\n    Args:\n        center: Map center as [latitude, longitude]\n        zoom: Initial zoom level\n        style: Mapbox style URL or style object\n        width: Widget width\n        height: Widget height\n        bearing: Map bearing (rotation) in degrees\n        pitch: Map pitch (tilt) in degrees\n        access_token: Mapbox access token (required for Mapbox services).\n                     Get a free token at https://account.mapbox.com/access-tokens/\n                     Can also be set via MAPBOX_TOKEN environment variable.\n    \"\"\"\n    # Set default access token if not provided\n    if not access_token:\n        access_token = self._get_default_access_token()\n\n    super().__init__(\n        center=center,\n        zoom=zoom,\n        width=width,\n        height=height,\n        style=style,\n        bearing=bearing,\n        pitch=pitch,\n        access_token=access_token,\n        **kwargs,\n    )\n</code></pre>"},{"location":"mapbox/#anymap.mapbox.MapboxMap.add_3d_buildings","title":"<code>add_3d_buildings(self, layer_id='3d-buildings')</code>","text":"<p>Add 3D buildings layer to the map.</p> Source code in <code>anymap/mapbox.py</code> <pre><code>def add_3d_buildings(self, layer_id: str = \"3d-buildings\") -&gt; None:\n    \"\"\"Add 3D buildings layer to the map.\"\"\"\n    # Add the layer for 3D buildings\n    layer_config = {\n        \"id\": layer_id,\n        \"source\": \"composite\",\n        \"source-layer\": \"building\",\n        \"filter\": [\"==\", \"extrude\", \"true\"],\n        \"type\": \"fill-extrusion\",\n        \"minzoom\": 15,\n        \"paint\": {\n            \"fill-extrusion-color\": \"#aaa\",\n            \"fill-extrusion-height\": [\n                \"interpolate\",\n                [\"linear\"],\n                [\"zoom\"],\n                15,\n                0,\n                15.05,\n                [\"get\", \"height\"],\n            ],\n            \"fill-extrusion-base\": [\n                \"interpolate\",\n                [\"linear\"],\n                [\"zoom\"],\n                15,\n                0,\n                15.05,\n                [\"get\", \"min_height\"],\n            ],\n            \"fill-extrusion-opacity\": 0.6,\n        },\n    }\n    self.add_layer(layer_id, layer_config)\n</code></pre>"},{"location":"mapbox/#anymap.mapbox.MapboxMap.add_basemap","title":"<code>add_basemap(self, basemap, layer_id='basemap')</code>","text":"<p>Add a basemap to the map using xyzservices providers.</p> <p>Parameters:</p> Name Type Description Default <code>basemap</code> <code>str</code> <p>Name of the basemap from xyzservices (e.g., \"Esri.WorldImagery\")</p> required <code>layer_id</code> <code>str</code> <p>ID for the basemap layer (default: \"basemap\")</p> <code>'basemap'</code> Source code in <code>anymap/mapbox.py</code> <pre><code>def add_basemap(self, basemap: str, layer_id: str = \"basemap\") -&gt; None:\n    \"\"\"Add a basemap to the map using xyzservices providers.\n\n    Args:\n        basemap: Name of the basemap from xyzservices (e.g., \"Esri.WorldImagery\")\n        layer_id: ID for the basemap layer (default: \"basemap\")\n    \"\"\"\n    if basemap not in available_basemaps:\n        available_names = list(available_basemaps.keys())\n        raise ValueError(\n            f\"Basemap '{basemap}' not found. Available basemaps: {available_names}\"\n        )\n\n    basemap_config = available_basemaps[basemap]\n\n    # Convert xyzservices URL template to tile URL\n    tile_url = basemap_config.build_url()\n\n    # Get attribution if available\n    attribution = basemap_config.get(\"attribution\", \"\")\n\n    # Add as raster layer\n    self.add_tile_layer(\n        layer_id=layer_id, source_url=tile_url, paint={\"raster-opacity\": 1.0}\n    )\n</code></pre>"},{"location":"mapbox/#anymap.mapbox.MapboxMap.add_control","title":"<code>add_control(self, control_type, position='top-right', options=None)</code>","text":"<p>Add a control to the map.</p> <p>Parameters:</p> Name Type Description Default <code>control_type</code> <code>str</code> <p>Type of control ('navigation', 'scale', 'fullscreen', 'geolocate')</p> required <code>position</code> <code>str</code> <p>Position on map ('top-left', 'top-right', 'bottom-left', 'bottom-right')</p> <code>'top-right'</code> <code>options</code> <code>Optional[Dict[str, Any]]</code> <p>Additional options for the control</p> <code>None</code> Source code in <code>anymap/mapbox.py</code> <pre><code>def add_control(\n    self,\n    control_type: str,\n    position: str = \"top-right\",\n    options: Optional[Dict[str, Any]] = None,\n) -&gt; None:\n    \"\"\"Add a control to the map.\n\n    Args:\n        control_type: Type of control ('navigation', 'scale', 'fullscreen', 'geolocate')\n        position: Position on map ('top-left', 'top-right', 'bottom-left', 'bottom-right')\n        options: Additional options for the control\n    \"\"\"\n    control_options = options or {}\n    control_options[\"position\"] = position\n    self.call_js_method(\"addControl\", control_type, control_options)\n</code></pre>"},{"location":"mapbox/#anymap.mapbox.MapboxMap.add_geojson_layer","title":"<code>add_geojson_layer(self, layer_id, geojson_data, layer_type='fill', paint=None)</code>","text":"<p>Add a GeoJSON layer to the map.</p> Source code in <code>anymap/mapbox.py</code> <pre><code>def add_geojson_layer(\n    self,\n    layer_id: str,\n    geojson_data: Dict[str, Any],\n    layer_type: str = \"fill\",\n    paint: Optional[Dict[str, Any]] = None,\n) -&gt; None:\n    \"\"\"Add a GeoJSON layer to the map.\"\"\"\n    source_id = f\"{layer_id}_source\"\n\n    # Add source\n    self.add_source(source_id, {\"type\": \"geojson\", \"data\": geojson_data})\n\n    # Add layer\n    layer_config = {\"id\": layer_id, \"type\": layer_type, \"source\": source_id}\n\n    if paint:\n        layer_config[\"paint\"] = paint\n\n    self.add_layer(layer_id, layer_config)\n</code></pre>"},{"location":"mapbox/#anymap.mapbox.MapboxMap.add_image_layer","title":"<code>add_image_layer(self, layer_id, image_url, coordinates, paint=None)</code>","text":"<p>Add an image layer to the map.</p> Source code in <code>anymap/mapbox.py</code> <pre><code>def add_image_layer(\n    self,\n    layer_id: str,\n    image_url: str,\n    coordinates: List[List[float]],\n    paint: Optional[Dict[str, Any]] = None,\n) -&gt; None:\n    \"\"\"Add an image layer to the map.\"\"\"\n    source_id = f\"{layer_id}_source\"\n\n    # Add image source\n    self.add_source(\n        source_id, {\"type\": \"image\", \"url\": image_url, \"coordinates\": coordinates}\n    )\n\n    # Add raster layer for the image\n    layer_config = {\"id\": layer_id, \"type\": \"raster\", \"source\": source_id}\n\n    if paint:\n        layer_config[\"paint\"] = paint\n\n    self.add_layer(layer_id, layer_config)\n</code></pre>"},{"location":"mapbox/#anymap.mapbox.MapboxMap.add_marker","title":"<code>add_marker(self, lat, lng, popup=None)</code>","text":"<p>Add a marker to the map.</p> Source code in <code>anymap/mapbox.py</code> <pre><code>def add_marker(self, lat: float, lng: float, popup: Optional[str] = None) -&gt; None:\n    \"\"\"Add a marker to the map.\"\"\"\n    marker_data = {\"coordinates\": [lng, lat], \"popup\": popup}\n    self.call_js_method(\"addMarker\", marker_data)\n</code></pre>"},{"location":"mapbox/#anymap.mapbox.MapboxMap.add_tile_layer","title":"<code>add_tile_layer(self, layer_id, source_url, paint=None, layout=None)</code>","text":"<p>Add a raster layer to the map.</p> Source code in <code>anymap/mapbox.py</code> <pre><code>def add_tile_layer(\n    self,\n    layer_id: str,\n    source_url: str,\n    paint: Optional[Dict[str, Any]] = None,\n    layout: Optional[Dict[str, Any]] = None,\n) -&gt; None:\n    \"\"\"Add a raster layer to the map.\"\"\"\n    source_id = f\"{layer_id}_source\"\n\n    # Add raster source\n    self.add_source(\n        source_id, {\"type\": \"raster\", \"tiles\": [source_url], \"tileSize\": 256}\n    )\n\n    # Add raster layer\n    layer_config = {\"id\": layer_id, \"type\": \"raster\", \"source\": source_id}\n\n    if paint:\n        layer_config[\"paint\"] = paint\n    if layout:\n        layer_config[\"layout\"] = layout\n\n    self.add_layer(layer_id, layer_config)\n</code></pre>"},{"location":"mapbox/#anymap.mapbox.MapboxMap.add_vector_layer","title":"<code>add_vector_layer(self, layer_id, source_url, source_layer, layer_type='fill', paint=None, layout=None)</code>","text":"<p>Add a vector tile layer to the map.</p> Source code in <code>anymap/mapbox.py</code> <pre><code>def add_vector_layer(\n    self,\n    layer_id: str,\n    source_url: str,\n    source_layer: str,\n    layer_type: str = \"fill\",\n    paint: Optional[Dict[str, Any]] = None,\n    layout: Optional[Dict[str, Any]] = None,\n) -&gt; None:\n    \"\"\"Add a vector tile layer to the map.\"\"\"\n    source_id = f\"{layer_id}_source\"\n\n    # Add vector source\n    self.add_source(source_id, {\"type\": \"vector\", \"url\": source_url})\n\n    # Add vector layer\n    layer_config = {\n        \"id\": layer_id,\n        \"type\": layer_type,\n        \"source\": source_id,\n        \"source-layer\": source_layer,\n    }\n\n    if paint:\n        layer_config[\"paint\"] = paint\n    if layout:\n        layer_config[\"layout\"] = layout\n\n    self.add_layer(layer_id, layer_config)\n</code></pre>"},{"location":"mapbox/#anymap.mapbox.MapboxMap.fit_bounds","title":"<code>fit_bounds(self, bounds, padding=50)</code>","text":"<p>Fit the map to given bounds.</p> Source code in <code>anymap/mapbox.py</code> <pre><code>def fit_bounds(self, bounds: List[List[float]], padding: int = 50) -&gt; None:\n    \"\"\"Fit the map to given bounds.\"\"\"\n    self.call_js_method(\"fitBounds\", bounds, {\"padding\": padding})\n</code></pre>"},{"location":"mapbox/#anymap.mapbox.MapboxMap.set_access_token","title":"<code>set_access_token(self, token)</code>","text":"<p>Set the Mapbox access token.</p> Source code in <code>anymap/mapbox.py</code> <pre><code>def set_access_token(self, token: str) -&gt; None:\n    \"\"\"Set the Mapbox access token.\"\"\"\n    self.access_token = token\n</code></pre>"},{"location":"mapbox/#anymap.mapbox.MapboxMap.set_bearing","title":"<code>set_bearing(self, bearing)</code>","text":"<p>Set the map bearing (rotation).</p> Source code in <code>anymap/mapbox.py</code> <pre><code>def set_bearing(self, bearing: float) -&gt; None:\n    \"\"\"Set the map bearing (rotation).\"\"\"\n    self.bearing = bearing\n</code></pre>"},{"location":"mapbox/#anymap.mapbox.MapboxMap.set_fog","title":"<code>set_fog(self, fog_config=None)</code>","text":"<p>Set atmospheric fog on the map.</p> <p>Parameters:</p> Name Type Description Default <code>fog_config</code> <code>Optional[Dict[str, Any]]</code> <p>Fog configuration dict, or None to remove fog</p> <code>None</code> Source code in <code>anymap/mapbox.py</code> <pre><code>def set_fog(self, fog_config: Optional[Dict[str, Any]] = None) -&gt; None:\n    \"\"\"Set atmospheric fog on the map.\n\n    Args:\n        fog_config: Fog configuration dict, or None to remove fog\n    \"\"\"\n    self.call_js_method(\"setFog\", fog_config)\n</code></pre>"},{"location":"mapbox/#anymap.mapbox.MapboxMap.set_pitch","title":"<code>set_pitch(self, pitch)</code>","text":"<p>Set the map pitch (tilt).</p> Source code in <code>anymap/mapbox.py</code> <pre><code>def set_pitch(self, pitch: float) -&gt; None:\n    \"\"\"Set the map pitch (tilt).\"\"\"\n    self.pitch = pitch\n</code></pre>"},{"location":"mapbox/#anymap.mapbox.MapboxMap.set_style","title":"<code>set_style(self, style)</code>","text":"<p>Set the map style.</p> Source code in <code>anymap/mapbox.py</code> <pre><code>def set_style(self, style: Union[str, Dict[str, Any]]) -&gt; None:\n    \"\"\"Set the map style.\"\"\"\n    if isinstance(style, str):\n        self.style = style\n    else:\n        self.call_js_method(\"setStyle\", style)\n</code></pre>"},{"location":"mapbox/#anymap.mapbox.MapboxMap.set_terrain","title":"<code>set_terrain(self, terrain_config=None)</code>","text":"<p>Set 3D terrain on the map.</p> <p>Parameters:</p> Name Type Description Default <code>terrain_config</code> <code>Optional[Dict[str, Any]]</code> <p>Terrain configuration dict, or None to remove terrain</p> <code>None</code> Source code in <code>anymap/mapbox.py</code> <pre><code>def set_terrain(self, terrain_config: Optional[Dict[str, Any]] = None) -&gt; None:\n    \"\"\"Set 3D terrain on the map.\n\n    Args:\n        terrain_config: Terrain configuration dict, or None to remove terrain\n    \"\"\"\n    self.call_js_method(\"setTerrain\", terrain_config)\n</code></pre>"},{"location":"maplibre/","title":"maplibre module","text":"<p>MapLibre GL JS implementation of the map widget.</p> <p>This module provides the MapLibreMap class which implements an interactive map widget using the MapLibre GL JS library. MapLibre GL JS is an open-source fork of Mapbox GL JS, providing fast vector map rendering with WebGL.</p> <p>Classes</p> <p>MapLibreMap: Main map widget class for MapLibre GL JS.</p> <p>Examples:</p> <p>Basic usage of MapLibreMap:</p> <pre><code>&gt;&gt;&gt; from anymap.maplibre import MapLibreMap\n&gt;&gt;&gt; m = MapLibreMap(center=[-74.0, 40.7], zoom=10)\n&gt;&gt;&gt; m.add_basemap(\"OpenStreetMap.Mapnik\")\n&gt;&gt;&gt; m\n</code></pre>"},{"location":"maplibre/#anymap.maplibre.MapLibreMap","title":"<code> MapLibreMap            (MapWidget)         </code>","text":"<p>MapLibre GL JS implementation of the map widget.</p> <p>This class provides an interactive map widget using MapLibre GL JS, an open-source WebGL-based vector map renderer. It supports various data sources, custom styling, and interactive features.</p> <p>Attributes:</p> Name Type Description <code>style</code> <p>Map style configuration (URL string or style object).</p> <code>bearing</code> <p>Map rotation in degrees (0-360).</p> <code>pitch</code> <p>Map tilt in degrees (0-60).</p> <code>antialias</code> <p>Whether to enable antialiasing for better rendering quality.</p> <p>Examples:</p> <p>Creating a basic MapLibre map:</p> <pre><code>&gt;&gt;&gt; m = MapLibreMap(\n...     center=[40.7749, -122.4194],\n...     zoom=12,\n...     style=\"3d-satellite\"\n... )\n&gt;&gt;&gt; m.add_basemap(\"OpenStreetMap.Mapnik\")\n</code></pre> Source code in <code>anymap/maplibre.py</code> <pre><code>class MapLibreMap(MapWidget):\n    \"\"\"MapLibre GL JS implementation of the map widget.\n\n    This class provides an interactive map widget using MapLibre GL JS,\n    an open-source WebGL-based vector map renderer. It supports various\n    data sources, custom styling, and interactive features.\n\n    Attributes:\n        style: Map style configuration (URL string or style object).\n        bearing: Map rotation in degrees (0-360).\n        pitch: Map tilt in degrees (0-60).\n        antialias: Whether to enable antialiasing for better rendering quality.\n\n    Example:\n        Creating a basic MapLibre map:\n\n        &gt;&gt;&gt; m = MapLibreMap(\n        ...     center=[40.7749, -122.4194],\n        ...     zoom=12,\n        ...     style=\"3d-satellite\"\n        ... )\n        &gt;&gt;&gt; m.add_basemap(\"OpenStreetMap.Mapnik\")\n    \"\"\"\n\n    # MapLibre-specific traits\n    style = traitlets.Union(\n        [traitlets.Unicode(), traitlets.Dict()],\n        default_value=\"dark-matter\",\n    ).tag(sync=True)\n    bearing = traitlets.Float(0.0).tag(sync=True)\n    pitch = traitlets.Float(0.0).tag(sync=True)\n    antialias = traitlets.Bool(True).tag(sync=True)\n    _draw_data = traitlets.Dict().tag(sync=True)\n    _terra_draw_data = traitlets.Dict().tag(sync=True)\n    _terra_draw_enabled = traitlets.Bool(False).tag(sync=True)\n    _layer_dict = traitlets.Dict().tag(sync=True)\n    clicked = traitlets.Dict().tag(sync=True)\n    _deckgl_layers = traitlets.Dict().tag(sync=True)\n    flatgeobuf_layers = traitlets.Dict({}).tag(sync=True)\n    geoman_data = traitlets.Dict({\"type\": \"FeatureCollection\", \"features\": []}).tag(\n        sync=True\n    )\n\n    # Define the JavaScript module path\n    _esm = _esm_maplibre\n    _css = _css_maplibre\n\n    def __init__(\n        self,\n        center: List[float] = [0, 20],\n        zoom: float = 1.0,\n        style: Union[str, Dict[str, Any]] = \"dark-matter\",\n        width: str = \"100%\",\n        height: str = \"600px\",\n        bearing: float = 0.0,\n        pitch: float = 0.0,\n        controls: Dict[str, str] = {\n            \"navigation\": \"top-right\",\n            \"fullscreen\": \"top-right\",\n            \"scale\": \"bottom-left\",\n            \"globe\": \"top-right\",\n            \"layers\": \"top-right\",\n        },\n        projection: str = \"mercator\",\n        add_sidebar: bool = False,\n        sidebar_visible: bool = False,\n        sidebar_width: int = 360,\n        sidebar_args: Optional[Dict] = None,\n        layer_manager_expanded: bool = True,\n        **kwargs: Any,\n    ) -&gt; None:\n        \"\"\"Initialize MapLibre map widget.\n\n        Args:\n            center: Map center coordinates as [longitude, latitude]. Default is [0, 20].\n            zoom: Initial zoom level (typically 0-20). Default is 1.0.\n            style: MapLibre style URL string or style object dictionary.\n            width: Widget width as CSS string (e.g., \"100%\", \"800px\").\n            height: Widget height as CSS string (e.g., \"600px\", \"50vh\").\n            bearing: Map bearing (rotation) in degrees (0-360).\n            pitch: Map pitch (tilt) in degrees (0-60).\n            controls: Dictionary of control names and their positions. Default is {\n                \"navigation\": \"top-right\",\n                \"fullscreen\": \"top-right\",\n                \"scale\": \"bottom-left\",\n                \"globe\": \"top-right\",\n                \"layers\": \"top-right\",\n            }.\n            projection: Map projection type. Can be \"mercator\" or \"globe\". Default is \"mercator\".\n            add_sidebar: Whether to add a sidebar to the map. Default is False.\n            sidebar_visible: Whether the sidebar is visible. Default is False.\n            sidebar_width: Width of the sidebar in pixels. Default is 360.\n            sidebar_args: Additional keyword arguments for the sidebar. Default is None.\n            layer_manager_expanded: Whether the layer manager is expanded. Default is True.\n            **kwargs: Additional keyword arguments passed to parent class.\n        \"\"\"\n\n        if isinstance(style, str):\n            style = utils.construct_maplibre_style(style)\n\n        if abs(center[1]) &gt; 90:\n            center = center[::-1]\n\n        super().__init__(\n            center=center,\n            zoom=zoom,\n            width=width,\n            height=height,\n            style=style,\n            bearing=bearing,\n            pitch=pitch,\n            **kwargs,\n        )\n\n        self.layer_dict = {}\n        self.layer_dict[\"Background\"] = {\n            \"layer\": {\n                \"id\": \"Background\",\n                \"type\": \"background\",\n            },\n            \"opacity\": 1.0,\n            \"visible\": True,\n            \"type\": \"background\",\n            \"color\": None,\n        }\n\n        # Initialize the _layer_dict trait with the layer_dict content\n        self._layer_dict = dict(self.layer_dict)\n\n        # Initialize current state attributes\n        self._current_center = center\n        self._current_zoom = zoom\n        self._current_bearing = bearing\n        self._current_pitch = pitch\n        self._current_bounds = None  # Will be set after map loads\n\n        # Register event handler to update current state\n        self.on_map_event(\"moveend\", self._update_current_state)\n\n        self._style = style\n        self.style_dict = {}\n        for layer in self.get_style_layers():\n            self.style_dict[layer[\"id\"]] = layer\n        self.source_dict = {}\n\n        if projection.lower() == \"globe\":\n            self.set_projection(\n                {\n                    \"type\": [\n                        \"interpolate\",\n                        [\"linear\"],\n                        [\"zoom\"],\n                        10,\n                        \"vertical-perspective\",\n                        12,\n                        \"mercator\",\n                    ]\n                }\n            )\n\n        self.controls = {}\n        for control, position in controls.items():\n            if control == \"layers\":\n                self.add_layer_control(position)\n            elif control == \"geoman\":\n                self.add_geoman_control(position=position)\n                self.controls[control] = position\n            elif control == \"export\":\n                self.add_export_control(position=position)\n                self.controls[control] = position\n            else:\n                self.add_control(control, position)\n                self.controls[control] = position\n\n        if sidebar_args is None:\n            sidebar_args = {}\n        if \"sidebar_visible\" not in sidebar_args:\n            sidebar_args[\"sidebar_visible\"] = sidebar_visible\n        if \"sidebar_width\" not in sidebar_args:\n            if isinstance(sidebar_width, str):\n                sidebar_width = int(sidebar_width.replace(\"px\", \"\"))\n            sidebar_args[\"min_width\"] = sidebar_width\n            sidebar_args[\"max_width\"] = sidebar_width\n        if \"expanded\" not in sidebar_args:\n            sidebar_args[\"expanded\"] = layer_manager_expanded\n        self.sidebar_args = sidebar_args\n        self.layer_manager = None\n        self.container = None\n        self._widget_control_widgets: Dict[str, widgets.Widget] = {}\n        self._flatgeobuf_defaults: Dict[str, Any] = {}\n        if add_sidebar:\n            self._ipython_display_ = self._patched_display\n\n    def get_style(self) -&gt; Dict:\n        \"\"\"\n        Get the style of the map.\n\n        Returns:\n            Dict: The style of the map.\n        \"\"\"\n        if isinstance(self._style, str):\n            response = requests.get(self._style, timeout=10)\n            style = response.json()\n        elif isinstance(self._style, dict):\n            style = self._style\n        else:\n            style = {}\n        return style\n\n    def get_style_layers(self, return_ids=False, sorted=True) -&gt; List[str]:\n        \"\"\"\n        Get the names of the basemap layers.\n\n        Returns:\n            List[str]: The names of the basemap layers.\n        \"\"\"\n        style = self.get_style()\n        if \"layers\" in style:\n            layers = style[\"layers\"]\n            if return_ids:\n                ids = [layer[\"id\"] for layer in layers]\n                if sorted:\n                    ids.sort()\n\n                return ids\n            else:\n                return layers\n        else:\n            return []\n\n    def find_style_layer(self, id: str) -&gt; Optional[Dict]:\n        \"\"\"\n        Searches for a style layer in the map's current style by its ID and returns it if found.\n\n        Args:\n            id (str): The ID of the style layer to find.\n\n        Returns:\n            Optional[Dict]: The style layer as a dictionary if found, otherwise None.\n        \"\"\"\n        layers = self.get_style_layers()\n        for layer in layers:\n            if layer[\"id\"] == id:\n                return layer\n        return None\n\n    def find_first_symbol_layer(self) -&gt; Optional[Dict]:\n        \"\"\"\n        Find the first symbol layer in the map's current style.\n\n        Returns:\n            Optional[Dict]: The first symbol layer as a dictionary if found, otherwise None.\n        \"\"\"\n        layers = self.get_style_layers()\n        for layer in layers:\n            if layer[\"type\"] == \"symbol\":\n                return layer\n        return None\n\n    @property\n    def first_symbol_layer_id(self) -&gt; Optional[str]:\n        \"\"\"\n        Get the ID of the first symbol layer in the map's current style.\n        \"\"\"\n        layer = self.find_first_symbol_layer()\n        if layer is not None:\n            return layer[\"id\"]\n        else:\n            return None\n\n    def show(\n        self,\n        sidebar_visible: bool = False,\n        min_width: int = 360,\n        max_width: int = 360,\n        sidebar_content: Optional[Any] = None,\n        **kwargs: Any,\n    ) -&gt; None:\n        \"\"\"\n        Displays the map with an optional sidebar.\n\n        Args:\n            sidebar_visible (bool): Whether the sidebar is visible. Defaults to False.\n            min_width (int): Minimum width of the sidebar in pixels. Defaults to 250.\n            max_width (int): Maximum width of the sidebar in pixels. Defaults to 300.\n            sidebar_content (Optional[Any]): Content to display in the sidebar. Defaults to None.\n            **kwargs (Any): Additional keyword arguments.\n\n        Returns:\n            None\n        \"\"\"\n        return Container(\n            self,\n            sidebar_visible=sidebar_visible,\n            min_width=min_width,\n            max_width=max_width,\n            sidebar_content=sidebar_content,\n            **kwargs,\n        )\n\n    def create_container(\n        self,\n        sidebar_visible: bool = None,\n        min_width: int = None,\n        max_width: int = None,\n        expanded: bool = None,\n        **kwargs: Any,\n    ):\n        \"\"\"\n        Creates a container widget for the map with an optional sidebar.\n\n        This method initializes a `LayerManagerWidget` and a `Container` widget to display the map\n        alongside a sidebar. The sidebar can be customized with visibility, width, and additional content.\n\n        Args:\n            sidebar_visible (bool): Whether the sidebar is visible. Defaults to False.\n            min_width (int): Minimum width of the sidebar in pixels. Defaults to 360.\n            max_width (int): Maximum width of the sidebar in pixels. Defaults to 360.\n            expanded (bool): Whether the `LayerManagerWidget` is expanded by default. Defaults to True.\n            **kwargs (Any): Additional keyword arguments passed to the `Container` widget.\n\n        Returns:\n            Container: The created container widget with the map and sidebar.\n        \"\"\"\n\n        if sidebar_visible is None:\n            sidebar_visible = self.sidebar_args.get(\"sidebar_visible\", False)\n        if min_width is None:\n            min_width = self.sidebar_args.get(\"min_width\", 360)\n        if max_width is None:\n            max_width = self.sidebar_args.get(\"max_width\", 360)\n        if expanded is None:\n            expanded = self.sidebar_args.get(\"expanded\", True)\n        if self.layer_manager is None:\n            self.layer_manager = LayerManagerWidget(self, expanded=expanded)\n\n        container = Container(\n            host_map=self,\n            sidebar_visible=sidebar_visible,\n            min_width=min_width,\n            max_width=max_width,\n            sidebar_content=[self.layer_manager],\n            **kwargs,\n        )\n        self.container = container\n        self.container.sidebar_widgets[\"Layers\"] = self.layer_manager\n        return container\n\n    def _repr_html_(self, **kwargs: Any) -&gt; None:\n        \"\"\"\n        Displays the map in an IPython environment.\n\n        Args:\n            **kwargs (Any): Additional keyword arguments.\n\n        Returns:\n            None\n        \"\"\"\n\n        filename = os.environ.get(\"MAPLIBRE_OUTPUT\", None)\n        replace_key = os.environ.get(\"MAPTILER_REPLACE_KEY\", False)\n        if filename is not None:\n            self.to_html(filename, replace_key=replace_key)\n\n    def _patched_display(\n        self,\n        **kwargs: Any,\n    ) -&gt; None:\n        \"\"\"\n        Displays the map in an IPython environment with a patched display method.\n\n        Args:\n            **kwargs (Any): Additional keyword arguments.\n\n        Returns:\n            None\n        \"\"\"\n\n        if self.container is not None:\n            container = self.container\n        else:\n            sidebar_visible = self.sidebar_args.get(\"sidebar_visible\", False)\n            min_width = self.sidebar_args.get(\"min_width\", 360)\n            max_width = self.sidebar_args.get(\"max_width\", 360)\n            expanded = self.sidebar_args.get(\"expanded\", True)\n            if self.layer_manager is None:\n                self.layer_manager = LayerManagerWidget(self, expanded=expanded)\n            container = Container(\n                host_map=self,\n                sidebar_visible=sidebar_visible,\n                min_width=min_width,\n                max_width=max_width,\n                sidebar_content=[self.layer_manager],\n                **kwargs,\n            )\n            container.sidebar_widgets[\"Layers\"] = self.layer_manager\n            self.container = container\n\n        if \"google.colab\" in sys.modules:\n            import ipyvue as vue\n\n            display(vue.Html(children=[]), container)\n        else:\n            display(container)\n\n    def add_layer_manager(\n        self,\n        expanded: bool = True,\n        height: str = \"40px\",\n        layer_icon: str = \"mdi-layers\",\n        close_icon: str = \"mdi-close\",\n        label=\"Layers\",\n        background_color: str = \"#f5f5f5\",\n        *args: Any,\n        **kwargs: Any,\n    ) -&gt; None:\n        if self.layer_manager is None:\n            self.layer_manager = LayerManagerWidget(\n                self,\n                expanded=expanded,\n                height=height,\n                layer_icon=layer_icon,\n                close_icon=close_icon,\n                label=label,\n                background_color=background_color,\n                *args,\n                **kwargs,\n            )\n\n    def set_sidebar_content(\n        self, content: Union[widgets.VBox, List[widgets.Widget]]\n    ) -&gt; None:\n        \"\"\"\n        Replaces all content in the sidebar (except the toggle button).\n\n        Args:\n            content (Union[widgets.VBox, List[widgets.Widget]]): The new content for the sidebar.\n        \"\"\"\n\n        if self.container is not None:\n            self.container.set_sidebar_content(content)\n\n    def add_to_sidebar(\n        self,\n        widget: Union[widgets.Widget, List[widgets.Widget]],\n        add_header: bool = True,\n        widget_icon: str = \"mdi-tools\",\n        close_icon: str = \"mdi-close\",\n        label: str = \"My Tools\",\n        background_color: str = \"#f5f5f5\",\n        height: str = \"40px\",\n        expanded: bool = True,\n        **kwargs: Any,\n    ) -&gt; None:\n        \"\"\"\n        Appends a widget to the sidebar content.\n\n        Args:\n            widget (Optional[Union[widgets.Widget, List[widgets.Widget]]]): Initial widget(s) to display in the content box.\n            widget_icon (str): Icon for the header. See https://pictogrammers.github.io/@mdi/font/2.0.46/ for available icons.\n            close_icon (str): Icon for the close button. See https://pictogrammers.github.io/@mdi/font/2.0.46/ for available icons.\n            background_color (str): Background color of the header. Defaults to \"#f5f5f5\".\n            label (str): Text label for the header. Defaults to \"My Tools\".\n            height (str): Height of the header. Defaults to \"40px\".\n            expanded (bool): Whether the panel is expanded by default. Defaults to True.\n            **kwargs (Any): Additional keyword arguments for the parent class.\n\n        \"\"\"\n        if self.container is None:\n            self.create_container(**self.sidebar_args)\n        self.container.add_to_sidebar(\n            widget,\n            add_header=add_header,\n            widget_icon=widget_icon,\n            close_icon=close_icon,\n            label=label,\n            background_color=background_color,\n            height=height,\n            expanded=expanded,\n            host_map=self,\n            **kwargs,\n        )\n\n    def add_flatgeobuf_layer(\n        self,\n        url: str,\n        layer_id: str,\n        *,\n        layer_type: str = \"fill\",\n        source_id: Optional[str] = None,\n        paint: Optional[Dict[str, Any]] = None,\n        layout: Optional[Dict[str, Any]] = None,\n        filter: Optional[Any] = None,\n        bbox: Optional[List[float]] = None,\n        promote_id: Optional[Union[str, Dict[str, str]]] = None,\n        minzoom: Optional[float] = None,\n        maxzoom: Optional[float] = None,\n        before_id: Optional[str] = None,\n        metadata: Optional[Dict[str, Any]] = None,\n        name: Optional[str] = None,\n    ) -&gt; str:\n        \"\"\"\n        Add a vector layer from a FlatGeobuf dataset.\n\n        The FlatGeobuf file is streamed in the browser and converted to GeoJSON\n        before being added to the map. Rendering happens entirely client-side,\n        so very large datasets may still impact browser performance.\n\n        Args:\n            url: URL pointing to the FlatGeobuf resource.\n            layer_id: Unique identifier for the map layer.\n            layer_type: MapLibre layer type (e.g., ``'fill'``, ``'line'``, ``'circle'``).\n            source_id: Optional custom source identifier. Defaults to ``{layer_id}_source``.\n            paint: Optional paint properties dictionary.\n            layout: Optional layout properties dictionary.\n            filter: Optional MapLibre expression used to filter features.\n            bbox: Optional bounding box ``[minX, minY, maxX, maxY]`` used to limit\n                features retrieved from the dataset.\n            promote_id: Optional feature identifier promotion configuration.\n            minzoom: Optional minimum zoom level for the layer.\n            maxzoom: Optional maximum zoom level for the layer.\n            before_id: Optional layer id to insert the new layer before.\n            metadata: Optional metadata dictionary attached to the layer configuration.\n            name: Optional friendly name used in the layer manager. Defaults to ``layer_id``.\n\n        Returns:\n            str: The identifier of the layer that was registered.\n        \"\"\"\n\n        if source_id is None:\n            source_id = f\"{layer_id}_source\"\n\n        layer_config: Dict[str, Any] = {\n            \"id\": layer_id,\n            \"type\": layer_type,\n            \"source\": source_id,\n        }\n        if paint:\n            layer_config[\"paint\"] = paint\n        if layout:\n            layer_config[\"layout\"] = layout\n        if filter is not None:\n            layer_config[\"filter\"] = filter\n        if promote_id is not None:\n            layer_config[\"promoteId\"] = promote_id\n        if minzoom is not None:\n            layer_config[\"minzoom\"] = minzoom\n        if maxzoom is not None:\n            layer_config[\"maxzoom\"] = maxzoom\n        if metadata:\n            layer_config[\"metadata\"] = metadata\n\n        # Track the layer locally so the layer manager can interact with it.\n        current_layers = dict(self._layers)\n        current_layers[layer_id] = layer_config\n        self._layers = current_layers\n\n        display_name = name or layer_id\n        self.layer_dict[layer_id] = {\n            \"layer\": layer_config,\n            \"opacity\": 1.0,\n            \"visible\": True,\n            \"type\": \"flatgeobuf\",\n            \"name\": display_name,\n            \"url\": url,\n        }\n        self._update_layer_controls()\n\n        config: Dict[str, Any] = {\n            \"layerId\": layer_id,\n            \"sourceId\": source_id,\n            \"url\": url,\n            \"layerType\": layer_type,\n        }\n        if paint:\n            config[\"paint\"] = paint\n        if layout:\n            config[\"layout\"] = layout\n        if filter is not None:\n            config[\"filter\"] = filter\n        if bbox is not None:\n            config[\"bbox\"] = bbox\n        if promote_id is not None:\n            config[\"promoteId\"] = promote_id\n        if minzoom is not None:\n            config[\"minzoom\"] = minzoom\n        if maxzoom is not None:\n            config[\"maxzoom\"] = maxzoom\n        if before_id is not None:\n            config[\"beforeId\"] = before_id\n        if metadata:\n            config[\"metadata\"] = metadata\n        if name:\n            config[\"name\"] = display_name\n\n        flatgeobuf_layers = dict(self.flatgeobuf_layers)\n        flatgeobuf_layers[layer_id] = config\n        self.flatgeobuf_layers = flatgeobuf_layers\n\n        return layer_id\n\n    def enable_feature_popup(\n        self,\n        layer_id: str,\n        *,\n        fields: Optional[Union[Sequence[str], Dict[str, str]]] = None,\n        aliases: Optional[Dict[str, str]] = None,\n        title: Optional[str] = None,\n        title_field: Optional[str] = None,\n        max_properties: int = 25,\n        close_button: bool = True,\n        max_width: str = \"320px\",\n    ) -&gt; None:\n        \"\"\"\n        Enable attribute popups for a layer when users click its features.\n\n        Args:\n            layer_id: Identifier of the target layer.\n            fields: Optional ordered list of attribute keys to display. When omitted,\n                up to ``max_properties`` properties are shown.\n            aliases: Optional mapping from attribute key to display label. Only applies\n                when ``fields`` is provided.\n            title: Optional static string rendered above the attribute table.\n            title_field: Optional property key whose value should be used as the popup\n                title. Ignored when ``title`` is provided.\n            max_properties: Maximum number of properties displayed when ``fields`` is\n                not supplied. Defaults to 25.\n            close_button: Whether the popup shows a close button. Defaults to True.\n            max_width: CSS max-width applied to the popup container. Defaults to 320px.\n        \"\"\"\n\n        alias_lookup: Dict[str, str] = aliases or {}\n\n        field_config: Optional[List[Dict[str, str]]] = None\n        if fields is not None:\n            if isinstance(fields, dict):\n                field_config = [\n                    {\"name\": str(key), \"label\": str(value)}\n                    for key, value in fields.items()\n                ]\n            else:\n                field_config = []\n                for name in fields:\n                    field_name = str(name)\n                    label_source = alias_lookup.get(\n                        name, alias_lookup.get(field_name, field_name)\n                    )\n                    field_config.append(\n                        {\"name\": field_name, \"label\": str(label_source)}\n                    )\n\n        config: Dict[str, Any] = {\n            \"layerId\": layer_id,\n            \"maxProperties\": max_properties,\n            \"closeButton\": close_button,\n            \"maxWidth\": max_width,\n        }\n        if field_config is not None:\n            config[\"fields\"] = field_config\n        if title is not None:\n            config[\"title\"] = title\n        if title_field is not None:\n            config[\"titleField\"] = title_field\n\n        self.call_js_method(\"enableFeaturePopup\", config)\n\n    def disable_feature_popup(self, layer_id: str) -&gt; None:\n        \"\"\"\n        Disable attribute popups for the specified layer.\n\n        Args:\n            layer_id: Identifier of the target layer.\n        \"\"\"\n\n        self.call_js_method(\"disableFeaturePopup\", {\"layerId\": layer_id})\n\n    def add_widget_control(\n        self,\n        widget: widgets.Widget,\n        *,\n        label: str = \"Tools\",\n        icon: str = \"\u22ee\",\n        position: str = \"top-right\",\n        collapsed: bool = True,\n        panel_width: int = 320,\n        panel_min_width: int = 220,\n        panel_max_width: int = 420,\n        control_id: Optional[str] = None,\n        description: Optional[str] = None,\n    ) -&gt; str:\n        \"\"\"\n        Add a collapsible widget control anchored to the map viewport.\n\n        The control displays as a button alongside other MapLibre controls. Clicking\n        the button expands a sidebar-style panel that renders the supplied\n        ipywidget content.\n\n        Args:\n            widget: The ipywidget instance to embed inside the collapsible panel.\n            label: Title shown at the top of the expanded panel.\n            icon: Text or icon hint shown on the toggle button. Defaults to a vertical ellipsis.\n            position: Map control corner (``'top-left'``, ``'top-right'``,\n                ``'bottom-left'``, or ``'bottom-right'``).\n            collapsed: Whether the panel starts collapsed.\n            panel_width: Default panel width in pixels.\n            panel_min_width: Minimum panel width in pixels when resized on the front-end.\n            panel_max_width: Maximum panel width in pixels when resized on the front-end.\n            control_id: Optional identifier used for duplicate detection and later removal.\n                If omitted, a unique identifier is generated from the label.\n            description: Optional tooltip description for the toggle button.\n\n        Returns:\n            str: The unique identifier assigned to the widget control.\n\n        Raises:\n            TypeError: If ``widget`` is not an ipywidget instance.\n        \"\"\"\n        if not isinstance(widget, widgets.Widget):\n            raise TypeError(\"widget must be an ipywidgets.Widget instance\")\n\n        if control_id is None:\n            base_slug = \"\".join(\n                char.lower() if char.isalnum() else \"-\" for char in label\n            ).strip(\"-\")\n            if not base_slug:\n                base_slug = \"widget\"\n            control_id = f\"{base_slug}-{uuid.uuid4().hex[:6]}\"\n\n        # Ensure uniqueness when callers supply their own identifier\n        if control_id in self._widget_control_widgets:\n            raise ValueError(f\"Widget control '{control_id}' already exists\")\n\n        widget_id = getattr(widget, \"model_id\", None)\n        if widget_id is None:\n            raise ValueError(\n                \"The supplied widget does not have a model_id. Ensure it is an ipywidget \"\n                \"instance created within the current notebook session.\"\n            )\n\n        control_options: Dict[str, Any] = {\n            \"position\": position,\n            \"label\": label,\n            \"icon\": icon,\n            \"collapsed\": collapsed,\n            \"panelWidth\": panel_width,\n            \"panelMinWidth\": panel_min_width,\n            \"panelMaxWidth\": panel_max_width,\n            \"control_id\": control_id,\n            \"widget_model_id\": widget_id,\n        }\n\n        if description:\n            control_options[\"description\"] = description\n\n        control_key = f\"widget_panel_{control_id}\"\n\n        current_controls = dict(self._controls)\n        current_controls[control_key] = {\n            \"type\": \"widget_panel\",\n            \"position\": position,\n            \"options\": control_options,\n        }\n        self._controls = current_controls\n\n        self._widget_control_widgets[control_id] = widget\n        self.call_js_method(\"addControl\", \"widget_panel\", control_options)\n\n        return control_id\n\n    def remove_widget_control(self, control_id: str) -&gt; None:\n        \"\"\"Remove a previously registered widget control.\"\"\"\n        if not control_id:\n            raise ValueError(\"control_id is required\")\n\n        current_controls = dict(self._controls)\n        target_key = None\n        for key, config in current_controls.items():\n            if (\n                config.get(\"type\") == \"widget_panel\"\n                and config.get(\"options\", {}).get(\"control_id\") == control_id\n            ):\n                target_key = key\n                break\n\n        if target_key:\n            current_controls.pop(target_key)\n            self._controls = current_controls\n\n        if control_id in self._widget_control_widgets:\n            del self._widget_control_widgets[control_id]\n\n        self.call_js_method(\"removeWidgetControl\", control_id)\n\n    def remove_from_sidebar(\n        self, widget: widgets.Widget = None, name: str = None\n    ) -&gt; None:\n        \"\"\"\n        Removes a widget from the sidebar content.\n\n        Args:\n            widget (widgets.Widget): The widget to remove from the sidebar.\n            name (str): The name of the widget to remove from the sidebar.\n        \"\"\"\n        if self.container is not None:\n            self.container.remove_from_sidebar(widget, name)\n\n    def set_sidebar_width(self, min_width: int = None, max_width: int = None) -&gt; None:\n        \"\"\"\n        Dynamically updates the sidebar's minimum and maximum width.\n\n        Args:\n            min_width (int, optional): New minimum width in pixels. If None, keep current.\n            max_width (int, optional): New maximum width in pixels. If None, keep current.\n        \"\"\"\n        if self.container is None:\n            self.create_container()\n        self.container.set_sidebar_width(min_width, max_width)\n\n    @property\n    def sidebar_widgets(self) -&gt; Dict[str, widgets.Widget]:\n        \"\"\"\n        Returns a dictionary of widgets currently in the sidebar.\n\n        Returns:\n            Dict[str, widgets.Widget]: A dictionary where keys are the labels of the widgets and values are the widgets themselves.\n        \"\"\"\n        return self.container.sidebar_widgets\n\n    def set_style(self, style: Union[str, Dict[str, Any]]) -&gt; None:\n        \"\"\"Set the map style.\n\n        Args:\n            style: Map style as URL string or style object dictionary.\n        \"\"\"\n        if isinstance(style, str):\n            self.style = style\n        else:\n            self.call_js_method(\"setStyle\", style)\n\n    def set_bearing(self, bearing: float) -&gt; None:\n        \"\"\"Set the map bearing (rotation).\n\n        Args:\n            bearing: Map rotation in degrees (0-360).\n        \"\"\"\n        self.bearing = bearing\n\n    def set_pitch(self, pitch: float) -&gt; None:\n        \"\"\"Set the map pitch (tilt).\n\n        Args:\n            pitch: Map tilt in degrees (0-60).\n        \"\"\"\n        self.pitch = pitch\n\n    def set_layout_property(self, layer_id: str, name: str, value: Any) -&gt; None:\n        \"\"\"Set a layout property for a layer.\n\n        Args:\n            layer_id: Unique identifier of the layer.\n            name: Name of the layout property to set.\n            value: Value to set for the property.\n        \"\"\"\n        self.call_js_method(\"setLayoutProperty\", layer_id, name, value)\n\n    def set_paint_property(self, layer_id: str, name: str, value: Any) -&gt; None:\n        \"\"\"Set a paint property for a layer.\n\n        Args:\n            layer_id: Unique identifier of the layer.\n            name: Name of the paint property to set.\n            value: Value to set for the property.\n        \"\"\"\n        self.call_js_method(\"setPaintProperty\", layer_id, name, value)\n\n    def set_visibility(self, layer_id: str, visible: bool) -&gt; None:\n        \"\"\"Set the visibility of a layer.\n\n        Args:\n            layer_id: Unique identifier of the layer.\n            visible: Whether the layer should be visible.\n        \"\"\"\n        if visible:\n            visibility = \"visible\"\n        else:\n            visibility = \"none\"\n\n        if layer_id == \"Background\":\n            for layer in self.get_style_layers():\n                self.set_layout_property(layer[\"id\"], \"visibility\", visibility)\n        else:\n            self.set_layout_property(layer_id, \"visibility\", visibility)\n        if layer_id in self.layer_dict:\n            self.layer_dict[layer_id][\"visible\"] = visible\n            self._update_layer_controls()\n\n    def set_opacity(self, layer_id: str, opacity: float) -&gt; None:\n        \"\"\"Set the opacity of a layer.\n\n        Args:\n            layer_id: Unique identifier of the layer.\n            opacity: Opacity value between 0.0 (transparent) and 1.0 (opaque).\n        \"\"\"\n        layer_type = self.get_layer_type(layer_id)\n\n        if layer_id == \"Background\":\n            for layer in self.get_style_layers():\n                layer_type = layer.get(\"type\")\n                if layer_type != \"symbol\":\n                    self.set_paint_property(\n                        layer[\"id\"], f\"{layer_type}-opacity\", opacity\n                    )\n                else:\n                    self.set_paint_property(layer[\"id\"], \"icon-opacity\", opacity)\n                    self.set_paint_property(layer[\"id\"], \"text-opacity\", opacity)\n            return\n\n        if layer_id in self.layer_dict:\n            layer_type = self.layer_dict[layer_id][\"layer\"][\"type\"]\n            prop_name = f\"{layer_type}-opacity\"\n            self.layer_dict[layer_id][\"opacity\"] = opacity\n            self._update_layer_controls()\n        elif layer_id in self.style_dict:\n            layer = self.style_dict[layer_id]\n            layer_type = layer.get(\"type\")\n            prop_name = f\"{layer_type}-opacity\"\n            if \"paint\" in layer:\n                layer[\"paint\"][prop_name] = opacity\n\n        if layer_type != \"symbol\":\n            self.set_paint_property(layer_id, f\"{layer_type}-opacity\", opacity)\n        else:\n            self.set_paint_property(layer_id, \"icon-opacity\", opacity)\n            self.set_paint_property(layer_id, \"text-opacity\", opacity)\n\n    def set_projection(self, projection: Dict[str, Any]) -&gt; None:\n        \"\"\"Set the map projection.\n\n        Args:\n            projection: Projection configuration dictionary.\n        \"\"\"\n        # Store projection in persistent state\n        self._projection = projection\n        self.call_js_method(\"setProjection\", projection)\n\n    def set_terrain(\n        self,\n        source: str = \"https://elevation-tiles-prod.s3.amazonaws.com/terrarium/{z}/{x}/{y}.png\",\n        exaggeration: float = 1.0,\n        tile_size: int = 256,\n        encoding: str = \"terrarium\",\n        source_id: str = \"terrain-dem\",\n    ) -&gt; None:\n        \"\"\"Add terrain visualization to the map.\n\n        Args:\n            source: URL template for terrain tiles. Defaults to AWS elevation tiles.\n            exaggeration: Terrain exaggeration factor. Defaults to 1.0.\n            tile_size: Tile size in pixels. Defaults to 256.\n            encoding: Encoding for the terrain tiles. Defaults to \"terrarium\".\n            source_id: Unique identifier for the terrain source. Defaults to \"terrain-dem\".\n        \"\"\"\n        # Add terrain source\n        self.add_source(\n            source_id,\n            {\n                \"type\": \"raster-dem\",\n                \"tiles\": [source],\n                \"tileSize\": tile_size,\n                \"encoding\": encoding,\n            },\n        )\n\n        # Set terrain on the map\n        terrain_config = {\"source\": source_id, \"exaggeration\": exaggeration}\n\n        # Store terrain configuration in persistent state\n        self._terrain = terrain_config\n        self.call_js_method(\"setTerrain\", terrain_config)\n\n    def get_layer_type(self, layer_id: str) -&gt; Optional[str]:\n        \"\"\"Get the type of a layer.\n\n        Args:\n            layer_id: Unique identifier of the layer.\n\n        Returns:\n            Layer type string, or None if layer doesn't exist.\n        \"\"\"\n        if layer_id in self._layers:\n            return self._layers[layer_id][\"type\"]\n        else:\n            return None\n\n    def get_style(self):\n        \"\"\"\n        Get the style of the map.\n\n        Returns:\n            Dict: The style of the map.\n        \"\"\"\n        if self._style is not None:\n            if isinstance(self._style, str):\n                response = requests.get(self._style, timeout=10)\n                style = response.json()\n            elif isinstance(self._style, dict):\n                style = self._style\n            else:\n                style = {}\n            return style\n        else:\n            return {}\n\n    def get_style_layers(self, return_ids=False, sorted=True) -&gt; List[str]:\n        \"\"\"\n        Get the names of the basemap layers.\n\n        Returns:\n            List[str]: The names of the basemap layers.\n        \"\"\"\n        style = self.get_style()\n        if \"layers\" in style:\n            layers = style[\"layers\"]\n            if return_ids:\n                ids = [layer[\"id\"] for layer in layers]\n                if sorted:\n                    ids.sort()\n\n                return ids\n            else:\n                return layers\n        else:\n            return []\n\n    def add_layer(\n        self,\n        layer: Dict[str, Any],\n        before_id: Optional[str] = None,\n        layer_id: str = None,\n        opacity: Optional[float] = 1.0,\n        visible: Optional[bool] = True,\n        overwrite: bool = False,\n        **kwargs: Any,\n    ) -&gt; None:\n        \"\"\"Add a layer to the map.\n\n        Args:\n            layer_id: Unique identifier for the layer.\n            layer_config: Layer configuration dictionary containing\n                         properties like type, source, paint, and layout.\n            before_id: Optional layer ID to insert this layer before.\n                      If None, layer is added on top.\n        \"\"\"\n\n        if isinstance(layer, dict):\n            if \"minzoom\" in layer:\n                layer[\"min-zoom\"] = layer.pop(\"minzoom\")\n            if \"maxzoom\" in layer:\n                layer[\"max-zoom\"] = layer.pop(\"maxzoom\")\n            layer = utils.replace_top_level_hyphens(layer)\n\n        if \"name\" in kwargs and layer_id is None:\n            layer_id = kwargs.pop(\"name\")\n\n        if layer_id is None:\n            layer_id = utils.get_unique_name(\n                layer[\"id\"], list(self._layers.keys()), overwrite\n            )\n\n        # Store before_id in layer metadata for restoration when displaying in multiple cells\n        if before_id is not None:\n            if \"metadata\" not in layer:\n                layer[\"metadata\"] = {}\n            layer[\"metadata\"][\"beforeId\"] = before_id\n\n        # Store layer in local state for persistence\n        current_layers = dict(self._layers)\n        current_layers[layer_id] = layer\n        self._layers = current_layers\n\n        # Call JavaScript method with before_id if provided\n        self.call_js_method(\"addLayer\", layer, before_id)\n\n        self.set_visibility(layer_id, visible)\n        self.set_opacity(layer_id, opacity)\n        self.layer_dict[layer_id] = {\n            \"layer\": layer,\n            \"opacity\": opacity,\n            \"visible\": visible,\n            \"type\": layer[\"type\"],\n            # \"color\": color,\n        }\n\n        # Update the _layer_dict trait to trigger JavaScript sync\n        self._layer_dict = dict(self.layer_dict)\n\n        if self.layer_manager is not None:\n            self.layer_manager.refresh()\n\n        # Update layer controls if they exist\n        self._update_layer_controls()\n\n    def add_geojson_layer(\n        self,\n        layer_id: str,\n        geojson_data: Dict[str, Any],\n        layer_type: str = \"fill\",\n        paint: Optional[Dict[str, Any]] = None,\n        before_id: Optional[str] = None,\n    ) -&gt; None:\n        \"\"\"Add a GeoJSON layer to the map.\n\n        Args:\n            layer_id: Unique identifier for the layer.\n            geojson_data: GeoJSON data as a dictionary.\n            layer_type: Type of layer (e.g., 'fill', 'line', 'circle', 'symbol').\n            paint: Optional paint properties for styling the layer.\n            before_id: Optional layer ID to insert this layer before.\n        \"\"\"\n        source_id = f\"{layer_id}_source\"\n\n        # Add source\n        self.add_source(source_id, {\"type\": \"geojson\", \"data\": geojson_data})\n\n        # Add layer\n        layer_config = {\"id\": layer_id, \"type\": layer_type, \"source\": source_id}\n\n        if paint:\n            layer_config[\"paint\"] = paint\n\n        self.add_layer(layer=layer_config, before_id=before_id, layer_id=layer_id)\n\n    def add_marker(self, lng: float, lat: float, popup: Optional[str] = None) -&gt; None:\n        \"\"\"Add a marker to the map.\n\n        Args:\n            lng: Longitude coordinate for the marker.\n            lat: Latitude coordinate for the marker.\n            popup: Optional popup text to display when marker is clicked.\n        \"\"\"\n        marker_data = {\"coordinates\": [lng, lat], \"popup\": popup}\n        self.call_js_method(\"addMarker\", marker_data)\n\n    def fit_bounds(self, bounds: List[List[float]], padding: int = 50) -&gt; None:\n        \"\"\"Fit the map to given bounds.\n\n        Args:\n            bounds: Bounding box as [[south, west], [north, east]].\n            padding: Padding around the bounds in pixels.\n        \"\"\"\n        self.call_js_method(\"fitBounds\", bounds, {\"padding\": padding})\n\n    def add_geojson(\n        self,\n        data: Union[str, Dict],\n        layer_type: Optional[str] = None,\n        filter: Optional[Dict] = None,\n        paint: Optional[Dict] = None,\n        name: Optional[str] = None,\n        fit_bounds: bool = True,\n        visible: bool = True,\n        opacity: float = 1.0,\n        before_id: Optional[str] = None,\n        source_args: Optional[Dict] = None,\n        **kwargs: Any,\n    ) -&gt; None:\n        \"\"\"Add a GeoJSON layer to the map.\n\n        This method adds a GeoJSON layer to the map. The GeoJSON data can be a\n        URL to a GeoJSON file or a GeoJSON dictionary.\n\n        Args:\n            data: The GeoJSON data. This can be a URL to a GeoJSON file or a\n                GeoJSON dictionary.\n            layer_type: The type of the layer. It can be one of the following:\n                'circle', 'fill', 'fill-extrusion', 'line', 'symbol'. If None,\n                the type is inferred from the GeoJSON data.\n            filter: The filter to apply to the layer. If None, no filter is applied.\n            paint: The paint properties to apply to the layer. If None, default\n                paint properties are applied based on geometry type.\n            name: The name of the layer. If None, 'GeoJSON' is used.\n            fit_bounds: Whether to adjust the viewport of the map to fit the\n                bounds of the GeoJSON data. Defaults to True.\n            visible: Whether the layer is visible or not. Defaults to True.\n            opacity: The opacity of the layer. Defaults to 1.0.\n            before_id: The ID of an existing layer before which the new layer\n                should be inserted.\n            source_args: Additional keyword arguments that are passed to the\n                GeoJSON source.\n            **kwargs: Additional keyword arguments that are passed to the layer.\n        \"\"\"\n        import geopandas as gpd\n\n        bounds = None\n        geom_type = None\n        source_args = source_args or {}\n\n        # Load data from file or URL if necessary\n        if isinstance(data, str):\n            if os.path.isfile(data) or data.startswith(\"http\"):\n                gdf = gpd.read_file(data)\n                data = gdf.__geo_interface__\n                if fit_bounds:\n                    bounds = gdf.total_bounds  # [minx, miny, maxx, maxy]\n            else:\n                raise ValueError(\n                    \"The data must be a URL, file path, or GeoJSON dictionary.\"\n                )\n        elif isinstance(data, dict) and data.get(\"type\") == \"FeatureCollection\":\n            if fit_bounds:\n                gdf = gpd.GeoDataFrame.from_features(data)\n                bounds = gdf.total_bounds  # [minx, miny, maxx, maxy]\n        elif not isinstance(data, dict):\n            raise ValueError(\n                \"The data must be a URL, file path, or GeoJSON dictionary.\"\n            )\n\n        # Generate layer name if not provided\n        if name is None:\n            name = \"GeoJSON\"\n\n        # Infer geometry type and set default paint if not provided\n        if paint is None:\n            if \"features\" in data and len(data[\"features\"]) &gt; 0:\n                geom_type = data[\"features\"][0][\"geometry\"][\"type\"]\n            elif \"geometry\" in data:\n                geom_type = data[\"geometry\"][\"type\"]\n\n            if geom_type in [\"Point\", \"MultiPoint\"]:\n                if layer_type is None:\n                    layer_type = \"circle\"\n                paint = {\n                    \"circle-radius\": 5,\n                    \"circle-color\": \"#3388ff\",\n                    \"circle-stroke-color\": \"#ffffff\",\n                    \"circle-stroke-width\": 1,\n                }\n            elif geom_type in [\"LineString\", \"MultiLineString\"]:\n                if layer_type is None:\n                    layer_type = \"line\"\n                paint = {\"line-color\": \"#3388ff\", \"line-width\": 2}\n            elif geom_type in [\"Polygon\", \"MultiPolygon\"]:\n                if layer_type is None:\n                    layer_type = \"fill\"\n                paint = {\n                    \"fill-color\": \"#3388ff\",\n                    \"fill-opacity\": 0.5,\n                }\n\n        # Add source\n        source_id = f\"{name}_source\"\n        source_config = {\"type\": \"geojson\", \"data\": data}\n        source_config.update(source_args)\n        self.add_source(source_id, source_config)\n\n        # Prepare layer configuration\n        layer_config = {\n            \"id\": name,\n            \"type\": layer_type or \"fill\",\n            \"source\": source_id,\n        }\n\n        if filter is not None:\n            layer_config[\"filter\"] = filter\n\n        if paint is not None:\n            layer_config[\"paint\"] = paint\n\n        layer_config.update(kwargs)\n\n        # Add layer\n        self.add_layer(layer=layer_config, before_id=before_id, layer_id=name)\n\n        # Set visibility\n        if not visible:\n            self.set_visibility(name, False)\n\n        # Set opacity\n        if opacity &lt; 1.0:\n            self.set_opacity(name, opacity)\n\n        # Fit bounds if requested\n        if fit_bounds and bounds is not None:\n            # Convert from [minx, miny, maxx, maxy] to [[west, south], [east, north]]\n            self.fit_bounds([[bounds[0], bounds[1]], [bounds[2], bounds[3]]])\n\n    def add_vector(\n        self,\n        data: Union[str, \"gpd.GeoDataFrame\"],\n        layer_type: Optional[str] = None,\n        filter: Optional[Dict] = None,\n        paint: Optional[Dict] = None,\n        name: Optional[str] = None,\n        fit_bounds: bool = True,\n        visible: bool = True,\n        before_id: Optional[str] = None,\n        source_args: Optional[Dict] = None,\n        **kwargs: Any,\n    ) -&gt; None:\n        \"\"\"Add a vector layer to the map.\n\n        This method adds a vector layer to the map. The vector data can be a\n        URL or local file path to a vector file (e.g., shapefile, GeoJSON,\n        GeoPackage) or a GeoDataFrame.\n\n        Args:\n            data: The vector data. This can be a URL, local file path to a\n                vector file, or a GeoDataFrame.\n            layer_type: The type of the layer. If None, the type is inferred\n                from the GeoJSON data.\n            filter: The filter to apply to the layer. If None, no filter is applied.\n            paint: The paint properties to apply to the layer. If None, default\n                paint properties are applied.\n            name: The name of the layer. If None, a default name is generated.\n            fit_bounds: Whether to adjust the viewport of the map to fit the\n                bounds of the data. Defaults to True.\n            visible: Whether the layer is visible or not. Defaults to True.\n            before_id: The ID of an existing layer before which the new layer\n                should be inserted.\n            source_args: Additional keyword arguments that are passed to the\n                GeoJSON source.\n            **kwargs: Additional keyword arguments that are passed to the layer.\n        \"\"\"\n        import geopandas as gpd\n\n        if not isinstance(data, gpd.GeoDataFrame):\n            data = gpd.read_file(data).__geo_interface__\n        else:\n            data = data.__geo_interface__\n\n        self.add_geojson(\n            data,\n            layer_type=layer_type,\n            filter=filter,\n            paint=paint,\n            name=name,\n            fit_bounds=fit_bounds,\n            visible=visible,\n            before_id=before_id,\n            source_args=source_args,\n            **kwargs,\n        )\n\n    def add_raster(\n        self,\n        source,\n        indexes=None,\n        colormap=None,\n        vmin=None,\n        vmax=None,\n        nodata=None,\n        name=\"Raster\",\n        before_id=None,\n        fit_bounds=True,\n        visible=True,\n        opacity=1.0,\n        array_args={},\n        client_args={\"cors_all\": True},\n        overwrite: bool = True,\n        **kwargs: Any,\n    ):\n        \"\"\"Add a local raster dataset to the map.\n            If you are using this function in JupyterHub on a remote server\n            (e.g., Binder, Microsoft Planetary Computer) and if the raster\n            does not render properly, try installing jupyter-server-proxy using\n            `pip install jupyter-server-proxy`, then running the following code\n            before calling this function. For more info, see https://bit.ly/3JbmF93.\n\n            import os\n            os.environ['LOCALTILESERVER_CLIENT_PREFIX'] = 'proxy/{port}'\n\n        Args:\n            source (str): The path to the GeoTIFF file or the URL of the Cloud\n                Optimized GeoTIFF.\n            indexes (int, optional): The band(s) to use. Band indexing starts\n                at 1. Defaults to None.\n            colormap (str, optional): The name of the colormap from `matplotlib`\n                to use when plotting a single band.\n                See https://matplotlib.org/stable/gallery/color/colormap_reference.html.\n                Default is greyscale.\n            vmin (float, optional): The minimum value to use when colormapping\n                the palette when plotting a single band. Defaults to None.\n            vmax (float, optional): The maximum value to use when colormapping\n                the palette when plotting a single band. Defaults to None.\n            nodata (float, optional): The value from the band to use to interpret\n                as not valid data. Defaults to None.\n            name (str, optional): The layer name to use. Defaults to 'Raster'.\n            before_id (str, optional): The layer id to insert the layer before. Defaults to None.\n            fit_bounds (bool, optional): Whether to zoom to the extent of the\n                layer. Defaults to True.\n            visible (bool, optional): Whether the layer is visible. Defaults to True.\n            opacity (float, optional): The opacity of the layer. Defaults to 1.0.\n            array_args (dict, optional): Additional arguments to pass to\n                `array_to_memory_file` when reading the raster. Defaults to {}.\n            client_args (dict, optional): Additional arguments to pass to\n                localtileserver.TileClient. Defaults to { \"cors_all\": False }.\n            overwrite (bool, optional): Whether to overwrite an existing layer with the same name.\n                Defaults to True.\n            **kwargs: Additional keyword arguments to be passed to the underlying\n                `add_tile_layer` method.\n        \"\"\"\n        import numpy as np\n        import xarray as xr\n\n        if \"zoom_to_layer\" in kwargs:\n            fit_bounds = kwargs.pop(\"zoom_to_layer\")\n\n        if \"layer_name\" in kwargs:\n            name = kwargs.pop(\"layer_name\")\n\n        if isinstance(source, np.ndarray) or isinstance(source, xr.DataArray):\n            source = utils.array_to_image(source, **array_args)\n\n        if \"colormap_name\" in kwargs:\n            colormap = kwargs.pop(\"colormap_name\")\n\n        url, tile_client = utils.get_local_tile_url(\n            source,\n            indexes=indexes,\n            colormap=colormap,\n            vmin=vmin,\n            vmax=vmax,\n            nodata=nodata,\n            opacity=opacity,\n            client_args=client_args,\n            return_client=True,\n            **kwargs,\n        )\n\n        self.add_tile_layer(\n            layer_id=name,\n            source_url=url,\n            opacity=opacity,\n            visible=visible,\n            before_id=before_id,\n            overwrite=overwrite,\n        )\n\n        bounds = tile_client.bounds()  # [ymin, ymax, xmin, xmax]\n        bounds = [[bounds[2], bounds[0]], [bounds[3], bounds[1]]]\n        # [minx, miny, maxx, maxy]\n        if fit_bounds:\n            self.fit_bounds(bounds)\n\n    def add_tile_layer(\n        self,\n        layer_id: str,\n        source_url: str,\n        attribution: Optional[str] = None,\n        opacity: Optional[float] = 1.0,\n        visible: Optional[bool] = True,\n        minzoom: Optional[int] = None,\n        maxzoom: Optional[int] = None,\n        paint: Optional[Dict[str, Any]] = None,\n        layout: Optional[Dict[str, Any]] = None,\n        before_id: Optional[str] = None,\n        **kwargs: Any,\n    ) -&gt; None:\n        \"\"\"Add a raster tile layer to the map.\n\n        Args:\n            layer_id: Unique identifier for the layer.\n            source_url: URL template for the tile source (e.g., 'https://example.com/{z}/{x}/{y}.png').\n            attribution: Optional attribution text for the tile source.\n            opacity: Layer opacity between 0.0 and 1.0.\n            visible: Whether the layer should be visible initially.\n            minzoom: Minimum zoom level for the layer.\n            maxzoom: Maximum zoom level for the layer.\n            paint: Optional paint properties for the layer.\n            layout: Optional layout properties for the layer.\n            before_id: Optional layer ID to insert this layer before.\n            **kwargs: Additional source configuration options.\n        \"\"\"\n        source_id = f\"{layer_id}_source\"\n\n        # Add raster source\n        self.add_source(\n            source_id,\n            {\"type\": \"raster\", \"tiles\": [source_url], \"tileSize\": 256, **kwargs},\n        )\n\n        # Add raster layer\n        layer_config = {\"id\": layer_id, \"type\": \"raster\", \"source\": source_id}\n\n        if paint:\n            layer_config[\"paint\"] = paint\n        if layout:\n            layer_config[\"layout\"] = layout\n\n        self.add_layer(layer=layer_config, before_id=before_id, layer_id=layer_id)\n\n    def add_vector_layer(\n        self,\n        layer_id: str,\n        source_url: str,\n        source_layer: str,\n        layer_type: str = \"fill\",\n        paint: Optional[Dict[str, Any]] = None,\n        layout: Optional[Dict[str, Any]] = None,\n        before_id: Optional[str] = None,\n    ) -&gt; None:\n        \"\"\"Add a vector tile layer to the map.\n\n        Args:\n            layer_id: Unique identifier for the layer.\n            source_url: URL for the vector tile source.\n            source_layer: Name of the source layer within the vector tiles.\n            layer_type: Type of layer (e.g., 'fill', 'line', 'circle', 'symbol').\n            paint: Optional paint properties for styling the layer.\n            layout: Optional layout properties for the layer.\n            before_id: Optional layer ID to insert this layer before.\n        \"\"\"\n        source_id = f\"{layer_id}_source\"\n\n        # Add vector source\n        self.add_source(source_id, {\"type\": \"vector\", \"url\": source_url})\n\n        # Add vector layer\n        layer_config = {\n            \"id\": layer_id,\n            \"type\": layer_type,\n            \"source\": source_id,\n            \"source-layer\": source_layer,\n        }\n\n        if paint:\n            layer_config[\"paint\"] = paint\n        if layout:\n            layer_config[\"layout\"] = layout\n\n        self.add_layer(layer=layer_config, before_id=before_id, layer_id=layer_id)\n\n    def add_image_layer(\n        self,\n        layer_id: str,\n        image_url: str,\n        coordinates: List[List[float]],\n        paint: Optional[Dict[str, Any]] = None,\n        before_id: Optional[str] = None,\n    ) -&gt; None:\n        \"\"\"Add an image layer to the map.\n\n        Args:\n            layer_id: Unique identifier for the layer.\n            image_url: URL of the image to display.\n            coordinates: Corner coordinates of the image as [[top-left], [top-right], [bottom-right], [bottom-left]].\n                        Each coordinate should be [longitude, latitude].\n            paint: Optional paint properties for the image layer.\n            before_id: Optional layer ID to insert this layer before.\n        \"\"\"\n        source_id = f\"{layer_id}_source\"\n\n        # Add image source\n        self.add_source(\n            source_id, {\"type\": \"image\", \"url\": image_url, \"coordinates\": coordinates}\n        )\n\n        # Add raster layer for the image\n        layer_config = {\"id\": layer_id, \"type\": \"raster\", \"source\": source_id}\n\n        if paint:\n            layer_config[\"paint\"] = paint\n\n        self.add_layer(layer=layer_config, before_id=before_id, layer_id=layer_id)\n\n    def add_control(\n        self,\n        control_type: str,\n        position: str = \"top-right\",\n        options: Optional[Dict[str, Any]] = None,\n    ) -&gt; None:\n        \"\"\"Add a control to the map.\n\n        Args:\n            control_type: Type of control ('navigation', 'scale', 'fullscreen', 'geolocate', 'attribution', 'globe')\n            position: Position on map ('top-left', 'top-right', 'bottom-left', 'bottom-right')\n            options: Additional options for the control\n        \"\"\"\n        control_options = options or {}\n        control_options[\"position\"] = position\n\n        # Store control in persistent state\n        control_key = f\"{control_type}_{position}\"\n        current_controls = dict(self._controls)\n        current_controls[control_key] = {\n            \"type\": control_type,\n            \"position\": position,\n            \"options\": control_options,\n        }\n        self._controls = current_controls\n\n        self.call_js_method(\"addControl\", control_type, control_options)\n\n    def remove_control(\n        self,\n        control_type: str,\n        position: str = \"top-right\",\n    ) -&gt; None:\n        \"\"\"Remove a control from the map.\n\n        Args:\n            control_type: Type of control to remove ('navigation', 'scale', 'fullscreen', 'geolocate', 'attribution', 'globe')\n            position: Position where the control was added ('top-left', 'top-right', 'bottom-left', 'bottom-right')\n        \"\"\"\n        # Remove control from persistent state\n        control_key = f\"{control_type}_{position}\"\n        current_controls = dict(self._controls)\n        if control_key in current_controls:\n            del current_controls[control_key]\n            self._controls = current_controls\n\n        self.call_js_method(\"removeControl\", control_type, position)\n\n    def add_layer_control(\n        self,\n        position: str = \"top-right\",\n        collapsed: bool = True,\n        layers: Optional[List[str]] = None,\n        options: Optional[Dict[str, Any]] = None,\n    ) -&gt; None:\n        \"\"\"Add a collapsible layer control panel to the map.\n\n        The layer control is a collapsible panel that allows users to toggle\n        visibility and adjust opacity of map layers. It displays as an icon\n        similar to other controls, and expands when clicked.\n\n        Args:\n            position: Position on map ('top-left', 'top-right', 'bottom-left', 'bottom-right')\n            collapsed: Whether the control starts collapsed\n            layers: List of layer IDs to include. If None, includes all layers\n            options: Additional options for the control\n        \"\"\"\n        control_options = options or {}\n        control_options.update(\n            {\n                \"position\": position,\n                \"collapsed\": collapsed,\n                \"layers\": layers,\n            }\n        )\n\n        # Get current layer states for initialization\n        layer_states = {}\n        target_layers = layers if layers is not None else list(self.layer_dict.keys())\n\n        # Always include Background layer for controlling map style layers\n        if layers is None or \"Background\" in layers:\n            layer_states[\"Background\"] = {\n                \"visible\": True,\n                \"opacity\": 1.0,\n                \"name\": \"Background\",\n            }\n\n        for layer_id in target_layers:\n            if layer_id in self.layer_dict and layer_id != \"Background\":\n                layer_info = self.layer_dict[layer_id]\n                layer_states[layer_id] = {\n                    \"visible\": layer_info.get(\"visible\", True),\n                    \"opacity\": layer_info.get(\"opacity\", 1.0),\n                    \"name\": layer_id,  # Use layer_id as display name by default\n                }\n\n        control_options[\"layerStates\"] = layer_states\n\n        # Store control in persistent state\n        control_key = f\"layer_control_{position}\"\n        current_controls = dict(self._controls)\n        current_controls[control_key] = {\n            \"type\": \"layer_control\",\n            \"position\": position,\n            \"options\": control_options,\n        }\n        self._controls = current_controls\n\n        self.call_js_method(\"addControl\", \"layer_control\", control_options)\n\n    def add_geocoder_control(\n        self,\n        position: str = \"top-left\",\n        api_config: Optional[Dict[str, Any]] = None,\n        options: Optional[Dict[str, Any]] = None,\n        collapsed: bool = True,\n    ) -&gt; None:\n        \"\"\"Add a geocoder control to the map for searching locations.\n\n        The geocoder control allows users to search for locations using a geocoding service.\n        By default, it uses the Nominatim (OpenStreetMap) geocoding API.\n\n        Args:\n            position: Position on map ('top-left', 'top-right', 'bottom-left', 'bottom-right')\n            api_config: Configuration for the geocoding API. If None, uses default Nominatim config\n            options: Additional options for the geocoder control\n            collapsed: If True, shows only search icon initially. Click to expand input box.\n        \"\"\"\n        if api_config is None:\n            # Default configuration using Nominatim API\n            api_config = {\n                \"forwardGeocode\": True,\n                \"reverseGeocode\": False,\n                \"placeholder\": \"Search for places...\",\n                \"limit\": 5,\n                \"api_url\": \"https://nominatim.openstreetmap.org/search\",\n            }\n\n        control_options = options or {}\n        control_options.update(\n            {\n                \"position\": position,\n                \"api_config\": api_config,\n                \"collapsed\": collapsed,\n            }\n        )\n\n        # Store control in persistent state\n        control_key = f\"geocoder_{position}\"\n        current_controls = dict(self._controls)\n        current_controls[control_key] = {\n            \"type\": \"geocoder\",\n            \"position\": position,\n            \"options\": control_options,\n        }\n        self._controls = current_controls\n\n        self.call_js_method(\"addControl\", \"geocoder\", control_options)\n\n    def add_maplibre_geocoder(\n        self,\n        position: str = \"top-left\",\n        api_key: Optional[str] = None,\n        maplibre_api: str = \"maptiler\",\n        language: Optional[str] = None,\n        placeholder: str = \"Search\",\n        proximity: Optional[List[float]] = None,\n        bbox: Optional[List[float]] = None,\n        country: Optional[str] = None,\n        types: Optional[str] = None,\n        limit: int = 5,\n        marker: bool = True,\n        show_result_markers: bool = True,\n        collapsed: bool = False,\n        clear_on_blur: bool = False,\n        clear_and_blur_on_esc: bool = False,\n        enable_event_logging: bool = False,\n        min_length: int = 2,\n        options: Optional[Dict[str, Any]] = None,\n    ) -&gt; None:\n        \"\"\"Add MapLibre GL Geocoder control to the map.\n\n        The MapLibre GL Geocoder is a geocoder control for MapLibre GL that supports\n        various geocoding APIs including Maptiler, Mapbox, and others. It provides a\n        search interface for finding locations and can display markers for search results.\n\n        See: https://github.com/maplibre/maplibre-gl-geocoder\n\n        Args:\n            position: Position on map ('top-left', 'top-right', 'bottom-left', 'bottom-right')\n            api_key: API key for the geocoding service (required for most services)\n            maplibre_api: Geocoding API to use ('maptiler', 'mapbox', or custom)\n            language: Language code for results (e.g., 'en', 'es', 'fr')\n            placeholder: Placeholder text in the search input\n            proximity: [lng, lat] to bias results towards this location\n            bbox: [minLng, minLat, maxLng, maxLat] to limit results to this bounding box\n            country: Country code(s) to limit results (e.g., 'us' or 'us,ca')\n            types: Comma-separated types to filter results (e.g., 'country,region,place')\n            limit: Maximum number of results to return\n            marker: Whether to add a marker at the geocoded location\n            show_result_markers: Whether to show markers for all search results\n            collapsed: Whether the control should start collapsed\n            clear_on_blur: Clear the input when it loses focus\n            clear_and_blur_on_esc: Clear input and remove focus when ESC is pressed\n            enable_event_logging: Enable console logging of geocoder events\n            min_length: Minimum number of characters to trigger search\n            options: Additional options passed to the MaplibreGeocoder constructor\n\n        Example:\n            ```python\n            m = MapLibreMap(center=[-87.61694, 41.86625], zoom=10)\n            m.add_maplibre_geocoder(\n                position=\"top-left\",\n                api_key=\"your_api_key\",\n                maplibre_api=\"maptiler\",\n                language=\"en\",\n                country=\"us\"\n            )\n            ```\n        \"\"\"\n        geocoder_config: Dict[str, Any] = options or {}\n\n        # Build configuration\n        geocoder_config.update(\n            {\n                \"position\": position,\n                \"maplibregl\": True,  # Signal to use maplibregl\n                \"placeholder\": placeholder,\n                \"limit\": limit,\n                \"marker\": marker,\n                \"showResultMarkers\": show_result_markers,\n                \"collapsed\": collapsed,\n                \"clearOnBlur\": clear_on_blur,\n                \"clearAndBlurOnEsc\": clear_and_blur_on_esc,\n                \"enableEventLogging\": enable_event_logging,\n                \"minLength\": min_length,\n            }\n        )\n\n        if api_key:\n            geocoder_config[\"apiKey\"] = api_key\n\n        if maplibre_api:\n            geocoder_config[\"maplibreApi\"] = maplibre_api\n\n        if language:\n            geocoder_config[\"language\"] = language\n\n        if proximity:\n            if len(proximity) != 2:\n                raise ValueError(\n                    \"proximity must be a list of two floats: [longitude, latitude]\"\n                )\n            geocoder_config[\"proximity\"] = proximity\n\n        if bbox:\n            if len(bbox) != 4:\n                raise ValueError(\n                    \"bbox must be a list of four floats: [minLng, minLat, maxLng, maxLat]\"\n                )\n            geocoder_config[\"bbox\"] = bbox\n\n        if country:\n            geocoder_config[\"country\"] = country\n\n        if types:\n            geocoder_config[\"types\"] = types\n\n        # Store control state\n        control_key = f\"maplibre_geocoder_{position}\"\n        current_controls = dict(self._controls)\n        current_controls[control_key] = {\n            \"type\": \"maplibre_geocoder\",\n            \"position\": position,\n            \"options\": geocoder_config,\n        }\n        self._controls = current_controls\n\n        self.call_js_method(\"addControl\", \"maplibre_geocoder\", geocoder_config)\n\n    def add_export_control(\n        self,\n        position: str = \"top-right\",\n        filename: str = \"map\",\n        page_size: Optional[Sequence[Union[int, float]]] = None,\n        page_orientation: str = \"landscape\",\n        default_format: str = \"pdf\",\n        dpi: int = 300,\n        allowed_sizes: Optional[Sequence[str]] = None,\n        crosshair: bool = False,\n        printable_area: bool = False,\n        locale: str = \"en\",\n        options: Optional[Dict[str, Any]] = None,\n        collapsed: bool = True,\n    ) -&gt; None:\n        \"\"\"Add an export control for saving the map as images or PDF.\n\n        This control leverages the `@watergis/maplibre-gl-export` plugin to provide an\n        interactive, collapsible button that lets users export the current map view as\n        PNG, JPEG, PDF, or SVG files. The control appears alongside other MapLibre\n        controls and opens a small panel when toggled.\n\n        Args:\n            position: Placement of the control on the map container.\n            filename: Default filename (without extension) suggested for exports.\n            page_size: Size of the export page in millimetres as [width, height]. If\n                omitted, the plugin defaults to A4.\n            page_orientation: Page orientation, either ``\"landscape\"`` or ``\"portrait\"``.\n            default_format: Default export format (``\"pdf\"``, ``\"png\"``, ``\"jpg\"``, ``\"svg\"``).\n            dpi: Dots per inch used when rendering the export.\n            allowed_sizes: Optional whitelist of page sizes (e.g. ``[\"A4\", \"LETTER\"]``).\n            crosshair: Whether to show the crosshair overlay when the panel is open.\n            printable_area: Whether to show the printable area overlay when the panel is open.\n            locale: Two-letter locale code for the control's UI language.\n            options: Extra keyword arguments forwarded to the export plugin.\n            collapsed: Whether the control should start collapsed (button only).\n        \"\"\"\n\n        orientation_value = page_orientation.lower()\n        if orientation_value not in {\"landscape\", \"portrait\"}:\n            raise ValueError(\"page_orientation must be 'landscape' or 'portrait'\")\n\n        format_value = default_format.lower()\n        if format_value not in {\"png\", \"jpg\", \"jpeg\", \"pdf\", \"svg\"}:\n            raise ValueError(\n                \"default_format must be one of {'png', 'jpg', 'jpeg', 'pdf', 'svg'}\"\n            )\n        # Normalise JPEG alias\n        if format_value == \"jpeg\":\n            format_value = \"jpg\"\n\n        control_options: Dict[str, Any] = dict(options or {})\n        clean_filename = (\n            filename.strip() if isinstance(filename, str) else str(filename)\n        )\n        clean_locale = (\n            locale.strip().lower() if isinstance(locale, str) else str(locale).lower()\n        )\n\n        control_options[\"position\"] = position\n        control_options.setdefault(\"Filename\", clean_filename or \"map\")\n        control_options.setdefault(\"PageOrientation\", orientation_value)\n        control_options.setdefault(\"Format\", format_value)\n        control_options.setdefault(\"DPI\", int(dpi))\n        control_options.setdefault(\"Crosshair\", bool(crosshair))\n        control_options.setdefault(\"PrintableArea\", bool(printable_area))\n        control_options.setdefault(\"Locale\", clean_locale or \"en\")\n        control_options[\"collapsed\"] = collapsed\n\n        if page_size is not None:\n            page_size_values = list(page_size)\n            if len(page_size_values) != 2:\n                raise ValueError(\n                    \"page_size must contain exactly two values [width, height]\"\n                )\n            control_options[\"PageSize\"] = [\n                float(page_size_values[0]),\n                float(page_size_values[1]),\n            ]\n\n        if allowed_sizes is not None:\n            control_options[\"AllowedSizes\"] = [\n                size.upper() for size in allowed_sizes if isinstance(size, str)\n            ]\n\n        control_key = f\"export_{position}\"\n        current_controls = dict(self._controls)\n        current_controls[control_key] = {\n            \"type\": \"export\",\n            \"position\": position,\n            \"options\": control_options,\n        }\n        self._controls = current_controls\n\n        self.call_js_method(\"addControl\", \"export\", control_options)\n\n    def add_geogrid_control(\n        self,\n        position: str = \"top-left\",\n        before_layer_id: Optional[str] = None,\n        zoom_level_range: Optional[Sequence[Union[int, float]]] = None,\n        grid_style: Optional[Dict[str, Any]] = None,\n        label_style: Optional[Dict[str, Any]] = None,\n        options: Optional[Dict[str, Any]] = None,\n    ) -&gt; None:\n        \"\"\"Add a geographic grid (graticule) with labeled coordinates to the map.\n\n        This control uses the `geogrid-maplibre-gl` plugin to display latitude/longitude\n        grid lines with customizable styling and formatting. The grid dynamically adjusts\n        based on zoom level and supports globe projection (MapLibre GL 5.x).\n\n        Args:\n            position: Placement of the control on the map container (not applicable\n                for this plugin, but kept for API consistency).\n            before_layer_id: ID of the layer to insert the grid beneath. If None,\n                the grid is added as the top layer.\n            zoom_level_range: Tuple of [min_zoom, max_zoom] defining visibility range.\n                If None, the grid is visible at all zoom levels.\n            grid_style: Styling options for grid lines. Supports both MapLibre paint\n                properties (``line-color``, ``line-width``, ``line-dasharray``,\n                ``line-opacity``) and GeoGrid native properties (``color``, ``width``,\n                ``dasharray``, ``opacity``). MapLibre properties are automatically\n                converted to GeoGrid format.\n            label_style: Styling options for coordinate labels. Supports CSS properties\n                like ``color``, ``fontSize``, ``textShadow``, etc.\n            options: Additional configuration options passed directly to the GeoGrid\n                constructor. Can include custom ``gridDensity`` or ``formatLabels`` functions.\n\n        Example:\n            &gt;&gt;&gt; m = MapLibreMap(center=[0, 20], zoom=2)\n            &gt;&gt;&gt; # Using MapLibre paint properties\n            &gt;&gt;&gt; m.add_geogrid_control(grid_style={'line-color': '#ff0000', 'line-width': 2})\n            &gt;&gt;&gt; # Using GeoGrid native properties\n            &gt;&gt;&gt; m.add_geogrid_control(grid_style={'color': 'red', 'width': 2})\n        \"\"\"\n\n        control_options: Dict[str, Any] = dict(options or {})\n        control_options[\"position\"] = position\n\n        if before_layer_id is not None:\n            control_options[\"beforeLayerId\"] = before_layer_id\n\n        if zoom_level_range is not None:\n            zoom_range = list(zoom_level_range)\n            if len(zoom_range) != 2:\n                raise ValueError(\n                    \"zoom_level_range must contain exactly two values [min_zoom, max_zoom]\"\n                )\n            control_options[\"zoomLevelRange\"] = [\n                float(zoom_range[0]),\n                float(zoom_range[1]),\n            ]\n\n        if grid_style is not None:\n            control_options[\"gridStyle\"] = dict(grid_style)\n\n        if label_style is not None:\n            control_options[\"labelStyle\"] = dict(label_style)\n\n        control_key = f\"geogrid_{position}\"\n        current_controls = dict(self._controls)\n        current_controls[control_key] = {\n            \"type\": \"geogrid\",\n            \"position\": position,\n            \"options\": control_options,\n        }\n        self._controls = current_controls\n\n        self.call_js_method(\"addControl\", \"geogrid\", control_options)\n\n    def remove_geogrid_control(self, position: str = \"top-left\") -&gt; None:\n        \"\"\"Remove the GeoGrid control from the map.\"\"\"\n\n        control_key = f\"geogrid_{position}\"\n        current_controls = dict(self._controls)\n        if control_key in current_controls:\n            current_controls.pop(control_key)\n            self._controls = current_controls\n        self.call_js_method(\"removeControl\", \"geogrid\", position)\n\n    def add_geoman_control(\n        self,\n        position: str = \"top-left\",\n        geoman_options: Optional[Dict[str, Any]] = None,\n        settings: Optional[Dict[str, Any]] = None,\n        controls: Optional[Dict[str, Any]] = None,\n        collapsed: Optional[bool] = False,\n    ) -&gt; None:\n        \"\"\"Add the MapLibre-Geoman drawing and editing toolkit.\n\n        Args:\n            position: Where to dock the Geoman toolbar on the map.\n            geoman_options: Raw configuration dictionary passed directly to the\n                ``Geoman`` constructor.\n            settings: Optional convenience overrides merged into\n                ``geoman_options['settings']``.\n            controls: Optional overrides for toolbar sections such as ``draw``,\n                ``edit``, or ``helper``. Each key should map to a dictionary of\n                button configuration overrides.\n            collapsed: Whether the toolbar UI should start collapsed. Use\n                ``None`` to defer to the underlying configuration.\n        \"\"\"\n\n        geoman_config: Dict[str, Any] = dict(geoman_options or {})\n\n        if settings:\n            geoman_settings = geoman_config.setdefault(\"settings\", {})\n            geoman_settings.update(settings)\n\n        # Enable snapping by default\n        geoman_controls = geoman_config.setdefault(\"controls\", {})\n        helper_controls = geoman_controls.setdefault(\"helper\", {})\n        snapping_config = helper_controls.setdefault(\"snapping\", {})\n        if \"active\" not in snapping_config:\n            snapping_config[\"active\"] = True\n\n        if controls:\n            for section, section_options in controls.items():\n                if isinstance(section_options, dict):\n                    section_config = geoman_controls.setdefault(section, {})\n                    section_config.update(section_options)\n                else:\n                    geoman_controls[section] = section_options\n\n        control_options: Dict[str, Any] = {\"position\": position}\n        if geoman_config:\n            control_options[\"geoman_options\"] = geoman_config\n\n        control_key = f\"geoman_{position}\"\n        current_controls = dict(self._controls)\n        current_controls[control_key] = {\n            \"type\": \"geoman\",\n            \"position\": position,\n            \"options\": control_options,\n        }\n        self._controls = current_controls\n        self.controls[\"geoman\"] = position\n\n        self.call_js_method(\"addControl\", \"geoman\", control_options)\n\n        if collapsed is not None:\n            if collapsed:\n                self.collapse_geoman_control()\n            else:\n                # If an explicit method to uncollapse exists, call it here.\n                # For now, this is a placeholder for future logic.\n                pass\n\n    def remove_geoman_control(self, position: str = \"top-left\") -&gt; None:\n        \"\"\"Remove the Geoman control toolbar.\"\"\"\n\n        control_key = f\"geoman_{position}\"\n        current_controls = dict(self._controls)\n        if control_key in current_controls:\n            current_controls.pop(control_key)\n            self._controls = current_controls\n        self.controls.pop(\"geoman\", None)\n        self.call_js_method(\"removeControl\", \"geoman\", position)\n\n    def set_geoman_data(self, data: Dict[str, Any]) -&gt; None:\n        \"\"\"Replace the current Geoman feature collection.\"\"\"\n\n        self.geoman_data = data or {\"type\": \"FeatureCollection\", \"features\": []}\n\n    def clear_geoman_data(self) -&gt; None:\n        \"\"\"Clear all Geoman-managed features.\"\"\"\n\n        self.set_geoman_data({\"type\": \"FeatureCollection\", \"features\": []})\n\n    def get_geoman_data(\n        self,\n    ) -&gt; Dict[str, Any]:\n        \"\"\"Return the current Geoman feature collection.\n\n        Returns:\n            A GeoJSON FeatureCollection containing all Geoman-managed features.\n\n        \"\"\"\n\n        return self.geoman_data\n\n    def collapse_geoman_control(self) -&gt; None:\n        \"\"\"Collapse the Geoman draw control toolbar.\"\"\"\n\n        self.call_js_method(\"collapseGeomanControl\")\n\n    def expand_geoman_control(self) -&gt; None:\n        \"\"\"Expand the Geoman draw control toolbar.\"\"\"\n\n        self.call_js_method(\"expandGeomanControl\")\n\n    def toggle_geoman_control(self) -&gt; None:\n        \"\"\"Toggle the Geoman draw control toolbar between collapsed and expanded states.\"\"\"\n\n        self.call_js_method(\"toggleGeomanControl\")\n\n    def add_measures_control(\n        self,\n        position: str = \"top-left\",\n        units: str = \"metric\",\n        area_button_title: Optional[str] = None,\n        length_button_title: Optional[str] = None,\n        clear_button_title: Optional[str] = None,\n        options: Optional[Dict[str, Any]] = None,\n    ) -&gt; None:\n        \"\"\"Add the MapLibre GL Measures control for distance and area measurement.\n\n        This control allows users to measure distances along lines and calculate areas\n        within polygons on the map.\n\n        Args:\n            position: Position on map ('top-left', 'top-right', 'bottom-left', 'bottom-right')\n            units: Unit system for measurements, either 'metric' or 'imperial'\n            area_button_title: Custom title for the area measurement button\n            length_button_title: Custom title for the length measurement button\n            clear_button_title: Custom title for the clear measurements button\n            options: Additional options for the measures control (styling, callbacks, etc.)\n        \"\"\"\n        if units not in {\"metric\", \"imperial\"}:\n            raise ValueError(\"units must be either 'metric' or 'imperial'\")\n\n        measures_config: Dict[str, Any] = dict(options or {})\n\n        # Set unit system\n        measures_config[\"units\"] = units\n\n        # Set custom button titles if provided\n        if area_button_title is not None:\n            measures_config[\"areaMeasurementButtonTitle\"] = area_button_title\n        if length_button_title is not None:\n            measures_config[\"lengthMeasurementButtonTitle\"] = length_button_title\n        if clear_button_title is not None:\n            measures_config[\"clearMeasurementsButtonTitle\"] = clear_button_title\n\n        control_options: Dict[str, Any] = {\n            \"position\": position,\n            \"measures_options\": measures_config,\n        }\n\n        control_key = f\"measures_{position}\"\n        current_controls = dict(self._controls)\n        current_controls[control_key] = {\n            \"type\": \"measures\",\n            \"position\": position,\n            \"options\": control_options,\n        }\n        self._controls = current_controls\n        self.controls[\"measures\"] = position\n\n        self.call_js_method(\"addControl\", \"measures\", control_options)\n\n    def remove_measures_control(self, position: str = \"top-left\") -&gt; None:\n        \"\"\"Remove the Measures control.\"\"\"\n\n        control_key = f\"measures_{position}\"\n        current_controls = dict(self._controls)\n        if control_key in current_controls:\n            current_controls.pop(control_key)\n            self._controls = current_controls\n        self.controls.pop(\"measures\", None)\n        self.call_js_method(\"removeControl\", \"measures\", position)\n\n    def add_google_streetview(\n        self,\n        position: str = \"top-left\",\n        api_key: Optional[str] = None,\n        options: Optional[Dict[str, Any]] = None,\n    ) -&gt; None:\n        \"\"\"Add a Google Street View control to the map.\n\n        This method adds a Google Street View control that allows users to view\n        street-level imagery at clicked locations on the map.\n\n        Args:\n            position: Position on map ('top-left', 'top-right', 'bottom-left', 'bottom-right')\n            api_key: Google Maps API key. If None, retrieves from GOOGLE_MAPS_API_KEY environment variable\n            options: Additional options for the Street View control\n\n        Raises:\n            ValueError: If no API key is provided and none can be found in environment variables\n        \"\"\"\n        if api_key is None:\n            api_key = utils.get_env_var(\"GOOGLE_MAPS_API_KEY\")\n            if api_key is None:\n                raise ValueError(\n                    \"Google Maps API key is required. Please provide it as a parameter \"\n                    \"or set the GOOGLE_MAPS_API_KEY environment variable.\"\n                )\n\n        control_options = options or {}\n        control_options.update(\n            {\n                \"position\": position,\n                \"api_key\": api_key,\n            }\n        )\n\n        # Store control in persistent state\n        control_key = f\"google_streetview_{position}\"\n        current_controls = dict(self._controls)\n        current_controls[control_key] = {\n            \"type\": \"google_streetview\",\n            \"position\": position,\n            \"options\": control_options,\n        }\n        self._controls = current_controls\n\n        self.call_js_method(\"addControl\", \"google_streetview\", control_options)\n\n    def _update_layer_controls(self) -&gt; None:\n        \"\"\"Update all existing layer controls with the current layer state.\"\"\"\n        # Find all layer controls in the _controls dictionary\n        for control_key, control_config in self._controls.items():\n            if control_config.get(\"type\") == \"layer_control\":\n                # Update the layerStates in the control options\n                control_options = control_config.get(\"options\", {})\n                layers_filter = control_options.get(\"layers\")\n\n                # Get current layer states for this control\n                layer_states = {}\n                target_layers = (\n                    layers_filter\n                    if layers_filter is not None\n                    else list(self.layer_dict.keys())\n                )\n\n                # Always include Background layer for controlling map style layers\n                if layers_filter is None or \"Background\" in layers_filter:\n                    layer_states[\"Background\"] = {\n                        \"visible\": True,\n                        \"opacity\": 1.0,\n                        \"name\": \"Background\",\n                    }\n\n                for layer_id in target_layers:\n                    if layer_id in self.layer_dict and layer_id != \"Background\":\n                        layer_info = self.layer_dict[layer_id]\n                        layer_states[layer_id] = {\n                            \"visible\": layer_info.get(\"visible\", True),\n                            \"opacity\": layer_info.get(\"opacity\", 1.0),\n                            \"name\": layer_id,\n                        }\n\n                # Update the control options with new layer states\n                control_options[\"layerStates\"] = layer_states\n\n                # Update the control configuration\n                control_config[\"options\"] = control_options\n\n        # Trigger the JavaScript layer control to check for new layers\n        # by updating the _layer_dict trait that the JS listens to\n        self._layer_dict = dict(self.layer_dict)\n\n    def remove_layer(self, layer_id: str) -&gt; None:\n        \"\"\"Remove a layer from the map.\n\n        Args:\n            layer_id: Unique identifier for the layer to remove.\n        \"\"\"\n        # Remove from JavaScript map\n        self.call_js_method(\"removeLayer\", layer_id)\n\n        # Remove from local state\n        if layer_id in self._layers:\n            current_layers = dict(self._layers)\n            del current_layers[layer_id]\n            self._layers = current_layers\n\n        # Remove FlatGeobuf metadata if present\n        if layer_id in self.flatgeobuf_layers:\n            self.call_js_method(\"removeFlatGeobufLayer\", layer_id)\n            flatgeobuf_layers = dict(self.flatgeobuf_layers)\n            del flatgeobuf_layers[layer_id]\n            self.flatgeobuf_layers = flatgeobuf_layers\n\n        # Remove from layer_dict\n        if layer_id in self.layer_dict:\n            del self.layer_dict[layer_id]\n\n        # Update layer controls if they exist\n        self._update_layer_controls()\n\n    def add_cog_layer(\n        self,\n        layer_id: str,\n        cog_url: str,\n        opacity: Optional[float] = 1.0,\n        visible: Optional[bool] = True,\n        paint: Optional[Dict[str, Any]] = None,\n        before_id: Optional[str] = None,\n        titiler_endpoint: Optional[str] = None,\n        fit_bounds: bool = True,\n        **kwargs: Any,\n    ) -&gt; None:\n        \"\"\"Add a Cloud Optimized GeoTIFF (COG) layer to the map.\n\n        This method supports COGs in any coordinate reference system (CRS). For COGs\n        in EPSG:3857, it uses the maplibre-cog-protocol for direct rendering. For COGs\n        in other CRS, it uses TiTiler to reproject on-the-fly.\n\n        Args:\n            layer_id: Unique identifier for the COG layer.\n            cog_url: URL to the COG file.\n            opacity: Layer opacity between 0.0 and 1.0.\n            visible: Whether the layer should be visible initially.\n            paint: Optional paint properties for the layer.\n            before_id: Optional layer ID to insert this layer before.\n            titiler_endpoint: Optional TiTiler endpoint URL. If None, checks COG CRS\n                and uses TiTiler automatically for non-EPSG:3857 COGs. Set to a TiTiler\n                URL (e.g., \"https://giswqs-titiler-endpoint.hf.space\") to force using TiTiler.\n            fit_bounds: If True, automatically fit map bounds to COG extent.\n            **kwargs: Additional parameters passed to TiTiler (e.g., rescale, colormap,\n                bidx for band selection).\n\n        Example:\n            &gt;&gt;&gt; m = MapLibreMap()\n            &gt;&gt;&gt; # COG in EPSG:3857 (uses cog:// protocol)\n            &gt;&gt;&gt; m.add_cog_layer(\"cog1\", \"https://example.com/data_3857.tif\")\n            &gt;&gt;&gt;\n            &gt;&gt;&gt; # COG in any other CRS (uses TiTiler)\n            &gt;&gt;&gt; m.add_cog_layer(\"cog2\", \"https://example.com/data_4326.tif\")\n            &gt;&gt;&gt;\n            &gt;&gt;&gt; # Force TiTiler with custom endpoint\n            &gt;&gt;&gt; m.add_cog_layer(\n            ...     \"cog3\",\n            ...     \"https://example.com/data.tif\",\n            ...     titiler_endpoint=\"https://giswqs-titiler-endpoint.hf.space\",\n            ...     rescale=\"0,255\",\n            ...     colormap=\"viridis\"\n            ... )\n        \"\"\"\n        source_id = f\"{layer_id}_source\"\n\n        # Check if we should use TiTiler\n        use_titiler = titiler_endpoint is not None\n\n        if not use_titiler:\n            # Auto-detect if TiTiler is needed by checking COG CRS\n            try:\n                metadata = self.get_cog_metadata(cog_url, crs=None)\n                if metadata and metadata.get(\"crs\"):\n                    cog_crs = metadata[\"crs\"]\n                    # Use TiTiler if COG is not in EPSG:3857\n                    if cog_crs != \"EPSG:3857\":\n                        use_titiler = True\n                        print(f\"COG is in {cog_crs}, using TiTiler for reprojection\")\n            except Exception as e:\n                print(f\"Could not determine COG CRS, trying cog:// protocol: {e}\")\n\n        if use_titiler:\n            # Use TiTiler for on-the-fly reprojection\n            if titiler_endpoint is None:\n                titiler_endpoint = \"https://giswqs-titiler-endpoint.hf.space\"\n\n            # Build TiTiler tile URL\n            from urllib.parse import urlencode, quote\n\n            # Encode the COG URL\n            encoded_url = quote(cog_url, safe=\"\")\n\n            # Build query parameters\n            params = {\n                \"url\": cog_url,\n                \"TileMatrixSetId\": \"WebMercatorQuad\",  # Reproject to Web Mercator\n            }\n\n            # Add any additional TiTiler parameters\n            for key, value in kwargs.items():\n                params[key] = value\n\n            query_string = urlencode({k: v for k, v in params.items() if k != \"url\"})\n\n            # TiTiler tile URL format: {endpoint}/cog/tiles/WebMercatorQuad/{z}/{x}/{y}\n            tile_url = f\"{titiler_endpoint}/cog/tiles/WebMercatorQuad/{{z}}/{{x}}/{{y}}?url={encoded_url}\"\n            if query_string:\n                tile_url += f\"&amp;{query_string}\"\n\n            # print(f\"Using TiTiler: {titiler_endpoint}\")\n            # print(f\"Tile URL pattern: {tile_url[:100]}...\")\n\n            self.add_source(\n                source_id,\n                {\n                    \"type\": \"raster\",\n                    \"tiles\": [tile_url],\n                    \"tileSize\": 256,\n                    \"attribution\": \"TiTiler\",\n                },\n            )\n\n        else:\n            # Use cog:// protocol for EPSG:3857 COGs\n            cog_source_url = f\"cog://{cog_url}\"\n\n            self.add_source(\n                source_id,\n                {\n                    \"type\": \"raster\",\n                    \"url\": cog_source_url,\n                    \"tileSize\": 256,\n                },\n            )\n\n        # Add raster layer\n        layer_config = {\"id\": layer_id, \"type\": \"raster\", \"source\": source_id}\n\n        if paint:\n            layer_config[\"paint\"] = paint\n\n        self.add_layer(\n            layer=layer_config,\n            before_id=before_id,\n            layer_id=layer_id,\n            opacity=opacity,\n            visible=visible,\n        )\n\n        # Optionally fit bounds to COG extent\n        if fit_bounds:\n            try:\n                metadata = self.get_cog_metadata(cog_url, crs=\"EPSG:4326\")\n                if metadata and metadata.get(\"bbox\"):\n                    bbox = metadata[\"bbox\"]\n                    bounds = [[bbox[0], bbox[1]], [bbox[2], bbox[3]]]\n                    self.fit_bounds(bounds, padding=50)\n                    # print(f\"Map fitted to COG bounds: {bounds}\")\n            except Exception as e:\n                print(f\"Could not fit bounds to COG extent: {e}\")\n\n    def add_pmtiles(\n        self,\n        pmtiles_url: str,\n        layer_id: Optional[str] = None,\n        layers: Optional[List[Dict[str, Any]]] = None,\n        opacity: Optional[float] = 1.0,\n        visible: Optional[bool] = True,\n        before_id: Optional[str] = None,\n    ) -&gt; None:\n        \"\"\"Add PMTiles vector tiles to the map.\n\n        Args:\n            pmtiles_url: URL to the PMTiles file.\n            layer_id: Optional unique identifier for the layer. If None, uses filename.\n            layers: Optional list of layer configurations for rendering. If None, creates default layers.\n            opacity: Layer opacity between 0.0 and 1.0.\n            visible: Whether the layer should be visible initially.\n            before_id: Optional layer ID to insert this layer before.\n        \"\"\"\n        if layer_id is None:\n            layer_id = pmtiles_url.split(\"/\")[-1].replace(\".pmtiles\", \"\")\n\n        source_id = f\"{layer_id}_source\"\n\n        # Add PMTiles source using pmtiles:// protocol\n        pmtiles_source_url = f\"pmtiles://{pmtiles_url}\"\n\n        self.add_source(\n            source_id,\n            {\n                \"type\": \"vector\",\n                \"url\": pmtiles_source_url,\n                \"attribution\": \"PMTiles\",\n            },\n        )\n\n        # Add default layers if none provided\n        if layers is None:\n            layers = [\n                {\n                    \"id\": f\"{layer_id}_landuse\",\n                    \"source\": source_id,\n                    \"source-layer\": \"landuse\",\n                    \"type\": \"fill\",\n                    \"paint\": {\"fill-color\": \"steelblue\", \"fill-opacity\": 0.5},\n                },\n                {\n                    \"id\": f\"{layer_id}_roads\",\n                    \"source\": source_id,\n                    \"source-layer\": \"roads\",\n                    \"type\": \"line\",\n                    \"paint\": {\"line-color\": \"black\", \"line-width\": 1},\n                },\n                {\n                    \"id\": f\"{layer_id}_buildings\",\n                    \"source\": source_id,\n                    \"source-layer\": \"buildings\",\n                    \"type\": \"fill\",\n                    \"paint\": {\"fill-color\": \"gray\", \"fill-opacity\": 0.7},\n                },\n                {\n                    \"id\": f\"{layer_id}_water\",\n                    \"source\": source_id,\n                    \"source-layer\": \"water\",\n                    \"type\": \"fill\",\n                    \"paint\": {\"fill-color\": \"lightblue\", \"fill-opacity\": 0.8},\n                },\n            ]\n\n        # Add all layers\n        for layer_config in layers:\n            self.add_layer(\n                layer=layer_config,\n                before_id=before_id,\n                layer_id=layer_config[\"id\"],\n                opacity=opacity,\n                visible=visible,\n            )\n\n    def add_basemap(\n        self,\n        basemap: str,\n        layer_id: Optional[str] = None,\n        before_id: Optional[str] = None,\n    ) -&gt; None:\n        \"\"\"Add a basemap to the map using xyzservices providers.\n\n        Args:\n            basemap: Name of the basemap from xyzservices (e.g., \"Esri.WorldImagery\").\n                    Use available_basemaps to see all available options.\n            layer_id: Optional ID for the basemap layer. If None, uses basemap name.\n            before_id: Optional layer ID to insert this layer before.\n                      If None, layer is added on top.\n\n        Raises:\n            ValueError: If the specified basemap is not available.\n        \"\"\"\n        from .basemaps import available_basemaps\n\n        if basemap not in available_basemaps:\n            available_names = list(available_basemaps.keys())\n            raise ValueError(\n                f\"Basemap '{basemap}' not found. Available basemaps: {available_names}\"\n            )\n\n        basemap_config = available_basemaps[basemap]\n\n        # Convert xyzservices URL template to tile URL\n        tile_url = basemap_config.build_url()\n\n        # Get attribution if available\n        attribution = basemap_config.get(\"attribution\", \"\")\n        if layer_id is None:\n            layer_id = basemap\n\n        # Add as raster layer\n        self.add_tile_layer(\n            layer_id=layer_id,\n            source_url=tile_url,\n            paint={\"raster-opacity\": 1.0},\n            before_id=before_id,\n        )\n\n    def add_draw_control(\n        self,\n        position: str = \"top-left\",\n        controls: Optional[Dict[str, bool]] = None,\n        default_mode: str = \"simple_select\",\n        keybindings: bool = True,\n        touch_enabled: bool = True,\n        preserve_selection_on_edit: bool = True,\n        styles: Optional[List[Dict[str, Any]]] = None,\n        **kwargs: Any,\n    ) -&gt; None:\n        \"\"\"Add a draw control to the map for drawing and editing geometries.\n\n        Args:\n            position: Position on map ('top-left', 'top-right', 'bottom-left', 'bottom-right')\n            controls: Dictionary specifying which drawing tools to show.\n                     Defaults to {'point': True, 'line_string': True, 'polygon': True, 'trash': True}\n            default_mode: Initial interaction mode ('simple_select', 'direct_select', 'draw_point', etc.)\n            keybindings: Whether to enable keyboard shortcuts\n            touch_enabled: Whether to enable touch interactions\n            preserve_selection_on_edit: Whether to keep features selected during vertex editing/moving.\n                                       If True, features remain selected after editing. If False, uses\n                                       default MapboxDraw behavior (deselection after edit).\n            styles: Optional list of custom MapboxDraw style objects. If None, uses default styles.\n                   Each style should be a dict with 'id', 'type', 'filter', and 'paint'/'layout' properties.\n                   See MapboxDraw documentation for style object format.\n            **kwargs: Additional options to pass to MapboxDraw constructor\n        \"\"\"\n        if controls is None:\n            controls = {\n                \"point\": True,\n                \"line_string\": True,\n                \"polygon\": True,\n                \"trash\": True,\n            }\n\n        draw_options = {\n            \"displayControlsDefault\": False,\n            \"controls\": controls,\n            \"defaultMode\": default_mode,\n            \"keybindings\": keybindings,\n            \"touchEnabled\": touch_enabled,\n            \"position\": position,\n            \"preserveSelectionOnEdit\": preserve_selection_on_edit,\n            \"customStyles\": styles,\n            **kwargs,\n        }\n\n        # Store draw control configuration\n        current_controls = dict(self._controls)\n        draw_key = f\"draw_{position}\"\n        current_controls[draw_key] = {\n            \"type\": \"draw\",\n            \"position\": position,\n            \"options\": draw_options,\n        }\n        self._controls = current_controls\n\n        self.call_js_method(\"addDrawControl\", draw_options)\n\n    # Draw styles moved to draw_styles.py module\n\n    def load_draw_data(self, geojson_data: Union[Dict[str, Any], str]) -&gt; None:\n        \"\"\"Load GeoJSON data into the draw control.\n\n        Args:\n            geojson_data: GeoJSON data as dictionary or JSON string\n        \"\"\"\n        if isinstance(geojson_data, str):\n            geojson_data = json.loads(geojson_data)\n\n        # Update the trait immediately to ensure consistency\n        self._draw_data = geojson_data\n\n        # Send to JavaScript\n        self.call_js_method(\"loadDrawData\", geojson_data)\n\n    def add_draw_data(self, geojson_data: Union[Dict[str, Any], str]) -&gt; None:\n        \"\"\"Add GeoJSON features to the existing draw control data.\n\n        This method appends new features to the draw control without clearing\n        existing drawn features, unlike load_draw_data which replaces all data.\n\n        Args:\n            geojson_data: GeoJSON data as dictionary or JSON string. Can be a\n                         FeatureCollection or a single Feature.\n        \"\"\"\n        if isinstance(geojson_data, str):\n            geojson_data = json.loads(geojson_data)\n\n        # Normalize input to FeatureCollection if it's a single Feature\n        if geojson_data.get(\"type\") == \"Feature\":\n            geojson_data = {\"type\": \"FeatureCollection\", \"features\": [geojson_data]}\n\n        # Send to JavaScript - it will handle adding features and syncing back the data\n        self.call_js_method(\"addDrawData\", geojson_data)\n\n    def get_draw_data(self) -&gt; Dict[str, Any]:\n        \"\"\"Get all drawn features as GeoJSON.\n\n        Returns:\n            Dict containing GeoJSON FeatureCollection with drawn features\n        \"\"\"\n        # Try to get current data first\n        if self._draw_data:\n            return self._draw_data\n\n        # If no data in trait, call JavaScript to get fresh data\n        self.call_js_method(\"getDrawData\")\n        # Give JavaScript time to execute and sync data\n        import time\n\n        time.sleep(0.2)\n\n        # Return the synced data or empty FeatureCollection if nothing\n        return (\n            self._draw_data\n            if self._draw_data\n            else {\"type\": \"FeatureCollection\", \"features\": []}\n        )\n\n    @property\n    def draw_data(self) -&gt; Dict[str, Any]:\n        \"\"\"Get the current draw data as GeoJSON.\"\"\"\n        return self.get_draw_data()\n\n    def clear_draw_data(self) -&gt; None:\n        \"\"\"Clear all drawn features from the draw control.\"\"\"\n        # Clear the trait data immediately\n        self._draw_data = {\"type\": \"FeatureCollection\", \"features\": []}\n\n        # Clear in JavaScript\n        self.call_js_method(\"clearDrawData\")\n\n    def delete_draw_features(self, feature_ids: List[str]) -&gt; None:\n        \"\"\"Delete specific features from the draw control.\n\n        Args:\n            feature_ids: List of feature IDs to delete\n        \"\"\"\n        self.call_js_method(\"deleteDrawFeatures\", feature_ids)\n\n    def set_draw_mode(self, mode: str) -&gt; None:\n        \"\"\"Set the draw control mode.\n\n        Args:\n            mode: Draw mode ('simple_select', 'direct_select', 'draw_point',\n                 'draw_line_string', 'draw_polygon', 'static')\n        \"\"\"\n        self.call_js_method(\"setDrawMode\", mode)\n\n    def save_draw_data(self, filepath: str, driver: Optional[str] = None) -&gt; None:\n        \"\"\"Save drawn features to a file in various formats.\n\n        Args:\n            filepath: Path where to save the file. The file extension determines\n                     the output format if driver is not specified.\n            driver: GeoPandas driver name (e.g., 'GeoJSON', 'ESRI Shapefile', 'GPKG').\n                   If None, inferred from file extension.\n\n        Raises:\n            ImportError: If geopandas is not installed.\n            ValueError: If no drawn features exist or invalid driver/format.\n\n        Note:\n            For shapefiles, all features must have the same geometry type.\n            Use GeoJSON or GPKG formats for mixed geometry types.\n        \"\"\"\n        if not HAS_GEOPANDAS:\n            raise ImportError(\n                \"geopandas is required for save_draw_data. \"\n                \"Install it with: pip install geopandas\"\n            )\n\n        # Get the drawn features\n        draw_data = self.get_draw_data()\n\n        if not draw_data or not draw_data.get(\"features\"):\n            raise ValueError(\"No drawn features to save\")\n\n        # Convert to GeoDataFrame\n        gdf = gpd.GeoDataFrame.from_features(draw_data[\"features\"])\n\n        # Set a default CRS if not present\n        if gdf.crs is None:\n            gdf.set_crs(\"EPSG:4326\", inplace=True)\n\n        # Save to file\n        try:\n            gdf.to_file(filepath, driver=driver)\n        except Exception as e:\n            # Provide helpful error message for common shapefile issues\n            if \"shapefile\" in str(e).lower() or (\n                driver and \"shapefile\" in driver.lower()\n            ):\n                geometry_types = gdf.geometry.geom_type.unique()\n                if len(geometry_types) &gt; 1:\n                    raise ValueError(\n                        f\"Cannot save mixed geometry types {list(geometry_types)} to shapefile. \"\n                        \"Use GeoJSON (.geojson) or GeoPackage (.gpkg) format instead.\"\n                    ) from e\n            raise e\n\n    def add_terra_draw(\n        self,\n        position: str = \"top-left\",\n        modes: Optional[List[str]] = None,\n        open: bool = True,\n        **kwargs: Any,\n    ) -&gt; None:\n        \"\"\"Add a Terra Draw control to the map for drawing and editing geometries.\n\n        Args:\n            position: Position on map ('top-left', 'top-right', 'bottom-left', 'bottom-right')\n            modes: List of drawing modes to enable. Available modes:\n                  ['render', 'point', 'linestring', 'polygon', 'rectangle', 'circle',\n                   'freehand', 'angled-rectangle', 'sensor', 'sector', 'select',\n                   'delete-selection', 'delete', 'download']\n                  Defaults to all modes except 'render'\n            open: Whether the draw control panel should be open by default\n            **kwargs: Additional options to pass to Terra Draw constructor\n        \"\"\"\n        if modes is None:\n            modes = [\n                # 'render',  # Commented out to always show drawing tool\n                \"point\",\n                \"linestring\",\n                \"polygon\",\n                \"rectangle\",\n                \"circle\",\n                \"freehand\",\n                \"angled-rectangle\",\n                \"sensor\",\n                \"sector\",\n                \"select\",\n                \"delete-selection\",\n                \"delete\",\n                \"download\",\n            ]\n\n        terra_draw_options = {\n            \"modes\": modes,\n            \"open\": open,\n            \"position\": position,\n            **kwargs,\n        }\n\n        # Mark that Terra Draw is enabled\n        self._terra_draw_enabled = True\n\n        # Store Terra Draw control configuration\n        current_controls = dict(self._controls)\n        terra_draw_key = f\"terra_draw_{position}\"\n        current_controls[terra_draw_key] = {\n            \"type\": \"terra_draw\",\n            \"position\": position,\n            \"options\": terra_draw_options,\n        }\n        self._controls = current_controls\n\n        self.call_js_method(\"addTerraDrawControl\", terra_draw_options)\n\n    def get_terra_draw_data(self) -&gt; Dict[str, Any]:\n        \"\"\"Get all Terra Draw features as GeoJSON.\n\n        Returns:\n            Dict containing GeoJSON FeatureCollection with drawn features\n        \"\"\"\n        # Try to get current data first\n        if self._terra_draw_data:\n            return self._terra_draw_data\n\n        # If no data in trait, call JavaScript to get fresh data\n        self.call_js_method(\"getTerraDrawData\")\n        # Give JavaScript time to execute and sync data\n        import time\n\n        time.sleep(0.2)\n\n        # Return the synced data or empty FeatureCollection if nothing\n        return (\n            self._terra_draw_data\n            if self._terra_draw_data\n            else {\"type\": \"FeatureCollection\", \"features\": []}\n        )\n\n    def clear_terra_draw_data(self) -&gt; None:\n        \"\"\"Clear all Terra Draw features from the draw control.\"\"\"\n        # Clear the trait data immediately\n        self._terra_draw_data = {\"type\": \"FeatureCollection\", \"features\": []}\n\n        # Clear in JavaScript\n        self.call_js_method(\"clearTerraDrawData\")\n\n    def load_terra_draw_data(self, geojson_data: Union[Dict[str, Any], str]) -&gt; None:\n        \"\"\"Load GeoJSON data into the Terra Draw control.\n\n        Args:\n            geojson_data: GeoJSON data as dictionary or JSON string\n        \"\"\"\n        if isinstance(geojson_data, str):\n            geojson_data = json.loads(geojson_data)\n\n        # Update the trait immediately to ensure consistency\n        self._terra_draw_data = geojson_data\n\n        # Send to JavaScript\n        self.call_js_method(\"loadTerraDrawData\", geojson_data)\n\n    def _generate_html_template(\n        self, map_state: Dict[str, Any], title: str, **kwargs: Any\n    ) -&gt; str:\n        \"\"\"Generate HTML template for MapLibre GL JS.\n\n        Args:\n            map_state: Dictionary containing the current map state including\n                      center, zoom, style, layers, and sources.\n            title: Title for the HTML page.\n            **kwargs: Additional arguments for template customization.\n\n        Returns:\n            Complete HTML string for a standalone MapLibre GL JS map.\n        \"\"\"\n        import os\n\n        # Get the directory of the current file\n        current_dir = os.path.dirname(os.path.abspath(__file__))\n        template_path = os.path.join(current_dir, \"templates\", \"maplibre_template.html\")\n\n        # Read the template file\n        with open(template_path, \"r\", encoding=\"utf-8\") as f:\n            template_content = f.read()\n\n        # Serialize map state for JavaScript\n        map_state_json = json.dumps(map_state, indent=2)\n\n        # Replace placeholders with actual values\n        html_template = template_content.format(\n            title=title,\n            width=map_state[\"width\"],\n            height=map_state[\"height\"],\n            map_state_json=map_state_json,\n        )\n\n        return html_template\n\n    def _update_current_state(self, event: Dict[str, Any]) -&gt; None:\n        \"\"\"Update current state attributes from moveend event.\"\"\"\n        if \"center\" in event:\n            self._current_center = event[\"center\"]\n        if \"zoom\" in event:\n            self._current_zoom = event[\"zoom\"]\n        if \"bearing\" in event:\n            self._current_bearing = event[\"bearing\"]\n        if \"pitch\" in event:\n            self._current_pitch = event[\"pitch\"]\n        if \"bounds\" in event:\n            self._current_bounds = event[\"bounds\"]\n\n    def set_center(self, lng: float, lat: float) -&gt; None:\n        \"\"\"Set the map center coordinates.\n\n        Args:\n            lng: Longitude coordinate.\n            lat: Latitude coordinate.\n        \"\"\"\n        self.center = [lng, lat]\n        self._current_center = [lng, lat]\n\n    def set_zoom(self, zoom: float) -&gt; None:\n        \"\"\"Set the map zoom level.\n\n        Args:\n            zoom: Zoom level (typically 0-20).\n        \"\"\"\n        self.zoom = zoom\n        self._current_zoom = zoom\n\n    @property\n    def current_center(self) -&gt; List[float]:\n        \"\"\"Get the current map center coordinates as [longitude, latitude].\"\"\"\n        return self._current_center\n\n    @property\n    def current_zoom(self) -&gt; float:\n        \"\"\"Get the current map zoom level.\"\"\"\n        return self._current_zoom\n\n    @property\n    def current_bounds(self) -&gt; Optional[List[List[float]]]:\n        \"\"\"Get the current map bounds as [[lng, lat], [lng, lat]] (southwest, northeast).\"\"\"\n        return self._current_bounds\n\n    @property\n    def viewstate(self) -&gt; Dict[str, Any]:\n        \"\"\"Get the current map viewstate including center, zoom, bearing, pitch, and bounds.\"\"\"\n        return {\n            \"center\": self._current_center,\n            \"zoom\": self._current_zoom,\n            \"bearing\": self._current_bearing,\n            \"pitch\": self._current_pitch,\n            \"bounds\": self._current_bounds,\n        }\n\n    def get_cog_metadata(\n        self, url: str, crs: str = \"EPSG:4326\"\n    ) -&gt; Optional[Dict[str, Any]]:\n        \"\"\"Retrieve metadata from a Cloud Optimized GeoTIFF (COG) file.\n\n        This method fetches metadata from a COG file. It uses rasterio if available,\n        which provides comprehensive metadata extraction capabilities.\n\n        Note:\n            This feature corresponds to the getCogMetadata function in maplibre-cog-protocol,\n            which is marked as [unstable]. Some metadata internals may change in future releases.\n\n        Args:\n            url (str): The URL of the COG file to retrieve metadata from.\n            crs (str, optional): The coordinate reference system to use for the output bbox.\n                Defaults to \"EPSG:4326\" (WGS84 lat/lon). Set to None to use the COG's native CRS.\n\n        Returns:\n            Optional[Dict[str, Any]]: A dictionary containing COG metadata with keys such as:\n                - bbox: Bounding box coordinates [west, south, east, north] in the specified CRS\n                - bounds: BoundingBox in native CRS\n                - width: Width of the raster in pixels\n                - height: Height of the raster in pixels\n                - crs: Original coordinate reference system of the COG\n                - output_crs: CRS of the returned bbox\n                - transform: Affine transformation matrix\n                - count: Number of bands\n                - dtypes: Data types for each band\n                - nodata: NoData value\n                - scale: Scale value (if available)\n                - offset: Offset value (if available)\n            Returns None if metadata retrieval fails.\n\n        Example:\n            &gt;&gt;&gt; m = MapLibreMap()\n            &gt;&gt;&gt; url = \"https://example.com/data.tif\"\n            &gt;&gt;&gt; # Get metadata with bbox in WGS84 (default)\n            &gt;&gt;&gt; metadata = m.get_cog_metadata(url)\n            &gt;&gt;&gt; if metadata:\n            ...     print(f\"Bounding box (WGS84): {metadata.get('bbox')}\")\n            ...     # Fit bounds using WGS84 coordinates\n            ...     bbox = metadata['bbox']\n            ...     m.fit_bounds([[bbox[0], bbox[1]], [bbox[2], bbox[3]]])\n            &gt;&gt;&gt;\n            &gt;&gt;&gt; # Get metadata in native CRS\n            &gt;&gt;&gt; metadata = m.get_cog_metadata(url, crs=None)\n            &gt;&gt;&gt; if metadata:\n            ...     print(f\"Native CRS: {metadata.get('crs')}\")\n        \"\"\"\n        return utils.get_cog_metadata(url, crs=crs)\n\n    def add_basemap_control(\n        self,\n        position: str = \"top-right\",\n        basemaps: Optional[List[str]] = None,\n        labels: Optional[Dict[str, str]] = None,\n        initial_basemap: Optional[str] = None,\n        expand_direction: str = \"down\",\n        options: Optional[Dict[str, Any]] = None,\n    ) -&gt; None:\n        \"\"\"Add a basemap control to the map for switching between different basemaps.\n\n        The basemap control allows users to switch between different basemap providers\n        using a dropdown or expandable control. It uses the maplibre-gl-basemaps library.\n\n        Args:\n            position: Position on map ('top-left', 'top-right', 'bottom-left', 'bottom-right')\n            basemaps: List of basemap names to include. If None, uses a default set.\n                     Available basemaps can be found in anymap.basemaps.available_basemaps\n            labels: Dictionary mapping basemap names to display labels. If None, uses basemap names.\n            initial_basemap: Name of the initial basemap to show. If None, uses the first basemap.\n            expand_direction: Direction to expand the control ('up', 'down', 'left', 'right')\n            options: Additional options for the basemap control\n\n        Example:\n            &gt;&gt;&gt; m = MapLibreMap()\n            &gt;&gt;&gt; m.add_basemap_control(\n            ...     position=\"top-right\",\n            ...     basemaps=[\"OpenStreetMap.Mapnik\", \"Esri.WorldImagery\", \"CartoDB.DarkMatter\"],\n            ...     labels={\"OpenStreetMap.Mapnik\": \"OpenStreetMap\", \"Esri.WorldImagery\": \"Satellite\"},\n            ...     initial_basemap=\"OpenStreetMap.Mapnik\"\n            ... )\n        \"\"\"\n        from .basemaps import available_basemaps\n\n        # Default basemaps if none provided\n        if basemaps is None:\n            basemaps = [\n                \"OpenStreetMap.Mapnik\",\n                \"Esri.WorldImagery\",\n                \"CartoDB.DarkMatter\",\n                \"CartoDB.Positron\",\n            ]\n\n        # Filter available basemaps to only include those that exist\n        valid_basemaps = [name for name in basemaps if name in available_basemaps]\n        if not valid_basemaps:\n            raise ValueError(\n                f\"No valid basemaps found. Available basemaps: {list(available_basemaps.keys())}\"\n            )\n\n        # Set initial basemap if not provided\n        if initial_basemap is None:\n            initial_basemap = valid_basemaps[0]\n        elif initial_basemap not in valid_basemaps:\n            raise ValueError(\n                f\"Initial basemap '{initial_basemap}' not found in provided basemaps\"\n            )\n\n        # Create basemap configurations for the control\n        basemap_configs = []\n        for basemap_name in valid_basemaps:\n            basemap_provider = available_basemaps[basemap_name]\n            tile_url = basemap_provider.build_url()\n            attribution = basemap_provider.get(\"attribution\", \"\")\n\n            # Use custom label if provided, otherwise use basemap name\n            display_label = (\n                labels.get(basemap_name, basemap_name) if labels else basemap_name\n            )\n\n            basemap_config = {\n                \"id\": basemap_name,\n                \"tiles\": [tile_url],\n                \"sourceExtraParams\": {\n                    \"tileSize\": 256,\n                    \"attribution\": attribution,\n                    \"minzoom\": basemap_provider.get(\"min_zoom\", 0),\n                    \"maxzoom\": basemap_provider.get(\"max_zoom\", 22),\n                },\n                \"label\": display_label,\n            }\n            basemap_configs.append(basemap_config)\n\n        control_options = options or {}\n        control_options.update(\n            {\n                \"position\": position,\n                \"basemaps\": basemap_configs,\n                \"initialBasemap\": initial_basemap,\n                \"expandDirection\": expand_direction,\n            }\n        )\n\n        # Store control in persistent state\n        control_key = f\"basemap_control_{position}\"\n        current_controls = dict(self._controls)\n        current_controls[control_key] = {\n            \"type\": \"basemap_control\",\n            \"position\": position,\n            \"options\": control_options,\n        }\n        self._controls = current_controls\n\n        self.call_js_method(\"addControl\", \"basemap_control\", control_options)\n\n    def add_temporal_control(\n        self,\n        frames: List[Dict[str, Any]],\n        position: str = \"top-right\",\n        interval: int = 1000,\n        performance: bool = False,\n        options: Optional[Dict[str, Any]] = None,\n    ) -&gt; None:\n        \"\"\"Add a temporal control to the map for animating time-series data.\n\n        The temporal control enables animation of map layers across time, allowing\n        users to visualize changes over time with playback controls. It uses the\n        maplibre-gl-temporal-control plugin.\n\n        Args:\n            frames: List of frame configurations. Each frame is a dictionary with:\n                - title: Display name for the frame (e.g., \"2020-01-01\")\n                - layers: List of layer IDs to show in this frame\n            position: Position on map ('top-left', 'top-right', 'bottom-left', 'bottom-right')\n            interval: Duration to display each frame in milliseconds. Default is 1000 (1 second).\n            performance: Enable performance mode for slower systems. Default is False.\n            options: Additional options for the temporal control\n\n        Example:\n            &gt;&gt;&gt; m = MapLibreMap()\n            &gt;&gt;&gt; # Add layers for different time periods\n            &gt;&gt;&gt; m.add_geojson_layer(\"data-2020\", geojson_2020, \"circle\", paint={\"circle-color\": \"red\"})\n            &gt;&gt;&gt; m.add_geojson_layer(\"data-2021\", geojson_2021, \"circle\", paint={\"circle-color\": \"blue\"})\n            &gt;&gt;&gt; m.add_geojson_layer(\"data-2022\", geojson_2022, \"circle\", paint={\"circle-color\": \"green\"})\n            &gt;&gt;&gt;\n            &gt;&gt;&gt; # Configure temporal frames\n            &gt;&gt;&gt; frames = [\n            ...     {\"title\": \"2020\", \"layers\": [\"data-2020\"]},\n            ...     {\"title\": \"2021\", \"layers\": [\"data-2021\"]},\n            ...     {\"title\": \"2022\", \"layers\": [\"data-2022\"]},\n            ... ]\n            &gt;&gt;&gt;\n            &gt;&gt;&gt; # Add temporal control\n            &gt;&gt;&gt; m.add_temporal_control(\n            ...     frames=frames,\n            ...     position=\"top-right\",\n            ...     interval=2000  # 2 seconds per frame\n            ... )\n        \"\"\"\n        if not frames:\n            raise ValueError(\"At least one frame must be provided\")\n\n        control_options = options or {}\n        control_options.update(\n            {\n                \"position\": position,\n                \"frames\": frames,\n                \"interval\": interval,\n                \"performance\": performance,\n            }\n        )\n\n        # Store control in persistent state\n        control_key = f\"temporal_{position}\"\n        current_controls = dict(self._controls)\n        current_controls[control_key] = {\n            \"type\": \"temporal\",\n            \"position\": position,\n            \"options\": control_options,\n        }\n        self._controls = current_controls\n\n        self.call_js_method(\"addControl\", \"temporal\", control_options)\n\n    def add_infobox_control(\n        self,\n        position: str = \"top-right\",\n        layer_id: Optional[str] = None,\n        formatter: Optional[Union[str, Any]] = None,\n        collapsed: bool = True,\n        options: Optional[Dict[str, Any]] = None,\n    ) -&gt; None:\n        \"\"\"Add an InfoBox control (mapbox-gl-infobox) to display feature attributes.\n\n        Args:\n            position: Control position ('top-left', 'top-right', 'bottom-left', 'bottom-right').\n            layer_id: Optional target layer id to listen for hover/click features.\n            formatter: Either an HTML template string (e.g., \"&lt;b&gt;{{name}}&lt;/b&gt;\") or a callable\n                taking a properties dict and returning HTML. Strings will be templated against\n                feature properties; unknown keys render as empty.\n            collapsed: Whether the control starts collapsed.\n            options: Additional plugin options passed through.\n        \"\"\"\n        control_options: Dict[str, Any] = dict(options or {})\n        control_options.update(\n            {\n                \"position\": position,\n                \"collapsed\": collapsed,\n            }\n        )\n        if layer_id is not None:\n            control_options[\"layerId\"] = layer_id\n        if formatter is not None:\n            # Strings are handled as templates in JS; callables cannot be serialized\n            if isinstance(formatter, str):\n                control_options[\"formatter\"] = formatter\n            else:\n                # Best-effort stringification to avoid non-serializable objects\n                control_options[\"formatter_template\"] = str(formatter)\n\n        control_key = f\"infobox_{position}\"\n        current_controls = dict(self._controls)\n        current_controls[control_key] = {\n            \"type\": \"infobox\",\n            \"position\": position,\n            \"options\": control_options,\n        }\n        self._controls = current_controls\n\n        self.call_js_method(\"addControl\", \"infobox\", control_options)\n\n    def add_gradientbox_control(\n        self,\n        position: str = \"top-right\",\n        layer_id: Optional[str] = None,\n        weight_property: Optional[str] = None,\n        min_value: Optional[float] = None,\n        max_value: Optional[float] = None,\n        colors: Optional[List[str]] = None,\n        collapsed: bool = True,\n        options: Optional[Dict[str, Any]] = None,\n    ) -&gt; None:\n        \"\"\"Add a GradientBox control (mapbox-gl-infobox) to show value legend.\n\n        Args:\n            position: Control position.\n            layer_id: Optional target layer id used for value extraction.\n            weight_property: Feature property name used to compute weights.\n            min_value: Minimum value for gradient legend.\n            max_value: Maximum value for gradient legend.\n            collapsed: Whether the control starts collapsed.\n            options: Additional plugin options.\n        \"\"\"\n        control_options: Dict[str, Any] = dict(options or {})\n        control_options.update(\n            {\n                \"position\": position,\n                \"collapsed\": collapsed,\n            }\n        )\n        if layer_id is not None:\n            control_options[\"layerId\"] = layer_id\n        if weight_property is not None:\n            control_options[\"weight_property\"] = weight_property\n        if min_value is not None or max_value is not None:\n            # JS layer will normalize into minMaxValues\n            control_options[\"min_value\"] = min_value\n            control_options[\"max_value\"] = max_value\n        if colors is not None:\n            control_options[\"colors\"] = colors\n\n        control_key = f\"gradientbox_{position}\"\n        current_controls = dict(self._controls)\n        current_controls[control_key] = {\n            \"type\": \"gradientbox\",\n            \"position\": position,\n            \"options\": control_options,\n        }\n        self._controls = current_controls\n\n        self.call_js_method(\"addControl\", \"gradientbox\", control_options)\n\n    def add_legend_control(\n        self,\n        position: str = \"bottom-left\",\n        show_default: bool = True,\n        show_checkbox: bool = True,\n        only_rendered: bool = False,\n        reverse_order: bool = False,\n        options: Optional[Dict[str, Any]] = None,\n        targets: Optional[Dict[str, str]] = None,\n        label_overrides: Optional[Dict[str, str]] = None,\n        max_height: Optional[Union[int, float, str]] = None,\n        toggle_icon: Optional[str] = None,\n    ) -&gt; None:\n        \"\"\"Add a Legend control (watergis/mapbox-gl-legend) to the map.\n\n        The legend control inspects map layers and renders a legend UI. It works\n        best when layers include helpful `metadata` such as a human-readable\n        name, unit, or labels.\n\n        Args:\n            position: Control position ('top-left', 'top-right', 'bottom-left', 'bottom-right').\n            show_default: Whether to show default legend items inferred from layers.\n            show_checkbox: Whether to include visibility checkboxes per item.\n            only_rendered: If True, only include layers currently rendered in viewport.\n            reverse_order: If True, reverse the legend item order.\n            options: Additional plugin options forwarded to LegendControl.\n            targets: Optional mapping of layer IDs to include in the legend. When\n                provided, only these layers will appear (matching plugin behaviour).\n            label_overrides: Optional mapping of layer IDs to custom legend labels.\n                When omitted, labels are derived from layer metadata and fall back\n                to layer ids. This does not restrict which layers are shown.\n            max_height: Optional CSS size (e.g. 320, \"320px\", \"60vh\") used to cap the\n                legend panel height. When provided, a scrollbar appears if content\n                exceeds this limit.\n            toggle_icon: Optional HTML string or Unicode glyph for the collapsed\n                legend toggle button. Defaults to a list-style icon if omitted.\n        \"\"\"\n\n        def _derive_labels() -&gt; Dict[str, str]:\n            derived: Dict[str, str] = {}\n            for layer_id, layer_info in self.layer_dict.items():\n                layer_config = layer_info.get(\"layer\", {})\n                if not isinstance(layer_config, dict):\n                    continue\n\n                if layer_config.get(\"type\") == \"background\":\n                    continue\n\n                if not layer_info.get(\"visible\", True):\n                    continue\n\n                metadata = layer_config.get(\"metadata\") or {}\n                legend_meta = metadata.get(\"legend\") or {}\n                if legend_meta.get(\"exclude\"):\n                    continue\n\n                label = (\n                    legend_meta.get(\"label\")\n                    or legend_meta.get(\"title\")\n                    or metadata.get(\"name\")\n                    or legend_meta.get(\"name\")\n                    or layer_info.get(\"name\")\n                    or layer_config.get(\"id\")\n                    or layer_id\n                )\n                derived[layer_id] = label\n\n            return derived\n\n        control_options: Dict[str, Any] = dict(options or {})\n        control_options.update(\n            {\n                \"position\": position,\n                \"showDefault\": show_default,\n                \"showCheckbox\": show_checkbox,\n                \"onlyRendered\": only_rendered,\n                \"reverseOrder\": reverse_order,\n            }\n        )\n\n        if targets is not None:\n            control_options[\"targets\"] = dict(targets)\n\n        if max_height is not None:\n            if isinstance(max_height, (int, float)):\n                max_height_value = f\"{max_height}px\"\n            else:\n                max_height_value = str(max_height)\n            control_options[\"maxHeight\"] = max_height_value\n\n        if toggle_icon is not None:\n            control_options[\"toggleIcon\"] = str(toggle_icon)\n\n        auto_labels = _derive_labels()\n        merged_labels: Dict[str, str] = dict(auto_labels)\n        for label_map in (\n            control_options.get(\"label_overrides\"),\n            control_options.get(\"labelOverrides\"),\n            label_overrides,\n        ):\n            if label_map:\n                merged_labels.update(label_map)\n\n        if merged_labels:\n            control_options[\"label_overrides\"] = merged_labels\n\n        control_key = f\"legend_{position}\"\n        current_controls = dict(self._controls)\n        current_controls[control_key] = {\n            \"type\": \"legend\",\n            \"position\": position,\n            \"options\": control_options,\n        }\n        self._controls = current_controls\n\n        self.call_js_method(\"addControl\", \"legend\", control_options)\n\n    def _process_deckgl_props(self, props: Dict[str, Any]) -&gt; Dict[str, Any]:\n        \"\"\"Process DeckGL properties to handle lambda functions and other non-serializable objects.\n\n        Args:\n            props: Dictionary of DeckGL layer properties.\n\n        Returns:\n            Processed properties dictionary with serializable values.\n        \"\"\"\n        processed_props = {}\n\n        for key, value in props.items():\n            if callable(value):\n                # Handle lambda functions and other callables\n                if hasattr(value, \"__name__\") and value.__name__ == \"&lt;lambda&gt;\":\n                    # For lambda functions, we'll need to convert them to accessor strings\n                    # This is a simplified approach - in practice, you might want to\n                    # inspect the lambda to generate appropriate accessors\n                    processed_props[key] = f\"@@=d =&gt; d.{key.replace('get', '').lower()}\"\n                else:\n                    # For named functions, convert to string representation\n                    processed_props[key] = str(value)\n            else:\n                # Keep other values as-is\n                processed_props[key] = value\n\n        return processed_props\n\n    def add_deckgl_layer(\n        self,\n        layer_id: str,\n        layer_type: str,\n        data: Union[List[Dict], Dict[str, Any]],\n        props: Optional[Dict[str, Any]] = None,\n        visible: bool = True,\n        **kwargs: Any,\n    ) -&gt; None:\n        \"\"\"Add a DeckGL layer to the map.\n\n        This method adds a DeckGL layer overlay to the MapLibre map. DeckGL provides\n        high-performance visualization of large datasets with WebGL-powered layers.\n\n        Args:\n            layer_id: Unique identifier for the DeckGL layer.\n            layer_type: Type of DeckGL layer (e.g., 'ScatterplotLayer', 'PathLayer', 'GeoJsonLayer').\n            data: Data for the layer. Can be a list of objects or GeoJSON-like structure.\n            props: Layer-specific properties for styling and behavior.\n            visible: Whether the layer should be visible initially.\n            **kwargs: Additional layer properties.\n\n        Example:\n            &gt;&gt;&gt; m = MapLibreMap()\n            &gt;&gt;&gt;\n            &gt;&gt;&gt; # Add a scatterplot layer\n            &gt;&gt;&gt; data = [\n            ...     {\"position\": [-122.4, 37.8], \"radius\": 100, \"color\": [255, 0, 0]},\n            ...     {\"position\": [-74.0, 40.7], \"radius\": 150, \"color\": [0, 255, 0]}\n            ... ]\n            &gt;&gt;&gt; m.add_deckgl_layer(\n            ...     \"my_points\",\n            ...     \"ScatterplotLayer\",\n            ...     data,\n            ...     props={\n            ...         \"getPosition\": \"position\",\n            ...         \"getRadius\": \"radius\",\n            ...         \"getFillColor\": \"color\",\n            ...         \"pickable\": True\n            ...     }\n            ... )\n        \"\"\"\n        if props is None:\n            props = {}\n\n        # Merge kwargs into props\n        layer_props = {**props, **kwargs}\n\n        # Convert lambda functions to JavaScript-compatible strings\n        layer_props = self._process_deckgl_props(layer_props)\n\n        layer_config = {\n            \"id\": layer_id,\n            \"type\": layer_type,\n            \"data\": data,\n            \"props\": layer_props,\n            \"visible\": visible,\n        }\n\n        # Store layer in local state\n        current_layers = dict(self._deckgl_layers)\n        current_layers[layer_id] = layer_config\n        self._deckgl_layers = current_layers\n\n        # Send to JavaScript\n        self.call_js_method(\"addDeckGLLayer\", layer_config)\n\n    def remove_deckgl_layer(self, layer_id: str) -&gt; None:\n        \"\"\"Remove a DeckGL layer from the map.\n\n        Args:\n            layer_id: Unique identifier of the DeckGL layer to remove.\n        \"\"\"\n        # Remove from local state\n        if layer_id in self._deckgl_layers:\n            current_layers = dict(self._deckgl_layers)\n            del current_layers[layer_id]\n            self._deckgl_layers = current_layers\n\n        # Send to JavaScript\n        self.call_js_method(\"removeDeckGLLayer\", layer_id)\n\n    def update_deckgl_layer(\n        self,\n        layer_id: str,\n        data: Optional[Union[List[Dict], Dict[str, Any]]] = None,\n        props: Optional[Dict[str, Any]] = None,\n        **kwargs: Any,\n    ) -&gt; None:\n        \"\"\"Update a DeckGL layer's data or properties.\n\n        Args:\n            layer_id: Unique identifier of the DeckGL layer to update.\n            data: New data for the layer. If None, data is not updated.\n            props: New or updated properties for the layer.\n            **kwargs: Additional layer properties to update.\n        \"\"\"\n        if layer_id not in self._deckgl_layers:\n            raise ValueError(f\"DeckGL layer '{layer_id}' not found\")\n\n        # Get current layer config\n        current_layers = dict(self._deckgl_layers)\n        layer_config = current_layers[layer_id].copy()\n\n        # Update data if provided\n        if data is not None:\n            layer_config[\"data\"] = data\n\n        # Update properties if provided\n        if props is not None or kwargs:\n            current_props = layer_config.get(\"props\", {})\n            if props:\n                current_props.update(props)\n            if kwargs:\n                current_props.update(kwargs)\n            # Process the updated props to handle lambda functions\n            layer_config[\"props\"] = self._process_deckgl_props(current_props)\n\n        # Store updated config\n        current_layers[layer_id] = layer_config\n        self._deckgl_layers = current_layers\n\n        # Send to JavaScript\n        self.call_js_method(\"updateDeckGLLayer\", layer_config)\n\n    def set_deckgl_layer_visibility(self, layer_id: str, visible: bool) -&gt; None:\n        \"\"\"Set the visibility of a DeckGL layer.\n\n        Args:\n            layer_id: Unique identifier of the DeckGL layer.\n            visible: Whether the layer should be visible.\n        \"\"\"\n        if layer_id in self._deckgl_layers:\n            current_layers = dict(self._deckgl_layers)\n            current_layers[layer_id][\"visible\"] = visible\n            self._deckgl_layers = current_layers\n\n            # Send to JavaScript\n            self.call_js_method(\"setDeckGLLayerVisibility\", layer_id, visible)\n\n    def get_deckgl_layers(self) -&gt; Dict[str, Dict[str, Any]]:\n        \"\"\"Get all DeckGL layers currently on the map.\n\n        Returns:\n            Dictionary mapping layer IDs to their configurations.\n        \"\"\"\n        return dict(self._deckgl_layers)\n\n    def clear_deckgl_layers(self) -&gt; None:\n        \"\"\"Remove all DeckGL layers from the map.\"\"\"\n        # Clear local state\n        self._deckgl_layers = {}\n\n        # Send to JavaScript\n        self.call_js_method(\"clearDeckGLLayers\")\n\n    # Three.js / MapLibre Three Plugin methods\n\n    def init_three_scene(self) -&gt; None:\n        \"\"\"Initialize the MapLibre Three.js scene.\n\n        This must be called before adding any 3D models or lights.\n        It initializes the MapScene object that connects MapLibre GL JS with Three.js.\n\n        Example:\n            &gt;&gt;&gt; m = MapLibreMap(center=[148.9819, -35.3981], zoom=18, pitch=60)\n            &gt;&gt;&gt; m.init_three_scene()\n            &gt;&gt;&gt; m.add_three_light(light_type='ambient')\n        \"\"\"\n        self.call_js_method(\"initMapScene\")\n\n    def add_three_model(\n        self,\n        model_id: str,\n        url: str,\n        coordinates: List[float],\n        scale: Union[float, List[float]] = 1.0,\n        rotation: Optional[List[float]] = None,\n        **kwargs: Any,\n    ) -&gt; None:\n        \"\"\"Add a 3D GLTF model to the map using Three.js.\n\n        Args:\n            model_id: Unique identifier for the 3D model.\n            url: URL to the GLTF/GLB model file.\n            coordinates: Geographic coordinates [longitude, latitude] where the model should be placed.\n            scale: Scale factor for the model. Can be a single number or [x, y, z] list.\n            rotation: Optional rotation in radians as [x, y, z].\n            **kwargs: Additional options for the model.\n\n        Example:\n            &gt;&gt;&gt; m = MapLibreMap(center=[148.9819, -35.3981], zoom=18, pitch=60)\n            &gt;&gt;&gt; m.init_three_scene()\n            &gt;&gt;&gt; m.add_three_light(type='ambient')\n            &gt;&gt;&gt; m.add_three_model(\n            ...     model_id='my_model',\n            ...     url='https://example.com/model.gltf',\n            ...     coordinates=[148.9819, -35.3981],\n            ...     scale=100,\n            ...     rotation=[0, 0, 0]\n            ... )\n        \"\"\"\n        model_config = {\n            \"id\": model_id,\n            \"url\": url,\n            \"coordinates\": coordinates,\n            \"scale\": scale,\n            \"options\": kwargs,\n        }\n\n        if rotation is not None:\n            model_config[\"rotation\"] = rotation\n\n        self.call_js_method(\"addThreeModel\", model_config)\n\n    def add_three_light(\n        self,\n        light_type: str = \"ambient\",\n        color: int = 0xFFFFFF,\n        intensity: float = 1.0,\n        position: Optional[List[float]] = None,\n        light_id: Optional[str] = None,\n        target: Optional[List[float]] = None,\n        cast_shadow: Optional[bool] = None,\n        shadow_options: Optional[Dict[str, Any]] = None,\n        sun_options: Optional[Dict[str, Any]] = None,\n    ) -&gt; None:\n        \"\"\"Add a light to the Three.js scene.\n\n        Args:\n            light_type: Type of light ('ambient', 'directional', or 'sun').\n            color: Hexadecimal color value for the light (e.g., 0xffffff for white).\n            intensity: Light intensity value.\n            position: Optional position for directional lights as [x, y, z].\n            light_id: Optional identifier for the light so it can be updated or removed later.\n            target: Optional target position for directional lights as [x, y, z].\n            cast_shadow: Whether the light should cast shadows (if supported by the light type).\n            shadow_options: Additional shadow configuration such as map size or clipping planes.\n            sun_options: Additional options when using the `sun` light type (e.g., ``{\"current_time\": \"2024-01-01T12:00:00Z\"}``).\n\n        Example:\n            &gt;&gt;&gt; m = MapLibreMap(center=[148.9819, -35.3981], zoom=18, pitch=60)\n            &gt;&gt;&gt; m.init_three_scene()\n            &gt;&gt;&gt; m.add_three_light(light_type='ambient', intensity=0.5)\n            &gt;&gt;&gt; m.add_three_light(light_type='directional', position=[1, 1, 1])\n            &gt;&gt;&gt; m.add_three_light(light_type='sun')\n        \"\"\"\n        light_config: Dict[str, Any] = {\n            \"type\": light_type,\n            \"color\": color,\n            \"intensity\": intensity,\n        }\n\n        if position is not None:\n            light_config[\"position\"] = position\n        if light_id is not None:\n            light_config[\"id\"] = light_id\n        if target is not None:\n            light_config[\"target\"] = target\n        if cast_shadow is not None:\n            light_config[\"castShadow\"] = cast_shadow\n        if shadow_options:\n            light_config[\"shadowOptions\"] = shadow_options\n        if sun_options:\n            light_config[\"sunOptions\"] = sun_options\n\n        self.call_js_method(\"addThreeLight\", light_config)\n\n    def update_three_light(\n        self,\n        light_id: str,\n        *,\n        color: Optional[int] = None,\n        intensity: Optional[float] = None,\n        position: Optional[List[float]] = None,\n        target: Optional[List[float]] = None,\n        cast_shadow: Optional[bool] = None,\n        shadow_options: Optional[Dict[str, Any]] = None,\n        sun_options: Optional[Dict[str, Any]] = None,\n    ) -&gt; None:\n        \"\"\"Update properties of an existing Three.js light.\"\"\"\n\n        update_config: Dict[str, Any] = {\"id\": light_id}\n\n        if color is not None:\n            update_config[\"color\"] = color\n        if intensity is not None:\n            update_config[\"intensity\"] = intensity\n        if position is not None:\n            update_config[\"position\"] = position\n        if target is not None:\n            update_config[\"target\"] = target\n        if cast_shadow is not None:\n            update_config[\"castShadow\"] = cast_shadow\n        if shadow_options:\n            update_config[\"shadowOptions\"] = shadow_options\n        if sun_options:\n            update_config[\"sunOptions\"] = sun_options\n\n        self.call_js_method(\"updateThreeLight\", update_config)\n\n    def remove_three_light(self, light_id: str) -&gt; None:\n        \"\"\"Remove a Three.js light from the scene.\"\"\"\n\n        self.call_js_method(\"removeThreeLight\", light_id)\n\n    def remove_three_model(self, model_id: str) -&gt; None:\n        \"\"\"Remove a 3D model from the scene.\n\n        Args:\n            model_id: Unique identifier of the model to remove.\n\n        Example:\n            &gt;&gt;&gt; m.remove_three_model('my_model')\n        \"\"\"\n        self.call_js_method(\"removeThreeModel\", model_id)\n\n    def update_three_model(\n        self,\n        model_id: str,\n        position: Optional[List[float]] = None,\n        scale: Optional[Union[float, List[float]]] = None,\n        rotation: Optional[List[float]] = None,\n    ) -&gt; None:\n        \"\"\"Update properties of an existing 3D model.\n\n        Args:\n            model_id: Unique identifier of the model to update.\n            position: Optional new position as [x, y, z].\n            scale: Optional new scale. Can be a single number or [x, y, z] list.\n            rotation: Optional new rotation in radians as [x, y, z].\n\n        Example:\n            &gt;&gt;&gt; m.update_three_model('my_model', scale=200, rotation=[0, 1.57, 0])\n        \"\"\"\n        update_config = {\"id\": model_id}\n\n        if position is not None:\n            update_config[\"position\"] = position\n        if scale is not None:\n            update_config[\"scale\"] = scale\n        if rotation is not None:\n            update_config[\"rotation\"] = rotation\n\n        self.call_js_method(\"updateThreeModel\", update_config)\n\n    # 3D Tiles helpers\n\n    def add_three_tileset(\n        self,\n        tileset_id: str,\n        *,\n        asset_id: Optional[Union[int, str]] = None,\n        url: Optional[str] = None,\n        ion_token: Optional[str] = None,\n        auto_refresh_token: bool = True,\n        auto_disable_renderer_culling: bool = True,\n        fetch_options: Optional[Dict[str, Any]] = None,\n        lru_cache: Optional[Dict[str, Any]] = None,\n        draco_decoder_path: Optional[str] = None,\n        ktx2_transcoder_path: Optional[str] = None,\n        use_debug: bool = False,\n        use_fade: bool = False,\n        use_unload: bool = False,\n        use_update: bool = False,\n        height_offset: float = 0.0,\n        fly_to: bool = True,\n    ) -&gt; None:\n        \"\"\"Add a 3D Tiles dataset to the scene using TilesRenderer.\"\"\"\n\n        if asset_id is None and url is None:\n            raise ValueError(\n                \"Either asset_id or url must be provided for add_three_tileset\"\n            )\n\n        config: Dict[str, Any] = {\n            \"id\": tileset_id,\n            \"assetId\": asset_id,\n            \"url\": url,\n            \"ionToken\": ion_token,\n            \"autoRefreshToken\": auto_refresh_token,\n            \"autoDisableRendererCulling\": auto_disable_renderer_culling,\n            \"fetchOptions\": fetch_options,\n            \"lruCache\": lru_cache,\n            \"dracoDecoderPath\": draco_decoder_path,\n            \"ktx2TranscoderPath\": ktx2_transcoder_path,\n            \"useDebug\": use_debug,\n            \"useFade\": use_fade,\n            \"useUnload\": use_unload,\n            \"useUpdate\": use_update,\n            \"heightOffset\": height_offset,\n            \"flyTo\": fly_to,\n        }\n\n        # Remove None values to keep payload minimal\n        payload = {key: value for key, value in config.items() if value is not None}\n        self.call_js_method(\"addThreeTileset\", payload)\n\n    def remove_three_tileset(self, tileset_id: str) -&gt; None:\n        \"\"\"Remove a 3D Tiles dataset from the scene.\"\"\"\n\n        self.call_js_method(\"removeThreeTileset\", tileset_id)\n\n    def set_three_tileset_height(self, tileset_id: str, height: float) -&gt; None:\n        \"\"\"Adjust the height offset applied to a 3D Tiles dataset.\"\"\"\n\n        self.call_js_method(\n            \"setThreeTilesetHeight\", {\"id\": tileset_id, \"height\": height}\n        )\n\n    def fly_to_three_tileset(self, tileset_id: str) -&gt; None:\n        \"\"\"Animate the camera to frame a 3D Tiles dataset.\"\"\"\n\n        self.call_js_method(\"flyToThreeTileset\", tileset_id)\n\n    def to_html(\n        self,\n        filename: Optional[str] = None,\n        title: str = \"Anymap Export\",\n        width: str = \"100%\",\n        height: str = \"600px\",\n        **kwargs: Any,\n    ) -&gt; str:\n        \"\"\"Export the map to a standalone HTML file with DeckGL layers.\n\n        This method extends the base to_html method to include DeckGL layer state.\n\n        Args:\n            filename: Optional filename to save the HTML. If None, returns HTML string.\n            title: Title for the HTML page.\n            width: Width of the map container as CSS string.\n            height: Height of the map container as CSS string.\n            **kwargs: Additional arguments passed to the HTML template.\n\n        Returns:\n            HTML string content of the exported map.\n        \"\"\"\n        # Get the current map state\n        map_state = {\n            \"center\": self.center,\n            \"zoom\": self.zoom,\n            \"width\": width,\n            \"height\": height,\n            \"style\": self.style,\n            \"_layers\": dict(self._layers),\n            \"_sources\": dict(self._sources),\n            \"_controls\": dict(self._controls),\n            \"_terrain\": dict(self._terrain),\n            \"_deckgl_layers\": dict(self._deckgl_layers),  # Include DeckGL layers\n        }\n\n        # Add class-specific attributes\n        if hasattr(self, \"style\"):\n            map_state[\"style\"] = self.style\n        if hasattr(self, \"bearing\"):\n            map_state[\"bearing\"] = self.bearing\n        if hasattr(self, \"pitch\"):\n            map_state[\"pitch\"] = self.pitch\n        if hasattr(self, \"antialias\"):\n            map_state[\"antialias\"] = self.antialias\n        if hasattr(self, \"_draw_data\"):\n            map_state[\"_draw_data\"] = dict(self._draw_data)\n        if hasattr(self, \"_terra_draw_data\"):\n            map_state[\"_terra_draw_data\"] = dict(self._terra_draw_data)\n\n        # Generate HTML content\n        html_content = self._generate_html_template(map_state, title, **kwargs)\n\n        # Save to file if filename provided\n        if filename:\n            with open(filename, \"w\", encoding=\"utf-8\") as f:\n                f.write(html_content)\n\n        return html_content\n</code></pre>"},{"location":"maplibre/#anymap.maplibre.MapLibreMap.current_bounds","title":"<code>current_bounds: Optional[List[List[float]]]</code>  <code>property</code> <code>readonly</code>","text":"<p>Get the current map bounds as [[lng, lat], [lng, lat]] (southwest, northeast).</p>"},{"location":"maplibre/#anymap.maplibre.MapLibreMap.current_center","title":"<code>current_center: List[float]</code>  <code>property</code> <code>readonly</code>","text":"<p>Get the current map center coordinates as [longitude, latitude].</p>"},{"location":"maplibre/#anymap.maplibre.MapLibreMap.current_zoom","title":"<code>current_zoom: float</code>  <code>property</code> <code>readonly</code>","text":"<p>Get the current map zoom level.</p>"},{"location":"maplibre/#anymap.maplibre.MapLibreMap.draw_data","title":"<code>draw_data: Dict[str, Any]</code>  <code>property</code> <code>readonly</code>","text":"<p>Get the current draw data as GeoJSON.</p>"},{"location":"maplibre/#anymap.maplibre.MapLibreMap.first_symbol_layer_id","title":"<code>first_symbol_layer_id: Optional[str]</code>  <code>property</code> <code>readonly</code>","text":"<p>Get the ID of the first symbol layer in the map's current style.</p>"},{"location":"maplibre/#anymap.maplibre.MapLibreMap.sidebar_widgets","title":"<code>sidebar_widgets: Dict[str, ipywidgets.widgets.widget.Widget]</code>  <code>property</code> <code>readonly</code>","text":"<p>Returns a dictionary of widgets currently in the sidebar.</p> <p>Returns:</p> Type Description <code>Dict[str, widgets.Widget]</code> <p>A dictionary where keys are the labels of the widgets and values are the widgets themselves.</p>"},{"location":"maplibre/#anymap.maplibre.MapLibreMap.viewstate","title":"<code>viewstate: Dict[str, Any]</code>  <code>property</code> <code>readonly</code>","text":"<p>Get the current map viewstate including center, zoom, bearing, pitch, and bounds.</p>"},{"location":"maplibre/#anymap.maplibre.MapLibreMap.__init__","title":"<code>__init__(self, center=[0, 20], zoom=1.0, style='dark-matter', width='100%', height='600px', bearing=0.0, pitch=0.0, controls={'navigation': 'top-right', 'fullscreen': 'top-right', 'scale': 'bottom-left', 'globe': 'top-right', 'layers': 'top-right'}, projection='mercator', add_sidebar=False, sidebar_visible=False, sidebar_width=360, sidebar_args=None, layer_manager_expanded=True, **kwargs)</code>  <code>special</code>","text":"<p>Initialize MapLibre map widget.</p> <p>Parameters:</p> Name Type Description Default <code>center</code> <code>List[float]</code> <p>Map center coordinates as [longitude, latitude]. Default is [0, 20].</p> <code>[0, 20]</code> <code>zoom</code> <code>float</code> <p>Initial zoom level (typically 0-20). Default is 1.0.</p> <code>1.0</code> <code>style</code> <code>Union[str, Dict[str, Any]]</code> <p>MapLibre style URL string or style object dictionary.</p> <code>'dark-matter'</code> <code>width</code> <code>str</code> <p>Widget width as CSS string (e.g., \"100%\", \"800px\").</p> <code>'100%'</code> <code>height</code> <code>str</code> <p>Widget height as CSS string (e.g., \"600px\", \"50vh\").</p> <code>'600px'</code> <code>bearing</code> <code>float</code> <p>Map bearing (rotation) in degrees (0-360).</p> <code>0.0</code> <code>pitch</code> <code>float</code> <p>Map pitch (tilt) in degrees (0-60).</p> <code>0.0</code> <code>controls</code> <code>Dict[str, str]</code> <p>Dictionary of control names and their positions. Default is { \"navigation\": \"top-right\", \"fullscreen\": \"top-right\", \"scale\": \"bottom-left\", \"globe\": \"top-right\", \"layers\": \"top-right\",</p> <code>{'navigation': 'top-right', 'fullscreen': 'top-right', 'scale': 'bottom-left', 'globe': 'top-right', 'layers': 'top-right'}</code> <code>projection</code> <code>str</code> <p>Map projection type. Can be \"mercator\" or \"globe\". Default is \"mercator\".</p> <code>'mercator'</code> <code>add_sidebar</code> <code>bool</code> <p>Whether to add a sidebar to the map. Default is False.</p> <code>False</code> <code>sidebar_visible</code> <code>bool</code> <p>Whether the sidebar is visible. Default is False.</p> <code>False</code> <code>sidebar_width</code> <code>int</code> <p>Width of the sidebar in pixels. Default is 360.</p> <code>360</code> <code>sidebar_args</code> <code>Optional[Dict]</code> <p>Additional keyword arguments for the sidebar. Default is None.</p> <code>None</code> <code>layer_manager_expanded</code> <code>bool</code> <p>Whether the layer manager is expanded. Default is True.</p> <code>True</code> <code>**kwargs</code> <code>Any</code> <p>Additional keyword arguments passed to parent class.</p> <code>{}</code> Source code in <code>anymap/maplibre.py</code> <pre><code>def __init__(\n    self,\n    center: List[float] = [0, 20],\n    zoom: float = 1.0,\n    style: Union[str, Dict[str, Any]] = \"dark-matter\",\n    width: str = \"100%\",\n    height: str = \"600px\",\n    bearing: float = 0.0,\n    pitch: float = 0.0,\n    controls: Dict[str, str] = {\n        \"navigation\": \"top-right\",\n        \"fullscreen\": \"top-right\",\n        \"scale\": \"bottom-left\",\n        \"globe\": \"top-right\",\n        \"layers\": \"top-right\",\n    },\n    projection: str = \"mercator\",\n    add_sidebar: bool = False,\n    sidebar_visible: bool = False,\n    sidebar_width: int = 360,\n    sidebar_args: Optional[Dict] = None,\n    layer_manager_expanded: bool = True,\n    **kwargs: Any,\n) -&gt; None:\n    \"\"\"Initialize MapLibre map widget.\n\n    Args:\n        center: Map center coordinates as [longitude, latitude]. Default is [0, 20].\n        zoom: Initial zoom level (typically 0-20). Default is 1.0.\n        style: MapLibre style URL string or style object dictionary.\n        width: Widget width as CSS string (e.g., \"100%\", \"800px\").\n        height: Widget height as CSS string (e.g., \"600px\", \"50vh\").\n        bearing: Map bearing (rotation) in degrees (0-360).\n        pitch: Map pitch (tilt) in degrees (0-60).\n        controls: Dictionary of control names and their positions. Default is {\n            \"navigation\": \"top-right\",\n            \"fullscreen\": \"top-right\",\n            \"scale\": \"bottom-left\",\n            \"globe\": \"top-right\",\n            \"layers\": \"top-right\",\n        }.\n        projection: Map projection type. Can be \"mercator\" or \"globe\". Default is \"mercator\".\n        add_sidebar: Whether to add a sidebar to the map. Default is False.\n        sidebar_visible: Whether the sidebar is visible. Default is False.\n        sidebar_width: Width of the sidebar in pixels. Default is 360.\n        sidebar_args: Additional keyword arguments for the sidebar. Default is None.\n        layer_manager_expanded: Whether the layer manager is expanded. Default is True.\n        **kwargs: Additional keyword arguments passed to parent class.\n    \"\"\"\n\n    if isinstance(style, str):\n        style = utils.construct_maplibre_style(style)\n\n    if abs(center[1]) &gt; 90:\n        center = center[::-1]\n\n    super().__init__(\n        center=center,\n        zoom=zoom,\n        width=width,\n        height=height,\n        style=style,\n        bearing=bearing,\n        pitch=pitch,\n        **kwargs,\n    )\n\n    self.layer_dict = {}\n    self.layer_dict[\"Background\"] = {\n        \"layer\": {\n            \"id\": \"Background\",\n            \"type\": \"background\",\n        },\n        \"opacity\": 1.0,\n        \"visible\": True,\n        \"type\": \"background\",\n        \"color\": None,\n    }\n\n    # Initialize the _layer_dict trait with the layer_dict content\n    self._layer_dict = dict(self.layer_dict)\n\n    # Initialize current state attributes\n    self._current_center = center\n    self._current_zoom = zoom\n    self._current_bearing = bearing\n    self._current_pitch = pitch\n    self._current_bounds = None  # Will be set after map loads\n\n    # Register event handler to update current state\n    self.on_map_event(\"moveend\", self._update_current_state)\n\n    self._style = style\n    self.style_dict = {}\n    for layer in self.get_style_layers():\n        self.style_dict[layer[\"id\"]] = layer\n    self.source_dict = {}\n\n    if projection.lower() == \"globe\":\n        self.set_projection(\n            {\n                \"type\": [\n                    \"interpolate\",\n                    [\"linear\"],\n                    [\"zoom\"],\n                    10,\n                    \"vertical-perspective\",\n                    12,\n                    \"mercator\",\n                ]\n            }\n        )\n\n    self.controls = {}\n    for control, position in controls.items():\n        if control == \"layers\":\n            self.add_layer_control(position)\n        elif control == \"geoman\":\n            self.add_geoman_control(position=position)\n            self.controls[control] = position\n        elif control == \"export\":\n            self.add_export_control(position=position)\n            self.controls[control] = position\n        else:\n            self.add_control(control, position)\n            self.controls[control] = position\n\n    if sidebar_args is None:\n        sidebar_args = {}\n    if \"sidebar_visible\" not in sidebar_args:\n        sidebar_args[\"sidebar_visible\"] = sidebar_visible\n    if \"sidebar_width\" not in sidebar_args:\n        if isinstance(sidebar_width, str):\n            sidebar_width = int(sidebar_width.replace(\"px\", \"\"))\n        sidebar_args[\"min_width\"] = sidebar_width\n        sidebar_args[\"max_width\"] = sidebar_width\n    if \"expanded\" not in sidebar_args:\n        sidebar_args[\"expanded\"] = layer_manager_expanded\n    self.sidebar_args = sidebar_args\n    self.layer_manager = None\n    self.container = None\n    self._widget_control_widgets: Dict[str, widgets.Widget] = {}\n    self._flatgeobuf_defaults: Dict[str, Any] = {}\n    if add_sidebar:\n        self._ipython_display_ = self._patched_display\n</code></pre>"},{"location":"maplibre/#anymap.maplibre.MapLibreMap.add_basemap","title":"<code>add_basemap(self, basemap, layer_id=None, before_id=None)</code>","text":"<p>Add a basemap to the map using xyzservices providers.</p> <p>Parameters:</p> Name Type Description Default <code>basemap</code> <code>str</code> <p>Name of the basemap from xyzservices (e.g., \"Esri.WorldImagery\").     Use available_basemaps to see all available options.</p> required <code>layer_id</code> <code>Optional[str]</code> <p>Optional ID for the basemap layer. If None, uses basemap name.</p> <code>None</code> <code>before_id</code> <code>Optional[str]</code> <p>Optional layer ID to insert this layer before.       If None, layer is added on top.</p> <code>None</code> <p>Exceptions:</p> Type Description <code>ValueError</code> <p>If the specified basemap is not available.</p> Source code in <code>anymap/maplibre.py</code> <pre><code>def add_basemap(\n    self,\n    basemap: str,\n    layer_id: Optional[str] = None,\n    before_id: Optional[str] = None,\n) -&gt; None:\n    \"\"\"Add a basemap to the map using xyzservices providers.\n\n    Args:\n        basemap: Name of the basemap from xyzservices (e.g., \"Esri.WorldImagery\").\n                Use available_basemaps to see all available options.\n        layer_id: Optional ID for the basemap layer. If None, uses basemap name.\n        before_id: Optional layer ID to insert this layer before.\n                  If None, layer is added on top.\n\n    Raises:\n        ValueError: If the specified basemap is not available.\n    \"\"\"\n    from .basemaps import available_basemaps\n\n    if basemap not in available_basemaps:\n        available_names = list(available_basemaps.keys())\n        raise ValueError(\n            f\"Basemap '{basemap}' not found. Available basemaps: {available_names}\"\n        )\n\n    basemap_config = available_basemaps[basemap]\n\n    # Convert xyzservices URL template to tile URL\n    tile_url = basemap_config.build_url()\n\n    # Get attribution if available\n    attribution = basemap_config.get(\"attribution\", \"\")\n    if layer_id is None:\n        layer_id = basemap\n\n    # Add as raster layer\n    self.add_tile_layer(\n        layer_id=layer_id,\n        source_url=tile_url,\n        paint={\"raster-opacity\": 1.0},\n        before_id=before_id,\n    )\n</code></pre>"},{"location":"maplibre/#anymap.maplibre.MapLibreMap.add_basemap_control","title":"<code>add_basemap_control(self, position='top-right', basemaps=None, labels=None, initial_basemap=None, expand_direction='down', options=None)</code>","text":"<p>Add a basemap control to the map for switching between different basemaps.</p> <p>The basemap control allows users to switch between different basemap providers using a dropdown or expandable control. It uses the maplibre-gl-basemaps library.</p> <p>Parameters:</p> Name Type Description Default <code>position</code> <code>str</code> <p>Position on map ('top-left', 'top-right', 'bottom-left', 'bottom-right')</p> <code>'top-right'</code> <code>basemaps</code> <code>Optional[List[str]]</code> <p>List of basemap names to include. If None, uses a default set.      Available basemaps can be found in anymap.basemaps.available_basemaps</p> <code>None</code> <code>labels</code> <code>Optional[Dict[str, str]]</code> <p>Dictionary mapping basemap names to display labels. If None, uses basemap names.</p> <code>None</code> <code>initial_basemap</code> <code>Optional[str]</code> <p>Name of the initial basemap to show. If None, uses the first basemap.</p> <code>None</code> <code>expand_direction</code> <code>str</code> <p>Direction to expand the control ('up', 'down', 'left', 'right')</p> <code>'down'</code> <code>options</code> <code>Optional[Dict[str, Any]]</code> <p>Additional options for the basemap control</p> <code>None</code> <p>Examples:</p> <pre><code>&gt;&gt;&gt; m = MapLibreMap()\n&gt;&gt;&gt; m.add_basemap_control(\n...     position=\"top-right\",\n...     basemaps=[\"OpenStreetMap.Mapnik\", \"Esri.WorldImagery\", \"CartoDB.DarkMatter\"],\n...     labels={\"OpenStreetMap.Mapnik\": \"OpenStreetMap\", \"Esri.WorldImagery\": \"Satellite\"},\n...     initial_basemap=\"OpenStreetMap.Mapnik\"\n... )\n</code></pre> Source code in <code>anymap/maplibre.py</code> <pre><code>def add_basemap_control(\n    self,\n    position: str = \"top-right\",\n    basemaps: Optional[List[str]] = None,\n    labels: Optional[Dict[str, str]] = None,\n    initial_basemap: Optional[str] = None,\n    expand_direction: str = \"down\",\n    options: Optional[Dict[str, Any]] = None,\n) -&gt; None:\n    \"\"\"Add a basemap control to the map for switching between different basemaps.\n\n    The basemap control allows users to switch between different basemap providers\n    using a dropdown or expandable control. It uses the maplibre-gl-basemaps library.\n\n    Args:\n        position: Position on map ('top-left', 'top-right', 'bottom-left', 'bottom-right')\n        basemaps: List of basemap names to include. If None, uses a default set.\n                 Available basemaps can be found in anymap.basemaps.available_basemaps\n        labels: Dictionary mapping basemap names to display labels. If None, uses basemap names.\n        initial_basemap: Name of the initial basemap to show. If None, uses the first basemap.\n        expand_direction: Direction to expand the control ('up', 'down', 'left', 'right')\n        options: Additional options for the basemap control\n\n    Example:\n        &gt;&gt;&gt; m = MapLibreMap()\n        &gt;&gt;&gt; m.add_basemap_control(\n        ...     position=\"top-right\",\n        ...     basemaps=[\"OpenStreetMap.Mapnik\", \"Esri.WorldImagery\", \"CartoDB.DarkMatter\"],\n        ...     labels={\"OpenStreetMap.Mapnik\": \"OpenStreetMap\", \"Esri.WorldImagery\": \"Satellite\"},\n        ...     initial_basemap=\"OpenStreetMap.Mapnik\"\n        ... )\n    \"\"\"\n    from .basemaps import available_basemaps\n\n    # Default basemaps if none provided\n    if basemaps is None:\n        basemaps = [\n            \"OpenStreetMap.Mapnik\",\n            \"Esri.WorldImagery\",\n            \"CartoDB.DarkMatter\",\n            \"CartoDB.Positron\",\n        ]\n\n    # Filter available basemaps to only include those that exist\n    valid_basemaps = [name for name in basemaps if name in available_basemaps]\n    if not valid_basemaps:\n        raise ValueError(\n            f\"No valid basemaps found. Available basemaps: {list(available_basemaps.keys())}\"\n        )\n\n    # Set initial basemap if not provided\n    if initial_basemap is None:\n        initial_basemap = valid_basemaps[0]\n    elif initial_basemap not in valid_basemaps:\n        raise ValueError(\n            f\"Initial basemap '{initial_basemap}' not found in provided basemaps\"\n        )\n\n    # Create basemap configurations for the control\n    basemap_configs = []\n    for basemap_name in valid_basemaps:\n        basemap_provider = available_basemaps[basemap_name]\n        tile_url = basemap_provider.build_url()\n        attribution = basemap_provider.get(\"attribution\", \"\")\n\n        # Use custom label if provided, otherwise use basemap name\n        display_label = (\n            labels.get(basemap_name, basemap_name) if labels else basemap_name\n        )\n\n        basemap_config = {\n            \"id\": basemap_name,\n            \"tiles\": [tile_url],\n            \"sourceExtraParams\": {\n                \"tileSize\": 256,\n                \"attribution\": attribution,\n                \"minzoom\": basemap_provider.get(\"min_zoom\", 0),\n                \"maxzoom\": basemap_provider.get(\"max_zoom\", 22),\n            },\n            \"label\": display_label,\n        }\n        basemap_configs.append(basemap_config)\n\n    control_options = options or {}\n    control_options.update(\n        {\n            \"position\": position,\n            \"basemaps\": basemap_configs,\n            \"initialBasemap\": initial_basemap,\n            \"expandDirection\": expand_direction,\n        }\n    )\n\n    # Store control in persistent state\n    control_key = f\"basemap_control_{position}\"\n    current_controls = dict(self._controls)\n    current_controls[control_key] = {\n        \"type\": \"basemap_control\",\n        \"position\": position,\n        \"options\": control_options,\n    }\n    self._controls = current_controls\n\n    self.call_js_method(\"addControl\", \"basemap_control\", control_options)\n</code></pre>"},{"location":"maplibre/#anymap.maplibre.MapLibreMap.add_cog_layer","title":"<code>add_cog_layer(self, layer_id, cog_url, opacity=1.0, visible=True, paint=None, before_id=None, titiler_endpoint=None, fit_bounds=True, **kwargs)</code>","text":"<p>Add a Cloud Optimized GeoTIFF (COG) layer to the map.</p> <p>This method supports COGs in any coordinate reference system (CRS). For COGs in EPSG:3857, it uses the maplibre-cog-protocol for direct rendering. For COGs in other CRS, it uses TiTiler to reproject on-the-fly.</p> <p>Parameters:</p> Name Type Description Default <code>layer_id</code> <code>str</code> <p>Unique identifier for the COG layer.</p> required <code>cog_url</code> <code>str</code> <p>URL to the COG file.</p> required <code>opacity</code> <code>Optional[float]</code> <p>Layer opacity between 0.0 and 1.0.</p> <code>1.0</code> <code>visible</code> <code>Optional[bool]</code> <p>Whether the layer should be visible initially.</p> <code>True</code> <code>paint</code> <code>Optional[Dict[str, Any]]</code> <p>Optional paint properties for the layer.</p> <code>None</code> <code>before_id</code> <code>Optional[str]</code> <p>Optional layer ID to insert this layer before.</p> <code>None</code> <code>titiler_endpoint</code> <code>Optional[str]</code> <p>Optional TiTiler endpoint URL. If None, checks COG CRS and uses TiTiler automatically for non-EPSG:3857 COGs. Set to a TiTiler URL (e.g., \"https://giswqs-titiler-endpoint.hf.space\") to force using TiTiler.</p> <code>None</code> <code>fit_bounds</code> <code>bool</code> <p>If True, automatically fit map bounds to COG extent.</p> <code>True</code> <code>**kwargs</code> <code>Any</code> <p>Additional parameters passed to TiTiler (e.g., rescale, colormap, bidx for band selection).</p> <code>{}</code> <p>Examples:</p> <pre><code>&gt;&gt;&gt; m = MapLibreMap()\n&gt;&gt;&gt; # COG in EPSG:3857 (uses cog:// protocol)\n&gt;&gt;&gt; m.add_cog_layer(\"cog1\", \"https://example.com/data_3857.tif\")\n&gt;&gt;&gt;\n&gt;&gt;&gt; # COG in any other CRS (uses TiTiler)\n&gt;&gt;&gt; m.add_cog_layer(\"cog2\", \"https://example.com/data_4326.tif\")\n&gt;&gt;&gt;\n&gt;&gt;&gt; # Force TiTiler with custom endpoint\n&gt;&gt;&gt; m.add_cog_layer(\n...     \"cog3\",\n...     \"https://example.com/data.tif\",\n...     titiler_endpoint=\"https://giswqs-titiler-endpoint.hf.space\",\n...     rescale=\"0,255\",\n...     colormap=\"viridis\"\n... )\n</code></pre> Source code in <code>anymap/maplibre.py</code> <pre><code>def add_cog_layer(\n    self,\n    layer_id: str,\n    cog_url: str,\n    opacity: Optional[float] = 1.0,\n    visible: Optional[bool] = True,\n    paint: Optional[Dict[str, Any]] = None,\n    before_id: Optional[str] = None,\n    titiler_endpoint: Optional[str] = None,\n    fit_bounds: bool = True,\n    **kwargs: Any,\n) -&gt; None:\n    \"\"\"Add a Cloud Optimized GeoTIFF (COG) layer to the map.\n\n    This method supports COGs in any coordinate reference system (CRS). For COGs\n    in EPSG:3857, it uses the maplibre-cog-protocol for direct rendering. For COGs\n    in other CRS, it uses TiTiler to reproject on-the-fly.\n\n    Args:\n        layer_id: Unique identifier for the COG layer.\n        cog_url: URL to the COG file.\n        opacity: Layer opacity between 0.0 and 1.0.\n        visible: Whether the layer should be visible initially.\n        paint: Optional paint properties for the layer.\n        before_id: Optional layer ID to insert this layer before.\n        titiler_endpoint: Optional TiTiler endpoint URL. If None, checks COG CRS\n            and uses TiTiler automatically for non-EPSG:3857 COGs. Set to a TiTiler\n            URL (e.g., \"https://giswqs-titiler-endpoint.hf.space\") to force using TiTiler.\n        fit_bounds: If True, automatically fit map bounds to COG extent.\n        **kwargs: Additional parameters passed to TiTiler (e.g., rescale, colormap,\n            bidx for band selection).\n\n    Example:\n        &gt;&gt;&gt; m = MapLibreMap()\n        &gt;&gt;&gt; # COG in EPSG:3857 (uses cog:// protocol)\n        &gt;&gt;&gt; m.add_cog_layer(\"cog1\", \"https://example.com/data_3857.tif\")\n        &gt;&gt;&gt;\n        &gt;&gt;&gt; # COG in any other CRS (uses TiTiler)\n        &gt;&gt;&gt; m.add_cog_layer(\"cog2\", \"https://example.com/data_4326.tif\")\n        &gt;&gt;&gt;\n        &gt;&gt;&gt; # Force TiTiler with custom endpoint\n        &gt;&gt;&gt; m.add_cog_layer(\n        ...     \"cog3\",\n        ...     \"https://example.com/data.tif\",\n        ...     titiler_endpoint=\"https://giswqs-titiler-endpoint.hf.space\",\n        ...     rescale=\"0,255\",\n        ...     colormap=\"viridis\"\n        ... )\n    \"\"\"\n    source_id = f\"{layer_id}_source\"\n\n    # Check if we should use TiTiler\n    use_titiler = titiler_endpoint is not None\n\n    if not use_titiler:\n        # Auto-detect if TiTiler is needed by checking COG CRS\n        try:\n            metadata = self.get_cog_metadata(cog_url, crs=None)\n            if metadata and metadata.get(\"crs\"):\n                cog_crs = metadata[\"crs\"]\n                # Use TiTiler if COG is not in EPSG:3857\n                if cog_crs != \"EPSG:3857\":\n                    use_titiler = True\n                    print(f\"COG is in {cog_crs}, using TiTiler for reprojection\")\n        except Exception as e:\n            print(f\"Could not determine COG CRS, trying cog:// protocol: {e}\")\n\n    if use_titiler:\n        # Use TiTiler for on-the-fly reprojection\n        if titiler_endpoint is None:\n            titiler_endpoint = \"https://giswqs-titiler-endpoint.hf.space\"\n\n        # Build TiTiler tile URL\n        from urllib.parse import urlencode, quote\n\n        # Encode the COG URL\n        encoded_url = quote(cog_url, safe=\"\")\n\n        # Build query parameters\n        params = {\n            \"url\": cog_url,\n            \"TileMatrixSetId\": \"WebMercatorQuad\",  # Reproject to Web Mercator\n        }\n\n        # Add any additional TiTiler parameters\n        for key, value in kwargs.items():\n            params[key] = value\n\n        query_string = urlencode({k: v for k, v in params.items() if k != \"url\"})\n\n        # TiTiler tile URL format: {endpoint}/cog/tiles/WebMercatorQuad/{z}/{x}/{y}\n        tile_url = f\"{titiler_endpoint}/cog/tiles/WebMercatorQuad/{{z}}/{{x}}/{{y}}?url={encoded_url}\"\n        if query_string:\n            tile_url += f\"&amp;{query_string}\"\n\n        # print(f\"Using TiTiler: {titiler_endpoint}\")\n        # print(f\"Tile URL pattern: {tile_url[:100]}...\")\n\n        self.add_source(\n            source_id,\n            {\n                \"type\": \"raster\",\n                \"tiles\": [tile_url],\n                \"tileSize\": 256,\n                \"attribution\": \"TiTiler\",\n            },\n        )\n\n    else:\n        # Use cog:// protocol for EPSG:3857 COGs\n        cog_source_url = f\"cog://{cog_url}\"\n\n        self.add_source(\n            source_id,\n            {\n                \"type\": \"raster\",\n                \"url\": cog_source_url,\n                \"tileSize\": 256,\n            },\n        )\n\n    # Add raster layer\n    layer_config = {\"id\": layer_id, \"type\": \"raster\", \"source\": source_id}\n\n    if paint:\n        layer_config[\"paint\"] = paint\n\n    self.add_layer(\n        layer=layer_config,\n        before_id=before_id,\n        layer_id=layer_id,\n        opacity=opacity,\n        visible=visible,\n    )\n\n    # Optionally fit bounds to COG extent\n    if fit_bounds:\n        try:\n            metadata = self.get_cog_metadata(cog_url, crs=\"EPSG:4326\")\n            if metadata and metadata.get(\"bbox\"):\n                bbox = metadata[\"bbox\"]\n                bounds = [[bbox[0], bbox[1]], [bbox[2], bbox[3]]]\n                self.fit_bounds(bounds, padding=50)\n                # print(f\"Map fitted to COG bounds: {bounds}\")\n        except Exception as e:\n            print(f\"Could not fit bounds to COG extent: {e}\")\n</code></pre>"},{"location":"maplibre/#anymap.maplibre.MapLibreMap.add_control","title":"<code>add_control(self, control_type, position='top-right', options=None)</code>","text":"<p>Add a control to the map.</p> <p>Parameters:</p> Name Type Description Default <code>control_type</code> <code>str</code> <p>Type of control ('navigation', 'scale', 'fullscreen', 'geolocate', 'attribution', 'globe')</p> required <code>position</code> <code>str</code> <p>Position on map ('top-left', 'top-right', 'bottom-left', 'bottom-right')</p> <code>'top-right'</code> <code>options</code> <code>Optional[Dict[str, Any]]</code> <p>Additional options for the control</p> <code>None</code> Source code in <code>anymap/maplibre.py</code> <pre><code>def add_control(\n    self,\n    control_type: str,\n    position: str = \"top-right\",\n    options: Optional[Dict[str, Any]] = None,\n) -&gt; None:\n    \"\"\"Add a control to the map.\n\n    Args:\n        control_type: Type of control ('navigation', 'scale', 'fullscreen', 'geolocate', 'attribution', 'globe')\n        position: Position on map ('top-left', 'top-right', 'bottom-left', 'bottom-right')\n        options: Additional options for the control\n    \"\"\"\n    control_options = options or {}\n    control_options[\"position\"] = position\n\n    # Store control in persistent state\n    control_key = f\"{control_type}_{position}\"\n    current_controls = dict(self._controls)\n    current_controls[control_key] = {\n        \"type\": control_type,\n        \"position\": position,\n        \"options\": control_options,\n    }\n    self._controls = current_controls\n\n    self.call_js_method(\"addControl\", control_type, control_options)\n</code></pre>"},{"location":"maplibre/#anymap.maplibre.MapLibreMap.add_deckgl_layer","title":"<code>add_deckgl_layer(self, layer_id, layer_type, data, props=None, visible=True, **kwargs)</code>","text":"<p>Add a DeckGL layer to the map.</p> <p>This method adds a DeckGL layer overlay to the MapLibre map. DeckGL provides high-performance visualization of large datasets with WebGL-powered layers.</p> <p>Parameters:</p> Name Type Description Default <code>layer_id</code> <code>str</code> <p>Unique identifier for the DeckGL layer.</p> required <code>layer_type</code> <code>str</code> <p>Type of DeckGL layer (e.g., 'ScatterplotLayer', 'PathLayer', 'GeoJsonLayer').</p> required <code>data</code> <code>Union[List[Dict], Dict[str, Any]]</code> <p>Data for the layer. Can be a list of objects or GeoJSON-like structure.</p> required <code>props</code> <code>Optional[Dict[str, Any]]</code> <p>Layer-specific properties for styling and behavior.</p> <code>None</code> <code>visible</code> <code>bool</code> <p>Whether the layer should be visible initially.</p> <code>True</code> <code>**kwargs</code> <code>Any</code> <p>Additional layer properties.</p> <code>{}</code> <p>Examples:</p> <pre><code>&gt;&gt;&gt; m = MapLibreMap()\n&gt;&gt;&gt;\n&gt;&gt;&gt; # Add a scatterplot layer\n&gt;&gt;&gt; data = [\n...     {\"position\": [-122.4, 37.8], \"radius\": 100, \"color\": [255, 0, 0]},\n...     {\"position\": [-74.0, 40.7], \"radius\": 150, \"color\": [0, 255, 0]}\n... ]\n&gt;&gt;&gt; m.add_deckgl_layer(\n...     \"my_points\",\n...     \"ScatterplotLayer\",\n...     data,\n...     props={\n...         \"getPosition\": \"position\",\n...         \"getRadius\": \"radius\",\n...         \"getFillColor\": \"color\",\n...         \"pickable\": True\n...     }\n... )\n</code></pre> Source code in <code>anymap/maplibre.py</code> <pre><code>def add_deckgl_layer(\n    self,\n    layer_id: str,\n    layer_type: str,\n    data: Union[List[Dict], Dict[str, Any]],\n    props: Optional[Dict[str, Any]] = None,\n    visible: bool = True,\n    **kwargs: Any,\n) -&gt; None:\n    \"\"\"Add a DeckGL layer to the map.\n\n    This method adds a DeckGL layer overlay to the MapLibre map. DeckGL provides\n    high-performance visualization of large datasets with WebGL-powered layers.\n\n    Args:\n        layer_id: Unique identifier for the DeckGL layer.\n        layer_type: Type of DeckGL layer (e.g., 'ScatterplotLayer', 'PathLayer', 'GeoJsonLayer').\n        data: Data for the layer. Can be a list of objects or GeoJSON-like structure.\n        props: Layer-specific properties for styling and behavior.\n        visible: Whether the layer should be visible initially.\n        **kwargs: Additional layer properties.\n\n    Example:\n        &gt;&gt;&gt; m = MapLibreMap()\n        &gt;&gt;&gt;\n        &gt;&gt;&gt; # Add a scatterplot layer\n        &gt;&gt;&gt; data = [\n        ...     {\"position\": [-122.4, 37.8], \"radius\": 100, \"color\": [255, 0, 0]},\n        ...     {\"position\": [-74.0, 40.7], \"radius\": 150, \"color\": [0, 255, 0]}\n        ... ]\n        &gt;&gt;&gt; m.add_deckgl_layer(\n        ...     \"my_points\",\n        ...     \"ScatterplotLayer\",\n        ...     data,\n        ...     props={\n        ...         \"getPosition\": \"position\",\n        ...         \"getRadius\": \"radius\",\n        ...         \"getFillColor\": \"color\",\n        ...         \"pickable\": True\n        ...     }\n        ... )\n    \"\"\"\n    if props is None:\n        props = {}\n\n    # Merge kwargs into props\n    layer_props = {**props, **kwargs}\n\n    # Convert lambda functions to JavaScript-compatible strings\n    layer_props = self._process_deckgl_props(layer_props)\n\n    layer_config = {\n        \"id\": layer_id,\n        \"type\": layer_type,\n        \"data\": data,\n        \"props\": layer_props,\n        \"visible\": visible,\n    }\n\n    # Store layer in local state\n    current_layers = dict(self._deckgl_layers)\n    current_layers[layer_id] = layer_config\n    self._deckgl_layers = current_layers\n\n    # Send to JavaScript\n    self.call_js_method(\"addDeckGLLayer\", layer_config)\n</code></pre>"},{"location":"maplibre/#anymap.maplibre.MapLibreMap.add_draw_control","title":"<code>add_draw_control(self, position='top-left', controls=None, default_mode='simple_select', keybindings=True, touch_enabled=True, preserve_selection_on_edit=True, styles=None, **kwargs)</code>","text":"<p>Add a draw control to the map for drawing and editing geometries.</p> <p>Parameters:</p> Name Type Description Default <code>position</code> <code>str</code> <p>Position on map ('top-left', 'top-right', 'bottom-left', 'bottom-right')</p> <code>'top-left'</code> <code>controls</code> <code>Optional[Dict[str, bool]]</code> <p>Dictionary specifying which drawing tools to show.      Defaults to {'point': True, 'line_string': True, 'polygon': True, 'trash': True}</p> <code>None</code> <code>default_mode</code> <code>str</code> <p>Initial interaction mode ('simple_select', 'direct_select', 'draw_point', etc.)</p> <code>'simple_select'</code> <code>keybindings</code> <code>bool</code> <p>Whether to enable keyboard shortcuts</p> <code>True</code> <code>touch_enabled</code> <code>bool</code> <p>Whether to enable touch interactions</p> <code>True</code> <code>preserve_selection_on_edit</code> <code>bool</code> <p>Whether to keep features selected during vertex editing/moving.                        If True, features remain selected after editing. If False, uses                        default MapboxDraw behavior (deselection after edit).</p> <code>True</code> <code>styles</code> <code>Optional[List[Dict[str, Any]]]</code> <p>Optional list of custom MapboxDraw style objects. If None, uses default styles.    Each style should be a dict with 'id', 'type', 'filter', and 'paint'/'layout' properties.    See MapboxDraw documentation for style object format.</p> <code>None</code> <code>**kwargs</code> <code>Any</code> <p>Additional options to pass to MapboxDraw constructor</p> <code>{}</code> Source code in <code>anymap/maplibre.py</code> <pre><code>def add_draw_control(\n    self,\n    position: str = \"top-left\",\n    controls: Optional[Dict[str, bool]] = None,\n    default_mode: str = \"simple_select\",\n    keybindings: bool = True,\n    touch_enabled: bool = True,\n    preserve_selection_on_edit: bool = True,\n    styles: Optional[List[Dict[str, Any]]] = None,\n    **kwargs: Any,\n) -&gt; None:\n    \"\"\"Add a draw control to the map for drawing and editing geometries.\n\n    Args:\n        position: Position on map ('top-left', 'top-right', 'bottom-left', 'bottom-right')\n        controls: Dictionary specifying which drawing tools to show.\n                 Defaults to {'point': True, 'line_string': True, 'polygon': True, 'trash': True}\n        default_mode: Initial interaction mode ('simple_select', 'direct_select', 'draw_point', etc.)\n        keybindings: Whether to enable keyboard shortcuts\n        touch_enabled: Whether to enable touch interactions\n        preserve_selection_on_edit: Whether to keep features selected during vertex editing/moving.\n                                   If True, features remain selected after editing. If False, uses\n                                   default MapboxDraw behavior (deselection after edit).\n        styles: Optional list of custom MapboxDraw style objects. If None, uses default styles.\n               Each style should be a dict with 'id', 'type', 'filter', and 'paint'/'layout' properties.\n               See MapboxDraw documentation for style object format.\n        **kwargs: Additional options to pass to MapboxDraw constructor\n    \"\"\"\n    if controls is None:\n        controls = {\n            \"point\": True,\n            \"line_string\": True,\n            \"polygon\": True,\n            \"trash\": True,\n        }\n\n    draw_options = {\n        \"displayControlsDefault\": False,\n        \"controls\": controls,\n        \"defaultMode\": default_mode,\n        \"keybindings\": keybindings,\n        \"touchEnabled\": touch_enabled,\n        \"position\": position,\n        \"preserveSelectionOnEdit\": preserve_selection_on_edit,\n        \"customStyles\": styles,\n        **kwargs,\n    }\n\n    # Store draw control configuration\n    current_controls = dict(self._controls)\n    draw_key = f\"draw_{position}\"\n    current_controls[draw_key] = {\n        \"type\": \"draw\",\n        \"position\": position,\n        \"options\": draw_options,\n    }\n    self._controls = current_controls\n\n    self.call_js_method(\"addDrawControl\", draw_options)\n</code></pre>"},{"location":"maplibre/#anymap.maplibre.MapLibreMap.add_draw_data","title":"<code>add_draw_data(self, geojson_data)</code>","text":"<p>Add GeoJSON features to the existing draw control data.</p> <p>This method appends new features to the draw control without clearing existing drawn features, unlike load_draw_data which replaces all data.</p> <p>Parameters:</p> Name Type Description Default <code>geojson_data</code> <code>Union[Dict[str, Any], str]</code> <p>GeoJSON data as dictionary or JSON string. Can be a          FeatureCollection or a single Feature.</p> required Source code in <code>anymap/maplibre.py</code> <pre><code>def add_draw_data(self, geojson_data: Union[Dict[str, Any], str]) -&gt; None:\n    \"\"\"Add GeoJSON features to the existing draw control data.\n\n    This method appends new features to the draw control without clearing\n    existing drawn features, unlike load_draw_data which replaces all data.\n\n    Args:\n        geojson_data: GeoJSON data as dictionary or JSON string. Can be a\n                     FeatureCollection or a single Feature.\n    \"\"\"\n    if isinstance(geojson_data, str):\n        geojson_data = json.loads(geojson_data)\n\n    # Normalize input to FeatureCollection if it's a single Feature\n    if geojson_data.get(\"type\") == \"Feature\":\n        geojson_data = {\"type\": \"FeatureCollection\", \"features\": [geojson_data]}\n\n    # Send to JavaScript - it will handle adding features and syncing back the data\n    self.call_js_method(\"addDrawData\", geojson_data)\n</code></pre>"},{"location":"maplibre/#anymap.maplibre.MapLibreMap.add_export_control","title":"<code>add_export_control(self, position='top-right', filename='map', page_size=None, page_orientation='landscape', default_format='pdf', dpi=300, allowed_sizes=None, crosshair=False, printable_area=False, locale='en', options=None, collapsed=True)</code>","text":"<p>Add an export control for saving the map as images or PDF.</p> <p>This control leverages the <code>@watergis/maplibre-gl-export</code> plugin to provide an interactive, collapsible button that lets users export the current map view as PNG, JPEG, PDF, or SVG files. The control appears alongside other MapLibre controls and opens a small panel when toggled.</p> <p>Parameters:</p> Name Type Description Default <code>position</code> <code>str</code> <p>Placement of the control on the map container.</p> <code>'top-right'</code> <code>filename</code> <code>str</code> <p>Default filename (without extension) suggested for exports.</p> <code>'map'</code> <code>page_size</code> <code>Optional[Sequence[Union[int, float]]]</code> <p>Size of the export page in millimetres as [width, height]. If omitted, the plugin defaults to A4.</p> <code>None</code> <code>page_orientation</code> <code>str</code> <p>Page orientation, either <code>\"landscape\"</code> or <code>\"portrait\"</code>.</p> <code>'landscape'</code> <code>default_format</code> <code>str</code> <p>Default export format (<code>\"pdf\"</code>, <code>\"png\"</code>, <code>\"jpg\"</code>, <code>\"svg\"</code>).</p> <code>'pdf'</code> <code>dpi</code> <code>int</code> <p>Dots per inch used when rendering the export.</p> <code>300</code> <code>allowed_sizes</code> <code>Optional[Sequence[str]]</code> <p>Optional whitelist of page sizes (e.g. <code>[\"A4\", \"LETTER\"]</code>).</p> <code>None</code> <code>crosshair</code> <code>bool</code> <p>Whether to show the crosshair overlay when the panel is open.</p> <code>False</code> <code>printable_area</code> <code>bool</code> <p>Whether to show the printable area overlay when the panel is open.</p> <code>False</code> <code>locale</code> <code>str</code> <p>Two-letter locale code for the control's UI language.</p> <code>'en'</code> <code>options</code> <code>Optional[Dict[str, Any]]</code> <p>Extra keyword arguments forwarded to the export plugin.</p> <code>None</code> <code>collapsed</code> <code>bool</code> <p>Whether the control should start collapsed (button only).</p> <code>True</code> Source code in <code>anymap/maplibre.py</code> <pre><code>def add_export_control(\n    self,\n    position: str = \"top-right\",\n    filename: str = \"map\",\n    page_size: Optional[Sequence[Union[int, float]]] = None,\n    page_orientation: str = \"landscape\",\n    default_format: str = \"pdf\",\n    dpi: int = 300,\n    allowed_sizes: Optional[Sequence[str]] = None,\n    crosshair: bool = False,\n    printable_area: bool = False,\n    locale: str = \"en\",\n    options: Optional[Dict[str, Any]] = None,\n    collapsed: bool = True,\n) -&gt; None:\n    \"\"\"Add an export control for saving the map as images or PDF.\n\n    This control leverages the `@watergis/maplibre-gl-export` plugin to provide an\n    interactive, collapsible button that lets users export the current map view as\n    PNG, JPEG, PDF, or SVG files. The control appears alongside other MapLibre\n    controls and opens a small panel when toggled.\n\n    Args:\n        position: Placement of the control on the map container.\n        filename: Default filename (without extension) suggested for exports.\n        page_size: Size of the export page in millimetres as [width, height]. If\n            omitted, the plugin defaults to A4.\n        page_orientation: Page orientation, either ``\"landscape\"`` or ``\"portrait\"``.\n        default_format: Default export format (``\"pdf\"``, ``\"png\"``, ``\"jpg\"``, ``\"svg\"``).\n        dpi: Dots per inch used when rendering the export.\n        allowed_sizes: Optional whitelist of page sizes (e.g. ``[\"A4\", \"LETTER\"]``).\n        crosshair: Whether to show the crosshair overlay when the panel is open.\n        printable_area: Whether to show the printable area overlay when the panel is open.\n        locale: Two-letter locale code for the control's UI language.\n        options: Extra keyword arguments forwarded to the export plugin.\n        collapsed: Whether the control should start collapsed (button only).\n    \"\"\"\n\n    orientation_value = page_orientation.lower()\n    if orientation_value not in {\"landscape\", \"portrait\"}:\n        raise ValueError(\"page_orientation must be 'landscape' or 'portrait'\")\n\n    format_value = default_format.lower()\n    if format_value not in {\"png\", \"jpg\", \"jpeg\", \"pdf\", \"svg\"}:\n        raise ValueError(\n            \"default_format must be one of {'png', 'jpg', 'jpeg', 'pdf', 'svg'}\"\n        )\n    # Normalise JPEG alias\n    if format_value == \"jpeg\":\n        format_value = \"jpg\"\n\n    control_options: Dict[str, Any] = dict(options or {})\n    clean_filename = (\n        filename.strip() if isinstance(filename, str) else str(filename)\n    )\n    clean_locale = (\n        locale.strip().lower() if isinstance(locale, str) else str(locale).lower()\n    )\n\n    control_options[\"position\"] = position\n    control_options.setdefault(\"Filename\", clean_filename or \"map\")\n    control_options.setdefault(\"PageOrientation\", orientation_value)\n    control_options.setdefault(\"Format\", format_value)\n    control_options.setdefault(\"DPI\", int(dpi))\n    control_options.setdefault(\"Crosshair\", bool(crosshair))\n    control_options.setdefault(\"PrintableArea\", bool(printable_area))\n    control_options.setdefault(\"Locale\", clean_locale or \"en\")\n    control_options[\"collapsed\"] = collapsed\n\n    if page_size is not None:\n        page_size_values = list(page_size)\n        if len(page_size_values) != 2:\n            raise ValueError(\n                \"page_size must contain exactly two values [width, height]\"\n            )\n        control_options[\"PageSize\"] = [\n            float(page_size_values[0]),\n            float(page_size_values[1]),\n        ]\n\n    if allowed_sizes is not None:\n        control_options[\"AllowedSizes\"] = [\n            size.upper() for size in allowed_sizes if isinstance(size, str)\n        ]\n\n    control_key = f\"export_{position}\"\n    current_controls = dict(self._controls)\n    current_controls[control_key] = {\n        \"type\": \"export\",\n        \"position\": position,\n        \"options\": control_options,\n    }\n    self._controls = current_controls\n\n    self.call_js_method(\"addControl\", \"export\", control_options)\n</code></pre>"},{"location":"maplibre/#anymap.maplibre.MapLibreMap.add_flatgeobuf_layer","title":"<code>add_flatgeobuf_layer(self, url, layer_id, *, layer_type='fill', source_id=None, paint=None, layout=None, filter=None, bbox=None, promote_id=None, minzoom=None, maxzoom=None, before_id=None, metadata=None, name=None)</code>","text":"<p>Add a vector layer from a FlatGeobuf dataset.</p> <p>The FlatGeobuf file is streamed in the browser and converted to GeoJSON before being added to the map. Rendering happens entirely client-side, so very large datasets may still impact browser performance.</p> <p>Parameters:</p> Name Type Description Default <code>url</code> <code>str</code> <p>URL pointing to the FlatGeobuf resource.</p> required <code>layer_id</code> <code>str</code> <p>Unique identifier for the map layer.</p> required <code>layer_type</code> <code>str</code> <p>MapLibre layer type (e.g., <code>'fill'</code>, <code>'line'</code>, <code>'circle'</code>).</p> <code>'fill'</code> <code>source_id</code> <code>Optional[str]</code> <p>Optional custom source identifier. Defaults to <code>{layer_id}_source</code>.</p> <code>None</code> <code>paint</code> <code>Optional[Dict[str, Any]]</code> <p>Optional paint properties dictionary.</p> <code>None</code> <code>layout</code> <code>Optional[Dict[str, Any]]</code> <p>Optional layout properties dictionary.</p> <code>None</code> <code>filter</code> <code>Optional[Any]</code> <p>Optional MapLibre expression used to filter features.</p> <code>None</code> <code>bbox</code> <code>Optional[List[float]]</code> <p>Optional bounding box <code>[minX, minY, maxX, maxY]</code> used to limit features retrieved from the dataset.</p> <code>None</code> <code>promote_id</code> <code>Union[str, Dict[str, str]]</code> <p>Optional feature identifier promotion configuration.</p> <code>None</code> <code>minzoom</code> <code>Optional[float]</code> <p>Optional minimum zoom level for the layer.</p> <code>None</code> <code>maxzoom</code> <code>Optional[float]</code> <p>Optional maximum zoom level for the layer.</p> <code>None</code> <code>before_id</code> <code>Optional[str]</code> <p>Optional layer id to insert the new layer before.</p> <code>None</code> <code>metadata</code> <code>Optional[Dict[str, Any]]</code> <p>Optional metadata dictionary attached to the layer configuration.</p> <code>None</code> <code>name</code> <code>Optional[str]</code> <p>Optional friendly name used in the layer manager. Defaults to <code>layer_id</code>.</p> <code>None</code> <p>Returns:</p> Type Description <code>str</code> <p>The identifier of the layer that was registered.</p> Source code in <code>anymap/maplibre.py</code> <pre><code>def add_flatgeobuf_layer(\n    self,\n    url: str,\n    layer_id: str,\n    *,\n    layer_type: str = \"fill\",\n    source_id: Optional[str] = None,\n    paint: Optional[Dict[str, Any]] = None,\n    layout: Optional[Dict[str, Any]] = None,\n    filter: Optional[Any] = None,\n    bbox: Optional[List[float]] = None,\n    promote_id: Optional[Union[str, Dict[str, str]]] = None,\n    minzoom: Optional[float] = None,\n    maxzoom: Optional[float] = None,\n    before_id: Optional[str] = None,\n    metadata: Optional[Dict[str, Any]] = None,\n    name: Optional[str] = None,\n) -&gt; str:\n    \"\"\"\n    Add a vector layer from a FlatGeobuf dataset.\n\n    The FlatGeobuf file is streamed in the browser and converted to GeoJSON\n    before being added to the map. Rendering happens entirely client-side,\n    so very large datasets may still impact browser performance.\n\n    Args:\n        url: URL pointing to the FlatGeobuf resource.\n        layer_id: Unique identifier for the map layer.\n        layer_type: MapLibre layer type (e.g., ``'fill'``, ``'line'``, ``'circle'``).\n        source_id: Optional custom source identifier. Defaults to ``{layer_id}_source``.\n        paint: Optional paint properties dictionary.\n        layout: Optional layout properties dictionary.\n        filter: Optional MapLibre expression used to filter features.\n        bbox: Optional bounding box ``[minX, minY, maxX, maxY]`` used to limit\n            features retrieved from the dataset.\n        promote_id: Optional feature identifier promotion configuration.\n        minzoom: Optional minimum zoom level for the layer.\n        maxzoom: Optional maximum zoom level for the layer.\n        before_id: Optional layer id to insert the new layer before.\n        metadata: Optional metadata dictionary attached to the layer configuration.\n        name: Optional friendly name used in the layer manager. Defaults to ``layer_id``.\n\n    Returns:\n        str: The identifier of the layer that was registered.\n    \"\"\"\n\n    if source_id is None:\n        source_id = f\"{layer_id}_source\"\n\n    layer_config: Dict[str, Any] = {\n        \"id\": layer_id,\n        \"type\": layer_type,\n        \"source\": source_id,\n    }\n    if paint:\n        layer_config[\"paint\"] = paint\n    if layout:\n        layer_config[\"layout\"] = layout\n    if filter is not None:\n        layer_config[\"filter\"] = filter\n    if promote_id is not None:\n        layer_config[\"promoteId\"] = promote_id\n    if minzoom is not None:\n        layer_config[\"minzoom\"] = minzoom\n    if maxzoom is not None:\n        layer_config[\"maxzoom\"] = maxzoom\n    if metadata:\n        layer_config[\"metadata\"] = metadata\n\n    # Track the layer locally so the layer manager can interact with it.\n    current_layers = dict(self._layers)\n    current_layers[layer_id] = layer_config\n    self._layers = current_layers\n\n    display_name = name or layer_id\n    self.layer_dict[layer_id] = {\n        \"layer\": layer_config,\n        \"opacity\": 1.0,\n        \"visible\": True,\n        \"type\": \"flatgeobuf\",\n        \"name\": display_name,\n        \"url\": url,\n    }\n    self._update_layer_controls()\n\n    config: Dict[str, Any] = {\n        \"layerId\": layer_id,\n        \"sourceId\": source_id,\n        \"url\": url,\n        \"layerType\": layer_type,\n    }\n    if paint:\n        config[\"paint\"] = paint\n    if layout:\n        config[\"layout\"] = layout\n    if filter is not None:\n        config[\"filter\"] = filter\n    if bbox is not None:\n        config[\"bbox\"] = bbox\n    if promote_id is not None:\n        config[\"promoteId\"] = promote_id\n    if minzoom is not None:\n        config[\"minzoom\"] = minzoom\n    if maxzoom is not None:\n        config[\"maxzoom\"] = maxzoom\n    if before_id is not None:\n        config[\"beforeId\"] = before_id\n    if metadata:\n        config[\"metadata\"] = metadata\n    if name:\n        config[\"name\"] = display_name\n\n    flatgeobuf_layers = dict(self.flatgeobuf_layers)\n    flatgeobuf_layers[layer_id] = config\n    self.flatgeobuf_layers = flatgeobuf_layers\n\n    return layer_id\n</code></pre>"},{"location":"maplibre/#anymap.maplibre.MapLibreMap.add_geocoder_control","title":"<code>add_geocoder_control(self, position='top-left', api_config=None, options=None, collapsed=True)</code>","text":"<p>Add a geocoder control to the map for searching locations.</p> <p>The geocoder control allows users to search for locations using a geocoding service. By default, it uses the Nominatim (OpenStreetMap) geocoding API.</p> <p>Parameters:</p> Name Type Description Default <code>position</code> <code>str</code> <p>Position on map ('top-left', 'top-right', 'bottom-left', 'bottom-right')</p> <code>'top-left'</code> <code>api_config</code> <code>Optional[Dict[str, Any]]</code> <p>Configuration for the geocoding API. If None, uses default Nominatim config</p> <code>None</code> <code>options</code> <code>Optional[Dict[str, Any]]</code> <p>Additional options for the geocoder control</p> <code>None</code> <code>collapsed</code> <code>bool</code> <p>If True, shows only search icon initially. Click to expand input box.</p> <code>True</code> Source code in <code>anymap/maplibre.py</code> <pre><code>def add_geocoder_control(\n    self,\n    position: str = \"top-left\",\n    api_config: Optional[Dict[str, Any]] = None,\n    options: Optional[Dict[str, Any]] = None,\n    collapsed: bool = True,\n) -&gt; None:\n    \"\"\"Add a geocoder control to the map for searching locations.\n\n    The geocoder control allows users to search for locations using a geocoding service.\n    By default, it uses the Nominatim (OpenStreetMap) geocoding API.\n\n    Args:\n        position: Position on map ('top-left', 'top-right', 'bottom-left', 'bottom-right')\n        api_config: Configuration for the geocoding API. If None, uses default Nominatim config\n        options: Additional options for the geocoder control\n        collapsed: If True, shows only search icon initially. Click to expand input box.\n    \"\"\"\n    if api_config is None:\n        # Default configuration using Nominatim API\n        api_config = {\n            \"forwardGeocode\": True,\n            \"reverseGeocode\": False,\n            \"placeholder\": \"Search for places...\",\n            \"limit\": 5,\n            \"api_url\": \"https://nominatim.openstreetmap.org/search\",\n        }\n\n    control_options = options or {}\n    control_options.update(\n        {\n            \"position\": position,\n            \"api_config\": api_config,\n            \"collapsed\": collapsed,\n        }\n    )\n\n    # Store control in persistent state\n    control_key = f\"geocoder_{position}\"\n    current_controls = dict(self._controls)\n    current_controls[control_key] = {\n        \"type\": \"geocoder\",\n        \"position\": position,\n        \"options\": control_options,\n    }\n    self._controls = current_controls\n\n    self.call_js_method(\"addControl\", \"geocoder\", control_options)\n</code></pre>"},{"location":"maplibre/#anymap.maplibre.MapLibreMap.add_geogrid_control","title":"<code>add_geogrid_control(self, position='top-left', before_layer_id=None, zoom_level_range=None, grid_style=None, label_style=None, options=None)</code>","text":"<p>Add a geographic grid (graticule) with labeled coordinates to the map.</p> <p>This control uses the <code>geogrid-maplibre-gl</code> plugin to display latitude/longitude grid lines with customizable styling and formatting. The grid dynamically adjusts based on zoom level and supports globe projection (MapLibre GL 5.x).</p> <p>Parameters:</p> Name Type Description Default <code>position</code> <code>str</code> <p>Placement of the control on the map container (not applicable for this plugin, but kept for API consistency).</p> <code>'top-left'</code> <code>before_layer_id</code> <code>Optional[str]</code> <p>ID of the layer to insert the grid beneath. If None, the grid is added as the top layer.</p> <code>None</code> <code>zoom_level_range</code> <code>Optional[Sequence[Union[int, float]]]</code> <p>Tuple of [min_zoom, max_zoom] defining visibility range. If None, the grid is visible at all zoom levels.</p> <code>None</code> <code>grid_style</code> <code>Optional[Dict[str, Any]]</code> <p>Styling options for grid lines. Supports both MapLibre paint properties (<code>line-color</code>, <code>line-width</code>, <code>line-dasharray</code>, <code>line-opacity</code>) and GeoGrid native properties (<code>color</code>, <code>width</code>, <code>dasharray</code>, <code>opacity</code>). MapLibre properties are automatically converted to GeoGrid format.</p> <code>None</code> <code>label_style</code> <code>Optional[Dict[str, Any]]</code> <p>Styling options for coordinate labels. Supports CSS properties like <code>color</code>, <code>fontSize</code>, <code>textShadow</code>, etc.</p> <code>None</code> <code>options</code> <code>Optional[Dict[str, Any]]</code> <p>Additional configuration options passed directly to the GeoGrid constructor. Can include custom <code>gridDensity</code> or <code>formatLabels</code> functions.</p> <code>None</code> <p>Examples:</p> <pre><code>&gt;&gt;&gt; m = MapLibreMap(center=[0, 20], zoom=2)\n&gt;&gt;&gt; # Using MapLibre paint properties\n&gt;&gt;&gt; m.add_geogrid_control(grid_style={'line-color': '#ff0000', 'line-width': 2})\n&gt;&gt;&gt; # Using GeoGrid native properties\n&gt;&gt;&gt; m.add_geogrid_control(grid_style={'color': 'red', 'width': 2})\n</code></pre> Source code in <code>anymap/maplibre.py</code> <pre><code>def add_geogrid_control(\n    self,\n    position: str = \"top-left\",\n    before_layer_id: Optional[str] = None,\n    zoom_level_range: Optional[Sequence[Union[int, float]]] = None,\n    grid_style: Optional[Dict[str, Any]] = None,\n    label_style: Optional[Dict[str, Any]] = None,\n    options: Optional[Dict[str, Any]] = None,\n) -&gt; None:\n    \"\"\"Add a geographic grid (graticule) with labeled coordinates to the map.\n\n    This control uses the `geogrid-maplibre-gl` plugin to display latitude/longitude\n    grid lines with customizable styling and formatting. The grid dynamically adjusts\n    based on zoom level and supports globe projection (MapLibre GL 5.x).\n\n    Args:\n        position: Placement of the control on the map container (not applicable\n            for this plugin, but kept for API consistency).\n        before_layer_id: ID of the layer to insert the grid beneath. If None,\n            the grid is added as the top layer.\n        zoom_level_range: Tuple of [min_zoom, max_zoom] defining visibility range.\n            If None, the grid is visible at all zoom levels.\n        grid_style: Styling options for grid lines. Supports both MapLibre paint\n            properties (``line-color``, ``line-width``, ``line-dasharray``,\n            ``line-opacity``) and GeoGrid native properties (``color``, ``width``,\n            ``dasharray``, ``opacity``). MapLibre properties are automatically\n            converted to GeoGrid format.\n        label_style: Styling options for coordinate labels. Supports CSS properties\n            like ``color``, ``fontSize``, ``textShadow``, etc.\n        options: Additional configuration options passed directly to the GeoGrid\n            constructor. Can include custom ``gridDensity`` or ``formatLabels`` functions.\n\n    Example:\n        &gt;&gt;&gt; m = MapLibreMap(center=[0, 20], zoom=2)\n        &gt;&gt;&gt; # Using MapLibre paint properties\n        &gt;&gt;&gt; m.add_geogrid_control(grid_style={'line-color': '#ff0000', 'line-width': 2})\n        &gt;&gt;&gt; # Using GeoGrid native properties\n        &gt;&gt;&gt; m.add_geogrid_control(grid_style={'color': 'red', 'width': 2})\n    \"\"\"\n\n    control_options: Dict[str, Any] = dict(options or {})\n    control_options[\"position\"] = position\n\n    if before_layer_id is not None:\n        control_options[\"beforeLayerId\"] = before_layer_id\n\n    if zoom_level_range is not None:\n        zoom_range = list(zoom_level_range)\n        if len(zoom_range) != 2:\n            raise ValueError(\n                \"zoom_level_range must contain exactly two values [min_zoom, max_zoom]\"\n            )\n        control_options[\"zoomLevelRange\"] = [\n            float(zoom_range[0]),\n            float(zoom_range[1]),\n        ]\n\n    if grid_style is not None:\n        control_options[\"gridStyle\"] = dict(grid_style)\n\n    if label_style is not None:\n        control_options[\"labelStyle\"] = dict(label_style)\n\n    control_key = f\"geogrid_{position}\"\n    current_controls = dict(self._controls)\n    current_controls[control_key] = {\n        \"type\": \"geogrid\",\n        \"position\": position,\n        \"options\": control_options,\n    }\n    self._controls = current_controls\n\n    self.call_js_method(\"addControl\", \"geogrid\", control_options)\n</code></pre>"},{"location":"maplibre/#anymap.maplibre.MapLibreMap.add_geojson","title":"<code>add_geojson(self, data, layer_type=None, filter=None, paint=None, name=None, fit_bounds=True, visible=True, opacity=1.0, before_id=None, source_args=None, **kwargs)</code>","text":"<p>Add a GeoJSON layer to the map.</p> <p>This method adds a GeoJSON layer to the map. The GeoJSON data can be a URL to a GeoJSON file or a GeoJSON dictionary.</p> <p>Parameters:</p> Name Type Description Default <code>data</code> <code>Union[str, Dict]</code> <p>The GeoJSON data. This can be a URL to a GeoJSON file or a GeoJSON dictionary.</p> required <code>layer_type</code> <code>Optional[str]</code> <p>The type of the layer. It can be one of the following: 'circle', 'fill', 'fill-extrusion', 'line', 'symbol'. If None, the type is inferred from the GeoJSON data.</p> <code>None</code> <code>filter</code> <code>Optional[Dict]</code> <p>The filter to apply to the layer. If None, no filter is applied.</p> <code>None</code> <code>paint</code> <code>Optional[Dict]</code> <p>The paint properties to apply to the layer. If None, default paint properties are applied based on geometry type.</p> <code>None</code> <code>name</code> <code>Optional[str]</code> <p>The name of the layer. If None, 'GeoJSON' is used.</p> <code>None</code> <code>fit_bounds</code> <code>bool</code> <p>Whether to adjust the viewport of the map to fit the bounds of the GeoJSON data. Defaults to True.</p> <code>True</code> <code>visible</code> <code>bool</code> <p>Whether the layer is visible or not. Defaults to True.</p> <code>True</code> <code>opacity</code> <code>float</code> <p>The opacity of the layer. Defaults to 1.0.</p> <code>1.0</code> <code>before_id</code> <code>Optional[str]</code> <p>The ID of an existing layer before which the new layer should be inserted.</p> <code>None</code> <code>source_args</code> <code>Optional[Dict]</code> <p>Additional keyword arguments that are passed to the GeoJSON source.</p> <code>None</code> <code>**kwargs</code> <code>Any</code> <p>Additional keyword arguments that are passed to the layer.</p> <code>{}</code> Source code in <code>anymap/maplibre.py</code> <pre><code>def add_geojson(\n    self,\n    data: Union[str, Dict],\n    layer_type: Optional[str] = None,\n    filter: Optional[Dict] = None,\n    paint: Optional[Dict] = None,\n    name: Optional[str] = None,\n    fit_bounds: bool = True,\n    visible: bool = True,\n    opacity: float = 1.0,\n    before_id: Optional[str] = None,\n    source_args: Optional[Dict] = None,\n    **kwargs: Any,\n) -&gt; None:\n    \"\"\"Add a GeoJSON layer to the map.\n\n    This method adds a GeoJSON layer to the map. The GeoJSON data can be a\n    URL to a GeoJSON file or a GeoJSON dictionary.\n\n    Args:\n        data: The GeoJSON data. This can be a URL to a GeoJSON file or a\n            GeoJSON dictionary.\n        layer_type: The type of the layer. It can be one of the following:\n            'circle', 'fill', 'fill-extrusion', 'line', 'symbol'. If None,\n            the type is inferred from the GeoJSON data.\n        filter: The filter to apply to the layer. If None, no filter is applied.\n        paint: The paint properties to apply to the layer. If None, default\n            paint properties are applied based on geometry type.\n        name: The name of the layer. If None, 'GeoJSON' is used.\n        fit_bounds: Whether to adjust the viewport of the map to fit the\n            bounds of the GeoJSON data. Defaults to True.\n        visible: Whether the layer is visible or not. Defaults to True.\n        opacity: The opacity of the layer. Defaults to 1.0.\n        before_id: The ID of an existing layer before which the new layer\n            should be inserted.\n        source_args: Additional keyword arguments that are passed to the\n            GeoJSON source.\n        **kwargs: Additional keyword arguments that are passed to the layer.\n    \"\"\"\n    import geopandas as gpd\n\n    bounds = None\n    geom_type = None\n    source_args = source_args or {}\n\n    # Load data from file or URL if necessary\n    if isinstance(data, str):\n        if os.path.isfile(data) or data.startswith(\"http\"):\n            gdf = gpd.read_file(data)\n            data = gdf.__geo_interface__\n            if fit_bounds:\n                bounds = gdf.total_bounds  # [minx, miny, maxx, maxy]\n        else:\n            raise ValueError(\n                \"The data must be a URL, file path, or GeoJSON dictionary.\"\n            )\n    elif isinstance(data, dict) and data.get(\"type\") == \"FeatureCollection\":\n        if fit_bounds:\n            gdf = gpd.GeoDataFrame.from_features(data)\n            bounds = gdf.total_bounds  # [minx, miny, maxx, maxy]\n    elif not isinstance(data, dict):\n        raise ValueError(\n            \"The data must be a URL, file path, or GeoJSON dictionary.\"\n        )\n\n    # Generate layer name if not provided\n    if name is None:\n        name = \"GeoJSON\"\n\n    # Infer geometry type and set default paint if not provided\n    if paint is None:\n        if \"features\" in data and len(data[\"features\"]) &gt; 0:\n            geom_type = data[\"features\"][0][\"geometry\"][\"type\"]\n        elif \"geometry\" in data:\n            geom_type = data[\"geometry\"][\"type\"]\n\n        if geom_type in [\"Point\", \"MultiPoint\"]:\n            if layer_type is None:\n                layer_type = \"circle\"\n            paint = {\n                \"circle-radius\": 5,\n                \"circle-color\": \"#3388ff\",\n                \"circle-stroke-color\": \"#ffffff\",\n                \"circle-stroke-width\": 1,\n            }\n        elif geom_type in [\"LineString\", \"MultiLineString\"]:\n            if layer_type is None:\n                layer_type = \"line\"\n            paint = {\"line-color\": \"#3388ff\", \"line-width\": 2}\n        elif geom_type in [\"Polygon\", \"MultiPolygon\"]:\n            if layer_type is None:\n                layer_type = \"fill\"\n            paint = {\n                \"fill-color\": \"#3388ff\",\n                \"fill-opacity\": 0.5,\n            }\n\n    # Add source\n    source_id = f\"{name}_source\"\n    source_config = {\"type\": \"geojson\", \"data\": data}\n    source_config.update(source_args)\n    self.add_source(source_id, source_config)\n\n    # Prepare layer configuration\n    layer_config = {\n        \"id\": name,\n        \"type\": layer_type or \"fill\",\n        \"source\": source_id,\n    }\n\n    if filter is not None:\n        layer_config[\"filter\"] = filter\n\n    if paint is not None:\n        layer_config[\"paint\"] = paint\n\n    layer_config.update(kwargs)\n\n    # Add layer\n    self.add_layer(layer=layer_config, before_id=before_id, layer_id=name)\n\n    # Set visibility\n    if not visible:\n        self.set_visibility(name, False)\n\n    # Set opacity\n    if opacity &lt; 1.0:\n        self.set_opacity(name, opacity)\n\n    # Fit bounds if requested\n    if fit_bounds and bounds is not None:\n        # Convert from [minx, miny, maxx, maxy] to [[west, south], [east, north]]\n        self.fit_bounds([[bounds[0], bounds[1]], [bounds[2], bounds[3]]])\n</code></pre>"},{"location":"maplibre/#anymap.maplibre.MapLibreMap.add_geojson_layer","title":"<code>add_geojson_layer(self, layer_id, geojson_data, layer_type='fill', paint=None, before_id=None)</code>","text":"<p>Add a GeoJSON layer to the map.</p> <p>Parameters:</p> Name Type Description Default <code>layer_id</code> <code>str</code> <p>Unique identifier for the layer.</p> required <code>geojson_data</code> <code>Dict[str, Any]</code> <p>GeoJSON data as a dictionary.</p> required <code>layer_type</code> <code>str</code> <p>Type of layer (e.g., 'fill', 'line', 'circle', 'symbol').</p> <code>'fill'</code> <code>paint</code> <code>Optional[Dict[str, Any]]</code> <p>Optional paint properties for styling the layer.</p> <code>None</code> <code>before_id</code> <code>Optional[str]</code> <p>Optional layer ID to insert this layer before.</p> <code>None</code> Source code in <code>anymap/maplibre.py</code> <pre><code>def add_geojson_layer(\n    self,\n    layer_id: str,\n    geojson_data: Dict[str, Any],\n    layer_type: str = \"fill\",\n    paint: Optional[Dict[str, Any]] = None,\n    before_id: Optional[str] = None,\n) -&gt; None:\n    \"\"\"Add a GeoJSON layer to the map.\n\n    Args:\n        layer_id: Unique identifier for the layer.\n        geojson_data: GeoJSON data as a dictionary.\n        layer_type: Type of layer (e.g., 'fill', 'line', 'circle', 'symbol').\n        paint: Optional paint properties for styling the layer.\n        before_id: Optional layer ID to insert this layer before.\n    \"\"\"\n    source_id = f\"{layer_id}_source\"\n\n    # Add source\n    self.add_source(source_id, {\"type\": \"geojson\", \"data\": geojson_data})\n\n    # Add layer\n    layer_config = {\"id\": layer_id, \"type\": layer_type, \"source\": source_id}\n\n    if paint:\n        layer_config[\"paint\"] = paint\n\n    self.add_layer(layer=layer_config, before_id=before_id, layer_id=layer_id)\n</code></pre>"},{"location":"maplibre/#anymap.maplibre.MapLibreMap.add_geoman_control","title":"<code>add_geoman_control(self, position='top-left', geoman_options=None, settings=None, controls=None, collapsed=False)</code>","text":"<p>Add the MapLibre-Geoman drawing and editing toolkit.</p> <p>Parameters:</p> Name Type Description Default <code>position</code> <code>str</code> <p>Where to dock the Geoman toolbar on the map.</p> <code>'top-left'</code> <code>geoman_options</code> <code>Optional[Dict[str, Any]]</code> <p>Raw configuration dictionary passed directly to the <code>Geoman</code> constructor.</p> <code>None</code> <code>settings</code> <code>Optional[Dict[str, Any]]</code> <p>Optional convenience overrides merged into <code>geoman_options['settings']</code>.</p> <code>None</code> <code>controls</code> <code>Optional[Dict[str, Any]]</code> <p>Optional overrides for toolbar sections such as <code>draw</code>, <code>edit</code>, or <code>helper</code>. Each key should map to a dictionary of button configuration overrides.</p> <code>None</code> <code>collapsed</code> <code>Optional[bool]</code> <p>Whether the toolbar UI should start collapsed. Use <code>None</code> to defer to the underlying configuration.</p> <code>False</code> Source code in <code>anymap/maplibre.py</code> <pre><code>def add_geoman_control(\n    self,\n    position: str = \"top-left\",\n    geoman_options: Optional[Dict[str, Any]] = None,\n    settings: Optional[Dict[str, Any]] = None,\n    controls: Optional[Dict[str, Any]] = None,\n    collapsed: Optional[bool] = False,\n) -&gt; None:\n    \"\"\"Add the MapLibre-Geoman drawing and editing toolkit.\n\n    Args:\n        position: Where to dock the Geoman toolbar on the map.\n        geoman_options: Raw configuration dictionary passed directly to the\n            ``Geoman`` constructor.\n        settings: Optional convenience overrides merged into\n            ``geoman_options['settings']``.\n        controls: Optional overrides for toolbar sections such as ``draw``,\n            ``edit``, or ``helper``. Each key should map to a dictionary of\n            button configuration overrides.\n        collapsed: Whether the toolbar UI should start collapsed. Use\n            ``None`` to defer to the underlying configuration.\n    \"\"\"\n\n    geoman_config: Dict[str, Any] = dict(geoman_options or {})\n\n    if settings:\n        geoman_settings = geoman_config.setdefault(\"settings\", {})\n        geoman_settings.update(settings)\n\n    # Enable snapping by default\n    geoman_controls = geoman_config.setdefault(\"controls\", {})\n    helper_controls = geoman_controls.setdefault(\"helper\", {})\n    snapping_config = helper_controls.setdefault(\"snapping\", {})\n    if \"active\" not in snapping_config:\n        snapping_config[\"active\"] = True\n\n    if controls:\n        for section, section_options in controls.items():\n            if isinstance(section_options, dict):\n                section_config = geoman_controls.setdefault(section, {})\n                section_config.update(section_options)\n            else:\n                geoman_controls[section] = section_options\n\n    control_options: Dict[str, Any] = {\"position\": position}\n    if geoman_config:\n        control_options[\"geoman_options\"] = geoman_config\n\n    control_key = f\"geoman_{position}\"\n    current_controls = dict(self._controls)\n    current_controls[control_key] = {\n        \"type\": \"geoman\",\n        \"position\": position,\n        \"options\": control_options,\n    }\n    self._controls = current_controls\n    self.controls[\"geoman\"] = position\n\n    self.call_js_method(\"addControl\", \"geoman\", control_options)\n\n    if collapsed is not None:\n        if collapsed:\n            self.collapse_geoman_control()\n        else:\n            # If an explicit method to uncollapse exists, call it here.\n            # For now, this is a placeholder for future logic.\n            pass\n</code></pre>"},{"location":"maplibre/#anymap.maplibre.MapLibreMap.add_google_streetview","title":"<code>add_google_streetview(self, position='top-left', api_key=None, options=None)</code>","text":"<p>Add a Google Street View control to the map.</p> <p>This method adds a Google Street View control that allows users to view street-level imagery at clicked locations on the map.</p> <p>Parameters:</p> Name Type Description Default <code>position</code> <code>str</code> <p>Position on map ('top-left', 'top-right', 'bottom-left', 'bottom-right')</p> <code>'top-left'</code> <code>api_key</code> <code>Optional[str]</code> <p>Google Maps API key. If None, retrieves from GOOGLE_MAPS_API_KEY environment variable</p> <code>None</code> <code>options</code> <code>Optional[Dict[str, Any]]</code> <p>Additional options for the Street View control</p> <code>None</code> <p>Exceptions:</p> Type Description <code>ValueError</code> <p>If no API key is provided and none can be found in environment variables</p> Source code in <code>anymap/maplibre.py</code> <pre><code>def add_google_streetview(\n    self,\n    position: str = \"top-left\",\n    api_key: Optional[str] = None,\n    options: Optional[Dict[str, Any]] = None,\n) -&gt; None:\n    \"\"\"Add a Google Street View control to the map.\n\n    This method adds a Google Street View control that allows users to view\n    street-level imagery at clicked locations on the map.\n\n    Args:\n        position: Position on map ('top-left', 'top-right', 'bottom-left', 'bottom-right')\n        api_key: Google Maps API key. If None, retrieves from GOOGLE_MAPS_API_KEY environment variable\n        options: Additional options for the Street View control\n\n    Raises:\n        ValueError: If no API key is provided and none can be found in environment variables\n    \"\"\"\n    if api_key is None:\n        api_key = utils.get_env_var(\"GOOGLE_MAPS_API_KEY\")\n        if api_key is None:\n            raise ValueError(\n                \"Google Maps API key is required. Please provide it as a parameter \"\n                \"or set the GOOGLE_MAPS_API_KEY environment variable.\"\n            )\n\n    control_options = options or {}\n    control_options.update(\n        {\n            \"position\": position,\n            \"api_key\": api_key,\n        }\n    )\n\n    # Store control in persistent state\n    control_key = f\"google_streetview_{position}\"\n    current_controls = dict(self._controls)\n    current_controls[control_key] = {\n        \"type\": \"google_streetview\",\n        \"position\": position,\n        \"options\": control_options,\n    }\n    self._controls = current_controls\n\n    self.call_js_method(\"addControl\", \"google_streetview\", control_options)\n</code></pre>"},{"location":"maplibre/#anymap.maplibre.MapLibreMap.add_gradientbox_control","title":"<code>add_gradientbox_control(self, position='top-right', layer_id=None, weight_property=None, min_value=None, max_value=None, colors=None, collapsed=True, options=None)</code>","text":"<p>Add a GradientBox control (mapbox-gl-infobox) to show value legend.</p> <p>Parameters:</p> Name Type Description Default <code>position</code> <code>str</code> <p>Control position.</p> <code>'top-right'</code> <code>layer_id</code> <code>Optional[str]</code> <p>Optional target layer id used for value extraction.</p> <code>None</code> <code>weight_property</code> <code>Optional[str]</code> <p>Feature property name used to compute weights.</p> <code>None</code> <code>min_value</code> <code>Optional[float]</code> <p>Minimum value for gradient legend.</p> <code>None</code> <code>max_value</code> <code>Optional[float]</code> <p>Maximum value for gradient legend.</p> <code>None</code> <code>collapsed</code> <code>bool</code> <p>Whether the control starts collapsed.</p> <code>True</code> <code>options</code> <code>Optional[Dict[str, Any]]</code> <p>Additional plugin options.</p> <code>None</code> Source code in <code>anymap/maplibre.py</code> <pre><code>def add_gradientbox_control(\n    self,\n    position: str = \"top-right\",\n    layer_id: Optional[str] = None,\n    weight_property: Optional[str] = None,\n    min_value: Optional[float] = None,\n    max_value: Optional[float] = None,\n    colors: Optional[List[str]] = None,\n    collapsed: bool = True,\n    options: Optional[Dict[str, Any]] = None,\n) -&gt; None:\n    \"\"\"Add a GradientBox control (mapbox-gl-infobox) to show value legend.\n\n    Args:\n        position: Control position.\n        layer_id: Optional target layer id used for value extraction.\n        weight_property: Feature property name used to compute weights.\n        min_value: Minimum value for gradient legend.\n        max_value: Maximum value for gradient legend.\n        collapsed: Whether the control starts collapsed.\n        options: Additional plugin options.\n    \"\"\"\n    control_options: Dict[str, Any] = dict(options or {})\n    control_options.update(\n        {\n            \"position\": position,\n            \"collapsed\": collapsed,\n        }\n    )\n    if layer_id is not None:\n        control_options[\"layerId\"] = layer_id\n    if weight_property is not None:\n        control_options[\"weight_property\"] = weight_property\n    if min_value is not None or max_value is not None:\n        # JS layer will normalize into minMaxValues\n        control_options[\"min_value\"] = min_value\n        control_options[\"max_value\"] = max_value\n    if colors is not None:\n        control_options[\"colors\"] = colors\n\n    control_key = f\"gradientbox_{position}\"\n    current_controls = dict(self._controls)\n    current_controls[control_key] = {\n        \"type\": \"gradientbox\",\n        \"position\": position,\n        \"options\": control_options,\n    }\n    self._controls = current_controls\n\n    self.call_js_method(\"addControl\", \"gradientbox\", control_options)\n</code></pre>"},{"location":"maplibre/#anymap.maplibre.MapLibreMap.add_image_layer","title":"<code>add_image_layer(self, layer_id, image_url, coordinates, paint=None, before_id=None)</code>","text":"<p>Add an image layer to the map.</p> <p>Parameters:</p> Name Type Description Default <code>layer_id</code> <code>str</code> <p>Unique identifier for the layer.</p> required <code>image_url</code> <code>str</code> <p>URL of the image to display.</p> required <code>coordinates</code> <code>List[List[float]]</code> <p>Corner coordinates of the image as [[top-left], [top-right], [bottom-right], [bottom-left]].         Each coordinate should be [longitude, latitude].</p> required <code>paint</code> <code>Optional[Dict[str, Any]]</code> <p>Optional paint properties for the image layer.</p> <code>None</code> <code>before_id</code> <code>Optional[str]</code> <p>Optional layer ID to insert this layer before.</p> <code>None</code> Source code in <code>anymap/maplibre.py</code> <pre><code>def add_image_layer(\n    self,\n    layer_id: str,\n    image_url: str,\n    coordinates: List[List[float]],\n    paint: Optional[Dict[str, Any]] = None,\n    before_id: Optional[str] = None,\n) -&gt; None:\n    \"\"\"Add an image layer to the map.\n\n    Args:\n        layer_id: Unique identifier for the layer.\n        image_url: URL of the image to display.\n        coordinates: Corner coordinates of the image as [[top-left], [top-right], [bottom-right], [bottom-left]].\n                    Each coordinate should be [longitude, latitude].\n        paint: Optional paint properties for the image layer.\n        before_id: Optional layer ID to insert this layer before.\n    \"\"\"\n    source_id = f\"{layer_id}_source\"\n\n    # Add image source\n    self.add_source(\n        source_id, {\"type\": \"image\", \"url\": image_url, \"coordinates\": coordinates}\n    )\n\n    # Add raster layer for the image\n    layer_config = {\"id\": layer_id, \"type\": \"raster\", \"source\": source_id}\n\n    if paint:\n        layer_config[\"paint\"] = paint\n\n    self.add_layer(layer=layer_config, before_id=before_id, layer_id=layer_id)\n</code></pre>"},{"location":"maplibre/#anymap.maplibre.MapLibreMap.add_infobox_control","title":"<code>add_infobox_control(self, position='top-right', layer_id=None, formatter=None, collapsed=True, options=None)</code>","text":"<p>Add an InfoBox control (mapbox-gl-infobox) to display feature attributes.</p> <p>Parameters:</p> Name Type Description Default <code>position</code> <code>str</code> <p>Control position ('top-left', 'top-right', 'bottom-left', 'bottom-right').</p> <code>'top-right'</code> <code>layer_id</code> <code>Optional[str]</code> <p>Optional target layer id to listen for hover/click features.</p> <code>None</code> <code>formatter</code> <code>Union[str, Any]</code> <p>Either an HTML template string (e.g., \"{{name}}\") or a callable taking a properties dict and returning HTML. Strings will be templated against feature properties; unknown keys render as empty.</p> <code>None</code> <code>collapsed</code> <code>bool</code> <p>Whether the control starts collapsed.</p> <code>True</code> <code>options</code> <code>Optional[Dict[str, Any]]</code> <p>Additional plugin options passed through.</p> <code>None</code> Source code in <code>anymap/maplibre.py</code> <pre><code>def add_infobox_control(\n    self,\n    position: str = \"top-right\",\n    layer_id: Optional[str] = None,\n    formatter: Optional[Union[str, Any]] = None,\n    collapsed: bool = True,\n    options: Optional[Dict[str, Any]] = None,\n) -&gt; None:\n    \"\"\"Add an InfoBox control (mapbox-gl-infobox) to display feature attributes.\n\n    Args:\n        position: Control position ('top-left', 'top-right', 'bottom-left', 'bottom-right').\n        layer_id: Optional target layer id to listen for hover/click features.\n        formatter: Either an HTML template string (e.g., \"&lt;b&gt;{{name}}&lt;/b&gt;\") or a callable\n            taking a properties dict and returning HTML. Strings will be templated against\n            feature properties; unknown keys render as empty.\n        collapsed: Whether the control starts collapsed.\n        options: Additional plugin options passed through.\n    \"\"\"\n    control_options: Dict[str, Any] = dict(options or {})\n    control_options.update(\n        {\n            \"position\": position,\n            \"collapsed\": collapsed,\n        }\n    )\n    if layer_id is not None:\n        control_options[\"layerId\"] = layer_id\n    if formatter is not None:\n        # Strings are handled as templates in JS; callables cannot be serialized\n        if isinstance(formatter, str):\n            control_options[\"formatter\"] = formatter\n        else:\n            # Best-effort stringification to avoid non-serializable objects\n            control_options[\"formatter_template\"] = str(formatter)\n\n    control_key = f\"infobox_{position}\"\n    current_controls = dict(self._controls)\n    current_controls[control_key] = {\n        \"type\": \"infobox\",\n        \"position\": position,\n        \"options\": control_options,\n    }\n    self._controls = current_controls\n\n    self.call_js_method(\"addControl\", \"infobox\", control_options)\n</code></pre>"},{"location":"maplibre/#anymap.maplibre.MapLibreMap.add_layer","title":"<code>add_layer(self, layer, before_id=None, layer_id=None, opacity=1.0, visible=True, overwrite=False, **kwargs)</code>","text":"<p>Add a layer to the map.</p> <p>Parameters:</p> Name Type Description Default <code>layer_id</code> <code>str</code> <p>Unique identifier for the layer.</p> <code>None</code> <code>layer_config</code> <p>Layer configuration dictionary containing          properties like type, source, paint, and layout.</p> required <code>before_id</code> <code>Optional[str]</code> <p>Optional layer ID to insert this layer before.       If None, layer is added on top.</p> <code>None</code> Source code in <code>anymap/maplibre.py</code> <pre><code>def add_layer(\n    self,\n    layer: Dict[str, Any],\n    before_id: Optional[str] = None,\n    layer_id: str = None,\n    opacity: Optional[float] = 1.0,\n    visible: Optional[bool] = True,\n    overwrite: bool = False,\n    **kwargs: Any,\n) -&gt; None:\n    \"\"\"Add a layer to the map.\n\n    Args:\n        layer_id: Unique identifier for the layer.\n        layer_config: Layer configuration dictionary containing\n                     properties like type, source, paint, and layout.\n        before_id: Optional layer ID to insert this layer before.\n                  If None, layer is added on top.\n    \"\"\"\n\n    if isinstance(layer, dict):\n        if \"minzoom\" in layer:\n            layer[\"min-zoom\"] = layer.pop(\"minzoom\")\n        if \"maxzoom\" in layer:\n            layer[\"max-zoom\"] = layer.pop(\"maxzoom\")\n        layer = utils.replace_top_level_hyphens(layer)\n\n    if \"name\" in kwargs and layer_id is None:\n        layer_id = kwargs.pop(\"name\")\n\n    if layer_id is None:\n        layer_id = utils.get_unique_name(\n            layer[\"id\"], list(self._layers.keys()), overwrite\n        )\n\n    # Store before_id in layer metadata for restoration when displaying in multiple cells\n    if before_id is not None:\n        if \"metadata\" not in layer:\n            layer[\"metadata\"] = {}\n        layer[\"metadata\"][\"beforeId\"] = before_id\n\n    # Store layer in local state for persistence\n    current_layers = dict(self._layers)\n    current_layers[layer_id] = layer\n    self._layers = current_layers\n\n    # Call JavaScript method with before_id if provided\n    self.call_js_method(\"addLayer\", layer, before_id)\n\n    self.set_visibility(layer_id, visible)\n    self.set_opacity(layer_id, opacity)\n    self.layer_dict[layer_id] = {\n        \"layer\": layer,\n        \"opacity\": opacity,\n        \"visible\": visible,\n        \"type\": layer[\"type\"],\n        # \"color\": color,\n    }\n\n    # Update the _layer_dict trait to trigger JavaScript sync\n    self._layer_dict = dict(self.layer_dict)\n\n    if self.layer_manager is not None:\n        self.layer_manager.refresh()\n\n    # Update layer controls if they exist\n    self._update_layer_controls()\n</code></pre>"},{"location":"maplibre/#anymap.maplibre.MapLibreMap.add_layer_control","title":"<code>add_layer_control(self, position='top-right', collapsed=True, layers=None, options=None)</code>","text":"<p>Add a collapsible layer control panel to the map.</p> <p>The layer control is a collapsible panel that allows users to toggle visibility and adjust opacity of map layers. It displays as an icon similar to other controls, and expands when clicked.</p> <p>Parameters:</p> Name Type Description Default <code>position</code> <code>str</code> <p>Position on map ('top-left', 'top-right', 'bottom-left', 'bottom-right')</p> <code>'top-right'</code> <code>collapsed</code> <code>bool</code> <p>Whether the control starts collapsed</p> <code>True</code> <code>layers</code> <code>Optional[List[str]]</code> <p>List of layer IDs to include. If None, includes all layers</p> <code>None</code> <code>options</code> <code>Optional[Dict[str, Any]]</code> <p>Additional options for the control</p> <code>None</code> Source code in <code>anymap/maplibre.py</code> <pre><code>def add_layer_control(\n    self,\n    position: str = \"top-right\",\n    collapsed: bool = True,\n    layers: Optional[List[str]] = None,\n    options: Optional[Dict[str, Any]] = None,\n) -&gt; None:\n    \"\"\"Add a collapsible layer control panel to the map.\n\n    The layer control is a collapsible panel that allows users to toggle\n    visibility and adjust opacity of map layers. It displays as an icon\n    similar to other controls, and expands when clicked.\n\n    Args:\n        position: Position on map ('top-left', 'top-right', 'bottom-left', 'bottom-right')\n        collapsed: Whether the control starts collapsed\n        layers: List of layer IDs to include. If None, includes all layers\n        options: Additional options for the control\n    \"\"\"\n    control_options = options or {}\n    control_options.update(\n        {\n            \"position\": position,\n            \"collapsed\": collapsed,\n            \"layers\": layers,\n        }\n    )\n\n    # Get current layer states for initialization\n    layer_states = {}\n    target_layers = layers if layers is not None else list(self.layer_dict.keys())\n\n    # Always include Background layer for controlling map style layers\n    if layers is None or \"Background\" in layers:\n        layer_states[\"Background\"] = {\n            \"visible\": True,\n            \"opacity\": 1.0,\n            \"name\": \"Background\",\n        }\n\n    for layer_id in target_layers:\n        if layer_id in self.layer_dict and layer_id != \"Background\":\n            layer_info = self.layer_dict[layer_id]\n            layer_states[layer_id] = {\n                \"visible\": layer_info.get(\"visible\", True),\n                \"opacity\": layer_info.get(\"opacity\", 1.0),\n                \"name\": layer_id,  # Use layer_id as display name by default\n            }\n\n    control_options[\"layerStates\"] = layer_states\n\n    # Store control in persistent state\n    control_key = f\"layer_control_{position}\"\n    current_controls = dict(self._controls)\n    current_controls[control_key] = {\n        \"type\": \"layer_control\",\n        \"position\": position,\n        \"options\": control_options,\n    }\n    self._controls = current_controls\n\n    self.call_js_method(\"addControl\", \"layer_control\", control_options)\n</code></pre>"},{"location":"maplibre/#anymap.maplibre.MapLibreMap.add_legend_control","title":"<code>add_legend_control(self, position='bottom-left', show_default=True, show_checkbox=True, only_rendered=False, reverse_order=False, options=None, targets=None, label_overrides=None, max_height=None, toggle_icon=None)</code>","text":"<p>Add a Legend control (watergis/mapbox-gl-legend) to the map.</p> <p>The legend control inspects map layers and renders a legend UI. It works best when layers include helpful <code>metadata</code> such as a human-readable name, unit, or labels.</p> <p>Parameters:</p> Name Type Description Default <code>position</code> <code>str</code> <p>Control position ('top-left', 'top-right', 'bottom-left', 'bottom-right').</p> <code>'bottom-left'</code> <code>show_default</code> <code>bool</code> <p>Whether to show default legend items inferred from layers.</p> <code>True</code> <code>show_checkbox</code> <code>bool</code> <p>Whether to include visibility checkboxes per item.</p> <code>True</code> <code>only_rendered</code> <code>bool</code> <p>If True, only include layers currently rendered in viewport.</p> <code>False</code> <code>reverse_order</code> <code>bool</code> <p>If True, reverse the legend item order.</p> <code>False</code> <code>options</code> <code>Optional[Dict[str, Any]]</code> <p>Additional plugin options forwarded to LegendControl.</p> <code>None</code> <code>targets</code> <code>Optional[Dict[str, str]]</code> <p>Optional mapping of layer IDs to include in the legend. When provided, only these layers will appear (matching plugin behaviour).</p> <code>None</code> <code>label_overrides</code> <code>Optional[Dict[str, str]]</code> <p>Optional mapping of layer IDs to custom legend labels. When omitted, labels are derived from layer metadata and fall back to layer ids. This does not restrict which layers are shown.</p> <code>None</code> <code>max_height</code> <code>Union[int, float, str]</code> <p>Optional CSS size (e.g. 320, \"320px\", \"60vh\") used to cap the legend panel height. When provided, a scrollbar appears if content exceeds this limit.</p> <code>None</code> <code>toggle_icon</code> <code>Optional[str]</code> <p>Optional HTML string or Unicode glyph for the collapsed legend toggle button. Defaults to a list-style icon if omitted.</p> <code>None</code> Source code in <code>anymap/maplibre.py</code> <pre><code>def add_legend_control(\n    self,\n    position: str = \"bottom-left\",\n    show_default: bool = True,\n    show_checkbox: bool = True,\n    only_rendered: bool = False,\n    reverse_order: bool = False,\n    options: Optional[Dict[str, Any]] = None,\n    targets: Optional[Dict[str, str]] = None,\n    label_overrides: Optional[Dict[str, str]] = None,\n    max_height: Optional[Union[int, float, str]] = None,\n    toggle_icon: Optional[str] = None,\n) -&gt; None:\n    \"\"\"Add a Legend control (watergis/mapbox-gl-legend) to the map.\n\n    The legend control inspects map layers and renders a legend UI. It works\n    best when layers include helpful `metadata` such as a human-readable\n    name, unit, or labels.\n\n    Args:\n        position: Control position ('top-left', 'top-right', 'bottom-left', 'bottom-right').\n        show_default: Whether to show default legend items inferred from layers.\n        show_checkbox: Whether to include visibility checkboxes per item.\n        only_rendered: If True, only include layers currently rendered in viewport.\n        reverse_order: If True, reverse the legend item order.\n        options: Additional plugin options forwarded to LegendControl.\n        targets: Optional mapping of layer IDs to include in the legend. When\n            provided, only these layers will appear (matching plugin behaviour).\n        label_overrides: Optional mapping of layer IDs to custom legend labels.\n            When omitted, labels are derived from layer metadata and fall back\n            to layer ids. This does not restrict which layers are shown.\n        max_height: Optional CSS size (e.g. 320, \"320px\", \"60vh\") used to cap the\n            legend panel height. When provided, a scrollbar appears if content\n            exceeds this limit.\n        toggle_icon: Optional HTML string or Unicode glyph for the collapsed\n            legend toggle button. Defaults to a list-style icon if omitted.\n    \"\"\"\n\n    def _derive_labels() -&gt; Dict[str, str]:\n        derived: Dict[str, str] = {}\n        for layer_id, layer_info in self.layer_dict.items():\n            layer_config = layer_info.get(\"layer\", {})\n            if not isinstance(layer_config, dict):\n                continue\n\n            if layer_config.get(\"type\") == \"background\":\n                continue\n\n            if not layer_info.get(\"visible\", True):\n                continue\n\n            metadata = layer_config.get(\"metadata\") or {}\n            legend_meta = metadata.get(\"legend\") or {}\n            if legend_meta.get(\"exclude\"):\n                continue\n\n            label = (\n                legend_meta.get(\"label\")\n                or legend_meta.get(\"title\")\n                or metadata.get(\"name\")\n                or legend_meta.get(\"name\")\n                or layer_info.get(\"name\")\n                or layer_config.get(\"id\")\n                or layer_id\n            )\n            derived[layer_id] = label\n\n        return derived\n\n    control_options: Dict[str, Any] = dict(options or {})\n    control_options.update(\n        {\n            \"position\": position,\n            \"showDefault\": show_default,\n            \"showCheckbox\": show_checkbox,\n            \"onlyRendered\": only_rendered,\n            \"reverseOrder\": reverse_order,\n        }\n    )\n\n    if targets is not None:\n        control_options[\"targets\"] = dict(targets)\n\n    if max_height is not None:\n        if isinstance(max_height, (int, float)):\n            max_height_value = f\"{max_height}px\"\n        else:\n            max_height_value = str(max_height)\n        control_options[\"maxHeight\"] = max_height_value\n\n    if toggle_icon is not None:\n        control_options[\"toggleIcon\"] = str(toggle_icon)\n\n    auto_labels = _derive_labels()\n    merged_labels: Dict[str, str] = dict(auto_labels)\n    for label_map in (\n        control_options.get(\"label_overrides\"),\n        control_options.get(\"labelOverrides\"),\n        label_overrides,\n    ):\n        if label_map:\n            merged_labels.update(label_map)\n\n    if merged_labels:\n        control_options[\"label_overrides\"] = merged_labels\n\n    control_key = f\"legend_{position}\"\n    current_controls = dict(self._controls)\n    current_controls[control_key] = {\n        \"type\": \"legend\",\n        \"position\": position,\n        \"options\": control_options,\n    }\n    self._controls = current_controls\n\n    self.call_js_method(\"addControl\", \"legend\", control_options)\n</code></pre>"},{"location":"maplibre/#anymap.maplibre.MapLibreMap.add_maplibre_geocoder","title":"<code>add_maplibre_geocoder(self, position='top-left', api_key=None, maplibre_api='maptiler', language=None, placeholder='Search', proximity=None, bbox=None, country=None, types=None, limit=5, marker=True, show_result_markers=True, collapsed=False, clear_on_blur=False, clear_and_blur_on_esc=False, enable_event_logging=False, min_length=2, options=None)</code>","text":"<p>Add MapLibre GL Geocoder control to the map.</p> <p>The MapLibre GL Geocoder is a geocoder control for MapLibre GL that supports various geocoding APIs including Maptiler, Mapbox, and others. It provides a search interface for finding locations and can display markers for search results.</p> <p>See: https://github.com/maplibre/maplibre-gl-geocoder</p> <p>Parameters:</p> Name Type Description Default <code>position</code> <code>str</code> <p>Position on map ('top-left', 'top-right', 'bottom-left', 'bottom-right')</p> <code>'top-left'</code> <code>api_key</code> <code>Optional[str]</code> <p>API key for the geocoding service (required for most services)</p> <code>None</code> <code>maplibre_api</code> <code>str</code> <p>Geocoding API to use ('maptiler', 'mapbox', or custom)</p> <code>'maptiler'</code> <code>language</code> <code>Optional[str]</code> <p>Language code for results (e.g., 'en', 'es', 'fr')</p> <code>None</code> <code>placeholder</code> <code>str</code> <p>Placeholder text in the search input</p> <code>'Search'</code> <code>proximity</code> <code>Optional[List[float]]</code> <p>[lng, lat] to bias results towards this location</p> <code>None</code> <code>bbox</code> <code>Optional[List[float]]</code> <p>[minLng, minLat, maxLng, maxLat] to limit results to this bounding box</p> <code>None</code> <code>country</code> <code>Optional[str]</code> <p>Country code(s) to limit results (e.g., 'us' or 'us,ca')</p> <code>None</code> <code>types</code> <code>Optional[str]</code> <p>Comma-separated types to filter results (e.g., 'country,region,place')</p> <code>None</code> <code>limit</code> <code>int</code> <p>Maximum number of results to return</p> <code>5</code> <code>marker</code> <code>bool</code> <p>Whether to add a marker at the geocoded location</p> <code>True</code> <code>show_result_markers</code> <code>bool</code> <p>Whether to show markers for all search results</p> <code>True</code> <code>collapsed</code> <code>bool</code> <p>Whether the control should start collapsed</p> <code>False</code> <code>clear_on_blur</code> <code>bool</code> <p>Clear the input when it loses focus</p> <code>False</code> <code>clear_and_blur_on_esc</code> <code>bool</code> <p>Clear input and remove focus when ESC is pressed</p> <code>False</code> <code>enable_event_logging</code> <code>bool</code> <p>Enable console logging of geocoder events</p> <code>False</code> <code>min_length</code> <code>int</code> <p>Minimum number of characters to trigger search</p> <code>2</code> <code>options</code> <code>Optional[Dict[str, Any]]</code> <p>Additional options passed to the MaplibreGeocoder constructor</p> <code>None</code> <p>Examples:</p> <pre><code>m = MapLibreMap(center=[-87.61694, 41.86625], zoom=10)\nm.add_maplibre_geocoder(\n    position=\"top-left\",\n    api_key=\"your_api_key\",\n    maplibre_api=\"maptiler\",\n    language=\"en\",\n    country=\"us\"\n)\n</code></pre> Source code in <code>anymap/maplibre.py</code> <pre><code>def add_maplibre_geocoder(\n    self,\n    position: str = \"top-left\",\n    api_key: Optional[str] = None,\n    maplibre_api: str = \"maptiler\",\n    language: Optional[str] = None,\n    placeholder: str = \"Search\",\n    proximity: Optional[List[float]] = None,\n    bbox: Optional[List[float]] = None,\n    country: Optional[str] = None,\n    types: Optional[str] = None,\n    limit: int = 5,\n    marker: bool = True,\n    show_result_markers: bool = True,\n    collapsed: bool = False,\n    clear_on_blur: bool = False,\n    clear_and_blur_on_esc: bool = False,\n    enable_event_logging: bool = False,\n    min_length: int = 2,\n    options: Optional[Dict[str, Any]] = None,\n) -&gt; None:\n    \"\"\"Add MapLibre GL Geocoder control to the map.\n\n    The MapLibre GL Geocoder is a geocoder control for MapLibre GL that supports\n    various geocoding APIs including Maptiler, Mapbox, and others. It provides a\n    search interface for finding locations and can display markers for search results.\n\n    See: https://github.com/maplibre/maplibre-gl-geocoder\n\n    Args:\n        position: Position on map ('top-left', 'top-right', 'bottom-left', 'bottom-right')\n        api_key: API key for the geocoding service (required for most services)\n        maplibre_api: Geocoding API to use ('maptiler', 'mapbox', or custom)\n        language: Language code for results (e.g., 'en', 'es', 'fr')\n        placeholder: Placeholder text in the search input\n        proximity: [lng, lat] to bias results towards this location\n        bbox: [minLng, minLat, maxLng, maxLat] to limit results to this bounding box\n        country: Country code(s) to limit results (e.g., 'us' or 'us,ca')\n        types: Comma-separated types to filter results (e.g., 'country,region,place')\n        limit: Maximum number of results to return\n        marker: Whether to add a marker at the geocoded location\n        show_result_markers: Whether to show markers for all search results\n        collapsed: Whether the control should start collapsed\n        clear_on_blur: Clear the input when it loses focus\n        clear_and_blur_on_esc: Clear input and remove focus when ESC is pressed\n        enable_event_logging: Enable console logging of geocoder events\n        min_length: Minimum number of characters to trigger search\n        options: Additional options passed to the MaplibreGeocoder constructor\n\n    Example:\n        ```python\n        m = MapLibreMap(center=[-87.61694, 41.86625], zoom=10)\n        m.add_maplibre_geocoder(\n            position=\"top-left\",\n            api_key=\"your_api_key\",\n            maplibre_api=\"maptiler\",\n            language=\"en\",\n            country=\"us\"\n        )\n        ```\n    \"\"\"\n    geocoder_config: Dict[str, Any] = options or {}\n\n    # Build configuration\n    geocoder_config.update(\n        {\n            \"position\": position,\n            \"maplibregl\": True,  # Signal to use maplibregl\n            \"placeholder\": placeholder,\n            \"limit\": limit,\n            \"marker\": marker,\n            \"showResultMarkers\": show_result_markers,\n            \"collapsed\": collapsed,\n            \"clearOnBlur\": clear_on_blur,\n            \"clearAndBlurOnEsc\": clear_and_blur_on_esc,\n            \"enableEventLogging\": enable_event_logging,\n            \"minLength\": min_length,\n        }\n    )\n\n    if api_key:\n        geocoder_config[\"apiKey\"] = api_key\n\n    if maplibre_api:\n        geocoder_config[\"maplibreApi\"] = maplibre_api\n\n    if language:\n        geocoder_config[\"language\"] = language\n\n    if proximity:\n        if len(proximity) != 2:\n            raise ValueError(\n                \"proximity must be a list of two floats: [longitude, latitude]\"\n            )\n        geocoder_config[\"proximity\"] = proximity\n\n    if bbox:\n        if len(bbox) != 4:\n            raise ValueError(\n                \"bbox must be a list of four floats: [minLng, minLat, maxLng, maxLat]\"\n            )\n        geocoder_config[\"bbox\"] = bbox\n\n    if country:\n        geocoder_config[\"country\"] = country\n\n    if types:\n        geocoder_config[\"types\"] = types\n\n    # Store control state\n    control_key = f\"maplibre_geocoder_{position}\"\n    current_controls = dict(self._controls)\n    current_controls[control_key] = {\n        \"type\": \"maplibre_geocoder\",\n        \"position\": position,\n        \"options\": geocoder_config,\n    }\n    self._controls = current_controls\n\n    self.call_js_method(\"addControl\", \"maplibre_geocoder\", geocoder_config)\n</code></pre>"},{"location":"maplibre/#anymap.maplibre.MapLibreMap.add_marker","title":"<code>add_marker(self, lng, lat, popup=None)</code>","text":"<p>Add a marker to the map.</p> <p>Parameters:</p> Name Type Description Default <code>lng</code> <code>float</code> <p>Longitude coordinate for the marker.</p> required <code>lat</code> <code>float</code> <p>Latitude coordinate for the marker.</p> required <code>popup</code> <code>Optional[str]</code> <p>Optional popup text to display when marker is clicked.</p> <code>None</code> Source code in <code>anymap/maplibre.py</code> <pre><code>def add_marker(self, lng: float, lat: float, popup: Optional[str] = None) -&gt; None:\n    \"\"\"Add a marker to the map.\n\n    Args:\n        lng: Longitude coordinate for the marker.\n        lat: Latitude coordinate for the marker.\n        popup: Optional popup text to display when marker is clicked.\n    \"\"\"\n    marker_data = {\"coordinates\": [lng, lat], \"popup\": popup}\n    self.call_js_method(\"addMarker\", marker_data)\n</code></pre>"},{"location":"maplibre/#anymap.maplibre.MapLibreMap.add_measures_control","title":"<code>add_measures_control(self, position='top-left', units='metric', area_button_title=None, length_button_title=None, clear_button_title=None, options=None)</code>","text":"<p>Add the MapLibre GL Measures control for distance and area measurement.</p> <p>This control allows users to measure distances along lines and calculate areas within polygons on the map.</p> <p>Parameters:</p> Name Type Description Default <code>position</code> <code>str</code> <p>Position on map ('top-left', 'top-right', 'bottom-left', 'bottom-right')</p> <code>'top-left'</code> <code>units</code> <code>str</code> <p>Unit system for measurements, either 'metric' or 'imperial'</p> <code>'metric'</code> <code>area_button_title</code> <code>Optional[str]</code> <p>Custom title for the area measurement button</p> <code>None</code> <code>length_button_title</code> <code>Optional[str]</code> <p>Custom title for the length measurement button</p> <code>None</code> <code>clear_button_title</code> <code>Optional[str]</code> <p>Custom title for the clear measurements button</p> <code>None</code> <code>options</code> <code>Optional[Dict[str, Any]]</code> <p>Additional options for the measures control (styling, callbacks, etc.)</p> <code>None</code> Source code in <code>anymap/maplibre.py</code> <pre><code>def add_measures_control(\n    self,\n    position: str = \"top-left\",\n    units: str = \"metric\",\n    area_button_title: Optional[str] = None,\n    length_button_title: Optional[str] = None,\n    clear_button_title: Optional[str] = None,\n    options: Optional[Dict[str, Any]] = None,\n) -&gt; None:\n    \"\"\"Add the MapLibre GL Measures control for distance and area measurement.\n\n    This control allows users to measure distances along lines and calculate areas\n    within polygons on the map.\n\n    Args:\n        position: Position on map ('top-left', 'top-right', 'bottom-left', 'bottom-right')\n        units: Unit system for measurements, either 'metric' or 'imperial'\n        area_button_title: Custom title for the area measurement button\n        length_button_title: Custom title for the length measurement button\n        clear_button_title: Custom title for the clear measurements button\n        options: Additional options for the measures control (styling, callbacks, etc.)\n    \"\"\"\n    if units not in {\"metric\", \"imperial\"}:\n        raise ValueError(\"units must be either 'metric' or 'imperial'\")\n\n    measures_config: Dict[str, Any] = dict(options or {})\n\n    # Set unit system\n    measures_config[\"units\"] = units\n\n    # Set custom button titles if provided\n    if area_button_title is not None:\n        measures_config[\"areaMeasurementButtonTitle\"] = area_button_title\n    if length_button_title is not None:\n        measures_config[\"lengthMeasurementButtonTitle\"] = length_button_title\n    if clear_button_title is not None:\n        measures_config[\"clearMeasurementsButtonTitle\"] = clear_button_title\n\n    control_options: Dict[str, Any] = {\n        \"position\": position,\n        \"measures_options\": measures_config,\n    }\n\n    control_key = f\"measures_{position}\"\n    current_controls = dict(self._controls)\n    current_controls[control_key] = {\n        \"type\": \"measures\",\n        \"position\": position,\n        \"options\": control_options,\n    }\n    self._controls = current_controls\n    self.controls[\"measures\"] = position\n\n    self.call_js_method(\"addControl\", \"measures\", control_options)\n</code></pre>"},{"location":"maplibre/#anymap.maplibre.MapLibreMap.add_pmtiles","title":"<code>add_pmtiles(self, pmtiles_url, layer_id=None, layers=None, opacity=1.0, visible=True, before_id=None)</code>","text":"<p>Add PMTiles vector tiles to the map.</p> <p>Parameters:</p> Name Type Description Default <code>pmtiles_url</code> <code>str</code> <p>URL to the PMTiles file.</p> required <code>layer_id</code> <code>Optional[str]</code> <p>Optional unique identifier for the layer. If None, uses filename.</p> <code>None</code> <code>layers</code> <code>Optional[List[Dict[str, Any]]]</code> <p>Optional list of layer configurations for rendering. If None, creates default layers.</p> <code>None</code> <code>opacity</code> <code>Optional[float]</code> <p>Layer opacity between 0.0 and 1.0.</p> <code>1.0</code> <code>visible</code> <code>Optional[bool]</code> <p>Whether the layer should be visible initially.</p> <code>True</code> <code>before_id</code> <code>Optional[str]</code> <p>Optional layer ID to insert this layer before.</p> <code>None</code> Source code in <code>anymap/maplibre.py</code> <pre><code>def add_pmtiles(\n    self,\n    pmtiles_url: str,\n    layer_id: Optional[str] = None,\n    layers: Optional[List[Dict[str, Any]]] = None,\n    opacity: Optional[float] = 1.0,\n    visible: Optional[bool] = True,\n    before_id: Optional[str] = None,\n) -&gt; None:\n    \"\"\"Add PMTiles vector tiles to the map.\n\n    Args:\n        pmtiles_url: URL to the PMTiles file.\n        layer_id: Optional unique identifier for the layer. If None, uses filename.\n        layers: Optional list of layer configurations for rendering. If None, creates default layers.\n        opacity: Layer opacity between 0.0 and 1.0.\n        visible: Whether the layer should be visible initially.\n        before_id: Optional layer ID to insert this layer before.\n    \"\"\"\n    if layer_id is None:\n        layer_id = pmtiles_url.split(\"/\")[-1].replace(\".pmtiles\", \"\")\n\n    source_id = f\"{layer_id}_source\"\n\n    # Add PMTiles source using pmtiles:// protocol\n    pmtiles_source_url = f\"pmtiles://{pmtiles_url}\"\n\n    self.add_source(\n        source_id,\n        {\n            \"type\": \"vector\",\n            \"url\": pmtiles_source_url,\n            \"attribution\": \"PMTiles\",\n        },\n    )\n\n    # Add default layers if none provided\n    if layers is None:\n        layers = [\n            {\n                \"id\": f\"{layer_id}_landuse\",\n                \"source\": source_id,\n                \"source-layer\": \"landuse\",\n                \"type\": \"fill\",\n                \"paint\": {\"fill-color\": \"steelblue\", \"fill-opacity\": 0.5},\n            },\n            {\n                \"id\": f\"{layer_id}_roads\",\n                \"source\": source_id,\n                \"source-layer\": \"roads\",\n                \"type\": \"line\",\n                \"paint\": {\"line-color\": \"black\", \"line-width\": 1},\n            },\n            {\n                \"id\": f\"{layer_id}_buildings\",\n                \"source\": source_id,\n                \"source-layer\": \"buildings\",\n                \"type\": \"fill\",\n                \"paint\": {\"fill-color\": \"gray\", \"fill-opacity\": 0.7},\n            },\n            {\n                \"id\": f\"{layer_id}_water\",\n                \"source\": source_id,\n                \"source-layer\": \"water\",\n                \"type\": \"fill\",\n                \"paint\": {\"fill-color\": \"lightblue\", \"fill-opacity\": 0.8},\n            },\n        ]\n\n    # Add all layers\n    for layer_config in layers:\n        self.add_layer(\n            layer=layer_config,\n            before_id=before_id,\n            layer_id=layer_config[\"id\"],\n            opacity=opacity,\n            visible=visible,\n        )\n</code></pre>"},{"location":"maplibre/#anymap.maplibre.MapLibreMap.add_raster","title":"<code>add_raster(self, source, indexes=None, colormap=None, vmin=None, vmax=None, nodata=None, name='Raster', before_id=None, fit_bounds=True, visible=True, opacity=1.0, array_args={}, client_args={'cors_all': True}, overwrite=True, **kwargs)</code>","text":"<p>Add a local raster dataset to the map.     If you are using this function in JupyterHub on a remote server     (e.g., Binder, Microsoft Planetary Computer) and if the raster     does not render properly, try installing jupyter-server-proxy using     <code>pip install jupyter-server-proxy</code>, then running the following code     before calling this function. For more info, see https://bit.ly/3JbmF93.</p> <pre><code>import os\nos.environ['LOCALTILESERVER_CLIENT_PREFIX'] = 'proxy/{port}'\n</code></pre> <p>Parameters:</p> Name Type Description Default <code>source</code> <code>str</code> <p>The path to the GeoTIFF file or the URL of the Cloud Optimized GeoTIFF.</p> required <code>indexes</code> <code>int</code> <p>The band(s) to use. Band indexing starts at 1. Defaults to None.</p> <code>None</code> <code>colormap</code> <code>str</code> <p>The name of the colormap from <code>matplotlib</code> to use when plotting a single band. See https://matplotlib.org/stable/gallery/color/colormap_reference.html. Default is greyscale.</p> <code>None</code> <code>vmin</code> <code>float</code> <p>The minimum value to use when colormapping the palette when plotting a single band. Defaults to None.</p> <code>None</code> <code>vmax</code> <code>float</code> <p>The maximum value to use when colormapping the palette when plotting a single band. Defaults to None.</p> <code>None</code> <code>nodata</code> <code>float</code> <p>The value from the band to use to interpret as not valid data. Defaults to None.</p> <code>None</code> <code>name</code> <code>str</code> <p>The layer name to use. Defaults to 'Raster'.</p> <code>'Raster'</code> <code>before_id</code> <code>str</code> <p>The layer id to insert the layer before. Defaults to None.</p> <code>None</code> <code>fit_bounds</code> <code>bool</code> <p>Whether to zoom to the extent of the layer. Defaults to True.</p> <code>True</code> <code>visible</code> <code>bool</code> <p>Whether the layer is visible. Defaults to True.</p> <code>True</code> <code>opacity</code> <code>float</code> <p>The opacity of the layer. Defaults to 1.0.</p> <code>1.0</code> <code>array_args</code> <code>dict</code> <p>Additional arguments to pass to <code>array_to_memory_file</code> when reading the raster. Defaults to {}.</p> <code>{}</code> <code>client_args</code> <code>dict</code> <p>Additional arguments to pass to localtileserver.TileClient. Defaults to { \"cors_all\": False }.</p> <code>{'cors_all': True}</code> <code>overwrite</code> <code>bool</code> <p>Whether to overwrite an existing layer with the same name. Defaults to True.</p> <code>True</code> <code>**kwargs</code> <code>Any</code> <p>Additional keyword arguments to be passed to the underlying <code>add_tile_layer</code> method.</p> <code>{}</code> Source code in <code>anymap/maplibre.py</code> <pre><code>def add_raster(\n    self,\n    source,\n    indexes=None,\n    colormap=None,\n    vmin=None,\n    vmax=None,\n    nodata=None,\n    name=\"Raster\",\n    before_id=None,\n    fit_bounds=True,\n    visible=True,\n    opacity=1.0,\n    array_args={},\n    client_args={\"cors_all\": True},\n    overwrite: bool = True,\n    **kwargs: Any,\n):\n    \"\"\"Add a local raster dataset to the map.\n        If you are using this function in JupyterHub on a remote server\n        (e.g., Binder, Microsoft Planetary Computer) and if the raster\n        does not render properly, try installing jupyter-server-proxy using\n        `pip install jupyter-server-proxy`, then running the following code\n        before calling this function. For more info, see https://bit.ly/3JbmF93.\n\n        import os\n        os.environ['LOCALTILESERVER_CLIENT_PREFIX'] = 'proxy/{port}'\n\n    Args:\n        source (str): The path to the GeoTIFF file or the URL of the Cloud\n            Optimized GeoTIFF.\n        indexes (int, optional): The band(s) to use. Band indexing starts\n            at 1. Defaults to None.\n        colormap (str, optional): The name of the colormap from `matplotlib`\n            to use when plotting a single band.\n            See https://matplotlib.org/stable/gallery/color/colormap_reference.html.\n            Default is greyscale.\n        vmin (float, optional): The minimum value to use when colormapping\n            the palette when plotting a single band. Defaults to None.\n        vmax (float, optional): The maximum value to use when colormapping\n            the palette when plotting a single band. Defaults to None.\n        nodata (float, optional): The value from the band to use to interpret\n            as not valid data. Defaults to None.\n        name (str, optional): The layer name to use. Defaults to 'Raster'.\n        before_id (str, optional): The layer id to insert the layer before. Defaults to None.\n        fit_bounds (bool, optional): Whether to zoom to the extent of the\n            layer. Defaults to True.\n        visible (bool, optional): Whether the layer is visible. Defaults to True.\n        opacity (float, optional): The opacity of the layer. Defaults to 1.0.\n        array_args (dict, optional): Additional arguments to pass to\n            `array_to_memory_file` when reading the raster. Defaults to {}.\n        client_args (dict, optional): Additional arguments to pass to\n            localtileserver.TileClient. Defaults to { \"cors_all\": False }.\n        overwrite (bool, optional): Whether to overwrite an existing layer with the same name.\n            Defaults to True.\n        **kwargs: Additional keyword arguments to be passed to the underlying\n            `add_tile_layer` method.\n    \"\"\"\n    import numpy as np\n    import xarray as xr\n\n    if \"zoom_to_layer\" in kwargs:\n        fit_bounds = kwargs.pop(\"zoom_to_layer\")\n\n    if \"layer_name\" in kwargs:\n        name = kwargs.pop(\"layer_name\")\n\n    if isinstance(source, np.ndarray) or isinstance(source, xr.DataArray):\n        source = utils.array_to_image(source, **array_args)\n\n    if \"colormap_name\" in kwargs:\n        colormap = kwargs.pop(\"colormap_name\")\n\n    url, tile_client = utils.get_local_tile_url(\n        source,\n        indexes=indexes,\n        colormap=colormap,\n        vmin=vmin,\n        vmax=vmax,\n        nodata=nodata,\n        opacity=opacity,\n        client_args=client_args,\n        return_client=True,\n        **kwargs,\n    )\n\n    self.add_tile_layer(\n        layer_id=name,\n        source_url=url,\n        opacity=opacity,\n        visible=visible,\n        before_id=before_id,\n        overwrite=overwrite,\n    )\n\n    bounds = tile_client.bounds()  # [ymin, ymax, xmin, xmax]\n    bounds = [[bounds[2], bounds[0]], [bounds[3], bounds[1]]]\n    # [minx, miny, maxx, maxy]\n    if fit_bounds:\n        self.fit_bounds(bounds)\n</code></pre>"},{"location":"maplibre/#anymap.maplibre.MapLibreMap.add_temporal_control","title":"<code>add_temporal_control(self, frames, position='top-right', interval=1000, performance=False, options=None)</code>","text":"<p>Add a temporal control to the map for animating time-series data.</p> <p>The temporal control enables animation of map layers across time, allowing users to visualize changes over time with playback controls. It uses the maplibre-gl-temporal-control plugin.</p> <p>Parameters:</p> Name Type Description Default <code>frames</code> <code>List[Dict[str, Any]]</code> <p>List of frame configurations. Each frame is a dictionary with: - title: Display name for the frame (e.g., \"2020-01-01\") - layers: List of layer IDs to show in this frame</p> required <code>position</code> <code>str</code> <p>Position on map ('top-left', 'top-right', 'bottom-left', 'bottom-right')</p> <code>'top-right'</code> <code>interval</code> <code>int</code> <p>Duration to display each frame in milliseconds. Default is 1000 (1 second).</p> <code>1000</code> <code>performance</code> <code>bool</code> <p>Enable performance mode for slower systems. Default is False.</p> <code>False</code> <code>options</code> <code>Optional[Dict[str, Any]]</code> <p>Additional options for the temporal control</p> <code>None</code> <p>Examples:</p> <pre><code>&gt;&gt;&gt; m = MapLibreMap()\n&gt;&gt;&gt; # Add layers for different time periods\n&gt;&gt;&gt; m.add_geojson_layer(\"data-2020\", geojson_2020, \"circle\", paint={\"circle-color\": \"red\"})\n&gt;&gt;&gt; m.add_geojson_layer(\"data-2021\", geojson_2021, \"circle\", paint={\"circle-color\": \"blue\"})\n&gt;&gt;&gt; m.add_geojson_layer(\"data-2022\", geojson_2022, \"circle\", paint={\"circle-color\": \"green\"})\n&gt;&gt;&gt;\n&gt;&gt;&gt; # Configure temporal frames\n&gt;&gt;&gt; frames = [\n...     {\"title\": \"2020\", \"layers\": [\"data-2020\"]},\n...     {\"title\": \"2021\", \"layers\": [\"data-2021\"]},\n...     {\"title\": \"2022\", \"layers\": [\"data-2022\"]},\n... ]\n&gt;&gt;&gt;\n&gt;&gt;&gt; # Add temporal control\n&gt;&gt;&gt; m.add_temporal_control(\n...     frames=frames,\n...     position=\"top-right\",\n...     interval=2000  # 2 seconds per frame\n... )\n</code></pre> Source code in <code>anymap/maplibre.py</code> <pre><code>def add_temporal_control(\n    self,\n    frames: List[Dict[str, Any]],\n    position: str = \"top-right\",\n    interval: int = 1000,\n    performance: bool = False,\n    options: Optional[Dict[str, Any]] = None,\n) -&gt; None:\n    \"\"\"Add a temporal control to the map for animating time-series data.\n\n    The temporal control enables animation of map layers across time, allowing\n    users to visualize changes over time with playback controls. It uses the\n    maplibre-gl-temporal-control plugin.\n\n    Args:\n        frames: List of frame configurations. Each frame is a dictionary with:\n            - title: Display name for the frame (e.g., \"2020-01-01\")\n            - layers: List of layer IDs to show in this frame\n        position: Position on map ('top-left', 'top-right', 'bottom-left', 'bottom-right')\n        interval: Duration to display each frame in milliseconds. Default is 1000 (1 second).\n        performance: Enable performance mode for slower systems. Default is False.\n        options: Additional options for the temporal control\n\n    Example:\n        &gt;&gt;&gt; m = MapLibreMap()\n        &gt;&gt;&gt; # Add layers for different time periods\n        &gt;&gt;&gt; m.add_geojson_layer(\"data-2020\", geojson_2020, \"circle\", paint={\"circle-color\": \"red\"})\n        &gt;&gt;&gt; m.add_geojson_layer(\"data-2021\", geojson_2021, \"circle\", paint={\"circle-color\": \"blue\"})\n        &gt;&gt;&gt; m.add_geojson_layer(\"data-2022\", geojson_2022, \"circle\", paint={\"circle-color\": \"green\"})\n        &gt;&gt;&gt;\n        &gt;&gt;&gt; # Configure temporal frames\n        &gt;&gt;&gt; frames = [\n        ...     {\"title\": \"2020\", \"layers\": [\"data-2020\"]},\n        ...     {\"title\": \"2021\", \"layers\": [\"data-2021\"]},\n        ...     {\"title\": \"2022\", \"layers\": [\"data-2022\"]},\n        ... ]\n        &gt;&gt;&gt;\n        &gt;&gt;&gt; # Add temporal control\n        &gt;&gt;&gt; m.add_temporal_control(\n        ...     frames=frames,\n        ...     position=\"top-right\",\n        ...     interval=2000  # 2 seconds per frame\n        ... )\n    \"\"\"\n    if not frames:\n        raise ValueError(\"At least one frame must be provided\")\n\n    control_options = options or {}\n    control_options.update(\n        {\n            \"position\": position,\n            \"frames\": frames,\n            \"interval\": interval,\n            \"performance\": performance,\n        }\n    )\n\n    # Store control in persistent state\n    control_key = f\"temporal_{position}\"\n    current_controls = dict(self._controls)\n    current_controls[control_key] = {\n        \"type\": \"temporal\",\n        \"position\": position,\n        \"options\": control_options,\n    }\n    self._controls = current_controls\n\n    self.call_js_method(\"addControl\", \"temporal\", control_options)\n</code></pre>"},{"location":"maplibre/#anymap.maplibre.MapLibreMap.add_terra_draw","title":"<code>add_terra_draw(self, position='top-left', modes=None, open=True, **kwargs)</code>","text":"<p>Add a Terra Draw control to the map for drawing and editing geometries.</p> <p>Parameters:</p> Name Type Description Default <code>position</code> <code>str</code> <p>Position on map ('top-left', 'top-right', 'bottom-left', 'bottom-right')</p> <code>'top-left'</code> <code>modes</code> <code>Optional[List[str]]</code> <p>List of drawing modes to enable. Available modes:   ['render', 'point', 'linestring', 'polygon', 'rectangle', 'circle',    'freehand', 'angled-rectangle', 'sensor', 'sector', 'select',    'delete-selection', 'delete', 'download']   Defaults to all modes except 'render'</p> <code>None</code> <code>open</code> <code>bool</code> <p>Whether the draw control panel should be open by default</p> <code>True</code> <code>**kwargs</code> <code>Any</code> <p>Additional options to pass to Terra Draw constructor</p> <code>{}</code> Source code in <code>anymap/maplibre.py</code> <pre><code>def add_terra_draw(\n    self,\n    position: str = \"top-left\",\n    modes: Optional[List[str]] = None,\n    open: bool = True,\n    **kwargs: Any,\n) -&gt; None:\n    \"\"\"Add a Terra Draw control to the map for drawing and editing geometries.\n\n    Args:\n        position: Position on map ('top-left', 'top-right', 'bottom-left', 'bottom-right')\n        modes: List of drawing modes to enable. Available modes:\n              ['render', 'point', 'linestring', 'polygon', 'rectangle', 'circle',\n               'freehand', 'angled-rectangle', 'sensor', 'sector', 'select',\n               'delete-selection', 'delete', 'download']\n              Defaults to all modes except 'render'\n        open: Whether the draw control panel should be open by default\n        **kwargs: Additional options to pass to Terra Draw constructor\n    \"\"\"\n    if modes is None:\n        modes = [\n            # 'render',  # Commented out to always show drawing tool\n            \"point\",\n            \"linestring\",\n            \"polygon\",\n            \"rectangle\",\n            \"circle\",\n            \"freehand\",\n            \"angled-rectangle\",\n            \"sensor\",\n            \"sector\",\n            \"select\",\n            \"delete-selection\",\n            \"delete\",\n            \"download\",\n        ]\n\n    terra_draw_options = {\n        \"modes\": modes,\n        \"open\": open,\n        \"position\": position,\n        **kwargs,\n    }\n\n    # Mark that Terra Draw is enabled\n    self._terra_draw_enabled = True\n\n    # Store Terra Draw control configuration\n    current_controls = dict(self._controls)\n    terra_draw_key = f\"terra_draw_{position}\"\n    current_controls[terra_draw_key] = {\n        \"type\": \"terra_draw\",\n        \"position\": position,\n        \"options\": terra_draw_options,\n    }\n    self._controls = current_controls\n\n    self.call_js_method(\"addTerraDrawControl\", terra_draw_options)\n</code></pre>"},{"location":"maplibre/#anymap.maplibre.MapLibreMap.add_three_light","title":"<code>add_three_light(self, light_type='ambient', color=16777215, intensity=1.0, position=None, light_id=None, target=None, cast_shadow=None, shadow_options=None, sun_options=None)</code>","text":"<p>Add a light to the Three.js scene.</p> <p>Parameters:</p> Name Type Description Default <code>light_type</code> <code>str</code> <p>Type of light ('ambient', 'directional', or 'sun').</p> <code>'ambient'</code> <code>color</code> <code>int</code> <p>Hexadecimal color value for the light (e.g., 0xffffff for white).</p> <code>16777215</code> <code>intensity</code> <code>float</code> <p>Light intensity value.</p> <code>1.0</code> <code>position</code> <code>Optional[List[float]]</code> <p>Optional position for directional lights as [x, y, z].</p> <code>None</code> <code>light_id</code> <code>Optional[str]</code> <p>Optional identifier for the light so it can be updated or removed later.</p> <code>None</code> <code>target</code> <code>Optional[List[float]]</code> <p>Optional target position for directional lights as [x, y, z].</p> <code>None</code> <code>cast_shadow</code> <code>Optional[bool]</code> <p>Whether the light should cast shadows (if supported by the light type).</p> <code>None</code> <code>shadow_options</code> <code>Optional[Dict[str, Any]]</code> <p>Additional shadow configuration such as map size or clipping planes.</p> <code>None</code> <code>sun_options</code> <code>Optional[Dict[str, Any]]</code> <p>Additional options when using the <code>sun</code> light type (e.g., <code>{\"current_time\": \"2024-01-01T12:00:00Z\"}</code>).</p> <code>None</code> <p>Examples:</p> <pre><code>&gt;&gt;&gt; m = MapLibreMap(center=[148.9819, -35.3981], zoom=18, pitch=60)\n&gt;&gt;&gt; m.init_three_scene()\n&gt;&gt;&gt; m.add_three_light(light_type='ambient', intensity=0.5)\n&gt;&gt;&gt; m.add_three_light(light_type='directional', position=[1, 1, 1])\n&gt;&gt;&gt; m.add_three_light(light_type='sun')\n</code></pre> Source code in <code>anymap/maplibre.py</code> <pre><code>def add_three_light(\n    self,\n    light_type: str = \"ambient\",\n    color: int = 0xFFFFFF,\n    intensity: float = 1.0,\n    position: Optional[List[float]] = None,\n    light_id: Optional[str] = None,\n    target: Optional[List[float]] = None,\n    cast_shadow: Optional[bool] = None,\n    shadow_options: Optional[Dict[str, Any]] = None,\n    sun_options: Optional[Dict[str, Any]] = None,\n) -&gt; None:\n    \"\"\"Add a light to the Three.js scene.\n\n    Args:\n        light_type: Type of light ('ambient', 'directional', or 'sun').\n        color: Hexadecimal color value for the light (e.g., 0xffffff for white).\n        intensity: Light intensity value.\n        position: Optional position for directional lights as [x, y, z].\n        light_id: Optional identifier for the light so it can be updated or removed later.\n        target: Optional target position for directional lights as [x, y, z].\n        cast_shadow: Whether the light should cast shadows (if supported by the light type).\n        shadow_options: Additional shadow configuration such as map size or clipping planes.\n        sun_options: Additional options when using the `sun` light type (e.g., ``{\"current_time\": \"2024-01-01T12:00:00Z\"}``).\n\n    Example:\n        &gt;&gt;&gt; m = MapLibreMap(center=[148.9819, -35.3981], zoom=18, pitch=60)\n        &gt;&gt;&gt; m.init_three_scene()\n        &gt;&gt;&gt; m.add_three_light(light_type='ambient', intensity=0.5)\n        &gt;&gt;&gt; m.add_three_light(light_type='directional', position=[1, 1, 1])\n        &gt;&gt;&gt; m.add_three_light(light_type='sun')\n    \"\"\"\n    light_config: Dict[str, Any] = {\n        \"type\": light_type,\n        \"color\": color,\n        \"intensity\": intensity,\n    }\n\n    if position is not None:\n        light_config[\"position\"] = position\n    if light_id is not None:\n        light_config[\"id\"] = light_id\n    if target is not None:\n        light_config[\"target\"] = target\n    if cast_shadow is not None:\n        light_config[\"castShadow\"] = cast_shadow\n    if shadow_options:\n        light_config[\"shadowOptions\"] = shadow_options\n    if sun_options:\n        light_config[\"sunOptions\"] = sun_options\n\n    self.call_js_method(\"addThreeLight\", light_config)\n</code></pre>"},{"location":"maplibre/#anymap.maplibre.MapLibreMap.add_three_model","title":"<code>add_three_model(self, model_id, url, coordinates, scale=1.0, rotation=None, **kwargs)</code>","text":"<p>Add a 3D GLTF model to the map using Three.js.</p> <p>Parameters:</p> Name Type Description Default <code>model_id</code> <code>str</code> <p>Unique identifier for the 3D model.</p> required <code>url</code> <code>str</code> <p>URL to the GLTF/GLB model file.</p> required <code>coordinates</code> <code>List[float]</code> <p>Geographic coordinates [longitude, latitude] where the model should be placed.</p> required <code>scale</code> <code>Union[float, List[float]]</code> <p>Scale factor for the model. Can be a single number or [x, y, z] list.</p> <code>1.0</code> <code>rotation</code> <code>Optional[List[float]]</code> <p>Optional rotation in radians as [x, y, z].</p> <code>None</code> <code>**kwargs</code> <code>Any</code> <p>Additional options for the model.</p> <code>{}</code> <p>Examples:</p> <pre><code>&gt;&gt;&gt; m = MapLibreMap(center=[148.9819, -35.3981], zoom=18, pitch=60)\n&gt;&gt;&gt; m.init_three_scene()\n&gt;&gt;&gt; m.add_three_light(type='ambient')\n&gt;&gt;&gt; m.add_three_model(\n...     model_id='my_model',\n...     url='https://example.com/model.gltf',\n...     coordinates=[148.9819, -35.3981],\n...     scale=100,\n...     rotation=[0, 0, 0]\n... )\n</code></pre> Source code in <code>anymap/maplibre.py</code> <pre><code>def add_three_model(\n    self,\n    model_id: str,\n    url: str,\n    coordinates: List[float],\n    scale: Union[float, List[float]] = 1.0,\n    rotation: Optional[List[float]] = None,\n    **kwargs: Any,\n) -&gt; None:\n    \"\"\"Add a 3D GLTF model to the map using Three.js.\n\n    Args:\n        model_id: Unique identifier for the 3D model.\n        url: URL to the GLTF/GLB model file.\n        coordinates: Geographic coordinates [longitude, latitude] where the model should be placed.\n        scale: Scale factor for the model. Can be a single number or [x, y, z] list.\n        rotation: Optional rotation in radians as [x, y, z].\n        **kwargs: Additional options for the model.\n\n    Example:\n        &gt;&gt;&gt; m = MapLibreMap(center=[148.9819, -35.3981], zoom=18, pitch=60)\n        &gt;&gt;&gt; m.init_three_scene()\n        &gt;&gt;&gt; m.add_three_light(type='ambient')\n        &gt;&gt;&gt; m.add_three_model(\n        ...     model_id='my_model',\n        ...     url='https://example.com/model.gltf',\n        ...     coordinates=[148.9819, -35.3981],\n        ...     scale=100,\n        ...     rotation=[0, 0, 0]\n        ... )\n    \"\"\"\n    model_config = {\n        \"id\": model_id,\n        \"url\": url,\n        \"coordinates\": coordinates,\n        \"scale\": scale,\n        \"options\": kwargs,\n    }\n\n    if rotation is not None:\n        model_config[\"rotation\"] = rotation\n\n    self.call_js_method(\"addThreeModel\", model_config)\n</code></pre>"},{"location":"maplibre/#anymap.maplibre.MapLibreMap.add_three_tileset","title":"<code>add_three_tileset(self, tileset_id, *, asset_id=None, url=None, ion_token=None, auto_refresh_token=True, auto_disable_renderer_culling=True, fetch_options=None, lru_cache=None, draco_decoder_path=None, ktx2_transcoder_path=None, use_debug=False, use_fade=False, use_unload=False, use_update=False, height_offset=0.0, fly_to=True)</code>","text":"<p>Add a 3D Tiles dataset to the scene using TilesRenderer.</p> Source code in <code>anymap/maplibre.py</code> <pre><code>def add_three_tileset(\n    self,\n    tileset_id: str,\n    *,\n    asset_id: Optional[Union[int, str]] = None,\n    url: Optional[str] = None,\n    ion_token: Optional[str] = None,\n    auto_refresh_token: bool = True,\n    auto_disable_renderer_culling: bool = True,\n    fetch_options: Optional[Dict[str, Any]] = None,\n    lru_cache: Optional[Dict[str, Any]] = None,\n    draco_decoder_path: Optional[str] = None,\n    ktx2_transcoder_path: Optional[str] = None,\n    use_debug: bool = False,\n    use_fade: bool = False,\n    use_unload: bool = False,\n    use_update: bool = False,\n    height_offset: float = 0.0,\n    fly_to: bool = True,\n) -&gt; None:\n    \"\"\"Add a 3D Tiles dataset to the scene using TilesRenderer.\"\"\"\n\n    if asset_id is None and url is None:\n        raise ValueError(\n            \"Either asset_id or url must be provided for add_three_tileset\"\n        )\n\n    config: Dict[str, Any] = {\n        \"id\": tileset_id,\n        \"assetId\": asset_id,\n        \"url\": url,\n        \"ionToken\": ion_token,\n        \"autoRefreshToken\": auto_refresh_token,\n        \"autoDisableRendererCulling\": auto_disable_renderer_culling,\n        \"fetchOptions\": fetch_options,\n        \"lruCache\": lru_cache,\n        \"dracoDecoderPath\": draco_decoder_path,\n        \"ktx2TranscoderPath\": ktx2_transcoder_path,\n        \"useDebug\": use_debug,\n        \"useFade\": use_fade,\n        \"useUnload\": use_unload,\n        \"useUpdate\": use_update,\n        \"heightOffset\": height_offset,\n        \"flyTo\": fly_to,\n    }\n\n    # Remove None values to keep payload minimal\n    payload = {key: value for key, value in config.items() if value is not None}\n    self.call_js_method(\"addThreeTileset\", payload)\n</code></pre>"},{"location":"maplibre/#anymap.maplibre.MapLibreMap.add_tile_layer","title":"<code>add_tile_layer(self, layer_id, source_url, attribution=None, opacity=1.0, visible=True, minzoom=None, maxzoom=None, paint=None, layout=None, before_id=None, **kwargs)</code>","text":"<p>Add a raster tile layer to the map.</p> <p>Parameters:</p> Name Type Description Default <code>layer_id</code> <code>str</code> <p>Unique identifier for the layer.</p> required <code>source_url</code> <code>str</code> <p>URL template for the tile source (e.g., 'https://example.com/{z}/{x}/{y}.png').</p> required <code>attribution</code> <code>Optional[str]</code> <p>Optional attribution text for the tile source.</p> <code>None</code> <code>opacity</code> <code>Optional[float]</code> <p>Layer opacity between 0.0 and 1.0.</p> <code>1.0</code> <code>visible</code> <code>Optional[bool]</code> <p>Whether the layer should be visible initially.</p> <code>True</code> <code>minzoom</code> <code>Optional[int]</code> <p>Minimum zoom level for the layer.</p> <code>None</code> <code>maxzoom</code> <code>Optional[int]</code> <p>Maximum zoom level for the layer.</p> <code>None</code> <code>paint</code> <code>Optional[Dict[str, Any]]</code> <p>Optional paint properties for the layer.</p> <code>None</code> <code>layout</code> <code>Optional[Dict[str, Any]]</code> <p>Optional layout properties for the layer.</p> <code>None</code> <code>before_id</code> <code>Optional[str]</code> <p>Optional layer ID to insert this layer before.</p> <code>None</code> <code>**kwargs</code> <code>Any</code> <p>Additional source configuration options.</p> <code>{}</code> Source code in <code>anymap/maplibre.py</code> <pre><code>def add_tile_layer(\n    self,\n    layer_id: str,\n    source_url: str,\n    attribution: Optional[str] = None,\n    opacity: Optional[float] = 1.0,\n    visible: Optional[bool] = True,\n    minzoom: Optional[int] = None,\n    maxzoom: Optional[int] = None,\n    paint: Optional[Dict[str, Any]] = None,\n    layout: Optional[Dict[str, Any]] = None,\n    before_id: Optional[str] = None,\n    **kwargs: Any,\n) -&gt; None:\n    \"\"\"Add a raster tile layer to the map.\n\n    Args:\n        layer_id: Unique identifier for the layer.\n        source_url: URL template for the tile source (e.g., 'https://example.com/{z}/{x}/{y}.png').\n        attribution: Optional attribution text for the tile source.\n        opacity: Layer opacity between 0.0 and 1.0.\n        visible: Whether the layer should be visible initially.\n        minzoom: Minimum zoom level for the layer.\n        maxzoom: Maximum zoom level for the layer.\n        paint: Optional paint properties for the layer.\n        layout: Optional layout properties for the layer.\n        before_id: Optional layer ID to insert this layer before.\n        **kwargs: Additional source configuration options.\n    \"\"\"\n    source_id = f\"{layer_id}_source\"\n\n    # Add raster source\n    self.add_source(\n        source_id,\n        {\"type\": \"raster\", \"tiles\": [source_url], \"tileSize\": 256, **kwargs},\n    )\n\n    # Add raster layer\n    layer_config = {\"id\": layer_id, \"type\": \"raster\", \"source\": source_id}\n\n    if paint:\n        layer_config[\"paint\"] = paint\n    if layout:\n        layer_config[\"layout\"] = layout\n\n    self.add_layer(layer=layer_config, before_id=before_id, layer_id=layer_id)\n</code></pre>"},{"location":"maplibre/#anymap.maplibre.MapLibreMap.add_to_sidebar","title":"<code>add_to_sidebar(self, widget, add_header=True, widget_icon='mdi-tools', close_icon='mdi-close', label='My Tools', background_color='#f5f5f5', height='40px', expanded=True, **kwargs)</code>","text":"<p>Appends a widget to the sidebar content.</p> <p>Parameters:</p> Name Type Description Default <code>widget</code> <code>Optional[Union[widgets.Widget, List[widgets.Widget]]]</code> <p>Initial widget(s) to display in the content box.</p> required <code>widget_icon</code> <code>str</code> <p>Icon for the header. See https://pictogrammers.github.io/@mdi/font/2.0.46/ for available icons.</p> <code>'mdi-tools'</code> <code>close_icon</code> <code>str</code> <p>Icon for the close button. See https://pictogrammers.github.io/@mdi/font/2.0.46/ for available icons.</p> <code>'mdi-close'</code> <code>background_color</code> <code>str</code> <p>Background color of the header. Defaults to \"#f5f5f5\".</p> <code>'#f5f5f5'</code> <code>label</code> <code>str</code> <p>Text label for the header. Defaults to \"My Tools\".</p> <code>'My Tools'</code> <code>height</code> <code>str</code> <p>Height of the header. Defaults to \"40px\".</p> <code>'40px'</code> <code>expanded</code> <code>bool</code> <p>Whether the panel is expanded by default. Defaults to True.</p> <code>True</code> <code>**kwargs</code> <code>Any</code> <p>Additional keyword arguments for the parent class.</p> <code>{}</code> Source code in <code>anymap/maplibre.py</code> <pre><code>def add_to_sidebar(\n    self,\n    widget: Union[widgets.Widget, List[widgets.Widget]],\n    add_header: bool = True,\n    widget_icon: str = \"mdi-tools\",\n    close_icon: str = \"mdi-close\",\n    label: str = \"My Tools\",\n    background_color: str = \"#f5f5f5\",\n    height: str = \"40px\",\n    expanded: bool = True,\n    **kwargs: Any,\n) -&gt; None:\n    \"\"\"\n    Appends a widget to the sidebar content.\n\n    Args:\n        widget (Optional[Union[widgets.Widget, List[widgets.Widget]]]): Initial widget(s) to display in the content box.\n        widget_icon (str): Icon for the header. See https://pictogrammers.github.io/@mdi/font/2.0.46/ for available icons.\n        close_icon (str): Icon for the close button. See https://pictogrammers.github.io/@mdi/font/2.0.46/ for available icons.\n        background_color (str): Background color of the header. Defaults to \"#f5f5f5\".\n        label (str): Text label for the header. Defaults to \"My Tools\".\n        height (str): Height of the header. Defaults to \"40px\".\n        expanded (bool): Whether the panel is expanded by default. Defaults to True.\n        **kwargs (Any): Additional keyword arguments for the parent class.\n\n    \"\"\"\n    if self.container is None:\n        self.create_container(**self.sidebar_args)\n    self.container.add_to_sidebar(\n        widget,\n        add_header=add_header,\n        widget_icon=widget_icon,\n        close_icon=close_icon,\n        label=label,\n        background_color=background_color,\n        height=height,\n        expanded=expanded,\n        host_map=self,\n        **kwargs,\n    )\n</code></pre>"},{"location":"maplibre/#anymap.maplibre.MapLibreMap.add_vector","title":"<code>add_vector(self, data, layer_type=None, filter=None, paint=None, name=None, fit_bounds=True, visible=True, before_id=None, source_args=None, **kwargs)</code>","text":"<p>Add a vector layer to the map.</p> <p>This method adds a vector layer to the map. The vector data can be a URL or local file path to a vector file (e.g., shapefile, GeoJSON, GeoPackage) or a GeoDataFrame.</p> <p>Parameters:</p> Name Type Description Default <code>data</code> <code>Union[str, gpd.GeoDataFrame]</code> <p>The vector data. This can be a URL, local file path to a vector file, or a GeoDataFrame.</p> required <code>layer_type</code> <code>Optional[str]</code> <p>The type of the layer. If None, the type is inferred from the GeoJSON data.</p> <code>None</code> <code>filter</code> <code>Optional[Dict]</code> <p>The filter to apply to the layer. If None, no filter is applied.</p> <code>None</code> <code>paint</code> <code>Optional[Dict]</code> <p>The paint properties to apply to the layer. If None, default paint properties are applied.</p> <code>None</code> <code>name</code> <code>Optional[str]</code> <p>The name of the layer. If None, a default name is generated.</p> <code>None</code> <code>fit_bounds</code> <code>bool</code> <p>Whether to adjust the viewport of the map to fit the bounds of the data. Defaults to True.</p> <code>True</code> <code>visible</code> <code>bool</code> <p>Whether the layer is visible or not. Defaults to True.</p> <code>True</code> <code>before_id</code> <code>Optional[str]</code> <p>The ID of an existing layer before which the new layer should be inserted.</p> <code>None</code> <code>source_args</code> <code>Optional[Dict]</code> <p>Additional keyword arguments that are passed to the GeoJSON source.</p> <code>None</code> <code>**kwargs</code> <code>Any</code> <p>Additional keyword arguments that are passed to the layer.</p> <code>{}</code> Source code in <code>anymap/maplibre.py</code> <pre><code>def add_vector(\n    self,\n    data: Union[str, \"gpd.GeoDataFrame\"],\n    layer_type: Optional[str] = None,\n    filter: Optional[Dict] = None,\n    paint: Optional[Dict] = None,\n    name: Optional[str] = None,\n    fit_bounds: bool = True,\n    visible: bool = True,\n    before_id: Optional[str] = None,\n    source_args: Optional[Dict] = None,\n    **kwargs: Any,\n) -&gt; None:\n    \"\"\"Add a vector layer to the map.\n\n    This method adds a vector layer to the map. The vector data can be a\n    URL or local file path to a vector file (e.g., shapefile, GeoJSON,\n    GeoPackage) or a GeoDataFrame.\n\n    Args:\n        data: The vector data. This can be a URL, local file path to a\n            vector file, or a GeoDataFrame.\n        layer_type: The type of the layer. If None, the type is inferred\n            from the GeoJSON data.\n        filter: The filter to apply to the layer. If None, no filter is applied.\n        paint: The paint properties to apply to the layer. If None, default\n            paint properties are applied.\n        name: The name of the layer. If None, a default name is generated.\n        fit_bounds: Whether to adjust the viewport of the map to fit the\n            bounds of the data. Defaults to True.\n        visible: Whether the layer is visible or not. Defaults to True.\n        before_id: The ID of an existing layer before which the new layer\n            should be inserted.\n        source_args: Additional keyword arguments that are passed to the\n            GeoJSON source.\n        **kwargs: Additional keyword arguments that are passed to the layer.\n    \"\"\"\n    import geopandas as gpd\n\n    if not isinstance(data, gpd.GeoDataFrame):\n        data = gpd.read_file(data).__geo_interface__\n    else:\n        data = data.__geo_interface__\n\n    self.add_geojson(\n        data,\n        layer_type=layer_type,\n        filter=filter,\n        paint=paint,\n        name=name,\n        fit_bounds=fit_bounds,\n        visible=visible,\n        before_id=before_id,\n        source_args=source_args,\n        **kwargs,\n    )\n</code></pre>"},{"location":"maplibre/#anymap.maplibre.MapLibreMap.add_vector_layer","title":"<code>add_vector_layer(self, layer_id, source_url, source_layer, layer_type='fill', paint=None, layout=None, before_id=None)</code>","text":"<p>Add a vector tile layer to the map.</p> <p>Parameters:</p> Name Type Description Default <code>layer_id</code> <code>str</code> <p>Unique identifier for the layer.</p> required <code>source_url</code> <code>str</code> <p>URL for the vector tile source.</p> required <code>source_layer</code> <code>str</code> <p>Name of the source layer within the vector tiles.</p> required <code>layer_type</code> <code>str</code> <p>Type of layer (e.g., 'fill', 'line', 'circle', 'symbol').</p> <code>'fill'</code> <code>paint</code> <code>Optional[Dict[str, Any]]</code> <p>Optional paint properties for styling the layer.</p> <code>None</code> <code>layout</code> <code>Optional[Dict[str, Any]]</code> <p>Optional layout properties for the layer.</p> <code>None</code> <code>before_id</code> <code>Optional[str]</code> <p>Optional layer ID to insert this layer before.</p> <code>None</code> Source code in <code>anymap/maplibre.py</code> <pre><code>def add_vector_layer(\n    self,\n    layer_id: str,\n    source_url: str,\n    source_layer: str,\n    layer_type: str = \"fill\",\n    paint: Optional[Dict[str, Any]] = None,\n    layout: Optional[Dict[str, Any]] = None,\n    before_id: Optional[str] = None,\n) -&gt; None:\n    \"\"\"Add a vector tile layer to the map.\n\n    Args:\n        layer_id: Unique identifier for the layer.\n        source_url: URL for the vector tile source.\n        source_layer: Name of the source layer within the vector tiles.\n        layer_type: Type of layer (e.g., 'fill', 'line', 'circle', 'symbol').\n        paint: Optional paint properties for styling the layer.\n        layout: Optional layout properties for the layer.\n        before_id: Optional layer ID to insert this layer before.\n    \"\"\"\n    source_id = f\"{layer_id}_source\"\n\n    # Add vector source\n    self.add_source(source_id, {\"type\": \"vector\", \"url\": source_url})\n\n    # Add vector layer\n    layer_config = {\n        \"id\": layer_id,\n        \"type\": layer_type,\n        \"source\": source_id,\n        \"source-layer\": source_layer,\n    }\n\n    if paint:\n        layer_config[\"paint\"] = paint\n    if layout:\n        layer_config[\"layout\"] = layout\n\n    self.add_layer(layer=layer_config, before_id=before_id, layer_id=layer_id)\n</code></pre>"},{"location":"maplibre/#anymap.maplibre.MapLibreMap.add_widget_control","title":"<code>add_widget_control(self, widget, *, label='Tools', icon='\u22ee', position='top-right', collapsed=True, panel_width=320, panel_min_width=220, panel_max_width=420, control_id=None, description=None)</code>","text":"<p>Add a collapsible widget control anchored to the map viewport.</p> <p>The control displays as a button alongside other MapLibre controls. Clicking the button expands a sidebar-style panel that renders the supplied ipywidget content.</p> <p>Parameters:</p> Name Type Description Default <code>widget</code> <code>Widget</code> <p>The ipywidget instance to embed inside the collapsible panel.</p> required <code>label</code> <code>str</code> <p>Title shown at the top of the expanded panel.</p> <code>'Tools'</code> <code>icon</code> <code>str</code> <p>Text or icon hint shown on the toggle button. Defaults to a vertical ellipsis.</p> <code>'\u22ee'</code> <code>position</code> <code>str</code> <p>Map control corner (<code>'top-left'</code>, <code>'top-right'</code>, <code>'bottom-left'</code>, or <code>'bottom-right'</code>).</p> <code>'top-right'</code> <code>collapsed</code> <code>bool</code> <p>Whether the panel starts collapsed.</p> <code>True</code> <code>panel_width</code> <code>int</code> <p>Default panel width in pixels.</p> <code>320</code> <code>panel_min_width</code> <code>int</code> <p>Minimum panel width in pixels when resized on the front-end.</p> <code>220</code> <code>panel_max_width</code> <code>int</code> <p>Maximum panel width in pixels when resized on the front-end.</p> <code>420</code> <code>control_id</code> <code>Optional[str]</code> <p>Optional identifier used for duplicate detection and later removal. If omitted, a unique identifier is generated from the label.</p> <code>None</code> <code>description</code> <code>Optional[str]</code> <p>Optional tooltip description for the toggle button.</p> <code>None</code> <p>Returns:</p> Type Description <code>str</code> <p>The unique identifier assigned to the widget control.</p> <p>Exceptions:</p> Type Description <code>TypeError</code> <p>If <code>widget</code> is not an ipywidget instance.</p> Source code in <code>anymap/maplibre.py</code> <pre><code>def add_widget_control(\n    self,\n    widget: widgets.Widget,\n    *,\n    label: str = \"Tools\",\n    icon: str = \"\u22ee\",\n    position: str = \"top-right\",\n    collapsed: bool = True,\n    panel_width: int = 320,\n    panel_min_width: int = 220,\n    panel_max_width: int = 420,\n    control_id: Optional[str] = None,\n    description: Optional[str] = None,\n) -&gt; str:\n    \"\"\"\n    Add a collapsible widget control anchored to the map viewport.\n\n    The control displays as a button alongside other MapLibre controls. Clicking\n    the button expands a sidebar-style panel that renders the supplied\n    ipywidget content.\n\n    Args:\n        widget: The ipywidget instance to embed inside the collapsible panel.\n        label: Title shown at the top of the expanded panel.\n        icon: Text or icon hint shown on the toggle button. Defaults to a vertical ellipsis.\n        position: Map control corner (``'top-left'``, ``'top-right'``,\n            ``'bottom-left'``, or ``'bottom-right'``).\n        collapsed: Whether the panel starts collapsed.\n        panel_width: Default panel width in pixels.\n        panel_min_width: Minimum panel width in pixels when resized on the front-end.\n        panel_max_width: Maximum panel width in pixels when resized on the front-end.\n        control_id: Optional identifier used for duplicate detection and later removal.\n            If omitted, a unique identifier is generated from the label.\n        description: Optional tooltip description for the toggle button.\n\n    Returns:\n        str: The unique identifier assigned to the widget control.\n\n    Raises:\n        TypeError: If ``widget`` is not an ipywidget instance.\n    \"\"\"\n    if not isinstance(widget, widgets.Widget):\n        raise TypeError(\"widget must be an ipywidgets.Widget instance\")\n\n    if control_id is None:\n        base_slug = \"\".join(\n            char.lower() if char.isalnum() else \"-\" for char in label\n        ).strip(\"-\")\n        if not base_slug:\n            base_slug = \"widget\"\n        control_id = f\"{base_slug}-{uuid.uuid4().hex[:6]}\"\n\n    # Ensure uniqueness when callers supply their own identifier\n    if control_id in self._widget_control_widgets:\n        raise ValueError(f\"Widget control '{control_id}' already exists\")\n\n    widget_id = getattr(widget, \"model_id\", None)\n    if widget_id is None:\n        raise ValueError(\n            \"The supplied widget does not have a model_id. Ensure it is an ipywidget \"\n            \"instance created within the current notebook session.\"\n        )\n\n    control_options: Dict[str, Any] = {\n        \"position\": position,\n        \"label\": label,\n        \"icon\": icon,\n        \"collapsed\": collapsed,\n        \"panelWidth\": panel_width,\n        \"panelMinWidth\": panel_min_width,\n        \"panelMaxWidth\": panel_max_width,\n        \"control_id\": control_id,\n        \"widget_model_id\": widget_id,\n    }\n\n    if description:\n        control_options[\"description\"] = description\n\n    control_key = f\"widget_panel_{control_id}\"\n\n    current_controls = dict(self._controls)\n    current_controls[control_key] = {\n        \"type\": \"widget_panel\",\n        \"position\": position,\n        \"options\": control_options,\n    }\n    self._controls = current_controls\n\n    self._widget_control_widgets[control_id] = widget\n    self.call_js_method(\"addControl\", \"widget_panel\", control_options)\n\n    return control_id\n</code></pre>"},{"location":"maplibre/#anymap.maplibre.MapLibreMap.clear_deckgl_layers","title":"<code>clear_deckgl_layers(self)</code>","text":"<p>Remove all DeckGL layers from the map.</p> Source code in <code>anymap/maplibre.py</code> <pre><code>def clear_deckgl_layers(self) -&gt; None:\n    \"\"\"Remove all DeckGL layers from the map.\"\"\"\n    # Clear local state\n    self._deckgl_layers = {}\n\n    # Send to JavaScript\n    self.call_js_method(\"clearDeckGLLayers\")\n</code></pre>"},{"location":"maplibre/#anymap.maplibre.MapLibreMap.clear_draw_data","title":"<code>clear_draw_data(self)</code>","text":"<p>Clear all drawn features from the draw control.</p> Source code in <code>anymap/maplibre.py</code> <pre><code>def clear_draw_data(self) -&gt; None:\n    \"\"\"Clear all drawn features from the draw control.\"\"\"\n    # Clear the trait data immediately\n    self._draw_data = {\"type\": \"FeatureCollection\", \"features\": []}\n\n    # Clear in JavaScript\n    self.call_js_method(\"clearDrawData\")\n</code></pre>"},{"location":"maplibre/#anymap.maplibre.MapLibreMap.clear_geoman_data","title":"<code>clear_geoman_data(self)</code>","text":"<p>Clear all Geoman-managed features.</p> Source code in <code>anymap/maplibre.py</code> <pre><code>def clear_geoman_data(self) -&gt; None:\n    \"\"\"Clear all Geoman-managed features.\"\"\"\n\n    self.set_geoman_data({\"type\": \"FeatureCollection\", \"features\": []})\n</code></pre>"},{"location":"maplibre/#anymap.maplibre.MapLibreMap.clear_terra_draw_data","title":"<code>clear_terra_draw_data(self)</code>","text":"<p>Clear all Terra Draw features from the draw control.</p> Source code in <code>anymap/maplibre.py</code> <pre><code>def clear_terra_draw_data(self) -&gt; None:\n    \"\"\"Clear all Terra Draw features from the draw control.\"\"\"\n    # Clear the trait data immediately\n    self._terra_draw_data = {\"type\": \"FeatureCollection\", \"features\": []}\n\n    # Clear in JavaScript\n    self.call_js_method(\"clearTerraDrawData\")\n</code></pre>"},{"location":"maplibre/#anymap.maplibre.MapLibreMap.collapse_geoman_control","title":"<code>collapse_geoman_control(self)</code>","text":"<p>Collapse the Geoman draw control toolbar.</p> Source code in <code>anymap/maplibre.py</code> <pre><code>def collapse_geoman_control(self) -&gt; None:\n    \"\"\"Collapse the Geoman draw control toolbar.\"\"\"\n\n    self.call_js_method(\"collapseGeomanControl\")\n</code></pre>"},{"location":"maplibre/#anymap.maplibre.MapLibreMap.create_container","title":"<code>create_container(self, sidebar_visible=None, min_width=None, max_width=None, expanded=None, **kwargs)</code>","text":"<p>Creates a container widget for the map with an optional sidebar.</p> <p>This method initializes a <code>LayerManagerWidget</code> and a <code>Container</code> widget to display the map alongside a sidebar. The sidebar can be customized with visibility, width, and additional content.</p> <p>Parameters:</p> Name Type Description Default <code>sidebar_visible</code> <code>bool</code> <p>Whether the sidebar is visible. Defaults to False.</p> <code>None</code> <code>min_width</code> <code>int</code> <p>Minimum width of the sidebar in pixels. Defaults to 360.</p> <code>None</code> <code>max_width</code> <code>int</code> <p>Maximum width of the sidebar in pixels. Defaults to 360.</p> <code>None</code> <code>expanded</code> <code>bool</code> <p>Whether the <code>LayerManagerWidget</code> is expanded by default. Defaults to True.</p> <code>None</code> <code>**kwargs</code> <code>Any</code> <p>Additional keyword arguments passed to the <code>Container</code> widget.</p> <code>{}</code> <p>Returns:</p> Type Description <code>Container</code> <p>The created container widget with the map and sidebar.</p> Source code in <code>anymap/maplibre.py</code> <pre><code>def create_container(\n    self,\n    sidebar_visible: bool = None,\n    min_width: int = None,\n    max_width: int = None,\n    expanded: bool = None,\n    **kwargs: Any,\n):\n    \"\"\"\n    Creates a container widget for the map with an optional sidebar.\n\n    This method initializes a `LayerManagerWidget` and a `Container` widget to display the map\n    alongside a sidebar. The sidebar can be customized with visibility, width, and additional content.\n\n    Args:\n        sidebar_visible (bool): Whether the sidebar is visible. Defaults to False.\n        min_width (int): Minimum width of the sidebar in pixels. Defaults to 360.\n        max_width (int): Maximum width of the sidebar in pixels. Defaults to 360.\n        expanded (bool): Whether the `LayerManagerWidget` is expanded by default. Defaults to True.\n        **kwargs (Any): Additional keyword arguments passed to the `Container` widget.\n\n    Returns:\n        Container: The created container widget with the map and sidebar.\n    \"\"\"\n\n    if sidebar_visible is None:\n        sidebar_visible = self.sidebar_args.get(\"sidebar_visible\", False)\n    if min_width is None:\n        min_width = self.sidebar_args.get(\"min_width\", 360)\n    if max_width is None:\n        max_width = self.sidebar_args.get(\"max_width\", 360)\n    if expanded is None:\n        expanded = self.sidebar_args.get(\"expanded\", True)\n    if self.layer_manager is None:\n        self.layer_manager = LayerManagerWidget(self, expanded=expanded)\n\n    container = Container(\n        host_map=self,\n        sidebar_visible=sidebar_visible,\n        min_width=min_width,\n        max_width=max_width,\n        sidebar_content=[self.layer_manager],\n        **kwargs,\n    )\n    self.container = container\n    self.container.sidebar_widgets[\"Layers\"] = self.layer_manager\n    return container\n</code></pre>"},{"location":"maplibre/#anymap.maplibre.MapLibreMap.delete_draw_features","title":"<code>delete_draw_features(self, feature_ids)</code>","text":"<p>Delete specific features from the draw control.</p> <p>Parameters:</p> Name Type Description Default <code>feature_ids</code> <code>List[str]</code> <p>List of feature IDs to delete</p> required Source code in <code>anymap/maplibre.py</code> <pre><code>def delete_draw_features(self, feature_ids: List[str]) -&gt; None:\n    \"\"\"Delete specific features from the draw control.\n\n    Args:\n        feature_ids: List of feature IDs to delete\n    \"\"\"\n    self.call_js_method(\"deleteDrawFeatures\", feature_ids)\n</code></pre>"},{"location":"maplibre/#anymap.maplibre.MapLibreMap.disable_feature_popup","title":"<code>disable_feature_popup(self, layer_id)</code>","text":"<p>Disable attribute popups for the specified layer.</p> <p>Parameters:</p> Name Type Description Default <code>layer_id</code> <code>str</code> <p>Identifier of the target layer.</p> required Source code in <code>anymap/maplibre.py</code> <pre><code>def disable_feature_popup(self, layer_id: str) -&gt; None:\n    \"\"\"\n    Disable attribute popups for the specified layer.\n\n    Args:\n        layer_id: Identifier of the target layer.\n    \"\"\"\n\n    self.call_js_method(\"disableFeaturePopup\", {\"layerId\": layer_id})\n</code></pre>"},{"location":"maplibre/#anymap.maplibre.MapLibreMap.enable_feature_popup","title":"<code>enable_feature_popup(self, layer_id, *, fields=None, aliases=None, title=None, title_field=None, max_properties=25, close_button=True, max_width='320px')</code>","text":"<p>Enable attribute popups for a layer when users click its features.</p> <p>Parameters:</p> Name Type Description Default <code>layer_id</code> <code>str</code> <p>Identifier of the target layer.</p> required <code>fields</code> <code>Union[Sequence[str], Dict[str, str]]</code> <p>Optional ordered list of attribute keys to display. When omitted, up to <code>max_properties</code> properties are shown.</p> <code>None</code> <code>aliases</code> <code>Optional[Dict[str, str]]</code> <p>Optional mapping from attribute key to display label. Only applies when <code>fields</code> is provided.</p> <code>None</code> <code>title</code> <code>Optional[str]</code> <p>Optional static string rendered above the attribute table.</p> <code>None</code> <code>title_field</code> <code>Optional[str]</code> <p>Optional property key whose value should be used as the popup title. Ignored when <code>title</code> is provided.</p> <code>None</code> <code>max_properties</code> <code>int</code> <p>Maximum number of properties displayed when <code>fields</code> is not supplied. Defaults to 25.</p> <code>25</code> <code>close_button</code> <code>bool</code> <p>Whether the popup shows a close button. Defaults to True.</p> <code>True</code> <code>max_width</code> <code>str</code> <p>CSS max-width applied to the popup container. Defaults to 320px.</p> <code>'320px'</code> Source code in <code>anymap/maplibre.py</code> <pre><code>def enable_feature_popup(\n    self,\n    layer_id: str,\n    *,\n    fields: Optional[Union[Sequence[str], Dict[str, str]]] = None,\n    aliases: Optional[Dict[str, str]] = None,\n    title: Optional[str] = None,\n    title_field: Optional[str] = None,\n    max_properties: int = 25,\n    close_button: bool = True,\n    max_width: str = \"320px\",\n) -&gt; None:\n    \"\"\"\n    Enable attribute popups for a layer when users click its features.\n\n    Args:\n        layer_id: Identifier of the target layer.\n        fields: Optional ordered list of attribute keys to display. When omitted,\n            up to ``max_properties`` properties are shown.\n        aliases: Optional mapping from attribute key to display label. Only applies\n            when ``fields`` is provided.\n        title: Optional static string rendered above the attribute table.\n        title_field: Optional property key whose value should be used as the popup\n            title. Ignored when ``title`` is provided.\n        max_properties: Maximum number of properties displayed when ``fields`` is\n            not supplied. Defaults to 25.\n        close_button: Whether the popup shows a close button. Defaults to True.\n        max_width: CSS max-width applied to the popup container. Defaults to 320px.\n    \"\"\"\n\n    alias_lookup: Dict[str, str] = aliases or {}\n\n    field_config: Optional[List[Dict[str, str]]] = None\n    if fields is not None:\n        if isinstance(fields, dict):\n            field_config = [\n                {\"name\": str(key), \"label\": str(value)}\n                for key, value in fields.items()\n            ]\n        else:\n            field_config = []\n            for name in fields:\n                field_name = str(name)\n                label_source = alias_lookup.get(\n                    name, alias_lookup.get(field_name, field_name)\n                )\n                field_config.append(\n                    {\"name\": field_name, \"label\": str(label_source)}\n                )\n\n    config: Dict[str, Any] = {\n        \"layerId\": layer_id,\n        \"maxProperties\": max_properties,\n        \"closeButton\": close_button,\n        \"maxWidth\": max_width,\n    }\n    if field_config is not None:\n        config[\"fields\"] = field_config\n    if title is not None:\n        config[\"title\"] = title\n    if title_field is not None:\n        config[\"titleField\"] = title_field\n\n    self.call_js_method(\"enableFeaturePopup\", config)\n</code></pre>"},{"location":"maplibre/#anymap.maplibre.MapLibreMap.expand_geoman_control","title":"<code>expand_geoman_control(self)</code>","text":"<p>Expand the Geoman draw control toolbar.</p> Source code in <code>anymap/maplibre.py</code> <pre><code>def expand_geoman_control(self) -&gt; None:\n    \"\"\"Expand the Geoman draw control toolbar.\"\"\"\n\n    self.call_js_method(\"expandGeomanControl\")\n</code></pre>"},{"location":"maplibre/#anymap.maplibre.MapLibreMap.find_first_symbol_layer","title":"<code>find_first_symbol_layer(self)</code>","text":"<p>Find the first symbol layer in the map's current style.</p> <p>Returns:</p> Type Description <code>Optional[Dict]</code> <p>The first symbol layer as a dictionary if found, otherwise None.</p> Source code in <code>anymap/maplibre.py</code> <pre><code>def find_first_symbol_layer(self) -&gt; Optional[Dict]:\n    \"\"\"\n    Find the first symbol layer in the map's current style.\n\n    Returns:\n        Optional[Dict]: The first symbol layer as a dictionary if found, otherwise None.\n    \"\"\"\n    layers = self.get_style_layers()\n    for layer in layers:\n        if layer[\"type\"] == \"symbol\":\n            return layer\n    return None\n</code></pre>"},{"location":"maplibre/#anymap.maplibre.MapLibreMap.find_style_layer","title":"<code>find_style_layer(self, id)</code>","text":"<p>Searches for a style layer in the map's current style by its ID and returns it if found.</p> <p>Parameters:</p> Name Type Description Default <code>id</code> <code>str</code> <p>The ID of the style layer to find.</p> required <p>Returns:</p> Type Description <code>Optional[Dict]</code> <p>The style layer as a dictionary if found, otherwise None.</p> Source code in <code>anymap/maplibre.py</code> <pre><code>def find_style_layer(self, id: str) -&gt; Optional[Dict]:\n    \"\"\"\n    Searches for a style layer in the map's current style by its ID and returns it if found.\n\n    Args:\n        id (str): The ID of the style layer to find.\n\n    Returns:\n        Optional[Dict]: The style layer as a dictionary if found, otherwise None.\n    \"\"\"\n    layers = self.get_style_layers()\n    for layer in layers:\n        if layer[\"id\"] == id:\n            return layer\n    return None\n</code></pre>"},{"location":"maplibre/#anymap.maplibre.MapLibreMap.fit_bounds","title":"<code>fit_bounds(self, bounds, padding=50)</code>","text":"<p>Fit the map to given bounds.</p> <p>Parameters:</p> Name Type Description Default <code>bounds</code> <code>List[List[float]]</code> <p>Bounding box as [[south, west], [north, east]].</p> required <code>padding</code> <code>int</code> <p>Padding around the bounds in pixels.</p> <code>50</code> Source code in <code>anymap/maplibre.py</code> <pre><code>def fit_bounds(self, bounds: List[List[float]], padding: int = 50) -&gt; None:\n    \"\"\"Fit the map to given bounds.\n\n    Args:\n        bounds: Bounding box as [[south, west], [north, east]].\n        padding: Padding around the bounds in pixels.\n    \"\"\"\n    self.call_js_method(\"fitBounds\", bounds, {\"padding\": padding})\n</code></pre>"},{"location":"maplibre/#anymap.maplibre.MapLibreMap.fly_to_three_tileset","title":"<code>fly_to_three_tileset(self, tileset_id)</code>","text":"<p>Animate the camera to frame a 3D Tiles dataset.</p> Source code in <code>anymap/maplibre.py</code> <pre><code>def fly_to_three_tileset(self, tileset_id: str) -&gt; None:\n    \"\"\"Animate the camera to frame a 3D Tiles dataset.\"\"\"\n\n    self.call_js_method(\"flyToThreeTileset\", tileset_id)\n</code></pre>"},{"location":"maplibre/#anymap.maplibre.MapLibreMap.get_cog_metadata","title":"<code>get_cog_metadata(self, url, crs='EPSG:4326')</code>","text":"<p>Retrieve metadata from a Cloud Optimized GeoTIFF (COG) file.</p> <p>This method fetches metadata from a COG file. It uses rasterio if available, which provides comprehensive metadata extraction capabilities.</p> <p>Note</p> <p>This feature corresponds to the getCogMetadata function in maplibre-cog-protocol, which is marked as [unstable]. Some metadata internals may change in future releases.</p> <p>Parameters:</p> Name Type Description Default <code>url</code> <code>str</code> <p>The URL of the COG file to retrieve metadata from.</p> required <code>crs</code> <code>str</code> <p>The coordinate reference system to use for the output bbox. Defaults to \"EPSG:4326\" (WGS84 lat/lon). Set to None to use the COG's native CRS.</p> <code>'EPSG:4326'</code> <p>Returns:</p> Type Description <code>Optional[Dict[str, Any]]</code> <p>A dictionary containing COG metadata with keys such as:     - bbox: Bounding box coordinates [west, south, east, north] in the specified CRS     - bounds: BoundingBox in native CRS     - width: Width of the raster in pixels     - height: Height of the raster in pixels     - crs: Original coordinate reference system of the COG     - output_crs: CRS of the returned bbox     - transform: Affine transformation matrix     - count: Number of bands     - dtypes: Data types for each band     - nodata: NoData value     - scale: Scale value (if available)     - offset: Offset value (if available) Returns None if metadata retrieval fails.</p> <p>Examples:</p> <pre><code>&gt;&gt;&gt; m = MapLibreMap()\n&gt;&gt;&gt; url = \"https://example.com/data.tif\"\n&gt;&gt;&gt; # Get metadata with bbox in WGS84 (default)\n&gt;&gt;&gt; metadata = m.get_cog_metadata(url)\n&gt;&gt;&gt; if metadata:\n...     print(f\"Bounding box (WGS84): {metadata.get('bbox')}\")\n...     # Fit bounds using WGS84 coordinates\n...     bbox = metadata['bbox']\n...     m.fit_bounds([[bbox[0], bbox[1]], [bbox[2], bbox[3]]])\n&gt;&gt;&gt;\n&gt;&gt;&gt; # Get metadata in native CRS\n&gt;&gt;&gt; metadata = m.get_cog_metadata(url, crs=None)\n&gt;&gt;&gt; if metadata:\n...     print(f\"Native CRS: {metadata.get('crs')}\")\n</code></pre> Source code in <code>anymap/maplibre.py</code> <pre><code>def get_cog_metadata(\n    self, url: str, crs: str = \"EPSG:4326\"\n) -&gt; Optional[Dict[str, Any]]:\n    \"\"\"Retrieve metadata from a Cloud Optimized GeoTIFF (COG) file.\n\n    This method fetches metadata from a COG file. It uses rasterio if available,\n    which provides comprehensive metadata extraction capabilities.\n\n    Note:\n        This feature corresponds to the getCogMetadata function in maplibre-cog-protocol,\n        which is marked as [unstable]. Some metadata internals may change in future releases.\n\n    Args:\n        url (str): The URL of the COG file to retrieve metadata from.\n        crs (str, optional): The coordinate reference system to use for the output bbox.\n            Defaults to \"EPSG:4326\" (WGS84 lat/lon). Set to None to use the COG's native CRS.\n\n    Returns:\n        Optional[Dict[str, Any]]: A dictionary containing COG metadata with keys such as:\n            - bbox: Bounding box coordinates [west, south, east, north] in the specified CRS\n            - bounds: BoundingBox in native CRS\n            - width: Width of the raster in pixels\n            - height: Height of the raster in pixels\n            - crs: Original coordinate reference system of the COG\n            - output_crs: CRS of the returned bbox\n            - transform: Affine transformation matrix\n            - count: Number of bands\n            - dtypes: Data types for each band\n            - nodata: NoData value\n            - scale: Scale value (if available)\n            - offset: Offset value (if available)\n        Returns None if metadata retrieval fails.\n\n    Example:\n        &gt;&gt;&gt; m = MapLibreMap()\n        &gt;&gt;&gt; url = \"https://example.com/data.tif\"\n        &gt;&gt;&gt; # Get metadata with bbox in WGS84 (default)\n        &gt;&gt;&gt; metadata = m.get_cog_metadata(url)\n        &gt;&gt;&gt; if metadata:\n        ...     print(f\"Bounding box (WGS84): {metadata.get('bbox')}\")\n        ...     # Fit bounds using WGS84 coordinates\n        ...     bbox = metadata['bbox']\n        ...     m.fit_bounds([[bbox[0], bbox[1]], [bbox[2], bbox[3]]])\n        &gt;&gt;&gt;\n        &gt;&gt;&gt; # Get metadata in native CRS\n        &gt;&gt;&gt; metadata = m.get_cog_metadata(url, crs=None)\n        &gt;&gt;&gt; if metadata:\n        ...     print(f\"Native CRS: {metadata.get('crs')}\")\n    \"\"\"\n    return utils.get_cog_metadata(url, crs=crs)\n</code></pre>"},{"location":"maplibre/#anymap.maplibre.MapLibreMap.get_deckgl_layers","title":"<code>get_deckgl_layers(self)</code>","text":"<p>Get all DeckGL layers currently on the map.</p> <p>Returns:</p> Type Description <code>Dict[str, Dict[str, Any]]</code> <p>Dictionary mapping layer IDs to their configurations.</p> Source code in <code>anymap/maplibre.py</code> <pre><code>def get_deckgl_layers(self) -&gt; Dict[str, Dict[str, Any]]:\n    \"\"\"Get all DeckGL layers currently on the map.\n\n    Returns:\n        Dictionary mapping layer IDs to their configurations.\n    \"\"\"\n    return dict(self._deckgl_layers)\n</code></pre>"},{"location":"maplibre/#anymap.maplibre.MapLibreMap.get_draw_data","title":"<code>get_draw_data(self)</code>","text":"<p>Get all drawn features as GeoJSON.</p> <p>Returns:</p> Type Description <code>Dict[str, Any]</code> <p>Dict containing GeoJSON FeatureCollection with drawn features</p> Source code in <code>anymap/maplibre.py</code> <pre><code>def get_draw_data(self) -&gt; Dict[str, Any]:\n    \"\"\"Get all drawn features as GeoJSON.\n\n    Returns:\n        Dict containing GeoJSON FeatureCollection with drawn features\n    \"\"\"\n    # Try to get current data first\n    if self._draw_data:\n        return self._draw_data\n\n    # If no data in trait, call JavaScript to get fresh data\n    self.call_js_method(\"getDrawData\")\n    # Give JavaScript time to execute and sync data\n    import time\n\n    time.sleep(0.2)\n\n    # Return the synced data or empty FeatureCollection if nothing\n    return (\n        self._draw_data\n        if self._draw_data\n        else {\"type\": \"FeatureCollection\", \"features\": []}\n    )\n</code></pre>"},{"location":"maplibre/#anymap.maplibre.MapLibreMap.get_geoman_data","title":"<code>get_geoman_data(self)</code>","text":"<p>Return the current Geoman feature collection.</p> <p>Returns:</p> Type Description <code>Dict[str, Any]</code> <p>A GeoJSON FeatureCollection containing all Geoman-managed features.</p> Source code in <code>anymap/maplibre.py</code> <pre><code>def get_geoman_data(\n    self,\n) -&gt; Dict[str, Any]:\n    \"\"\"Return the current Geoman feature collection.\n\n    Returns:\n        A GeoJSON FeatureCollection containing all Geoman-managed features.\n\n    \"\"\"\n\n    return self.geoman_data\n</code></pre>"},{"location":"maplibre/#anymap.maplibre.MapLibreMap.get_layer_type","title":"<code>get_layer_type(self, layer_id)</code>","text":"<p>Get the type of a layer.</p> <p>Parameters:</p> Name Type Description Default <code>layer_id</code> <code>str</code> <p>Unique identifier of the layer.</p> required <p>Returns:</p> Type Description <code>Optional[str]</code> <p>Layer type string, or None if layer doesn't exist.</p> Source code in <code>anymap/maplibre.py</code> <pre><code>def get_layer_type(self, layer_id: str) -&gt; Optional[str]:\n    \"\"\"Get the type of a layer.\n\n    Args:\n        layer_id: Unique identifier of the layer.\n\n    Returns:\n        Layer type string, or None if layer doesn't exist.\n    \"\"\"\n    if layer_id in self._layers:\n        return self._layers[layer_id][\"type\"]\n    else:\n        return None\n</code></pre>"},{"location":"maplibre/#anymap.maplibre.MapLibreMap.get_style","title":"<code>get_style(self)</code>","text":"<p>Get the style of the map.</p> <p>Returns:</p> Type Description <code>Dict</code> <p>The style of the map.</p> Source code in <code>anymap/maplibre.py</code> <pre><code>def get_style(self):\n    \"\"\"\n    Get the style of the map.\n\n    Returns:\n        Dict: The style of the map.\n    \"\"\"\n    if self._style is not None:\n        if isinstance(self._style, str):\n            response = requests.get(self._style, timeout=10)\n            style = response.json()\n        elif isinstance(self._style, dict):\n            style = self._style\n        else:\n            style = {}\n        return style\n    else:\n        return {}\n</code></pre>"},{"location":"maplibre/#anymap.maplibre.MapLibreMap.get_style_layers","title":"<code>get_style_layers(self, return_ids=False, sorted=True)</code>","text":"<p>Get the names of the basemap layers.</p> <p>Returns:</p> Type Description <code>List[str]</code> <p>The names of the basemap layers.</p> Source code in <code>anymap/maplibre.py</code> <pre><code>def get_style_layers(self, return_ids=False, sorted=True) -&gt; List[str]:\n    \"\"\"\n    Get the names of the basemap layers.\n\n    Returns:\n        List[str]: The names of the basemap layers.\n    \"\"\"\n    style = self.get_style()\n    if \"layers\" in style:\n        layers = style[\"layers\"]\n        if return_ids:\n            ids = [layer[\"id\"] for layer in layers]\n            if sorted:\n                ids.sort()\n\n            return ids\n        else:\n            return layers\n    else:\n        return []\n</code></pre>"},{"location":"maplibre/#anymap.maplibre.MapLibreMap.get_terra_draw_data","title":"<code>get_terra_draw_data(self)</code>","text":"<p>Get all Terra Draw features as GeoJSON.</p> <p>Returns:</p> Type Description <code>Dict[str, Any]</code> <p>Dict containing GeoJSON FeatureCollection with drawn features</p> Source code in <code>anymap/maplibre.py</code> <pre><code>def get_terra_draw_data(self) -&gt; Dict[str, Any]:\n    \"\"\"Get all Terra Draw features as GeoJSON.\n\n    Returns:\n        Dict containing GeoJSON FeatureCollection with drawn features\n    \"\"\"\n    # Try to get current data first\n    if self._terra_draw_data:\n        return self._terra_draw_data\n\n    # If no data in trait, call JavaScript to get fresh data\n    self.call_js_method(\"getTerraDrawData\")\n    # Give JavaScript time to execute and sync data\n    import time\n\n    time.sleep(0.2)\n\n    # Return the synced data or empty FeatureCollection if nothing\n    return (\n        self._terra_draw_data\n        if self._terra_draw_data\n        else {\"type\": \"FeatureCollection\", \"features\": []}\n    )\n</code></pre>"},{"location":"maplibre/#anymap.maplibre.MapLibreMap.init_three_scene","title":"<code>init_three_scene(self)</code>","text":"<p>Initialize the MapLibre Three.js scene.</p> <p>This must be called before adding any 3D models or lights. It initializes the MapScene object that connects MapLibre GL JS with Three.js.</p> <p>Examples:</p> <pre><code>&gt;&gt;&gt; m = MapLibreMap(center=[148.9819, -35.3981], zoom=18, pitch=60)\n&gt;&gt;&gt; m.init_three_scene()\n&gt;&gt;&gt; m.add_three_light(light_type='ambient')\n</code></pre> Source code in <code>anymap/maplibre.py</code> <pre><code>def init_three_scene(self) -&gt; None:\n    \"\"\"Initialize the MapLibre Three.js scene.\n\n    This must be called before adding any 3D models or lights.\n    It initializes the MapScene object that connects MapLibre GL JS with Three.js.\n\n    Example:\n        &gt;&gt;&gt; m = MapLibreMap(center=[148.9819, -35.3981], zoom=18, pitch=60)\n        &gt;&gt;&gt; m.init_three_scene()\n        &gt;&gt;&gt; m.add_three_light(light_type='ambient')\n    \"\"\"\n    self.call_js_method(\"initMapScene\")\n</code></pre>"},{"location":"maplibre/#anymap.maplibre.MapLibreMap.load_draw_data","title":"<code>load_draw_data(self, geojson_data)</code>","text":"<p>Load GeoJSON data into the draw control.</p> <p>Parameters:</p> Name Type Description Default <code>geojson_data</code> <code>Union[Dict[str, Any], str]</code> <p>GeoJSON data as dictionary or JSON string</p> required Source code in <code>anymap/maplibre.py</code> <pre><code>def load_draw_data(self, geojson_data: Union[Dict[str, Any], str]) -&gt; None:\n    \"\"\"Load GeoJSON data into the draw control.\n\n    Args:\n        geojson_data: GeoJSON data as dictionary or JSON string\n    \"\"\"\n    if isinstance(geojson_data, str):\n        geojson_data = json.loads(geojson_data)\n\n    # Update the trait immediately to ensure consistency\n    self._draw_data = geojson_data\n\n    # Send to JavaScript\n    self.call_js_method(\"loadDrawData\", geojson_data)\n</code></pre>"},{"location":"maplibre/#anymap.maplibre.MapLibreMap.load_terra_draw_data","title":"<code>load_terra_draw_data(self, geojson_data)</code>","text":"<p>Load GeoJSON data into the Terra Draw control.</p> <p>Parameters:</p> Name Type Description Default <code>geojson_data</code> <code>Union[Dict[str, Any], str]</code> <p>GeoJSON data as dictionary or JSON string</p> required Source code in <code>anymap/maplibre.py</code> <pre><code>def load_terra_draw_data(self, geojson_data: Union[Dict[str, Any], str]) -&gt; None:\n    \"\"\"Load GeoJSON data into the Terra Draw control.\n\n    Args:\n        geojson_data: GeoJSON data as dictionary or JSON string\n    \"\"\"\n    if isinstance(geojson_data, str):\n        geojson_data = json.loads(geojson_data)\n\n    # Update the trait immediately to ensure consistency\n    self._terra_draw_data = geojson_data\n\n    # Send to JavaScript\n    self.call_js_method(\"loadTerraDrawData\", geojson_data)\n</code></pre>"},{"location":"maplibre/#anymap.maplibre.MapLibreMap.remove_control","title":"<code>remove_control(self, control_type, position='top-right')</code>","text":"<p>Remove a control from the map.</p> <p>Parameters:</p> Name Type Description Default <code>control_type</code> <code>str</code> <p>Type of control to remove ('navigation', 'scale', 'fullscreen', 'geolocate', 'attribution', 'globe')</p> required <code>position</code> <code>str</code> <p>Position where the control was added ('top-left', 'top-right', 'bottom-left', 'bottom-right')</p> <code>'top-right'</code> Source code in <code>anymap/maplibre.py</code> <pre><code>def remove_control(\n    self,\n    control_type: str,\n    position: str = \"top-right\",\n) -&gt; None:\n    \"\"\"Remove a control from the map.\n\n    Args:\n        control_type: Type of control to remove ('navigation', 'scale', 'fullscreen', 'geolocate', 'attribution', 'globe')\n        position: Position where the control was added ('top-left', 'top-right', 'bottom-left', 'bottom-right')\n    \"\"\"\n    # Remove control from persistent state\n    control_key = f\"{control_type}_{position}\"\n    current_controls = dict(self._controls)\n    if control_key in current_controls:\n        del current_controls[control_key]\n        self._controls = current_controls\n\n    self.call_js_method(\"removeControl\", control_type, position)\n</code></pre>"},{"location":"maplibre/#anymap.maplibre.MapLibreMap.remove_deckgl_layer","title":"<code>remove_deckgl_layer(self, layer_id)</code>","text":"<p>Remove a DeckGL layer from the map.</p> <p>Parameters:</p> Name Type Description Default <code>layer_id</code> <code>str</code> <p>Unique identifier of the DeckGL layer to remove.</p> required Source code in <code>anymap/maplibre.py</code> <pre><code>def remove_deckgl_layer(self, layer_id: str) -&gt; None:\n    \"\"\"Remove a DeckGL layer from the map.\n\n    Args:\n        layer_id: Unique identifier of the DeckGL layer to remove.\n    \"\"\"\n    # Remove from local state\n    if layer_id in self._deckgl_layers:\n        current_layers = dict(self._deckgl_layers)\n        del current_layers[layer_id]\n        self._deckgl_layers = current_layers\n\n    # Send to JavaScript\n    self.call_js_method(\"removeDeckGLLayer\", layer_id)\n</code></pre>"},{"location":"maplibre/#anymap.maplibre.MapLibreMap.remove_from_sidebar","title":"<code>remove_from_sidebar(self, widget=None, name=None)</code>","text":"<p>Removes a widget from the sidebar content.</p> <p>Parameters:</p> Name Type Description Default <code>widget</code> <code>widgets.Widget</code> <p>The widget to remove from the sidebar.</p> <code>None</code> <code>name</code> <code>str</code> <p>The name of the widget to remove from the sidebar.</p> <code>None</code> Source code in <code>anymap/maplibre.py</code> <pre><code>def remove_from_sidebar(\n    self, widget: widgets.Widget = None, name: str = None\n) -&gt; None:\n    \"\"\"\n    Removes a widget from the sidebar content.\n\n    Args:\n        widget (widgets.Widget): The widget to remove from the sidebar.\n        name (str): The name of the widget to remove from the sidebar.\n    \"\"\"\n    if self.container is not None:\n        self.container.remove_from_sidebar(widget, name)\n</code></pre>"},{"location":"maplibre/#anymap.maplibre.MapLibreMap.remove_geogrid_control","title":"<code>remove_geogrid_control(self, position='top-left')</code>","text":"<p>Remove the GeoGrid control from the map.</p> Source code in <code>anymap/maplibre.py</code> <pre><code>def remove_geogrid_control(self, position: str = \"top-left\") -&gt; None:\n    \"\"\"Remove the GeoGrid control from the map.\"\"\"\n\n    control_key = f\"geogrid_{position}\"\n    current_controls = dict(self._controls)\n    if control_key in current_controls:\n        current_controls.pop(control_key)\n        self._controls = current_controls\n    self.call_js_method(\"removeControl\", \"geogrid\", position)\n</code></pre>"},{"location":"maplibre/#anymap.maplibre.MapLibreMap.remove_geoman_control","title":"<code>remove_geoman_control(self, position='top-left')</code>","text":"<p>Remove the Geoman control toolbar.</p> Source code in <code>anymap/maplibre.py</code> <pre><code>def remove_geoman_control(self, position: str = \"top-left\") -&gt; None:\n    \"\"\"Remove the Geoman control toolbar.\"\"\"\n\n    control_key = f\"geoman_{position}\"\n    current_controls = dict(self._controls)\n    if control_key in current_controls:\n        current_controls.pop(control_key)\n        self._controls = current_controls\n    self.controls.pop(\"geoman\", None)\n    self.call_js_method(\"removeControl\", \"geoman\", position)\n</code></pre>"},{"location":"maplibre/#anymap.maplibre.MapLibreMap.remove_layer","title":"<code>remove_layer(self, layer_id)</code>","text":"<p>Remove a layer from the map.</p> <p>Parameters:</p> Name Type Description Default <code>layer_id</code> <code>str</code> <p>Unique identifier for the layer to remove.</p> required Source code in <code>anymap/maplibre.py</code> <pre><code>def remove_layer(self, layer_id: str) -&gt; None:\n    \"\"\"Remove a layer from the map.\n\n    Args:\n        layer_id: Unique identifier for the layer to remove.\n    \"\"\"\n    # Remove from JavaScript map\n    self.call_js_method(\"removeLayer\", layer_id)\n\n    # Remove from local state\n    if layer_id in self._layers:\n        current_layers = dict(self._layers)\n        del current_layers[layer_id]\n        self._layers = current_layers\n\n    # Remove FlatGeobuf metadata if present\n    if layer_id in self.flatgeobuf_layers:\n        self.call_js_method(\"removeFlatGeobufLayer\", layer_id)\n        flatgeobuf_layers = dict(self.flatgeobuf_layers)\n        del flatgeobuf_layers[layer_id]\n        self.flatgeobuf_layers = flatgeobuf_layers\n\n    # Remove from layer_dict\n    if layer_id in self.layer_dict:\n        del self.layer_dict[layer_id]\n\n    # Update layer controls if they exist\n    self._update_layer_controls()\n</code></pre>"},{"location":"maplibre/#anymap.maplibre.MapLibreMap.remove_measures_control","title":"<code>remove_measures_control(self, position='top-left')</code>","text":"<p>Remove the Measures control.</p> Source code in <code>anymap/maplibre.py</code> <pre><code>def remove_measures_control(self, position: str = \"top-left\") -&gt; None:\n    \"\"\"Remove the Measures control.\"\"\"\n\n    control_key = f\"measures_{position}\"\n    current_controls = dict(self._controls)\n    if control_key in current_controls:\n        current_controls.pop(control_key)\n        self._controls = current_controls\n    self.controls.pop(\"measures\", None)\n    self.call_js_method(\"removeControl\", \"measures\", position)\n</code></pre>"},{"location":"maplibre/#anymap.maplibre.MapLibreMap.remove_three_light","title":"<code>remove_three_light(self, light_id)</code>","text":"<p>Remove a Three.js light from the scene.</p> Source code in <code>anymap/maplibre.py</code> <pre><code>def remove_three_light(self, light_id: str) -&gt; None:\n    \"\"\"Remove a Three.js light from the scene.\"\"\"\n\n    self.call_js_method(\"removeThreeLight\", light_id)\n</code></pre>"},{"location":"maplibre/#anymap.maplibre.MapLibreMap.remove_three_model","title":"<code>remove_three_model(self, model_id)</code>","text":"<p>Remove a 3D model from the scene.</p> <p>Parameters:</p> Name Type Description Default <code>model_id</code> <code>str</code> <p>Unique identifier of the model to remove.</p> required <p>Examples:</p> <pre><code>&gt;&gt;&gt; m.remove_three_model('my_model')\n</code></pre> Source code in <code>anymap/maplibre.py</code> <pre><code>def remove_three_model(self, model_id: str) -&gt; None:\n    \"\"\"Remove a 3D model from the scene.\n\n    Args:\n        model_id: Unique identifier of the model to remove.\n\n    Example:\n        &gt;&gt;&gt; m.remove_three_model('my_model')\n    \"\"\"\n    self.call_js_method(\"removeThreeModel\", model_id)\n</code></pre>"},{"location":"maplibre/#anymap.maplibre.MapLibreMap.remove_three_tileset","title":"<code>remove_three_tileset(self, tileset_id)</code>","text":"<p>Remove a 3D Tiles dataset from the scene.</p> Source code in <code>anymap/maplibre.py</code> <pre><code>def remove_three_tileset(self, tileset_id: str) -&gt; None:\n    \"\"\"Remove a 3D Tiles dataset from the scene.\"\"\"\n\n    self.call_js_method(\"removeThreeTileset\", tileset_id)\n</code></pre>"},{"location":"maplibre/#anymap.maplibre.MapLibreMap.remove_widget_control","title":"<code>remove_widget_control(self, control_id)</code>","text":"<p>Remove a previously registered widget control.</p> Source code in <code>anymap/maplibre.py</code> <pre><code>def remove_widget_control(self, control_id: str) -&gt; None:\n    \"\"\"Remove a previously registered widget control.\"\"\"\n    if not control_id:\n        raise ValueError(\"control_id is required\")\n\n    current_controls = dict(self._controls)\n    target_key = None\n    for key, config in current_controls.items():\n        if (\n            config.get(\"type\") == \"widget_panel\"\n            and config.get(\"options\", {}).get(\"control_id\") == control_id\n        ):\n            target_key = key\n            break\n\n    if target_key:\n        current_controls.pop(target_key)\n        self._controls = current_controls\n\n    if control_id in self._widget_control_widgets:\n        del self._widget_control_widgets[control_id]\n\n    self.call_js_method(\"removeWidgetControl\", control_id)\n</code></pre>"},{"location":"maplibre/#anymap.maplibre.MapLibreMap.save_draw_data","title":"<code>save_draw_data(self, filepath, driver=None)</code>","text":"<p>Save drawn features to a file in various formats.</p> <p>Parameters:</p> Name Type Description Default <code>filepath</code> <code>str</code> <p>Path where to save the file. The file extension determines      the output format if driver is not specified.</p> required <code>driver</code> <code>Optional[str]</code> <p>GeoPandas driver name (e.g., 'GeoJSON', 'ESRI Shapefile', 'GPKG').    If None, inferred from file extension.</p> <code>None</code> <p>Exceptions:</p> Type Description <code>ImportError</code> <p>If geopandas is not installed.</p> <code>ValueError</code> <p>If no drawn features exist or invalid driver/format.</p> <p>Note</p> <p>For shapefiles, all features must have the same geometry type. Use GeoJSON or GPKG formats for mixed geometry types.</p> Source code in <code>anymap/maplibre.py</code> <pre><code>def save_draw_data(self, filepath: str, driver: Optional[str] = None) -&gt; None:\n    \"\"\"Save drawn features to a file in various formats.\n\n    Args:\n        filepath: Path where to save the file. The file extension determines\n                 the output format if driver is not specified.\n        driver: GeoPandas driver name (e.g., 'GeoJSON', 'ESRI Shapefile', 'GPKG').\n               If None, inferred from file extension.\n\n    Raises:\n        ImportError: If geopandas is not installed.\n        ValueError: If no drawn features exist or invalid driver/format.\n\n    Note:\n        For shapefiles, all features must have the same geometry type.\n        Use GeoJSON or GPKG formats for mixed geometry types.\n    \"\"\"\n    if not HAS_GEOPANDAS:\n        raise ImportError(\n            \"geopandas is required for save_draw_data. \"\n            \"Install it with: pip install geopandas\"\n        )\n\n    # Get the drawn features\n    draw_data = self.get_draw_data()\n\n    if not draw_data or not draw_data.get(\"features\"):\n        raise ValueError(\"No drawn features to save\")\n\n    # Convert to GeoDataFrame\n    gdf = gpd.GeoDataFrame.from_features(draw_data[\"features\"])\n\n    # Set a default CRS if not present\n    if gdf.crs is None:\n        gdf.set_crs(\"EPSG:4326\", inplace=True)\n\n    # Save to file\n    try:\n        gdf.to_file(filepath, driver=driver)\n    except Exception as e:\n        # Provide helpful error message for common shapefile issues\n        if \"shapefile\" in str(e).lower() or (\n            driver and \"shapefile\" in driver.lower()\n        ):\n            geometry_types = gdf.geometry.geom_type.unique()\n            if len(geometry_types) &gt; 1:\n                raise ValueError(\n                    f\"Cannot save mixed geometry types {list(geometry_types)} to shapefile. \"\n                    \"Use GeoJSON (.geojson) or GeoPackage (.gpkg) format instead.\"\n                ) from e\n        raise e\n</code></pre>"},{"location":"maplibre/#anymap.maplibre.MapLibreMap.set_bearing","title":"<code>set_bearing(self, bearing)</code>","text":"<p>Set the map bearing (rotation).</p> <p>Parameters:</p> Name Type Description Default <code>bearing</code> <code>float</code> <p>Map rotation in degrees (0-360).</p> required Source code in <code>anymap/maplibre.py</code> <pre><code>def set_bearing(self, bearing: float) -&gt; None:\n    \"\"\"Set the map bearing (rotation).\n\n    Args:\n        bearing: Map rotation in degrees (0-360).\n    \"\"\"\n    self.bearing = bearing\n</code></pre>"},{"location":"maplibre/#anymap.maplibre.MapLibreMap.set_center","title":"<code>set_center(self, lng, lat)</code>","text":"<p>Set the map center coordinates.</p> <p>Parameters:</p> Name Type Description Default <code>lng</code> <code>float</code> <p>Longitude coordinate.</p> required <code>lat</code> <code>float</code> <p>Latitude coordinate.</p> required Source code in <code>anymap/maplibre.py</code> <pre><code>def set_center(self, lng: float, lat: float) -&gt; None:\n    \"\"\"Set the map center coordinates.\n\n    Args:\n        lng: Longitude coordinate.\n        lat: Latitude coordinate.\n    \"\"\"\n    self.center = [lng, lat]\n    self._current_center = [lng, lat]\n</code></pre>"},{"location":"maplibre/#anymap.maplibre.MapLibreMap.set_deckgl_layer_visibility","title":"<code>set_deckgl_layer_visibility(self, layer_id, visible)</code>","text":"<p>Set the visibility of a DeckGL layer.</p> <p>Parameters:</p> Name Type Description Default <code>layer_id</code> <code>str</code> <p>Unique identifier of the DeckGL layer.</p> required <code>visible</code> <code>bool</code> <p>Whether the layer should be visible.</p> required Source code in <code>anymap/maplibre.py</code> <pre><code>def set_deckgl_layer_visibility(self, layer_id: str, visible: bool) -&gt; None:\n    \"\"\"Set the visibility of a DeckGL layer.\n\n    Args:\n        layer_id: Unique identifier of the DeckGL layer.\n        visible: Whether the layer should be visible.\n    \"\"\"\n    if layer_id in self._deckgl_layers:\n        current_layers = dict(self._deckgl_layers)\n        current_layers[layer_id][\"visible\"] = visible\n        self._deckgl_layers = current_layers\n\n        # Send to JavaScript\n        self.call_js_method(\"setDeckGLLayerVisibility\", layer_id, visible)\n</code></pre>"},{"location":"maplibre/#anymap.maplibre.MapLibreMap.set_draw_mode","title":"<code>set_draw_mode(self, mode)</code>","text":"<p>Set the draw control mode.</p> <p>Parameters:</p> Name Type Description Default <code>mode</code> <code>str</code> <p>Draw mode ('simple_select', 'direct_select', 'draw_point',  'draw_line_string', 'draw_polygon', 'static')</p> required Source code in <code>anymap/maplibre.py</code> <pre><code>def set_draw_mode(self, mode: str) -&gt; None:\n    \"\"\"Set the draw control mode.\n\n    Args:\n        mode: Draw mode ('simple_select', 'direct_select', 'draw_point',\n             'draw_line_string', 'draw_polygon', 'static')\n    \"\"\"\n    self.call_js_method(\"setDrawMode\", mode)\n</code></pre>"},{"location":"maplibre/#anymap.maplibre.MapLibreMap.set_geoman_data","title":"<code>set_geoman_data(self, data)</code>","text":"<p>Replace the current Geoman feature collection.</p> Source code in <code>anymap/maplibre.py</code> <pre><code>def set_geoman_data(self, data: Dict[str, Any]) -&gt; None:\n    \"\"\"Replace the current Geoman feature collection.\"\"\"\n\n    self.geoman_data = data or {\"type\": \"FeatureCollection\", \"features\": []}\n</code></pre>"},{"location":"maplibre/#anymap.maplibre.MapLibreMap.set_layout_property","title":"<code>set_layout_property(self, layer_id, name, value)</code>","text":"<p>Set a layout property for a layer.</p> <p>Parameters:</p> Name Type Description Default <code>layer_id</code> <code>str</code> <p>Unique identifier of the layer.</p> required <code>name</code> <code>str</code> <p>Name of the layout property to set.</p> required <code>value</code> <code>Any</code> <p>Value to set for the property.</p> required Source code in <code>anymap/maplibre.py</code> <pre><code>def set_layout_property(self, layer_id: str, name: str, value: Any) -&gt; None:\n    \"\"\"Set a layout property for a layer.\n\n    Args:\n        layer_id: Unique identifier of the layer.\n        name: Name of the layout property to set.\n        value: Value to set for the property.\n    \"\"\"\n    self.call_js_method(\"setLayoutProperty\", layer_id, name, value)\n</code></pre>"},{"location":"maplibre/#anymap.maplibre.MapLibreMap.set_opacity","title":"<code>set_opacity(self, layer_id, opacity)</code>","text":"<p>Set the opacity of a layer.</p> <p>Parameters:</p> Name Type Description Default <code>layer_id</code> <code>str</code> <p>Unique identifier of the layer.</p> required <code>opacity</code> <code>float</code> <p>Opacity value between 0.0 (transparent) and 1.0 (opaque).</p> required Source code in <code>anymap/maplibre.py</code> <pre><code>def set_opacity(self, layer_id: str, opacity: float) -&gt; None:\n    \"\"\"Set the opacity of a layer.\n\n    Args:\n        layer_id: Unique identifier of the layer.\n        opacity: Opacity value between 0.0 (transparent) and 1.0 (opaque).\n    \"\"\"\n    layer_type = self.get_layer_type(layer_id)\n\n    if layer_id == \"Background\":\n        for layer in self.get_style_layers():\n            layer_type = layer.get(\"type\")\n            if layer_type != \"symbol\":\n                self.set_paint_property(\n                    layer[\"id\"], f\"{layer_type}-opacity\", opacity\n                )\n            else:\n                self.set_paint_property(layer[\"id\"], \"icon-opacity\", opacity)\n                self.set_paint_property(layer[\"id\"], \"text-opacity\", opacity)\n        return\n\n    if layer_id in self.layer_dict:\n        layer_type = self.layer_dict[layer_id][\"layer\"][\"type\"]\n        prop_name = f\"{layer_type}-opacity\"\n        self.layer_dict[layer_id][\"opacity\"] = opacity\n        self._update_layer_controls()\n    elif layer_id in self.style_dict:\n        layer = self.style_dict[layer_id]\n        layer_type = layer.get(\"type\")\n        prop_name = f\"{layer_type}-opacity\"\n        if \"paint\" in layer:\n            layer[\"paint\"][prop_name] = opacity\n\n    if layer_type != \"symbol\":\n        self.set_paint_property(layer_id, f\"{layer_type}-opacity\", opacity)\n    else:\n        self.set_paint_property(layer_id, \"icon-opacity\", opacity)\n        self.set_paint_property(layer_id, \"text-opacity\", opacity)\n</code></pre>"},{"location":"maplibre/#anymap.maplibre.MapLibreMap.set_paint_property","title":"<code>set_paint_property(self, layer_id, name, value)</code>","text":"<p>Set a paint property for a layer.</p> <p>Parameters:</p> Name Type Description Default <code>layer_id</code> <code>str</code> <p>Unique identifier of the layer.</p> required <code>name</code> <code>str</code> <p>Name of the paint property to set.</p> required <code>value</code> <code>Any</code> <p>Value to set for the property.</p> required Source code in <code>anymap/maplibre.py</code> <pre><code>def set_paint_property(self, layer_id: str, name: str, value: Any) -&gt; None:\n    \"\"\"Set a paint property for a layer.\n\n    Args:\n        layer_id: Unique identifier of the layer.\n        name: Name of the paint property to set.\n        value: Value to set for the property.\n    \"\"\"\n    self.call_js_method(\"setPaintProperty\", layer_id, name, value)\n</code></pre>"},{"location":"maplibre/#anymap.maplibre.MapLibreMap.set_pitch","title":"<code>set_pitch(self, pitch)</code>","text":"<p>Set the map pitch (tilt).</p> <p>Parameters:</p> Name Type Description Default <code>pitch</code> <code>float</code> <p>Map tilt in degrees (0-60).</p> required Source code in <code>anymap/maplibre.py</code> <pre><code>def set_pitch(self, pitch: float) -&gt; None:\n    \"\"\"Set the map pitch (tilt).\n\n    Args:\n        pitch: Map tilt in degrees (0-60).\n    \"\"\"\n    self.pitch = pitch\n</code></pre>"},{"location":"maplibre/#anymap.maplibre.MapLibreMap.set_projection","title":"<code>set_projection(self, projection)</code>","text":"<p>Set the map projection.</p> <p>Parameters:</p> Name Type Description Default <code>projection</code> <code>Dict[str, Any]</code> <p>Projection configuration dictionary.</p> required Source code in <code>anymap/maplibre.py</code> <pre><code>def set_projection(self, projection: Dict[str, Any]) -&gt; None:\n    \"\"\"Set the map projection.\n\n    Args:\n        projection: Projection configuration dictionary.\n    \"\"\"\n    # Store projection in persistent state\n    self._projection = projection\n    self.call_js_method(\"setProjection\", projection)\n</code></pre>"},{"location":"maplibre/#anymap.maplibre.MapLibreMap.set_sidebar_content","title":"<code>set_sidebar_content(self, content)</code>","text":"<p>Replaces all content in the sidebar (except the toggle button).</p> <p>Parameters:</p> Name Type Description Default <code>content</code> <code>Union[widgets.VBox, List[widgets.Widget]]</code> <p>The new content for the sidebar.</p> required Source code in <code>anymap/maplibre.py</code> <pre><code>def set_sidebar_content(\n    self, content: Union[widgets.VBox, List[widgets.Widget]]\n) -&gt; None:\n    \"\"\"\n    Replaces all content in the sidebar (except the toggle button).\n\n    Args:\n        content (Union[widgets.VBox, List[widgets.Widget]]): The new content for the sidebar.\n    \"\"\"\n\n    if self.container is not None:\n        self.container.set_sidebar_content(content)\n</code></pre>"},{"location":"maplibre/#anymap.maplibre.MapLibreMap.set_sidebar_width","title":"<code>set_sidebar_width(self, min_width=None, max_width=None)</code>","text":"<p>Dynamically updates the sidebar's minimum and maximum width.</p> <p>Parameters:</p> Name Type Description Default <code>min_width</code> <code>int</code> <p>New minimum width in pixels. If None, keep current.</p> <code>None</code> <code>max_width</code> <code>int</code> <p>New maximum width in pixels. If None, keep current.</p> <code>None</code> Source code in <code>anymap/maplibre.py</code> <pre><code>def set_sidebar_width(self, min_width: int = None, max_width: int = None) -&gt; None:\n    \"\"\"\n    Dynamically updates the sidebar's minimum and maximum width.\n\n    Args:\n        min_width (int, optional): New minimum width in pixels. If None, keep current.\n        max_width (int, optional): New maximum width in pixels. If None, keep current.\n    \"\"\"\n    if self.container is None:\n        self.create_container()\n    self.container.set_sidebar_width(min_width, max_width)\n</code></pre>"},{"location":"maplibre/#anymap.maplibre.MapLibreMap.set_style","title":"<code>set_style(self, style)</code>","text":"<p>Set the map style.</p> <p>Parameters:</p> Name Type Description Default <code>style</code> <code>Union[str, Dict[str, Any]]</code> <p>Map style as URL string or style object dictionary.</p> required Source code in <code>anymap/maplibre.py</code> <pre><code>def set_style(self, style: Union[str, Dict[str, Any]]) -&gt; None:\n    \"\"\"Set the map style.\n\n    Args:\n        style: Map style as URL string or style object dictionary.\n    \"\"\"\n    if isinstance(style, str):\n        self.style = style\n    else:\n        self.call_js_method(\"setStyle\", style)\n</code></pre>"},{"location":"maplibre/#anymap.maplibre.MapLibreMap.set_terrain","title":"<code>set_terrain(self, source='https://elevation-tiles-prod.s3.amazonaws.com/terrarium/{z}/{x}/{y}.png', exaggeration=1.0, tile_size=256, encoding='terrarium', source_id='terrain-dem')</code>","text":"<p>Add terrain visualization to the map.</p> <p>Parameters:</p> Name Type Description Default <code>source</code> <code>str</code> <p>URL template for terrain tiles. Defaults to AWS elevation tiles.</p> <code>'https://elevation-tiles-prod.s3.amazonaws.com/terrarium/{z}/{x}/{y}.png'</code> <code>exaggeration</code> <code>float</code> <p>Terrain exaggeration factor. Defaults to 1.0.</p> <code>1.0</code> <code>tile_size</code> <code>int</code> <p>Tile size in pixels. Defaults to 256.</p> <code>256</code> <code>encoding</code> <code>str</code> <p>Encoding for the terrain tiles. Defaults to \"terrarium\".</p> <code>'terrarium'</code> <code>source_id</code> <code>str</code> <p>Unique identifier for the terrain source. Defaults to \"terrain-dem\".</p> <code>'terrain-dem'</code> Source code in <code>anymap/maplibre.py</code> <pre><code>def set_terrain(\n    self,\n    source: str = \"https://elevation-tiles-prod.s3.amazonaws.com/terrarium/{z}/{x}/{y}.png\",\n    exaggeration: float = 1.0,\n    tile_size: int = 256,\n    encoding: str = \"terrarium\",\n    source_id: str = \"terrain-dem\",\n) -&gt; None:\n    \"\"\"Add terrain visualization to the map.\n\n    Args:\n        source: URL template for terrain tiles. Defaults to AWS elevation tiles.\n        exaggeration: Terrain exaggeration factor. Defaults to 1.0.\n        tile_size: Tile size in pixels. Defaults to 256.\n        encoding: Encoding for the terrain tiles. Defaults to \"terrarium\".\n        source_id: Unique identifier for the terrain source. Defaults to \"terrain-dem\".\n    \"\"\"\n    # Add terrain source\n    self.add_source(\n        source_id,\n        {\n            \"type\": \"raster-dem\",\n            \"tiles\": [source],\n            \"tileSize\": tile_size,\n            \"encoding\": encoding,\n        },\n    )\n\n    # Set terrain on the map\n    terrain_config = {\"source\": source_id, \"exaggeration\": exaggeration}\n\n    # Store terrain configuration in persistent state\n    self._terrain = terrain_config\n    self.call_js_method(\"setTerrain\", terrain_config)\n</code></pre>"},{"location":"maplibre/#anymap.maplibre.MapLibreMap.set_three_tileset_height","title":"<code>set_three_tileset_height(self, tileset_id, height)</code>","text":"<p>Adjust the height offset applied to a 3D Tiles dataset.</p> Source code in <code>anymap/maplibre.py</code> <pre><code>def set_three_tileset_height(self, tileset_id: str, height: float) -&gt; None:\n    \"\"\"Adjust the height offset applied to a 3D Tiles dataset.\"\"\"\n\n    self.call_js_method(\n        \"setThreeTilesetHeight\", {\"id\": tileset_id, \"height\": height}\n    )\n</code></pre>"},{"location":"maplibre/#anymap.maplibre.MapLibreMap.set_visibility","title":"<code>set_visibility(self, layer_id, visible)</code>","text":"<p>Set the visibility of a layer.</p> <p>Parameters:</p> Name Type Description Default <code>layer_id</code> <code>str</code> <p>Unique identifier of the layer.</p> required <code>visible</code> <code>bool</code> <p>Whether the layer should be visible.</p> required Source code in <code>anymap/maplibre.py</code> <pre><code>def set_visibility(self, layer_id: str, visible: bool) -&gt; None:\n    \"\"\"Set the visibility of a layer.\n\n    Args:\n        layer_id: Unique identifier of the layer.\n        visible: Whether the layer should be visible.\n    \"\"\"\n    if visible:\n        visibility = \"visible\"\n    else:\n        visibility = \"none\"\n\n    if layer_id == \"Background\":\n        for layer in self.get_style_layers():\n            self.set_layout_property(layer[\"id\"], \"visibility\", visibility)\n    else:\n        self.set_layout_property(layer_id, \"visibility\", visibility)\n    if layer_id in self.layer_dict:\n        self.layer_dict[layer_id][\"visible\"] = visible\n        self._update_layer_controls()\n</code></pre>"},{"location":"maplibre/#anymap.maplibre.MapLibreMap.set_zoom","title":"<code>set_zoom(self, zoom)</code>","text":"<p>Set the map zoom level.</p> <p>Parameters:</p> Name Type Description Default <code>zoom</code> <code>float</code> <p>Zoom level (typically 0-20).</p> required Source code in <code>anymap/maplibre.py</code> <pre><code>def set_zoom(self, zoom: float) -&gt; None:\n    \"\"\"Set the map zoom level.\n\n    Args:\n        zoom: Zoom level (typically 0-20).\n    \"\"\"\n    self.zoom = zoom\n    self._current_zoom = zoom\n</code></pre>"},{"location":"maplibre/#anymap.maplibre.MapLibreMap.show","title":"<code>show(self, sidebar_visible=False, min_width=360, max_width=360, sidebar_content=None, **kwargs)</code>","text":"<p>Displays the map with an optional sidebar.</p> <p>Parameters:</p> Name Type Description Default <code>sidebar_visible</code> <code>bool</code> <p>Whether the sidebar is visible. Defaults to False.</p> <code>False</code> <code>min_width</code> <code>int</code> <p>Minimum width of the sidebar in pixels. Defaults to 250.</p> <code>360</code> <code>max_width</code> <code>int</code> <p>Maximum width of the sidebar in pixels. Defaults to 300.</p> <code>360</code> <code>sidebar_content</code> <code>Optional[Any]</code> <p>Content to display in the sidebar. Defaults to None.</p> <code>None</code> <code>**kwargs</code> <code>Any</code> <p>Additional keyword arguments.</p> <code>{}</code> <p>Returns:</p> Type Description <code>None</code> <p>None</p> Source code in <code>anymap/maplibre.py</code> <pre><code>def show(\n    self,\n    sidebar_visible: bool = False,\n    min_width: int = 360,\n    max_width: int = 360,\n    sidebar_content: Optional[Any] = None,\n    **kwargs: Any,\n) -&gt; None:\n    \"\"\"\n    Displays the map with an optional sidebar.\n\n    Args:\n        sidebar_visible (bool): Whether the sidebar is visible. Defaults to False.\n        min_width (int): Minimum width of the sidebar in pixels. Defaults to 250.\n        max_width (int): Maximum width of the sidebar in pixels. Defaults to 300.\n        sidebar_content (Optional[Any]): Content to display in the sidebar. Defaults to None.\n        **kwargs (Any): Additional keyword arguments.\n\n    Returns:\n        None\n    \"\"\"\n    return Container(\n        self,\n        sidebar_visible=sidebar_visible,\n        min_width=min_width,\n        max_width=max_width,\n        sidebar_content=sidebar_content,\n        **kwargs,\n    )\n</code></pre>"},{"location":"maplibre/#anymap.maplibre.MapLibreMap.to_html","title":"<code>to_html(self, filename=None, title='Anymap Export', width='100%', height='600px', **kwargs)</code>","text":"<p>Export the map to a standalone HTML file with DeckGL layers.</p> <p>This method extends the base to_html method to include DeckGL layer state.</p> <p>Parameters:</p> Name Type Description Default <code>filename</code> <code>Optional[str]</code> <p>Optional filename to save the HTML. If None, returns HTML string.</p> <code>None</code> <code>title</code> <code>str</code> <p>Title for the HTML page.</p> <code>'Anymap Export'</code> <code>width</code> <code>str</code> <p>Width of the map container as CSS string.</p> <code>'100%'</code> <code>height</code> <code>str</code> <p>Height of the map container as CSS string.</p> <code>'600px'</code> <code>**kwargs</code> <code>Any</code> <p>Additional arguments passed to the HTML template.</p> <code>{}</code> <p>Returns:</p> Type Description <code>str</code> <p>HTML string content of the exported map.</p> Source code in <code>anymap/maplibre.py</code> <pre><code>def to_html(\n    self,\n    filename: Optional[str] = None,\n    title: str = \"Anymap Export\",\n    width: str = \"100%\",\n    height: str = \"600px\",\n    **kwargs: Any,\n) -&gt; str:\n    \"\"\"Export the map to a standalone HTML file with DeckGL layers.\n\n    This method extends the base to_html method to include DeckGL layer state.\n\n    Args:\n        filename: Optional filename to save the HTML. If None, returns HTML string.\n        title: Title for the HTML page.\n        width: Width of the map container as CSS string.\n        height: Height of the map container as CSS string.\n        **kwargs: Additional arguments passed to the HTML template.\n\n    Returns:\n        HTML string content of the exported map.\n    \"\"\"\n    # Get the current map state\n    map_state = {\n        \"center\": self.center,\n        \"zoom\": self.zoom,\n        \"width\": width,\n        \"height\": height,\n        \"style\": self.style,\n        \"_layers\": dict(self._layers),\n        \"_sources\": dict(self._sources),\n        \"_controls\": dict(self._controls),\n        \"_terrain\": dict(self._terrain),\n        \"_deckgl_layers\": dict(self._deckgl_layers),  # Include DeckGL layers\n    }\n\n    # Add class-specific attributes\n    if hasattr(self, \"style\"):\n        map_state[\"style\"] = self.style\n    if hasattr(self, \"bearing\"):\n        map_state[\"bearing\"] = self.bearing\n    if hasattr(self, \"pitch\"):\n        map_state[\"pitch\"] = self.pitch\n    if hasattr(self, \"antialias\"):\n        map_state[\"antialias\"] = self.antialias\n    if hasattr(self, \"_draw_data\"):\n        map_state[\"_draw_data\"] = dict(self._draw_data)\n    if hasattr(self, \"_terra_draw_data\"):\n        map_state[\"_terra_draw_data\"] = dict(self._terra_draw_data)\n\n    # Generate HTML content\n    html_content = self._generate_html_template(map_state, title, **kwargs)\n\n    # Save to file if filename provided\n    if filename:\n        with open(filename, \"w\", encoding=\"utf-8\") as f:\n            f.write(html_content)\n\n    return html_content\n</code></pre>"},{"location":"maplibre/#anymap.maplibre.MapLibreMap.toggle_geoman_control","title":"<code>toggle_geoman_control(self)</code>","text":"<p>Toggle the Geoman draw control toolbar between collapsed and expanded states.</p> Source code in <code>anymap/maplibre.py</code> <pre><code>def toggle_geoman_control(self) -&gt; None:\n    \"\"\"Toggle the Geoman draw control toolbar between collapsed and expanded states.\"\"\"\n\n    self.call_js_method(\"toggleGeomanControl\")\n</code></pre>"},{"location":"maplibre/#anymap.maplibre.MapLibreMap.update_deckgl_layer","title":"<code>update_deckgl_layer(self, layer_id, data=None, props=None, **kwargs)</code>","text":"<p>Update a DeckGL layer's data or properties.</p> <p>Parameters:</p> Name Type Description Default <code>layer_id</code> <code>str</code> <p>Unique identifier of the DeckGL layer to update.</p> required <code>data</code> <code>Union[List[Dict], Dict[str, Any]]</code> <p>New data for the layer. If None, data is not updated.</p> <code>None</code> <code>props</code> <code>Optional[Dict[str, Any]]</code> <p>New or updated properties for the layer.</p> <code>None</code> <code>**kwargs</code> <code>Any</code> <p>Additional layer properties to update.</p> <code>{}</code> Source code in <code>anymap/maplibre.py</code> <pre><code>def update_deckgl_layer(\n    self,\n    layer_id: str,\n    data: Optional[Union[List[Dict], Dict[str, Any]]] = None,\n    props: Optional[Dict[str, Any]] = None,\n    **kwargs: Any,\n) -&gt; None:\n    \"\"\"Update a DeckGL layer's data or properties.\n\n    Args:\n        layer_id: Unique identifier of the DeckGL layer to update.\n        data: New data for the layer. If None, data is not updated.\n        props: New or updated properties for the layer.\n        **kwargs: Additional layer properties to update.\n    \"\"\"\n    if layer_id not in self._deckgl_layers:\n        raise ValueError(f\"DeckGL layer '{layer_id}' not found\")\n\n    # Get current layer config\n    current_layers = dict(self._deckgl_layers)\n    layer_config = current_layers[layer_id].copy()\n\n    # Update data if provided\n    if data is not None:\n        layer_config[\"data\"] = data\n\n    # Update properties if provided\n    if props is not None or kwargs:\n        current_props = layer_config.get(\"props\", {})\n        if props:\n            current_props.update(props)\n        if kwargs:\n            current_props.update(kwargs)\n        # Process the updated props to handle lambda functions\n        layer_config[\"props\"] = self._process_deckgl_props(current_props)\n\n    # Store updated config\n    current_layers[layer_id] = layer_config\n    self._deckgl_layers = current_layers\n\n    # Send to JavaScript\n    self.call_js_method(\"updateDeckGLLayer\", layer_config)\n</code></pre>"},{"location":"maplibre/#anymap.maplibre.MapLibreMap.update_three_light","title":"<code>update_three_light(self, light_id, *, color=None, intensity=None, position=None, target=None, cast_shadow=None, shadow_options=None, sun_options=None)</code>","text":"<p>Update properties of an existing Three.js light.</p> Source code in <code>anymap/maplibre.py</code> <pre><code>def update_three_light(\n    self,\n    light_id: str,\n    *,\n    color: Optional[int] = None,\n    intensity: Optional[float] = None,\n    position: Optional[List[float]] = None,\n    target: Optional[List[float]] = None,\n    cast_shadow: Optional[bool] = None,\n    shadow_options: Optional[Dict[str, Any]] = None,\n    sun_options: Optional[Dict[str, Any]] = None,\n) -&gt; None:\n    \"\"\"Update properties of an existing Three.js light.\"\"\"\n\n    update_config: Dict[str, Any] = {\"id\": light_id}\n\n    if color is not None:\n        update_config[\"color\"] = color\n    if intensity is not None:\n        update_config[\"intensity\"] = intensity\n    if position is not None:\n        update_config[\"position\"] = position\n    if target is not None:\n        update_config[\"target\"] = target\n    if cast_shadow is not None:\n        update_config[\"castShadow\"] = cast_shadow\n    if shadow_options:\n        update_config[\"shadowOptions\"] = shadow_options\n    if sun_options:\n        update_config[\"sunOptions\"] = sun_options\n\n    self.call_js_method(\"updateThreeLight\", update_config)\n</code></pre>"},{"location":"maplibre/#anymap.maplibre.MapLibreMap.update_three_model","title":"<code>update_three_model(self, model_id, position=None, scale=None, rotation=None)</code>","text":"<p>Update properties of an existing 3D model.</p> <p>Parameters:</p> Name Type Description Default <code>model_id</code> <code>str</code> <p>Unique identifier of the model to update.</p> required <code>position</code> <code>Optional[List[float]]</code> <p>Optional new position as [x, y, z].</p> <code>None</code> <code>scale</code> <code>Union[float, List[float]]</code> <p>Optional new scale. Can be a single number or [x, y, z] list.</p> <code>None</code> <code>rotation</code> <code>Optional[List[float]]</code> <p>Optional new rotation in radians as [x, y, z].</p> <code>None</code> <p>Examples:</p> <pre><code>&gt;&gt;&gt; m.update_three_model('my_model', scale=200, rotation=[0, 1.57, 0])\n</code></pre> Source code in <code>anymap/maplibre.py</code> <pre><code>def update_three_model(\n    self,\n    model_id: str,\n    position: Optional[List[float]] = None,\n    scale: Optional[Union[float, List[float]]] = None,\n    rotation: Optional[List[float]] = None,\n) -&gt; None:\n    \"\"\"Update properties of an existing 3D model.\n\n    Args:\n        model_id: Unique identifier of the model to update.\n        position: Optional new position as [x, y, z].\n        scale: Optional new scale. Can be a single number or [x, y, z] list.\n        rotation: Optional new rotation in radians as [x, y, z].\n\n    Example:\n        &gt;&gt;&gt; m.update_three_model('my_model', scale=200, rotation=[0, 1.57, 0])\n    \"\"\"\n    update_config = {\"id\": model_id}\n\n    if position is not None:\n        update_config[\"position\"] = position\n    if scale is not None:\n        update_config[\"scale\"] = scale\n    if rotation is not None:\n        update_config[\"rotation\"] = rotation\n\n    self.call_js_method(\"updateThreeModel\", update_config)\n</code></pre>"},{"location":"maplibre_widgets/","title":"maplibre_widgets module","text":"<p>MapLibre widget classes for UI components.</p> <p>This module contains the widget classes that support the MapLibreMap implementation, including layer management, styling, and container widgets.</p> <p>Classes</p> <p>CustomWidget: Generic expansion panel widget with dynamic content management. Container: Container widget for map display with optional sidebar. LayerStyleWidget: Interactive widget for styling map layers. LayerManagerWidget: Widget for managing map layers (visibility, opacity, removal).</p> <p>These classes were extracted from maplibre.py to improve code organization and maintainability.</p>"},{"location":"maplibre_widgets/#anymap.maplibre_widgets.Container","title":"<code> Container            (Container)         </code>","text":"<p>A container widget for displaying a map with an optional sidebar.</p> <p>This class creates a layout with a map on the left and a sidebar on the right. The sidebar can be toggled on or off and can display additional content.</p> <p>Attributes:</p> Name Type Description <code>sidebar_visible</code> <code>bool</code> <p>Whether the sidebar is visible.</p> <code>min_width</code> <code>int</code> <p>Minimum width of the sidebar in pixels.</p> <code>max_width</code> <code>int</code> <p>Maximum width of the sidebar in pixels.</p> <code>map_container</code> <code>v.Col</code> <p>The container for the map.</p> <code>sidebar_content_box</code> <code>widgets.VBox</code> <p>The container for the sidebar content.</p> <code>toggle_icon</code> <code>v.Icon</code> <p>The icon for the toggle button.</p> <code>toggle_btn</code> <code>v.Btn</code> <p>The button to toggle the sidebar.</p> <code>sidebar</code> <code>v.Col</code> <p>The container for the sidebar.</p> <code>row</code> <code>v.Row</code> <p>The main layout row containing the map and sidebar.</p> Source code in <code>anymap/maplibre_widgets.py</code> <pre><code>class Container(v.Container):\n    \"\"\"\n    A container widget for displaying a map with an optional sidebar.\n\n    This class creates a layout with a map on the left and a sidebar on the right.\n    The sidebar can be toggled on or off and can display additional content.\n\n    Attributes:\n        sidebar_visible (bool): Whether the sidebar is visible.\n        min_width (int): Minimum width of the sidebar in pixels.\n        max_width (int): Maximum width of the sidebar in pixels.\n        map_container (v.Col): The container for the map.\n        sidebar_content_box (widgets.VBox): The container for the sidebar content.\n        toggle_icon (v.Icon): The icon for the toggle button.\n        toggle_btn (v.Btn): The button to toggle the sidebar.\n        sidebar (v.Col): The container for the sidebar.\n        row (v.Row): The main layout row containing the map and sidebar.\n    \"\"\"\n\n    def __init__(\n        self,\n        host_map: Optional[Any] = None,\n        sidebar_visible: bool = True,\n        min_width: int = 250,\n        max_width: int = 300,\n        sidebar_content: Optional[Union[widgets.VBox, List[widgets.Widget]]] = None,\n        *args: Any,\n        **kwargs: Any,\n    ) -&gt; None:\n        \"\"\"\n        Initializes the Container widget.\n\n        Args:\n            host_map (Optional[Any]): The map object to display in the container. Defaults to None.\n            sidebar_visible (bool): Whether the sidebar is visible. Defaults to True.\n            min_width (int): Minimum width of the sidebar in pixels. Defaults to 250.\n            max_width (int): Maximum width of the sidebar in pixels. Defaults to 300.\n            sidebar_content (Optional[Union[widgets.VBox, List[widgets.Widget]]]):\n                The content to display in the sidebar. Defaults to None.\n            *args (Any): Additional positional arguments for the parent class.\n            **kwargs (Any): Additional keyword arguments for the parent class.\n        \"\"\"\n        self.sidebar_visible = sidebar_visible\n        self.min_width = min_width\n        self.max_width = max_width\n        self.host_map = host_map\n        self.sidebar_widgets = {}\n\n        # Map display container (left column)\n        self.map_container = v.Col(\n            class_=\"pa-1\",\n            style_=\"flex-grow: 1; flex-shrink: 1; flex-basis: 0;\",\n        )\n        self.map_container.children = [host_map or self.create_map()]\n\n        # Sidebar content container (mutable VBox)\n        self.sidebar_content_box = widgets.VBox()\n        if sidebar_content:\n            self.set_sidebar_content(sidebar_content)\n\n        # Toggle button\n        if sidebar_visible:\n            self.toggle_icon = v.Icon(children=[\"mdi-chevron-right\"])\n        else:\n            self.toggle_icon = v.Icon(children=[\"mdi-chevron-left\"])  # default icon\n        self.toggle_btn = v.Btn(\n            icon=True,\n            children=[self.toggle_icon],\n            style_=\"width: 48px; height: 48px; min-width: 48px;\",\n        )\n        self.toggle_btn.on_event(\"click\", self.toggle_sidebar)\n\n        # Settings icon\n        self.settings_icon = v.Icon(children=[\"mdi-wrench\"])\n        self.settings_btn = v.Btn(\n            icon=True,\n            children=[self.settings_icon],\n            style_=\"width: 36px; height: 36px;\",\n        )\n        self.settings_btn.on_event(\"click\", self.toggle_width_slider)\n\n        # Sidebar controls row (toggle + settings)\n        self.sidebar_controls = v.Row(\n            class_=\"ma-0 pa-0\", children=[self.toggle_btn, self.settings_btn]\n        )\n\n        # Sidebar width slider (initially hidden)\n        self.width_slider = widgets.IntSlider(\n            value=self.max_width,\n            min=200,\n            max=1000,\n            step=10,\n            description=\"Width:\",\n            continuous_update=True,\n        )\n        self.width_slider.observe(self.on_width_change, names=\"value\")\n\n        self.settings_widget = CustomWidget(\n            self.width_slider,\n            widget_icon=\"mdi-cog\",\n            label=\"Sidebar Settings\",\n            host_map=self.host_map,\n        )\n\n        # Sidebar (right column)\n        self.sidebar = v.Col(class_=\"pa-1\", style_=\"overflow-y: hidden;\")\n        self.update_sidebar_content()\n\n        # Main layout row\n        self.row = v.Row(\n            class_=\"d-flex flex-nowrap\",\n            children=[self.map_container, self.sidebar],\n        )\n\n        super().__init__(fluid=True, children=[self.row], *args, **kwargs)\n\n    def create_map(self) -&gt; Any:\n        \"\"\"\n        Creates a default map object.\n\n        Returns:\n            Any: A default map object.\n        \"\"\"\n        from .maplibre import MapLibreMap\n\n        return MapLibreMap(center=[20, 0], zoom=2)\n\n    def toggle_sidebar(self, *args: Any, **kwargs: Any) -&gt; None:\n        \"\"\"\n        Toggles the visibility of the sidebar.\n\n        Args:\n            *args (Any): Additional positional arguments.\n            **kwargs (Any): Additional keyword arguments.\n        \"\"\"\n        self.sidebar_visible = not self.sidebar_visible\n        self.toggle_icon.children = [\n            \"mdi-chevron-right\" if self.sidebar_visible else \"mdi-chevron-left\"\n        ]\n        self.update_sidebar_content()\n\n    def update_sidebar_content(self) -&gt; None:\n        \"\"\"\n        Updates the content of the sidebar based on its visibility.\n        If the sidebar is visible, it displays the toggle button and the sidebar content.\n        If the sidebar is hidden, it only displays the toggle button.\n        \"\"\"\n        if self.sidebar_visible:\n            # Header row: toggle on the left, settings on the right\n            header_row = v.Row(\n                class_=\"ma-0 pa-0\",\n                align=\"center\",\n                justify=\"space-between\",\n                children=[self.toggle_btn, self.settings_btn],\n            )\n\n            children = [header_row]\n\n            children.append(self.sidebar_content_box)\n\n            self.sidebar.children = children\n            self.sidebar.style_ = (\n                f\"min-width: {self.min_width}px; max-width: {self.max_width}px;\"\n            )\n        else:\n            self.sidebar.children = [self.toggle_btn]\n            self.sidebar.style_ = \"width: 48px; min-width: 48px; max-width: 48px;\"\n\n    def set_sidebar_content(\n        self, content: Union[widgets.VBox, List[widgets.Widget]]\n    ) -&gt; None:\n        \"\"\"\n        Replaces all content in the sidebar (except the toggle button).\n\n        Args:\n            content (Union[widgets.VBox, List[widgets.Widget]]): The new content for the sidebar.\n        \"\"\"\n        if isinstance(content, (list, tuple)):\n            self.sidebar_content_box.children = content\n        else:\n            self.sidebar_content_box.children = [content]\n\n    def add_to_sidebar(\n        self,\n        widget: Union[widgets.Widget, List[widgets.Widget]],\n        add_header: bool = True,\n        widget_icon: str = \"mdi-tools\",\n        close_icon: str = \"mdi-close\",\n        label: str = \"My Tools\",\n        background_color: str = \"#f5f5f5\",\n        height: str = \"40px\",\n        expanded: bool = True,\n        host_map: Optional[Any] = None,\n        **kwargs: Any,\n    ) -&gt; None:\n        \"\"\"\n        Appends a widget to the sidebar content.\n\n        Args:\n            widget (Optional[Union[widgets.Widget, List[widgets.Widget]]]): Initial widget(s) to display in the content box.\n            widget_icon (str): Icon for the header. See https://pictogrammers.github.io/@mdi/font/2.0.46/ for available icons.\n            close_icon (str): Icon for the close button. See https://pictogrammers.github.io/@mdi/font/2.0.46/ for available icons.\n            background_color (str): Background color of the header. Defaults to \"#f5f5f5\".\n            label (str): Text label for the header. Defaults to \"My Tools\".\n            height (str): Height of the header. Defaults to \"40px\".\n            expanded (bool): Whether the panel is expanded by default. Defaults to True.\n            **kwargs (Any): Additional keyword arguments for the parent class.\n        \"\"\"\n\n        if label in self.sidebar_widgets:\n            self.remove_from_sidebar(name=label)\n\n        if add_header:\n            widget = CustomWidget(\n                widget,\n                widget_icon=widget_icon,\n                close_icon=close_icon,\n                label=label,\n                background_color=background_color,\n                height=height,\n                expanded=expanded,\n                host_map=host_map,\n                **kwargs,\n            )\n\n        self.sidebar_content_box.children += (widget,)\n        self.sidebar_widgets[label] = widget\n\n    def remove_from_sidebar(\n        self, widget: widgets.Widget = None, name: str = None\n    ) -&gt; None:\n        \"\"\"\n        Removes a widget from the sidebar content.\n\n        Args:\n            widget (widgets.Widget): The widget to remove from the sidebar.\n            name (str): The name of the widget to remove from the sidebar.\n        \"\"\"\n        key = None\n        for key, value in self.sidebar_widgets.items():\n            if value == widget or key == name:\n                if widget is None:\n                    widget = self.sidebar_widgets[key]\n                break\n\n        if key is not None and key in self.sidebar_widgets:\n            self.sidebar_widgets.pop(key)\n        self.sidebar_content_box.children = tuple(\n            child for child in self.sidebar_content_box.children if child != widget\n        )\n\n    def set_sidebar_width(self, min_width: int = None, max_width: int = None) -&gt; None:\n        \"\"\"\n        Dynamically updates the sidebar's minimum and maximum width.\n\n        Args:\n            min_width (int, optional): New minimum width in pixels. If None, keep current.\n            max_width (int, optional): New maximum width in pixels. If None, keep current.\n        \"\"\"\n        if min_width is not None:\n            if isinstance(min_width, str):\n                min_width = int(min_width.replace(\"px\", \"\"))\n            self.min_width = min_width\n        if max_width is not None:\n            if isinstance(max_width, str):\n                max_width = int(max_width.replace(\"px\", \"\"))\n            self.max_width = max_width\n        self.update_sidebar_content()\n\n    def toggle_width_slider(self, *args: Any) -&gt; None:\n\n        if self.settings_widget not in self.sidebar_content_box.children:\n            self.add_to_sidebar(self.settings_widget, add_header=False)\n\n    def on_width_change(self, change: dict) -&gt; None:\n        new_width = change[\"new\"]\n        self.set_sidebar_width(min_width=new_width, max_width=new_width)\n</code></pre>"},{"location":"maplibre_widgets/#anymap.maplibre_widgets.Container.__init__","title":"<code>__init__(self, host_map=None, sidebar_visible=True, min_width=250, max_width=300, sidebar_content=None, *args, **kwargs)</code>  <code>special</code>","text":"<p>Initializes the Container widget.</p> <p>Parameters:</p> Name Type Description Default <code>host_map</code> <code>Optional[Any]</code> <p>The map object to display in the container. Defaults to None.</p> <code>None</code> <code>sidebar_visible</code> <code>bool</code> <p>Whether the sidebar is visible. Defaults to True.</p> <code>True</code> <code>min_width</code> <code>int</code> <p>Minimum width of the sidebar in pixels. Defaults to 250.</p> <code>250</code> <code>max_width</code> <code>int</code> <p>Maximum width of the sidebar in pixels. Defaults to 300.</p> <code>300</code> <code>sidebar_content</code> <code>Optional[Union[widgets.VBox, List[widgets.Widget]]]</code> <p>The content to display in the sidebar. Defaults to None.</p> <code>None</code> <code>*args</code> <code>Any</code> <p>Additional positional arguments for the parent class.</p> <code>()</code> <code>**kwargs</code> <code>Any</code> <p>Additional keyword arguments for the parent class.</p> <code>{}</code> Source code in <code>anymap/maplibre_widgets.py</code> <pre><code>def __init__(\n    self,\n    host_map: Optional[Any] = None,\n    sidebar_visible: bool = True,\n    min_width: int = 250,\n    max_width: int = 300,\n    sidebar_content: Optional[Union[widgets.VBox, List[widgets.Widget]]] = None,\n    *args: Any,\n    **kwargs: Any,\n) -&gt; None:\n    \"\"\"\n    Initializes the Container widget.\n\n    Args:\n        host_map (Optional[Any]): The map object to display in the container. Defaults to None.\n        sidebar_visible (bool): Whether the sidebar is visible. Defaults to True.\n        min_width (int): Minimum width of the sidebar in pixels. Defaults to 250.\n        max_width (int): Maximum width of the sidebar in pixels. Defaults to 300.\n        sidebar_content (Optional[Union[widgets.VBox, List[widgets.Widget]]]):\n            The content to display in the sidebar. Defaults to None.\n        *args (Any): Additional positional arguments for the parent class.\n        **kwargs (Any): Additional keyword arguments for the parent class.\n    \"\"\"\n    self.sidebar_visible = sidebar_visible\n    self.min_width = min_width\n    self.max_width = max_width\n    self.host_map = host_map\n    self.sidebar_widgets = {}\n\n    # Map display container (left column)\n    self.map_container = v.Col(\n        class_=\"pa-1\",\n        style_=\"flex-grow: 1; flex-shrink: 1; flex-basis: 0;\",\n    )\n    self.map_container.children = [host_map or self.create_map()]\n\n    # Sidebar content container (mutable VBox)\n    self.sidebar_content_box = widgets.VBox()\n    if sidebar_content:\n        self.set_sidebar_content(sidebar_content)\n\n    # Toggle button\n    if sidebar_visible:\n        self.toggle_icon = v.Icon(children=[\"mdi-chevron-right\"])\n    else:\n        self.toggle_icon = v.Icon(children=[\"mdi-chevron-left\"])  # default icon\n    self.toggle_btn = v.Btn(\n        icon=True,\n        children=[self.toggle_icon],\n        style_=\"width: 48px; height: 48px; min-width: 48px;\",\n    )\n    self.toggle_btn.on_event(\"click\", self.toggle_sidebar)\n\n    # Settings icon\n    self.settings_icon = v.Icon(children=[\"mdi-wrench\"])\n    self.settings_btn = v.Btn(\n        icon=True,\n        children=[self.settings_icon],\n        style_=\"width: 36px; height: 36px;\",\n    )\n    self.settings_btn.on_event(\"click\", self.toggle_width_slider)\n\n    # Sidebar controls row (toggle + settings)\n    self.sidebar_controls = v.Row(\n        class_=\"ma-0 pa-0\", children=[self.toggle_btn, self.settings_btn]\n    )\n\n    # Sidebar width slider (initially hidden)\n    self.width_slider = widgets.IntSlider(\n        value=self.max_width,\n        min=200,\n        max=1000,\n        step=10,\n        description=\"Width:\",\n        continuous_update=True,\n    )\n    self.width_slider.observe(self.on_width_change, names=\"value\")\n\n    self.settings_widget = CustomWidget(\n        self.width_slider,\n        widget_icon=\"mdi-cog\",\n        label=\"Sidebar Settings\",\n        host_map=self.host_map,\n    )\n\n    # Sidebar (right column)\n    self.sidebar = v.Col(class_=\"pa-1\", style_=\"overflow-y: hidden;\")\n    self.update_sidebar_content()\n\n    # Main layout row\n    self.row = v.Row(\n        class_=\"d-flex flex-nowrap\",\n        children=[self.map_container, self.sidebar],\n    )\n\n    super().__init__(fluid=True, children=[self.row], *args, **kwargs)\n</code></pre>"},{"location":"maplibre_widgets/#anymap.maplibre_widgets.Container.add_to_sidebar","title":"<code>add_to_sidebar(self, widget, add_header=True, widget_icon='mdi-tools', close_icon='mdi-close', label='My Tools', background_color='#f5f5f5', height='40px', expanded=True, host_map=None, **kwargs)</code>","text":"<p>Appends a widget to the sidebar content.</p> <p>Parameters:</p> Name Type Description Default <code>widget</code> <code>Optional[Union[widgets.Widget, List[widgets.Widget]]]</code> <p>Initial widget(s) to display in the content box.</p> required <code>widget_icon</code> <code>str</code> <p>Icon for the header. See https://pictogrammers.github.io/@mdi/font/2.0.46/ for available icons.</p> <code>'mdi-tools'</code> <code>close_icon</code> <code>str</code> <p>Icon for the close button. See https://pictogrammers.github.io/@mdi/font/2.0.46/ for available icons.</p> <code>'mdi-close'</code> <code>background_color</code> <code>str</code> <p>Background color of the header. Defaults to \"#f5f5f5\".</p> <code>'#f5f5f5'</code> <code>label</code> <code>str</code> <p>Text label for the header. Defaults to \"My Tools\".</p> <code>'My Tools'</code> <code>height</code> <code>str</code> <p>Height of the header. Defaults to \"40px\".</p> <code>'40px'</code> <code>expanded</code> <code>bool</code> <p>Whether the panel is expanded by default. Defaults to True.</p> <code>True</code> <code>**kwargs</code> <code>Any</code> <p>Additional keyword arguments for the parent class.</p> <code>{}</code> Source code in <code>anymap/maplibre_widgets.py</code> <pre><code>def add_to_sidebar(\n    self,\n    widget: Union[widgets.Widget, List[widgets.Widget]],\n    add_header: bool = True,\n    widget_icon: str = \"mdi-tools\",\n    close_icon: str = \"mdi-close\",\n    label: str = \"My Tools\",\n    background_color: str = \"#f5f5f5\",\n    height: str = \"40px\",\n    expanded: bool = True,\n    host_map: Optional[Any] = None,\n    **kwargs: Any,\n) -&gt; None:\n    \"\"\"\n    Appends a widget to the sidebar content.\n\n    Args:\n        widget (Optional[Union[widgets.Widget, List[widgets.Widget]]]): Initial widget(s) to display in the content box.\n        widget_icon (str): Icon for the header. See https://pictogrammers.github.io/@mdi/font/2.0.46/ for available icons.\n        close_icon (str): Icon for the close button. See https://pictogrammers.github.io/@mdi/font/2.0.46/ for available icons.\n        background_color (str): Background color of the header. Defaults to \"#f5f5f5\".\n        label (str): Text label for the header. Defaults to \"My Tools\".\n        height (str): Height of the header. Defaults to \"40px\".\n        expanded (bool): Whether the panel is expanded by default. Defaults to True.\n        **kwargs (Any): Additional keyword arguments for the parent class.\n    \"\"\"\n\n    if label in self.sidebar_widgets:\n        self.remove_from_sidebar(name=label)\n\n    if add_header:\n        widget = CustomWidget(\n            widget,\n            widget_icon=widget_icon,\n            close_icon=close_icon,\n            label=label,\n            background_color=background_color,\n            height=height,\n            expanded=expanded,\n            host_map=host_map,\n            **kwargs,\n        )\n\n    self.sidebar_content_box.children += (widget,)\n    self.sidebar_widgets[label] = widget\n</code></pre>"},{"location":"maplibre_widgets/#anymap.maplibre_widgets.Container.create_map","title":"<code>create_map(self)</code>","text":"<p>Creates a default map object.</p> <p>Returns:</p> Type Description <code>Any</code> <p>A default map object.</p> Source code in <code>anymap/maplibre_widgets.py</code> <pre><code>def create_map(self) -&gt; Any:\n    \"\"\"\n    Creates a default map object.\n\n    Returns:\n        Any: A default map object.\n    \"\"\"\n    from .maplibre import MapLibreMap\n\n    return MapLibreMap(center=[20, 0], zoom=2)\n</code></pre>"},{"location":"maplibre_widgets/#anymap.maplibre_widgets.Container.remove_from_sidebar","title":"<code>remove_from_sidebar(self, widget=None, name=None)</code>","text":"<p>Removes a widget from the sidebar content.</p> <p>Parameters:</p> Name Type Description Default <code>widget</code> <code>widgets.Widget</code> <p>The widget to remove from the sidebar.</p> <code>None</code> <code>name</code> <code>str</code> <p>The name of the widget to remove from the sidebar.</p> <code>None</code> Source code in <code>anymap/maplibre_widgets.py</code> <pre><code>def remove_from_sidebar(\n    self, widget: widgets.Widget = None, name: str = None\n) -&gt; None:\n    \"\"\"\n    Removes a widget from the sidebar content.\n\n    Args:\n        widget (widgets.Widget): The widget to remove from the sidebar.\n        name (str): The name of the widget to remove from the sidebar.\n    \"\"\"\n    key = None\n    for key, value in self.sidebar_widgets.items():\n        if value == widget or key == name:\n            if widget is None:\n                widget = self.sidebar_widgets[key]\n            break\n\n    if key is not None and key in self.sidebar_widgets:\n        self.sidebar_widgets.pop(key)\n    self.sidebar_content_box.children = tuple(\n        child for child in self.sidebar_content_box.children if child != widget\n    )\n</code></pre>"},{"location":"maplibre_widgets/#anymap.maplibre_widgets.Container.set_sidebar_content","title":"<code>set_sidebar_content(self, content)</code>","text":"<p>Replaces all content in the sidebar (except the toggle button).</p> <p>Parameters:</p> Name Type Description Default <code>content</code> <code>Union[widgets.VBox, List[widgets.Widget]]</code> <p>The new content for the sidebar.</p> required Source code in <code>anymap/maplibre_widgets.py</code> <pre><code>def set_sidebar_content(\n    self, content: Union[widgets.VBox, List[widgets.Widget]]\n) -&gt; None:\n    \"\"\"\n    Replaces all content in the sidebar (except the toggle button).\n\n    Args:\n        content (Union[widgets.VBox, List[widgets.Widget]]): The new content for the sidebar.\n    \"\"\"\n    if isinstance(content, (list, tuple)):\n        self.sidebar_content_box.children = content\n    else:\n        self.sidebar_content_box.children = [content]\n</code></pre>"},{"location":"maplibre_widgets/#anymap.maplibre_widgets.Container.set_sidebar_width","title":"<code>set_sidebar_width(self, min_width=None, max_width=None)</code>","text":"<p>Dynamically updates the sidebar's minimum and maximum width.</p> <p>Parameters:</p> Name Type Description Default <code>min_width</code> <code>int</code> <p>New minimum width in pixels. If None, keep current.</p> <code>None</code> <code>max_width</code> <code>int</code> <p>New maximum width in pixels. If None, keep current.</p> <code>None</code> Source code in <code>anymap/maplibre_widgets.py</code> <pre><code>def set_sidebar_width(self, min_width: int = None, max_width: int = None) -&gt; None:\n    \"\"\"\n    Dynamically updates the sidebar's minimum and maximum width.\n\n    Args:\n        min_width (int, optional): New minimum width in pixels. If None, keep current.\n        max_width (int, optional): New maximum width in pixels. If None, keep current.\n    \"\"\"\n    if min_width is not None:\n        if isinstance(min_width, str):\n            min_width = int(min_width.replace(\"px\", \"\"))\n        self.min_width = min_width\n    if max_width is not None:\n        if isinstance(max_width, str):\n            max_width = int(max_width.replace(\"px\", \"\"))\n        self.max_width = max_width\n    self.update_sidebar_content()\n</code></pre>"},{"location":"maplibre_widgets/#anymap.maplibre_widgets.Container.toggle_sidebar","title":"<code>toggle_sidebar(self, *args, **kwargs)</code>","text":"<p>Toggles the visibility of the sidebar.</p> <p>Parameters:</p> Name Type Description Default <code>*args</code> <code>Any</code> <p>Additional positional arguments.</p> <code>()</code> <code>**kwargs</code> <code>Any</code> <p>Additional keyword arguments.</p> <code>{}</code> Source code in <code>anymap/maplibre_widgets.py</code> <pre><code>def toggle_sidebar(self, *args: Any, **kwargs: Any) -&gt; None:\n    \"\"\"\n    Toggles the visibility of the sidebar.\n\n    Args:\n        *args (Any): Additional positional arguments.\n        **kwargs (Any): Additional keyword arguments.\n    \"\"\"\n    self.sidebar_visible = not self.sidebar_visible\n    self.toggle_icon.children = [\n        \"mdi-chevron-right\" if self.sidebar_visible else \"mdi-chevron-left\"\n    ]\n    self.update_sidebar_content()\n</code></pre>"},{"location":"maplibre_widgets/#anymap.maplibre_widgets.Container.update_sidebar_content","title":"<code>update_sidebar_content(self)</code>","text":"<p>Updates the content of the sidebar based on its visibility. If the sidebar is visible, it displays the toggle button and the sidebar content. If the sidebar is hidden, it only displays the toggle button.</p> Source code in <code>anymap/maplibre_widgets.py</code> <pre><code>def update_sidebar_content(self) -&gt; None:\n    \"\"\"\n    Updates the content of the sidebar based on its visibility.\n    If the sidebar is visible, it displays the toggle button and the sidebar content.\n    If the sidebar is hidden, it only displays the toggle button.\n    \"\"\"\n    if self.sidebar_visible:\n        # Header row: toggle on the left, settings on the right\n        header_row = v.Row(\n            class_=\"ma-0 pa-0\",\n            align=\"center\",\n            justify=\"space-between\",\n            children=[self.toggle_btn, self.settings_btn],\n        )\n\n        children = [header_row]\n\n        children.append(self.sidebar_content_box)\n\n        self.sidebar.children = children\n        self.sidebar.style_ = (\n            f\"min-width: {self.min_width}px; max-width: {self.max_width}px;\"\n        )\n    else:\n        self.sidebar.children = [self.toggle_btn]\n        self.sidebar.style_ = \"width: 48px; min-width: 48px; max-width: 48px;\"\n</code></pre>"},{"location":"maplibre_widgets/#anymap.maplibre_widgets.CustomWidget","title":"<code> CustomWidget            (ExpansionPanels)         </code>","text":"<p>A custom expansion panel widget with dynamic widget management.</p> <p>This widget allows for the creation of an expandable panel with a customizable header and dynamic content. Widgets can be added, removed, or replaced in the content box.</p> <p>Attributes:</p> Name Type Description <code>content_box</code> <code>widgets.VBox</code> <p>A container for holding the widgets displayed in the panel.</p> <code>panel</code> <code>v.ExpansionPanel</code> <p>The main expansion panel containing the header and content.</p> Source code in <code>anymap/maplibre_widgets.py</code> <pre><code>class CustomWidget(v.ExpansionPanels):\n    \"\"\"\n    A custom expansion panel widget with dynamic widget management.\n\n    This widget allows for the creation of an expandable panel with a customizable header\n    and dynamic content. Widgets can be added, removed, or replaced in the content box.\n\n    Attributes:\n        content_box (widgets.VBox): A container for holding the widgets displayed in the panel.\n        panel (v.ExpansionPanel): The main expansion panel containing the header and content.\n    \"\"\"\n\n    def __init__(\n        self,\n        widget: Optional[Union[widgets.Widget, List[widgets.Widget]]] = None,\n        widget_icon: str = \"mdi-tools\",\n        close_icon: str = \"mdi-close\",\n        label: str = \"My Tools\",\n        background_color: str = \"#f5f5f5\",\n        height: str = \"40px\",\n        expanded: bool = True,\n        host_map: Optional[Any] = None,\n        *args: Any,\n        **kwargs: Any,\n    ) -&gt; None:\n        \"\"\"\n        Initializes the CustomWidget.\n\n        Args:\n            widget (Optional[Union[widgets.Widget, List[widgets.Widget]]]): Initial widget(s) to display in the content box.\n            widget_icon (str): Icon for the header. See https://pictogrammers.github.io/@mdi/font/2.0.46/ for available icons.\n            close_icon (str): Icon for the close button. See https://pictogrammers.github.io/@mdi/font/2.0.46/ for available icons.\n            background_color (str): Background color of the header. Defaults to \"#f5f5f5\".\n            label (str): Text label for the header. Defaults to \"My Tools\".\n            height (str): Height of the header. Defaults to \"40px\".\n            expanded (bool): Whether the panel is expanded by default. Defaults to True.\n            **kwargs (Any): Additional keyword arguments for the parent class.\n        \"\"\"\n        # Wrap content in a mutable VBox\n        self.content_box = widgets.VBox()\n        self.host_map = host_map\n        if widget:\n            if isinstance(widget, (list, tuple)):\n                self.content_box.children = widget\n            else:\n                self.content_box.children = [widget]\n\n        # Close icon button\n        close_btn = v.Btn(\n            icon=True,\n            small=True,\n            class_=\"ma-0\",\n            style_=\"min-width: 24px; width: 24px;\",\n            children=[v.Icon(children=[close_icon])],\n        )\n        close_btn.on_event(\"click\", self._handle_close)\n\n        header = v.ExpansionPanelHeader(\n            style_=f\"height: {height}; min-height: {height}; background-color: {background_color};\",\n            children=[\n                v.Row(\n                    align=\"center\",\n                    class_=\"d-flex flex-grow-1 align-center\",\n                    children=[\n                        v.Icon(children=[widget_icon], class_=\"ml-1\"),\n                        v.Spacer(),  # push title to center\n                        v.Html(tag=\"span\", children=[label], class_=\"text-subtitle-2\"),\n                        v.Spacer(),  # push close to right\n                        close_btn,\n                        v.Spacer(),\n                    ],\n                )\n            ],\n        )\n\n        self.panel = v.ExpansionPanel(\n            children=[\n                header,\n                v.ExpansionPanelContent(children=[self.content_box]),\n            ]\n        )\n\n        super().__init__(\n            children=[self.panel],\n            v_model=[0] if expanded else [],\n            multiple=True,\n            *args,\n            **kwargs,\n        )\n\n    def _handle_close(self, widget=None, event=None, data=None):\n        \"\"\"Calls the on_close callback if provided.\"\"\"\n\n        if self.host_map is not None:\n            self.host_map.remove_from_sidebar(self)\n        # self.close()\n\n    def add_widget(self, widget: widgets.Widget) -&gt; None:\n        \"\"\"\n        Adds a widget to the content box.\n\n        Args:\n            widget (widgets.Widget): The widget to add to the content box.\n        \"\"\"\n        self.content_box.children += (widget,)\n\n    def remove_widget(self, widget: widgets.Widget) -&gt; None:\n        \"\"\"\n        Removes a widget from the content box.\n\n        Args:\n            widget (widgets.Widget): The widget to remove from the content box.\n        \"\"\"\n        self.content_box.children = tuple(\n            w for w in self.content_box.children if w != widget\n        )\n\n    def set_widgets(self, widgets_list: List[widgets.Widget]) -&gt; None:\n        \"\"\"\n        Replaces all widgets in the content box.\n\n        Args:\n            widgets_list (List[widgets.Widget]): A list of widgets to set as the content of the content box.\n        \"\"\"\n        self.content_box.children = widgets_list\n</code></pre>"},{"location":"maplibre_widgets/#anymap.maplibre_widgets.CustomWidget.__init__","title":"<code>__init__(self, widget=None, widget_icon='mdi-tools', close_icon='mdi-close', label='My Tools', background_color='#f5f5f5', height='40px', expanded=True, host_map=None, *args, **kwargs)</code>  <code>special</code>","text":"<p>Initializes the CustomWidget.</p> <p>Parameters:</p> Name Type Description Default <code>widget</code> <code>Optional[Union[widgets.Widget, List[widgets.Widget]]]</code> <p>Initial widget(s) to display in the content box.</p> <code>None</code> <code>widget_icon</code> <code>str</code> <p>Icon for the header. See https://pictogrammers.github.io/@mdi/font/2.0.46/ for available icons.</p> <code>'mdi-tools'</code> <code>close_icon</code> <code>str</code> <p>Icon for the close button. See https://pictogrammers.github.io/@mdi/font/2.0.46/ for available icons.</p> <code>'mdi-close'</code> <code>background_color</code> <code>str</code> <p>Background color of the header. Defaults to \"#f5f5f5\".</p> <code>'#f5f5f5'</code> <code>label</code> <code>str</code> <p>Text label for the header. Defaults to \"My Tools\".</p> <code>'My Tools'</code> <code>height</code> <code>str</code> <p>Height of the header. Defaults to \"40px\".</p> <code>'40px'</code> <code>expanded</code> <code>bool</code> <p>Whether the panel is expanded by default. Defaults to True.</p> <code>True</code> <code>**kwargs</code> <code>Any</code> <p>Additional keyword arguments for the parent class.</p> <code>{}</code> Source code in <code>anymap/maplibre_widgets.py</code> <pre><code>def __init__(\n    self,\n    widget: Optional[Union[widgets.Widget, List[widgets.Widget]]] = None,\n    widget_icon: str = \"mdi-tools\",\n    close_icon: str = \"mdi-close\",\n    label: str = \"My Tools\",\n    background_color: str = \"#f5f5f5\",\n    height: str = \"40px\",\n    expanded: bool = True,\n    host_map: Optional[Any] = None,\n    *args: Any,\n    **kwargs: Any,\n) -&gt; None:\n    \"\"\"\n    Initializes the CustomWidget.\n\n    Args:\n        widget (Optional[Union[widgets.Widget, List[widgets.Widget]]]): Initial widget(s) to display in the content box.\n        widget_icon (str): Icon for the header. See https://pictogrammers.github.io/@mdi/font/2.0.46/ for available icons.\n        close_icon (str): Icon for the close button. See https://pictogrammers.github.io/@mdi/font/2.0.46/ for available icons.\n        background_color (str): Background color of the header. Defaults to \"#f5f5f5\".\n        label (str): Text label for the header. Defaults to \"My Tools\".\n        height (str): Height of the header. Defaults to \"40px\".\n        expanded (bool): Whether the panel is expanded by default. Defaults to True.\n        **kwargs (Any): Additional keyword arguments for the parent class.\n    \"\"\"\n    # Wrap content in a mutable VBox\n    self.content_box = widgets.VBox()\n    self.host_map = host_map\n    if widget:\n        if isinstance(widget, (list, tuple)):\n            self.content_box.children = widget\n        else:\n            self.content_box.children = [widget]\n\n    # Close icon button\n    close_btn = v.Btn(\n        icon=True,\n        small=True,\n        class_=\"ma-0\",\n        style_=\"min-width: 24px; width: 24px;\",\n        children=[v.Icon(children=[close_icon])],\n    )\n    close_btn.on_event(\"click\", self._handle_close)\n\n    header = v.ExpansionPanelHeader(\n        style_=f\"height: {height}; min-height: {height}; background-color: {background_color};\",\n        children=[\n            v.Row(\n                align=\"center\",\n                class_=\"d-flex flex-grow-1 align-center\",\n                children=[\n                    v.Icon(children=[widget_icon], class_=\"ml-1\"),\n                    v.Spacer(),  # push title to center\n                    v.Html(tag=\"span\", children=[label], class_=\"text-subtitle-2\"),\n                    v.Spacer(),  # push close to right\n                    close_btn,\n                    v.Spacer(),\n                ],\n            )\n        ],\n    )\n\n    self.panel = v.ExpansionPanel(\n        children=[\n            header,\n            v.ExpansionPanelContent(children=[self.content_box]),\n        ]\n    )\n\n    super().__init__(\n        children=[self.panel],\n        v_model=[0] if expanded else [],\n        multiple=True,\n        *args,\n        **kwargs,\n    )\n</code></pre>"},{"location":"maplibre_widgets/#anymap.maplibre_widgets.CustomWidget.add_widget","title":"<code>add_widget(self, widget)</code>","text":"<p>Adds a widget to the content box.</p> <p>Parameters:</p> Name Type Description Default <code>widget</code> <code>widgets.Widget</code> <p>The widget to add to the content box.</p> required Source code in <code>anymap/maplibre_widgets.py</code> <pre><code>def add_widget(self, widget: widgets.Widget) -&gt; None:\n    \"\"\"\n    Adds a widget to the content box.\n\n    Args:\n        widget (widgets.Widget): The widget to add to the content box.\n    \"\"\"\n    self.content_box.children += (widget,)\n</code></pre>"},{"location":"maplibre_widgets/#anymap.maplibre_widgets.CustomWidget.remove_widget","title":"<code>remove_widget(self, widget)</code>","text":"<p>Removes a widget from the content box.</p> <p>Parameters:</p> Name Type Description Default <code>widget</code> <code>widgets.Widget</code> <p>The widget to remove from the content box.</p> required Source code in <code>anymap/maplibre_widgets.py</code> <pre><code>def remove_widget(self, widget: widgets.Widget) -&gt; None:\n    \"\"\"\n    Removes a widget from the content box.\n\n    Args:\n        widget (widgets.Widget): The widget to remove from the content box.\n    \"\"\"\n    self.content_box.children = tuple(\n        w for w in self.content_box.children if w != widget\n    )\n</code></pre>"},{"location":"maplibre_widgets/#anymap.maplibre_widgets.CustomWidget.set_widgets","title":"<code>set_widgets(self, widgets_list)</code>","text":"<p>Replaces all widgets in the content box.</p> <p>Parameters:</p> Name Type Description Default <code>widgets_list</code> <code>List[widgets.Widget]</code> <p>A list of widgets to set as the content of the content box.</p> required Source code in <code>anymap/maplibre_widgets.py</code> <pre><code>def set_widgets(self, widgets_list: List[widgets.Widget]) -&gt; None:\n    \"\"\"\n    Replaces all widgets in the content box.\n\n    Args:\n        widgets_list (List[widgets.Widget]): A list of widgets to set as the content of the content box.\n    \"\"\"\n    self.content_box.children = widgets_list\n</code></pre>"},{"location":"maplibre_widgets/#anymap.maplibre_widgets.LayerManagerWidget","title":"<code> LayerManagerWidget            (ExpansionPanels)         </code>","text":"<p>A widget for managing map layers.</p> <p>This widget provides controls for toggling the visibility, adjusting the opacity, and removing layers from a map. It also includes a master toggle to turn all layers on or off.</p> <p>Attributes:</p> Name Type Description <code>m</code> <code>Map</code> <p>The map object to manage layers for.</p> <code>layer_items</code> <code>Dict[str, Dict[str, widgets.Widget]]</code> <p>A dictionary mapping layer names to their corresponding control widgets (checkbox and slider).</p> <code>_building</code> <code>bool</code> <p>A flag indicating whether the widget is currently being built.</p> <code>master_toggle</code> <code>widgets.Checkbox</code> <p>A checkbox to toggle all layers on or off.</p> <code>layers_box</code> <code>widgets.VBox</code> <p>A container for individual layer controls.</p> Source code in <code>anymap/maplibre_widgets.py</code> <pre><code>class LayerManagerWidget(v.ExpansionPanels):\n    \"\"\"\n    A widget for managing map layers.\n\n    This widget provides controls for toggling the visibility, adjusting the opacity,\n    and removing layers from a map. It also includes a master toggle to turn all layers\n    on or off.\n\n    Attributes:\n        m (Map): The map object to manage layers for.\n        layer_items (Dict[str, Dict[str, widgets.Widget]]): A dictionary mapping layer names\n            to their corresponding control widgets (checkbox and slider).\n        _building (bool): A flag indicating whether the widget is currently being built.\n        master_toggle (widgets.Checkbox): A checkbox to toggle all layers on or off.\n        layers_box (widgets.VBox): A container for individual layer controls.\n    \"\"\"\n\n    def __init__(\n        self,\n        m: Any,\n        expanded: bool = True,\n        height: str = \"40px\",\n        layer_icon: str = \"mdi-layers\",\n        close_icon: str = \"mdi-close\",\n        label=\"Layers\",\n        background_color: str = \"#f5f5f5\",\n        groups: dict = None,\n        *args: Any,\n        **kwargs: Any,\n    ) -&gt; None:\n        \"\"\"\n        Initializes the LayerManagerWidget.\n\n        Args:\n            m (Any): The map object to manage layers for.\n            expanded (bool): Whether the expansion panel should be expanded by default. Defaults to True.\n            height (str): The height of the header. Defaults to \"40px\".\n            layer_icon (str): The icon for the layer manager. Defaults to \"mdi-layers\".\n            close_icon (str): The icon for the close button. Defaults to \"mdi-close\".\n            label (str): The label for the layer manager. Defaults to \"Layers\".\n            background_color (str): The background color of the header. Defaults to \"#f5f5f5\".\n            groups (dict): A dictionary of layer groups, such as {\"Group 1\": [\"layer1\", \"layer2\"],\n                \"Group 2\": [\"layer3\", \"layer4\"]}. A group layer toggle will be created for each group.\n                Defaults to None.\n            *args (Any): Additional positional arguments for the parent class.\n            **kwargs (Any): Additional keyword arguments for the parent class.\n        \"\"\"\n        self.m = m\n        self.layer_items = {}\n        self.groups = groups\n        self._building = False\n\n        # Master toggle\n        style = {\"description_width\": \"initial\"}\n        self.master_toggle = widgets.Checkbox(\n            value=True, description=\"All layers on/off\", style=style\n        )\n        self.master_toggle.observe(self.toggle_all_layers, names=\"value\")\n\n        self.group_toggles = widgets.VBox()\n        if isinstance(groups, dict):\n            for group_name, group_layers in groups.items():\n                group_toggle = widgets.Checkbox(\n                    value=True,\n                    description=f\"{group_name} group layers on/off\",\n                    style=style,\n                )\n                group_toggle.observe(self.toggle_group_layers, names=\"value\")\n                self.group_toggles.children += (group_toggle,)\n\n        # Build individual layer rows\n        self.layers_box = widgets.VBox()\n        self.build_layer_controls()\n\n        # Close icon button\n        close_btn = v.Btn(\n            icon=True,\n            small=True,\n            class_=\"ma-0\",\n            style_=\"min-width: 24px; width: 24px;\",\n            children=[v.Icon(children=[close_icon])],\n        )\n        close_btn.on_event(\"click\", self._handle_close)\n\n        header = v.ExpansionPanelHeader(\n            style_=f\"height: {height}; min-height: {height}; background-color: {background_color};\",\n            children=[\n                v.Row(\n                    align=\"center\",\n                    class_=\"d-flex flex-grow-1 align-center\",\n                    children=[\n                        v.Icon(children=[layer_icon], class_=\"ml-1\"),\n                        v.Spacer(),  # push title to center\n                        v.Html(tag=\"span\", children=[label], class_=\"text-subtitle-2\"),\n                        v.Spacer(),  # push close to right\n                        close_btn,\n                        v.Spacer(),\n                    ],\n                )\n            ],\n        )\n\n        panel = v.ExpansionPanel(\n            children=[\n                header,\n                v.ExpansionPanelContent(\n                    children=[\n                        widgets.VBox(\n                            [self.master_toggle, self.group_toggles, self.layers_box]\n                        )\n                    ]\n                ),\n            ]\n        )\n\n        if expanded:\n            super().__init__(\n                children=[panel], v_model=[0], multiple=True, *args, **kwargs\n            )\n        else:\n            super().__init__(children=[panel], multiple=True, *args, **kwargs)\n\n    def _handle_close(self, widget=None, event=None, data=None):\n        \"\"\"Calls the on_close callback if provided.\"\"\"\n\n        self.m.remove_from_sidebar(self)\n        # self.close()\n\n    def build_layer_controls(self) -&gt; None:\n        \"\"\"\n        Builds the controls for individual layers.\n\n        This method creates checkboxes for toggling visibility, sliders for adjusting opacity,\n        and buttons for removing layers.\n        \"\"\"\n        self._building = True\n        self.layer_items.clear()\n        rows = []\n\n        style = {\"description_width\": \"initial\"}\n        padding = \"0px 5px 0px 5px\"\n\n        for name, info in list(self.m.layer_dict.items()):\n            # if name == \"Background\":\n            #     continue\n\n            visible = info.get(\"visible\", True)\n            opacity = info.get(\"opacity\", 1.0)\n\n            checkbox = widgets.Checkbox(value=visible, description=name, style=style)\n            checkbox.layout.max_width = \"150px\"\n\n            slider = widgets.FloatSlider(\n                value=opacity,\n                min=0,\n                max=1,\n                step=0.01,\n                readout=False,\n                tooltip=\"Change layer opacity\",\n                layout=widgets.Layout(width=\"150px\", padding=padding),\n            )\n\n            settings = widgets.Button(\n                icon=\"gear\",\n                tooltip=\"Change layer style\",\n                layout=widgets.Layout(width=\"38px\", height=\"25px\", padding=padding),\n            )\n\n            remove = widgets.Button(\n                icon=\"times\",\n                tooltip=\"Remove layer\",\n                layout=widgets.Layout(width=\"38px\", height=\"25px\", padding=padding),\n            )\n\n            def on_visibility_change(change, layer_name=name):\n                self.set_layer_visibility(layer_name, change[\"new\"])\n\n            def on_opacity_change(change, layer_name=name):\n                self.set_layer_opacity(layer_name, change[\"new\"])\n\n            def on_remove_clicked(btn, layer_name=name, row_ref=None):\n                if layer_name == \"Background\":\n                    for layer in self.m.get_style_layers():\n                        self.m.add_call(\"removeLayer\", layer[\"id\"])\n                else:\n                    self.m.remove_layer(layer_name)\n                if row_ref in self.layers_box.children:\n                    self.layers_box.children = tuple(\n                        c for c in self.layers_box.children if c != row_ref\n                    )\n                self.layer_items.pop(layer_name, None)\n                if f\"Style {layer_name}\" in self.m.sidebar_widgets:\n                    self.m.remove_from_sidebar(name=f\"Style {layer_name}\")\n\n            def on_settings_clicked(btn, layer_name=name):\n                style_widget = LayerStyleWidget(self.m.layer_dict[layer_name], self.m)\n                self.m.add_to_sidebar(\n                    style_widget,\n                    widget_icon=\"mdi-palette\",\n                    label=f\"Style {layer_name}\",\n                )\n\n            checkbox.observe(on_visibility_change, names=\"value\")\n            slider.observe(on_opacity_change, names=\"value\")\n\n            row = widgets.HBox(\n                [checkbox, slider, settings, remove], layout=widgets.Layout()\n            )\n\n            remove.on_click(\n                lambda btn, r=row, n=name: on_remove_clicked(\n                    btn, layer_name=n, row_ref=r\n                )\n            )\n\n            settings.on_click(\n                lambda btn, n=name: on_settings_clicked(btn, layer_name=n)\n            )\n\n            rows.append(row)\n            self.layer_items[name] = {\"checkbox\": checkbox, \"slider\": slider}\n\n        self.layers_box.children = rows\n        self._building = False\n\n    def toggle_all_layers(self, change: Dict[str, Any]) -&gt; None:\n        \"\"\"\n        Toggles the visibility of all layers.\n\n        Args:\n            change (Dict[str, Any]): The change event from the master toggle checkbox.\n        \"\"\"\n        if self._building:\n            return\n        for name, controls in self.layer_items.items():\n            controls[\"checkbox\"].value = change[\"new\"]\n\n        for widget in self.group_toggles.children:\n            widget.value = change[\"new\"]\n\n    def toggle_group_layers(self, change: Dict[str, Any]) -&gt; None:\n        \"\"\"\n        Toggles the visibility of a group of layers.\n        \"\"\"\n        if self._building:\n            return\n        group_name = change[\"owner\"].description.split(\" \")[0]\n        group_layers = self.groups[group_name]\n        for layer_name in group_layers:\n            self.set_layer_visibility(layer_name, change[\"new\"])\n        self.refresh()\n\n    def set_layer_visibility(self, name: str, visible: bool) -&gt; None:\n        \"\"\"\n        Sets the visibility of a specific layer.\n\n        Args:\n            name (str): The name of the layer.\n            visible (bool): Whether the layer should be visible.\n        \"\"\"\n        self.m.set_visibility(name, visible)\n\n    def set_layer_opacity(self, name: str, opacity: float) -&gt; None:\n        \"\"\"\n        Sets the opacity of a specific layer.\n\n        Args:\n            name (str): The name of the layer.\n            opacity (float): The opacity value (0 to 1).\n        \"\"\"\n        self.m.set_opacity(name, opacity)\n\n    def refresh(self) -&gt; None:\n        \"\"\"\n        Rebuilds the UI to reflect the current layers in the map.\n        \"\"\"\n        self.build_layer_controls()\n</code></pre>"},{"location":"maplibre_widgets/#anymap.maplibre_widgets.LayerManagerWidget.__init__","title":"<code>__init__(self, m, expanded=True, height='40px', layer_icon='mdi-layers', close_icon='mdi-close', label='Layers', background_color='#f5f5f5', groups=None, *args, **kwargs)</code>  <code>special</code>","text":"<p>Initializes the LayerManagerWidget.</p> <p>Parameters:</p> Name Type Description Default <code>m</code> <code>Any</code> <p>The map object to manage layers for.</p> required <code>expanded</code> <code>bool</code> <p>Whether the expansion panel should be expanded by default. Defaults to True.</p> <code>True</code> <code>height</code> <code>str</code> <p>The height of the header. Defaults to \"40px\".</p> <code>'40px'</code> <code>layer_icon</code> <code>str</code> <p>The icon for the layer manager. Defaults to \"mdi-layers\".</p> <code>'mdi-layers'</code> <code>close_icon</code> <code>str</code> <p>The icon for the close button. Defaults to \"mdi-close\".</p> <code>'mdi-close'</code> <code>label</code> <code>str</code> <p>The label for the layer manager. Defaults to \"Layers\".</p> <code>'Layers'</code> <code>background_color</code> <code>str</code> <p>The background color of the header. Defaults to \"#f5f5f5\".</p> <code>'#f5f5f5'</code> <code>groups</code> <code>dict</code> <p>A dictionary of layer groups, such as {\"Group 1\": [\"layer1\", \"layer2\"], \"Group 2\": [\"layer3\", \"layer4\"]}. A group layer toggle will be created for each group. Defaults to None.</p> <code>None</code> <code>*args</code> <code>Any</code> <p>Additional positional arguments for the parent class.</p> <code>()</code> <code>**kwargs</code> <code>Any</code> <p>Additional keyword arguments for the parent class.</p> <code>{}</code> Source code in <code>anymap/maplibre_widgets.py</code> <pre><code>def __init__(\n    self,\n    m: Any,\n    expanded: bool = True,\n    height: str = \"40px\",\n    layer_icon: str = \"mdi-layers\",\n    close_icon: str = \"mdi-close\",\n    label=\"Layers\",\n    background_color: str = \"#f5f5f5\",\n    groups: dict = None,\n    *args: Any,\n    **kwargs: Any,\n) -&gt; None:\n    \"\"\"\n    Initializes the LayerManagerWidget.\n\n    Args:\n        m (Any): The map object to manage layers for.\n        expanded (bool): Whether the expansion panel should be expanded by default. Defaults to True.\n        height (str): The height of the header. Defaults to \"40px\".\n        layer_icon (str): The icon for the layer manager. Defaults to \"mdi-layers\".\n        close_icon (str): The icon for the close button. Defaults to \"mdi-close\".\n        label (str): The label for the layer manager. Defaults to \"Layers\".\n        background_color (str): The background color of the header. Defaults to \"#f5f5f5\".\n        groups (dict): A dictionary of layer groups, such as {\"Group 1\": [\"layer1\", \"layer2\"],\n            \"Group 2\": [\"layer3\", \"layer4\"]}. A group layer toggle will be created for each group.\n            Defaults to None.\n        *args (Any): Additional positional arguments for the parent class.\n        **kwargs (Any): Additional keyword arguments for the parent class.\n    \"\"\"\n    self.m = m\n    self.layer_items = {}\n    self.groups = groups\n    self._building = False\n\n    # Master toggle\n    style = {\"description_width\": \"initial\"}\n    self.master_toggle = widgets.Checkbox(\n        value=True, description=\"All layers on/off\", style=style\n    )\n    self.master_toggle.observe(self.toggle_all_layers, names=\"value\")\n\n    self.group_toggles = widgets.VBox()\n    if isinstance(groups, dict):\n        for group_name, group_layers in groups.items():\n            group_toggle = widgets.Checkbox(\n                value=True,\n                description=f\"{group_name} group layers on/off\",\n                style=style,\n            )\n            group_toggle.observe(self.toggle_group_layers, names=\"value\")\n            self.group_toggles.children += (group_toggle,)\n\n    # Build individual layer rows\n    self.layers_box = widgets.VBox()\n    self.build_layer_controls()\n\n    # Close icon button\n    close_btn = v.Btn(\n        icon=True,\n        small=True,\n        class_=\"ma-0\",\n        style_=\"min-width: 24px; width: 24px;\",\n        children=[v.Icon(children=[close_icon])],\n    )\n    close_btn.on_event(\"click\", self._handle_close)\n\n    header = v.ExpansionPanelHeader(\n        style_=f\"height: {height}; min-height: {height}; background-color: {background_color};\",\n        children=[\n            v.Row(\n                align=\"center\",\n                class_=\"d-flex flex-grow-1 align-center\",\n                children=[\n                    v.Icon(children=[layer_icon], class_=\"ml-1\"),\n                    v.Spacer(),  # push title to center\n                    v.Html(tag=\"span\", children=[label], class_=\"text-subtitle-2\"),\n                    v.Spacer(),  # push close to right\n                    close_btn,\n                    v.Spacer(),\n                ],\n            )\n        ],\n    )\n\n    panel = v.ExpansionPanel(\n        children=[\n            header,\n            v.ExpansionPanelContent(\n                children=[\n                    widgets.VBox(\n                        [self.master_toggle, self.group_toggles, self.layers_box]\n                    )\n                ]\n            ),\n        ]\n    )\n\n    if expanded:\n        super().__init__(\n            children=[panel], v_model=[0], multiple=True, *args, **kwargs\n        )\n    else:\n        super().__init__(children=[panel], multiple=True, *args, **kwargs)\n</code></pre>"},{"location":"maplibre_widgets/#anymap.maplibre_widgets.LayerManagerWidget.build_layer_controls","title":"<code>build_layer_controls(self)</code>","text":"<p>Builds the controls for individual layers.</p> <p>This method creates checkboxes for toggling visibility, sliders for adjusting opacity, and buttons for removing layers.</p> Source code in <code>anymap/maplibre_widgets.py</code> <pre><code>def build_layer_controls(self) -&gt; None:\n    \"\"\"\n    Builds the controls for individual layers.\n\n    This method creates checkboxes for toggling visibility, sliders for adjusting opacity,\n    and buttons for removing layers.\n    \"\"\"\n    self._building = True\n    self.layer_items.clear()\n    rows = []\n\n    style = {\"description_width\": \"initial\"}\n    padding = \"0px 5px 0px 5px\"\n\n    for name, info in list(self.m.layer_dict.items()):\n        # if name == \"Background\":\n        #     continue\n\n        visible = info.get(\"visible\", True)\n        opacity = info.get(\"opacity\", 1.0)\n\n        checkbox = widgets.Checkbox(value=visible, description=name, style=style)\n        checkbox.layout.max_width = \"150px\"\n\n        slider = widgets.FloatSlider(\n            value=opacity,\n            min=0,\n            max=1,\n            step=0.01,\n            readout=False,\n            tooltip=\"Change layer opacity\",\n            layout=widgets.Layout(width=\"150px\", padding=padding),\n        )\n\n        settings = widgets.Button(\n            icon=\"gear\",\n            tooltip=\"Change layer style\",\n            layout=widgets.Layout(width=\"38px\", height=\"25px\", padding=padding),\n        )\n\n        remove = widgets.Button(\n            icon=\"times\",\n            tooltip=\"Remove layer\",\n            layout=widgets.Layout(width=\"38px\", height=\"25px\", padding=padding),\n        )\n\n        def on_visibility_change(change, layer_name=name):\n            self.set_layer_visibility(layer_name, change[\"new\"])\n\n        def on_opacity_change(change, layer_name=name):\n            self.set_layer_opacity(layer_name, change[\"new\"])\n\n        def on_remove_clicked(btn, layer_name=name, row_ref=None):\n            if layer_name == \"Background\":\n                for layer in self.m.get_style_layers():\n                    self.m.add_call(\"removeLayer\", layer[\"id\"])\n            else:\n                self.m.remove_layer(layer_name)\n            if row_ref in self.layers_box.children:\n                self.layers_box.children = tuple(\n                    c for c in self.layers_box.children if c != row_ref\n                )\n            self.layer_items.pop(layer_name, None)\n            if f\"Style {layer_name}\" in self.m.sidebar_widgets:\n                self.m.remove_from_sidebar(name=f\"Style {layer_name}\")\n\n        def on_settings_clicked(btn, layer_name=name):\n            style_widget = LayerStyleWidget(self.m.layer_dict[layer_name], self.m)\n            self.m.add_to_sidebar(\n                style_widget,\n                widget_icon=\"mdi-palette\",\n                label=f\"Style {layer_name}\",\n            )\n\n        checkbox.observe(on_visibility_change, names=\"value\")\n        slider.observe(on_opacity_change, names=\"value\")\n\n        row = widgets.HBox(\n            [checkbox, slider, settings, remove], layout=widgets.Layout()\n        )\n\n        remove.on_click(\n            lambda btn, r=row, n=name: on_remove_clicked(\n                btn, layer_name=n, row_ref=r\n            )\n        )\n\n        settings.on_click(\n            lambda btn, n=name: on_settings_clicked(btn, layer_name=n)\n        )\n\n        rows.append(row)\n        self.layer_items[name] = {\"checkbox\": checkbox, \"slider\": slider}\n\n    self.layers_box.children = rows\n    self._building = False\n</code></pre>"},{"location":"maplibre_widgets/#anymap.maplibre_widgets.LayerManagerWidget.refresh","title":"<code>refresh(self)</code>","text":"<p>Rebuilds the UI to reflect the current layers in the map.</p> Source code in <code>anymap/maplibre_widgets.py</code> <pre><code>def refresh(self) -&gt; None:\n    \"\"\"\n    Rebuilds the UI to reflect the current layers in the map.\n    \"\"\"\n    self.build_layer_controls()\n</code></pre>"},{"location":"maplibre_widgets/#anymap.maplibre_widgets.LayerManagerWidget.set_layer_opacity","title":"<code>set_layer_opacity(self, name, opacity)</code>","text":"<p>Sets the opacity of a specific layer.</p> <p>Parameters:</p> Name Type Description Default <code>name</code> <code>str</code> <p>The name of the layer.</p> required <code>opacity</code> <code>float</code> <p>The opacity value (0 to 1).</p> required Source code in <code>anymap/maplibre_widgets.py</code> <pre><code>def set_layer_opacity(self, name: str, opacity: float) -&gt; None:\n    \"\"\"\n    Sets the opacity of a specific layer.\n\n    Args:\n        name (str): The name of the layer.\n        opacity (float): The opacity value (0 to 1).\n    \"\"\"\n    self.m.set_opacity(name, opacity)\n</code></pre>"},{"location":"maplibre_widgets/#anymap.maplibre_widgets.LayerManagerWidget.set_layer_visibility","title":"<code>set_layer_visibility(self, name, visible)</code>","text":"<p>Sets the visibility of a specific layer.</p> <p>Parameters:</p> Name Type Description Default <code>name</code> <code>str</code> <p>The name of the layer.</p> required <code>visible</code> <code>bool</code> <p>Whether the layer should be visible.</p> required Source code in <code>anymap/maplibre_widgets.py</code> <pre><code>def set_layer_visibility(self, name: str, visible: bool) -&gt; None:\n    \"\"\"\n    Sets the visibility of a specific layer.\n\n    Args:\n        name (str): The name of the layer.\n        visible (bool): Whether the layer should be visible.\n    \"\"\"\n    self.m.set_visibility(name, visible)\n</code></pre>"},{"location":"maplibre_widgets/#anymap.maplibre_widgets.LayerManagerWidget.toggle_all_layers","title":"<code>toggle_all_layers(self, change)</code>","text":"<p>Toggles the visibility of all layers.</p> <p>Parameters:</p> Name Type Description Default <code>change</code> <code>Dict[str, Any]</code> <p>The change event from the master toggle checkbox.</p> required Source code in <code>anymap/maplibre_widgets.py</code> <pre><code>def toggle_all_layers(self, change: Dict[str, Any]) -&gt; None:\n    \"\"\"\n    Toggles the visibility of all layers.\n\n    Args:\n        change (Dict[str, Any]): The change event from the master toggle checkbox.\n    \"\"\"\n    if self._building:\n        return\n    for name, controls in self.layer_items.items():\n        controls[\"checkbox\"].value = change[\"new\"]\n\n    for widget in self.group_toggles.children:\n        widget.value = change[\"new\"]\n</code></pre>"},{"location":"maplibre_widgets/#anymap.maplibre_widgets.LayerManagerWidget.toggle_group_layers","title":"<code>toggle_group_layers(self, change)</code>","text":"<p>Toggles the visibility of a group of layers.</p> Source code in <code>anymap/maplibre_widgets.py</code> <pre><code>def toggle_group_layers(self, change: Dict[str, Any]) -&gt; None:\n    \"\"\"\n    Toggles the visibility of a group of layers.\n    \"\"\"\n    if self._building:\n        return\n    group_name = change[\"owner\"].description.split(\" \")[0]\n    group_layers = self.groups[group_name]\n    for layer_name in group_layers:\n        self.set_layer_visibility(layer_name, change[\"new\"])\n    self.refresh()\n</code></pre>"},{"location":"maplibre_widgets/#anymap.maplibre_widgets.LayerStyleWidget","title":"<code> LayerStyleWidget            (VBox)         </code>","text":"<p>A widget for styling map layers interactively.</p> <p>Parameters:</p> Name Type Description Default <code>layer</code> <code>dict</code> <p>The layer to style.</p> required <code>map_widget</code> <code>ipyleaflet.Map or folium.Map</code> <p>The map widget to update.</p> required <code>widget_width</code> <code>str</code> <p>The width of the widget. Defaults to \"270px\".</p> <code>'270px'</code> <code>label_width</code> <code>str</code> <p>The width of the label. Defaults to \"130px\".</p> <code>'130px'</code> Source code in <code>anymap/maplibre_widgets.py</code> <pre><code>class LayerStyleWidget(widgets.VBox):\n    \"\"\"\n    A widget for styling map layers interactively.\n\n    Args:\n        layer (dict): The layer to style.\n        map_widget (ipyleaflet.Map or folium.Map): The map widget to update.\n        widget_width (str, optional): The width of the widget. Defaults to \"270px\".\n        label_width (str, optional): The width of the label. Defaults to \"130px\".\n    \"\"\"\n\n    def __init__(\n        self,\n        layer: dict,\n        map_widget: \"MapLibreMap\",\n        widget_width: str = \"270px\",\n        label_width: str = \"130px\",\n    ):\n        super().__init__()\n        self.layer = layer\n        self.map = map_widget\n        self.layer_type = self._get_layer_type()\n        self.layer_id = layer[\"layer\"].id\n        self.layer_paint = layer[\"layer\"].paint\n        self.original_style = self._get_current_style()\n        self.widget_width = widget_width\n        self.label_width = label_width\n\n        # Create the styling widgets based on layer type\n        self.style_widgets = self._create_style_widgets()\n\n        # Create buttons\n        self.apply_btn = widgets.Button(\n            description=\"Apply\",\n            button_style=\"primary\",\n            tooltip=\"Apply style changes\",\n            layout=widgets.Layout(width=\"auto\"),\n        )\n\n        self.reset_btn = widgets.Button(\n            description=\"Reset\",\n            button_style=\"warning\",\n            tooltip=\"Reset to original style\",\n            layout=widgets.Layout(width=\"auto\"),\n        )\n\n        self.close_btn = widgets.Button(\n            description=\"Close\",\n            button_style=\"\",\n            tooltip=\"Close the widget\",\n            layout=widgets.Layout(width=\"auto\"),\n        )\n\n        self.output_widget = widgets.Output()\n\n        # Button container\n        self.button_box = widgets.HBox([self.apply_btn, self.reset_btn, self.close_btn])\n\n        # Add button callbacks\n        self.apply_btn.on_click(self._apply_style)\n        self.reset_btn.on_click(self._reset_style)\n        self.close_btn.on_click(self._close_widget)\n\n        # Layout\n        self.layout = widgets.Layout(width=\"300px\", padding=\"10px\")\n\n        # Combine all widgets\n        self.children = [*self.style_widgets, self.button_box, self.output_widget]\n\n    def _get_layer_type(self) -&gt; str:\n        \"\"\"Determine the layer type.\"\"\"\n        return self.layer[\"type\"]\n\n    def _get_current_style(self) -&gt; dict:\n        \"\"\"Get the current layer style.\"\"\"\n        return self.layer_paint\n\n    def _create_style_widgets(self) -&gt; List[widgets.Widget]:\n        \"\"\"Create style widgets based on layer type.\"\"\"\n        widgets_list = []\n\n        if self.layer_type == \"circle\":\n            widgets_list.extend(\n                [\n                    self._create_color_picker(\n                        \"Circle Color\", \"circle-color\", \"#3388ff\"\n                    ),\n                    self._create_number_slider(\n                        \"Circle Radius\", \"circle-radius\", 6, 1, 20\n                    ),\n                    self._create_number_slider(\n                        \"Circle Opacity\", \"circle-opacity\", 0.8, 0, 1, 0.05\n                    ),\n                    self._create_number_slider(\n                        \"Circle Blur\", \"circle-blur\", 0, 0, 1, 0.05\n                    ),\n                    self._create_color_picker(\n                        \"Circle Stroke Color\", \"circle-stroke-color\", \"#3388ff\"\n                    ),\n                    self._create_number_slider(\n                        \"Circle Stroke Width\", \"circle-stroke-width\", 1, 0, 5\n                    ),\n                    self._create_number_slider(\n                        \"Circle Stroke Opacity\",\n                        \"circle-stroke-opacity\",\n                        1.0,\n                        0,\n                        1,\n                        0.05,\n                    ),\n                ]\n            )\n\n        elif self.layer_type == \"line\":\n            widgets_list.extend(\n                [\n                    self._create_color_picker(\"Line Color\", \"line-color\", \"#3388ff\"),\n                    self._create_number_slider(\"Line Width\", \"line-width\", 2, 1, 10),\n                    self._create_number_slider(\n                        \"Line Opacity\", \"line-opacity\", 1.0, 0, 1, 0.05\n                    ),\n                    self._create_number_slider(\"Line Blur\", \"line-blur\", 0, 0, 1, 0.05),\n                    self._create_dropdown(\n                        \"Line Style\",\n                        \"line-dasharray\",\n                        [\n                            (\"Solid\", [1]),\n                            (\"Dashed\", [2, 4]),\n                            (\"Dotted\", [1, 4]),\n                            (\"Dash-dot\", [2, 4, 8, 4]),\n                        ],\n                    ),\n                ]\n            )\n\n        elif self.layer_type == \"fill\":\n            widgets_list.extend(\n                [\n                    self._create_color_picker(\"Fill Color\", \"fill-color\", \"#3388ff\"),\n                    self._create_number_slider(\n                        \"Fill Opacity\", \"fill-opacity\", 0.2, 0, 1, 0.05\n                    ),\n                    self._create_color_picker(\n                        \"Fill Outline Color\", \"fill-outline-color\", \"#3388ff\"\n                    ),\n                ]\n            )\n        else:\n            widgets_list.extend(\n                [widgets.HTML(value=f\"Layer type {self.layer_type} is not supported.\")]\n            )\n\n        return widgets_list\n\n    def _create_color_picker(\n        self, description: str, property_name: str, default_color: str\n    ) -&gt; widgets.ColorPicker:\n        \"\"\"Create a color picker widget.\"\"\"\n        return widgets.ColorPicker(\n            description=description,\n            value=self.original_style.get(property_name, default_color),\n            layout=widgets.Layout(\n                width=self.widget_width, description_width=self.label_width\n            ),\n            style={\"description_width\": \"initial\"},\n        )\n\n    def _create_number_slider(\n        self,\n        description: str,\n        property_name: str,\n        default_value: float,\n        min_val: float,\n        max_val: float,\n        step: float = 1,\n    ) -&gt; widgets.FloatSlider:\n        \"\"\"Create a number slider widget.\"\"\"\n        return widgets.FloatSlider(\n            description=description,\n            value=self.original_style.get(property_name, default_value),\n            min=min_val,\n            max=max_val,\n            step=step,\n            layout=widgets.Layout(\n                width=self.widget_width, description_width=self.label_width\n            ),\n            style={\"description_width\": \"initial\"},\n            continuous_update=False,\n        )\n\n    def _create_dropdown(\n        self,\n        description: str,\n        property_name: str,\n        options: List[Tuple[str, List[float]]],\n    ) -&gt; widgets.Dropdown:\n        \"\"\"Create a dropdown widget.\"\"\"\n        return widgets.Dropdown(\n            description=description,\n            options=options,\n            value=self.original_style.get(property_name, options[0][1]),\n            layout=widgets.Layout(\n                width=self.widget_width, description_width=self.label_width\n            ),\n            style={\"description_width\": \"initial\"},\n        )\n\n    def _apply_style(self, _) -&gt; None:\n        \"\"\"Apply the style changes to the layer.\"\"\"\n        new_style = {}\n\n        for widget in self.style_widgets:\n            if isinstance(widget, widgets.ColorPicker):\n                property_name = widget.description.lower().replace(\" \", \"-\")\n                new_style[property_name] = widget.value\n            elif isinstance(widget, widgets.FloatSlider):\n                property_name = widget.description.lower().replace(\" \", \"-\")\n                new_style[property_name] = widget.value\n            elif isinstance(widget, widgets.Dropdown):\n                property_name = widget.description.lower().replace(\" \", \"-\")\n                new_style[property_name] = widget.value\n\n        with self.output_widget:\n            try:\n                for key, value in new_style.items():\n                    if key == \"line-style\":\n                        key = \"line-dasharray\"\n                    self.map.set_paint_property(self.layer[\"layer\"].id, key, value)\n            except Exception as e:\n                print(e)\n\n        self.map.layer_manager.refresh()\n\n    def _reset_style(self, _) -&gt; None:\n        \"\"\"Reset to original style.\"\"\"\n\n        # Update widgets to reflect original style\n        for widget in self.style_widgets:\n            if isinstance(\n                widget, (widgets.ColorPicker, widgets.FloatSlider, widgets.Dropdown)\n            ):\n                property_name = widget.description.lower().replace(\" \", \"-\")\n                if property_name in self.original_style:\n                    widget.value = self.original_style[property_name]\n\n    def _close_widget(self, _) -&gt; None:\n        \"\"\"Close the widget.\"\"\"\n        # self.close()\n        self.map.remove_from_sidebar(name=f\"Style {self.layer['layer'].id}\")\n</code></pre>"},{"location":"openlayers/","title":"openlayers module","text":"<p>OpenLayers implementation of the map widget.</p>"},{"location":"openlayers/#anymap.openlayers.OpenLayersMap","title":"<code> OpenLayersMap            (MapWidget)         </code>","text":"<p>OpenLayers implementation of the map widget.</p> Source code in <code>anymap/openlayers.py</code> <pre><code>class OpenLayersMap(MapWidget):\n    \"\"\"OpenLayers implementation of the map widget.\"\"\"\n\n    # OpenLayers-specific traits\n    tile_layer = traitlets.Unicode(\"OSM\").tag(sync=True)\n    projection = traitlets.Unicode(\"EPSG:3857\").tag(sync=True)\n\n    # Define the JavaScript module path\n    _esm = _esm_openlayers\n    _css = _css_openlayers\n\n    def __init__(\n        self,\n        center: List[float] = [0.0, 0.0],\n        zoom: float = 2.0,\n        tile_layer: str = \"OSM\",\n        projection: str = \"EPSG:3857\",\n        width: str = \"100%\",\n        height: str = \"600px\",\n        **kwargs,\n    ):\n        \"\"\"Initialize OpenLayers map widget.\n\n        Args:\n            center: Map center as [longitude, latitude] (note: OpenLayers uses lon/lat order)\n            zoom: Initial zoom level\n            tile_layer: Tile layer provider name or URL template\n            projection: Map projection (default: EPSG:3857)\n            width: Widget width\n            height: Widget height\n            **kwargs: Additional widget arguments\n        \"\"\"\n        super().__init__(\n            center=center,\n            zoom=zoom,\n            width=width,\n            height=height,\n            **kwargs,\n        )\n        self.tile_layer = tile_layer\n        self.projection = projection\n\n    def add_tile_layer(\n        self,\n        url_template: str,\n        attribution: str = \"\",\n        layer_id: str = None,\n        **options,\n    ) -&gt; None:\n        \"\"\"Add a tile layer to the map.\n\n        Args:\n            url_template: URL template for the tile layer\n            attribution: Attribution text for the layer\n            layer_id: Unique identifier for the layer\n            **options: Additional layer options\n        \"\"\"\n        if layer_id is None:\n            layer_id = f\"tile_layer_{len(self._layers)}\"\n\n        layer_config = {\n            \"type\": \"tile\",\n            \"url\": url_template,\n            \"attribution\": attribution,\n            **options,\n        }\n        self.add_layer(layer_id, layer_config)\n\n    def add_marker(\n        self,\n        coordinate: List[float],\n        popup: str = \"\",\n        tooltip: str = \"\",\n        icon: Optional[Dict[str, Any]] = None,\n        **options,\n    ) -&gt; str:\n        \"\"\"Add a marker to the map.\n\n        Args:\n            coordinate: Marker position as [longitude, latitude]\n            popup: Popup text\n            tooltip: Tooltip text\n            icon: Icon configuration\n            **options: Additional marker options\n\n        Returns:\n            Marker ID\n        \"\"\"\n        marker_id = f\"marker_{len(self._layers)}\"\n\n        marker_config = {\n            \"type\": \"marker\",\n            \"coordinate\": coordinate,\n            \"popup\": popup,\n            \"tooltip\": tooltip,\n            **options,\n        }\n\n        if icon:\n            marker_config[\"icon\"] = icon\n\n        self.add_layer(marker_id, marker_config)\n        return marker_id\n\n    def add_circle(\n        self,\n        center: List[float],\n        radius: float,\n        color: str = \"blue\",\n        fillColor: str = \"blue\",\n        fillOpacity: float = 0.2,\n        strokeWidth: float = 2,\n        **options,\n    ) -&gt; str:\n        \"\"\"Add a circle to the map.\n\n        Args:\n            center: Circle center as [longitude, latitude]\n            radius: Circle radius in meters\n            color: Circle stroke color\n            fillColor: Circle fill color\n            fillOpacity: Circle fill opacity\n            strokeWidth: Circle stroke width\n            **options: Additional circle options\n\n        Returns:\n            Circle ID\n        \"\"\"\n        circle_id = f\"circle_{len(self._layers)}\"\n\n        circle_config = {\n            \"type\": \"circle\",\n            \"center\": center,\n            \"radius\": radius,\n            \"color\": color,\n            \"fillColor\": fillColor,\n            \"fillOpacity\": fillOpacity,\n            \"strokeWidth\": strokeWidth,\n            **options,\n        }\n\n        self.add_layer(circle_id, circle_config)\n        return circle_id\n\n    def add_polygon(\n        self,\n        coordinates: List[List[List[float]]],\n        color: str = \"blue\",\n        fillColor: str = \"blue\",\n        fillOpacity: float = 0.2,\n        strokeWidth: float = 2,\n        **options,\n    ) -&gt; str:\n        \"\"\"Add a polygon to the map.\n\n        Args:\n            coordinates: Polygon coordinates as [[[lon, lat], [lon, lat], ...]]\n            color: Polygon stroke color\n            fillColor: Polygon fill color\n            fillOpacity: Polygon fill opacity\n            strokeWidth: Polygon stroke width\n            **options: Additional polygon options\n\n        Returns:\n            Polygon ID\n        \"\"\"\n        polygon_id = f\"polygon_{len(self._layers)}\"\n\n        polygon_config = {\n            \"type\": \"polygon\",\n            \"coordinates\": coordinates,\n            \"color\": color,\n            \"fillColor\": fillColor,\n            \"fillOpacity\": fillOpacity,\n            \"strokeWidth\": strokeWidth,\n            **options,\n        }\n\n        self.add_layer(polygon_id, polygon_config)\n        return polygon_id\n\n    def add_linestring(\n        self,\n        coordinates: List[List[float]],\n        color: str = \"blue\",\n        strokeWidth: float = 3,\n        **options,\n    ) -&gt; str:\n        \"\"\"Add a line string to the map.\n\n        Args:\n            coordinates: Line coordinates as [[lon, lat], [lon, lat], ...]\n            color: Line color\n            strokeWidth: Line stroke width\n            **options: Additional line options\n\n        Returns:\n            LineString ID\n        \"\"\"\n        linestring_id = f\"linestring_{len(self._layers)}\"\n\n        linestring_config = {\n            \"type\": \"linestring\",\n            \"coordinates\": coordinates,\n            \"color\": color,\n            \"strokeWidth\": strokeWidth,\n            **options,\n        }\n\n        self.add_layer(linestring_id, linestring_config)\n        return linestring_id\n\n    def add_geojson(\n        self,\n        data: Union[str, Dict[str, Any]],\n        style: Optional[Dict[str, Any]] = None,\n        **options,\n    ) -&gt; str:\n        \"\"\"Add GeoJSON data to the map.\n\n        Args:\n            data: GeoJSON data as string or dict\n            style: Style configuration\n            **options: Additional GeoJSON options\n\n        Returns:\n            GeoJSON layer ID\n        \"\"\"\n        geojson_id = f\"geojson_{len(self._layers)}\"\n\n        geojson_config = {\n            \"type\": \"geojson\",\n            \"data\": data,\n            **options,\n        }\n\n        if style:\n            geojson_config[\"style\"] = style\n\n        self.add_layer(geojson_id, geojson_config)\n        return geojson_id\n\n    def add_vector_layer(\n        self,\n        features: List[Dict[str, Any]],\n        style: Optional[Dict[str, Any]] = None,\n        layer_id: str = None,\n        **options,\n    ) -&gt; str:\n        \"\"\"Add a vector layer with features.\n\n        Args:\n            features: List of feature objects\n            style: Style configuration for the layer\n            layer_id: Unique identifier for the layer\n            **options: Additional layer options\n\n        Returns:\n            Vector layer ID\n        \"\"\"\n        if layer_id is None:\n            layer_id = f\"vector_{len(self._layers)}\"\n\n        layer_config = {\n            \"type\": \"vector\",\n            \"features\": features,\n            \"style\": style or {},\n            **options,\n        }\n\n        self.add_layer(layer_id, layer_config)\n        return layer_id\n\n    def fit_extent(self, extent: List[float]) -&gt; None:\n        \"\"\"Fit the map view to given extent.\n\n        Args:\n            extent: Extent as [minX, minY, maxX, maxY]\n        \"\"\"\n        self.call_js_method(\"fitExtent\", extent)\n\n    def transform_coordinate(\n        self, coordinate: List[float], from_proj: str, to_proj: str\n    ) -&gt; List[float]:\n        \"\"\"Transform coordinate from one projection to another.\n\n        Args:\n            coordinate: Coordinate as [x, y]\n            from_proj: Source projection\n            to_proj: Target projection\n\n        Returns:\n            Transformed coordinate\n        \"\"\"\n        # This would typically be handled on the JavaScript side\n        self.call_js_method(\"transformCoordinate\", coordinate, from_proj, to_proj)\n        return coordinate  # Placeholder - real transformation happens in JS\n\n    def _generate_html_template(\n        self, map_state: Dict[str, Any], title: str, **kwargs\n    ) -&gt; str:\n        \"\"\"Generate the HTML template with map state for OpenLayers.\"\"\"\n\n        # Get tile layer URL template\n        tile_providers = {\n            \"OSM\": \"https://tile.openstreetmap.org/{z}/{x}/{y}.png\",\n            \"CartoDB.Positron\": \"https://cartodb-basemaps-{s}.global.ssl.fastly.net/light_all/{z}/{x}/{y}.png\",\n            \"CartoDB.DarkMatter\": \"https://cartodb-basemaps-{s}.global.ssl.fastly.net/dark_all/{z}/{x}/{y}.png\",\n            \"Stamen.Terrain\": \"https://stamen-tiles-{s}.a.ssl.fastly.net/terrain/{z}/{x}/{y}.jpg\",\n            \"Stamen.Watercolor\": \"https://stamen-tiles-{s}.a.ssl.fastly.net/watercolor/{z}/{x}/{y}.jpg\",\n        }\n\n        tile_url = tile_providers.get(map_state.get(\"tile_layer\", \"OSM\"))\n        if not tile_url:\n            tile_url = map_state.get(\"tile_layer\", tile_providers[\"OSM\"])\n\n        html_template = f\"\"\"&lt;!DOCTYPE html&gt;\n&lt;html&gt;\n&lt;head&gt;\n    &lt;title&gt;{title}&lt;/title&gt;\n    &lt;meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\"&gt;\n    &lt;link rel=\"stylesheet\" href=\"https://cdn.jsdelivr.net/npm/ol@v10.6.1/ol.css\"\n          crossorigin=\"\"/&gt;\n    &lt;style&gt;\n        body {{\n            margin: 0;\n            padding: 0;\n            font-family: Arial, sans-serif;\n        }}\n        #map {{\n            width: {map_state.get('width', '100%')};\n            height: {map_state.get('height', '600px')};\n        }}\n        .ol-popup {{\n            position: absolute;\n            background-color: white;\n            box-shadow: 0 1px 4px rgba(0,0,0,0.2);\n            padding: 15px;\n            border-radius: 10px;\n            border: 1px solid #cccccc;\n            bottom: 12px;\n            left: -50px;\n            min-width: 280px;\n        }}\n        .ol-popup:after, .ol-popup:before {{\n            top: 100%;\n            border: solid transparent;\n            content: \" \";\n            height: 0;\n            width: 0;\n            position: absolute;\n            pointer-events: none;\n        }}\n        .ol-popup:after {{\n            border-color: rgba(255, 255, 255, 0);\n            border-top-color: white;\n            border-width: 10px;\n            left: 48px;\n            margin-left: -10px;\n        }}\n        .ol-popup:before {{\n            border-color: rgba(204, 204, 204, 0);\n            border-top-color: #cccccc;\n            border-width: 11px;\n            left: 48px;\n            margin-left: -11px;\n        }}\n        .ol-popup-closer {{\n            text-decoration: none;\n            position: absolute;\n            top: 2px;\n            right: 8px;\n        }}\n        .ol-popup-closer:after {{\n            content: \"\u2716\";\n        }}\n    &lt;/style&gt;\n&lt;/head&gt;\n&lt;body&gt;\n    &lt;div id=\"map\"&gt;&lt;/div&gt;\n    &lt;div id=\"popup\" class=\"ol-popup\"&gt;\n        &lt;a href=\"#\" id=\"popup-closer\" class=\"ol-popup-closer\"&gt;&lt;/a&gt;\n        &lt;div id=\"popup-content\"&gt;&lt;/div&gt;\n    &lt;/div&gt;\n\n    &lt;script src=\"https://cdn.jsdelivr.net/npm/ol@v10.6.1/dist/ol.js\"\n            crossorigin=\"\"&gt;&lt;/script&gt;\n    &lt;script&gt;\n        // Import OpenLayers modules\n        const {{Map, View}} = ol;\n        const {{Tile: TileLayer, Vector: VectorLayer}} = ol.layer;\n        const {{OSM, XYZ, Vector: VectorSource}} = ol.source;\n        const {{Feature}} = ol;\n        const {{Point, Circle: CircleGeom, Polygon, LineString}} = ol.geom;\n        const {{Style, Fill, Stroke, Icon, Circle: CircleStyle}} = ol.style;\n        const {{fromLonLat, toLonLat}} = ol.proj;\n        const {{Overlay}} = ol;\n        const {{GeoJSON}} = ol.format;\n\n        // Initialize the map\n        const view = new View({{\n            center: fromLonLat({map_state.get('center', [0, 0])}),\n            zoom: {map_state.get('zoom', 2)},\n            projection: '{map_state.get('projection', 'EPSG:3857')}'\n        }});\n\n        const map = new Map({{\n            target: 'map',\n            view: view\n        }});\n\n        // Add base tile layer\n        let baseSource;\n        if ('{map_state.get('tile_layer', 'OSM')}' === 'OSM') {{\n            baseSource = new OSM();\n        }} else {{\n            baseSource = new XYZ({{\n                url: '{tile_url}',\n                attributions: '\u00a9 Map data providers'\n            }});\n        }}\n        const baseLayer = new TileLayer({{\n            source: baseSource\n        }});\n        map.addLayer(baseLayer);\n\n        // Setup popup\n        const container = document.getElementById('popup');\n        const content = document.getElementById('popup-content');\n        const closer = document.getElementById('popup-closer');\n\n        const overlay = new Overlay({{\n            element: container,\n            autoPan: {{\n                animation: {{\n                    duration: 250,\n                }}\n            }}\n        }});\n        map.addOverlay(overlay);\n\n        closer.onclick = function() {{\n            overlay.setPosition(undefined);\n            closer.blur();\n            return false;\n        }};\n\n        // Add layers\n        const layers = {json.dumps(map_state.get('_layers', {}))};\n        for (const layerId in layers) {{\n            const layer = layers[layerId];\n            let olLayer = null;\n\n            if (layer.type === 'tile') {{\n                olLayer = new TileLayer({{\n                    source: new XYZ({{\n                        url: layer.url,\n                        attributions: layer.attribution || ''\n                    }})\n                }});\n            }} else if (layer.type === 'marker') {{\n                const feature = new Feature({{\n                    geometry: new Point(fromLonLat(layer.coordinate))\n                }});\n\n                if (layer.popup) {{\n                    feature.set('popup', layer.popup);\n                }}\n\n                const vectorSource = new VectorSource({{\n                    features: [feature]\n                }});\n\n                olLayer = new VectorLayer({{\n                    source: vectorSource,\n                    style: new Style({{\n                        image: new CircleStyle({{\n                            radius: 8,\n                            fill: new Fill({{color: 'red'}}),\n                            stroke: new Stroke({{color: 'white', width: 2}})\n                        }})\n                    }})\n                }});\n            }} else if (layer.type === 'circle') {{\n                const feature = new Feature({{\n                    geometry: new CircleGeom(fromLonLat(layer.center), layer.radius)\n                }});\n\n                const vectorSource = new VectorSource({{\n                    features: [feature]\n                }});\n\n                olLayer = new VectorLayer({{\n                    source: vectorSource,\n                    style: new Style({{\n                        fill: new Fill({{\n                            color: layer.fillColor || 'blue',\n                            opacity: layer.fillOpacity || 0.2\n                        }}),\n                        stroke: new Stroke({{\n                            color: layer.color || 'blue',\n                            width: layer.strokeWidth || 2\n                        }})\n                    }})\n                }});\n            }} else if (layer.type === 'polygon') {{\n                const feature = new Feature({{\n                    geometry: new Polygon(layer.coordinates.map(ring =&gt;\n                        ring.map(coord =&gt; fromLonLat(coord))\n                    ))\n                }});\n\n                const vectorSource = new VectorSource({{\n                    features: [feature]\n                }});\n\n                olLayer = new VectorLayer({{\n                    source: vectorSource,\n                    style: new Style({{\n                        fill: new Fill({{\n                            color: layer.fillColor || 'blue',\n                            opacity: layer.fillOpacity || 0.2\n                        }}),\n                        stroke: new Stroke({{\n                            color: layer.color || 'blue',\n                            width: layer.strokeWidth || 2\n                        }})\n                    }})\n                }});\n            }} else if (layer.type === 'linestring') {{\n                const feature = new Feature({{\n                    geometry: new LineString(layer.coordinates.map(coord =&gt; fromLonLat(coord)))\n                }});\n\n                const vectorSource = new VectorSource({{\n                    features: [feature]\n                }});\n\n                olLayer = new VectorLayer({{\n                    source: vectorSource,\n                    style: new Style({{\n                        stroke: new Stroke({{\n                            color: layer.color || 'blue',\n                            width: layer.strokeWidth || 3\n                        }})\n                    }})\n                }});\n            }} else if (layer.type === 'geojson') {{\n                const vectorSource = new VectorSource({{\n                    features: new GeoJSON().readFeatures(layer.data, {{\n                        featureProjection: 'EPSG:3857'\n                    }})\n                }});\n\n                olLayer = new VectorLayer({{\n                    source: vectorSource\n                }});\n            }}\n\n            if (olLayer) {{\n                map.addLayer(olLayer);\n            }}\n        }}\n\n        // Handle map clicks for popups\n        map.on('singleclick', function(evt) {{\n            const feature = map.forEachFeatureAtPixel(evt.pixel, function(feature) {{\n                return feature;\n            }});\n\n            if (feature &amp;&amp; feature.get('popup')) {{\n                const coordinate = evt.coordinate;\n                content.innerHTML = feature.get('popup');\n                overlay.setPosition(coordinate);\n            }} else {{\n                overlay.setPosition(undefined);\n            }}\n        }});\n    &lt;/script&gt;\n&lt;/body&gt;\n&lt;/html&gt;\"\"\"\n        return html_template\n</code></pre>"},{"location":"openlayers/#anymap.openlayers.OpenLayersMap.__init__","title":"<code>__init__(self, center=[0.0, 0.0], zoom=2.0, tile_layer='OSM', projection='EPSG:3857', width='100%', height='600px', **kwargs)</code>  <code>special</code>","text":"<p>Initialize OpenLayers map widget.</p> <p>Parameters:</p> Name Type Description Default <code>center</code> <code>List[float]</code> <p>Map center as [longitude, latitude] (note: OpenLayers uses lon/lat order)</p> <code>[0.0, 0.0]</code> <code>zoom</code> <code>float</code> <p>Initial zoom level</p> <code>2.0</code> <code>tile_layer</code> <code>str</code> <p>Tile layer provider name or URL template</p> <code>'OSM'</code> <code>projection</code> <code>str</code> <p>Map projection (default: EPSG:3857)</p> <code>'EPSG:3857'</code> <code>width</code> <code>str</code> <p>Widget width</p> <code>'100%'</code> <code>height</code> <code>str</code> <p>Widget height</p> <code>'600px'</code> <code>**kwargs</code> <p>Additional widget arguments</p> <code>{}</code> Source code in <code>anymap/openlayers.py</code> <pre><code>def __init__(\n    self,\n    center: List[float] = [0.0, 0.0],\n    zoom: float = 2.0,\n    tile_layer: str = \"OSM\",\n    projection: str = \"EPSG:3857\",\n    width: str = \"100%\",\n    height: str = \"600px\",\n    **kwargs,\n):\n    \"\"\"Initialize OpenLayers map widget.\n\n    Args:\n        center: Map center as [longitude, latitude] (note: OpenLayers uses lon/lat order)\n        zoom: Initial zoom level\n        tile_layer: Tile layer provider name or URL template\n        projection: Map projection (default: EPSG:3857)\n        width: Widget width\n        height: Widget height\n        **kwargs: Additional widget arguments\n    \"\"\"\n    super().__init__(\n        center=center,\n        zoom=zoom,\n        width=width,\n        height=height,\n        **kwargs,\n    )\n    self.tile_layer = tile_layer\n    self.projection = projection\n</code></pre>"},{"location":"openlayers/#anymap.openlayers.OpenLayersMap.add_circle","title":"<code>add_circle(self, center, radius, color='blue', fillColor='blue', fillOpacity=0.2, strokeWidth=2, **options)</code>","text":"<p>Add a circle to the map.</p> <p>Parameters:</p> Name Type Description Default <code>center</code> <code>List[float]</code> <p>Circle center as [longitude, latitude]</p> required <code>radius</code> <code>float</code> <p>Circle radius in meters</p> required <code>color</code> <code>str</code> <p>Circle stroke color</p> <code>'blue'</code> <code>fillColor</code> <code>str</code> <p>Circle fill color</p> <code>'blue'</code> <code>fillOpacity</code> <code>float</code> <p>Circle fill opacity</p> <code>0.2</code> <code>strokeWidth</code> <code>float</code> <p>Circle stroke width</p> <code>2</code> <code>**options</code> <p>Additional circle options</p> <code>{}</code> <p>Returns:</p> Type Description <code>str</code> <p>Circle ID</p> Source code in <code>anymap/openlayers.py</code> <pre><code>def add_circle(\n    self,\n    center: List[float],\n    radius: float,\n    color: str = \"blue\",\n    fillColor: str = \"blue\",\n    fillOpacity: float = 0.2,\n    strokeWidth: float = 2,\n    **options,\n) -&gt; str:\n    \"\"\"Add a circle to the map.\n\n    Args:\n        center: Circle center as [longitude, latitude]\n        radius: Circle radius in meters\n        color: Circle stroke color\n        fillColor: Circle fill color\n        fillOpacity: Circle fill opacity\n        strokeWidth: Circle stroke width\n        **options: Additional circle options\n\n    Returns:\n        Circle ID\n    \"\"\"\n    circle_id = f\"circle_{len(self._layers)}\"\n\n    circle_config = {\n        \"type\": \"circle\",\n        \"center\": center,\n        \"radius\": radius,\n        \"color\": color,\n        \"fillColor\": fillColor,\n        \"fillOpacity\": fillOpacity,\n        \"strokeWidth\": strokeWidth,\n        **options,\n    }\n\n    self.add_layer(circle_id, circle_config)\n    return circle_id\n</code></pre>"},{"location":"openlayers/#anymap.openlayers.OpenLayersMap.add_geojson","title":"<code>add_geojson(self, data, style=None, **options)</code>","text":"<p>Add GeoJSON data to the map.</p> <p>Parameters:</p> Name Type Description Default <code>data</code> <code>Union[str, Dict[str, Any]]</code> <p>GeoJSON data as string or dict</p> required <code>style</code> <code>Optional[Dict[str, Any]]</code> <p>Style configuration</p> <code>None</code> <code>**options</code> <p>Additional GeoJSON options</p> <code>{}</code> <p>Returns:</p> Type Description <code>str</code> <p>GeoJSON layer ID</p> Source code in <code>anymap/openlayers.py</code> <pre><code>def add_geojson(\n    self,\n    data: Union[str, Dict[str, Any]],\n    style: Optional[Dict[str, Any]] = None,\n    **options,\n) -&gt; str:\n    \"\"\"Add GeoJSON data to the map.\n\n    Args:\n        data: GeoJSON data as string or dict\n        style: Style configuration\n        **options: Additional GeoJSON options\n\n    Returns:\n        GeoJSON layer ID\n    \"\"\"\n    geojson_id = f\"geojson_{len(self._layers)}\"\n\n    geojson_config = {\n        \"type\": \"geojson\",\n        \"data\": data,\n        **options,\n    }\n\n    if style:\n        geojson_config[\"style\"] = style\n\n    self.add_layer(geojson_id, geojson_config)\n    return geojson_id\n</code></pre>"},{"location":"openlayers/#anymap.openlayers.OpenLayersMap.add_linestring","title":"<code>add_linestring(self, coordinates, color='blue', strokeWidth=3, **options)</code>","text":"<p>Add a line string to the map.</p> <p>Parameters:</p> Name Type Description Default <code>coordinates</code> <code>List[List[float]]</code> <p>Line coordinates as [[lon, lat], [lon, lat], ...]</p> required <code>color</code> <code>str</code> <p>Line color</p> <code>'blue'</code> <code>strokeWidth</code> <code>float</code> <p>Line stroke width</p> <code>3</code> <code>**options</code> <p>Additional line options</p> <code>{}</code> <p>Returns:</p> Type Description <code>str</code> <p>LineString ID</p> Source code in <code>anymap/openlayers.py</code> <pre><code>def add_linestring(\n    self,\n    coordinates: List[List[float]],\n    color: str = \"blue\",\n    strokeWidth: float = 3,\n    **options,\n) -&gt; str:\n    \"\"\"Add a line string to the map.\n\n    Args:\n        coordinates: Line coordinates as [[lon, lat], [lon, lat], ...]\n        color: Line color\n        strokeWidth: Line stroke width\n        **options: Additional line options\n\n    Returns:\n        LineString ID\n    \"\"\"\n    linestring_id = f\"linestring_{len(self._layers)}\"\n\n    linestring_config = {\n        \"type\": \"linestring\",\n        \"coordinates\": coordinates,\n        \"color\": color,\n        \"strokeWidth\": strokeWidth,\n        **options,\n    }\n\n    self.add_layer(linestring_id, linestring_config)\n    return linestring_id\n</code></pre>"},{"location":"openlayers/#anymap.openlayers.OpenLayersMap.add_marker","title":"<code>add_marker(self, coordinate, popup='', tooltip='', icon=None, **options)</code>","text":"<p>Add a marker to the map.</p> <p>Parameters:</p> Name Type Description Default <code>coordinate</code> <code>List[float]</code> <p>Marker position as [longitude, latitude]</p> required <code>popup</code> <code>str</code> <p>Popup text</p> <code>''</code> <code>tooltip</code> <code>str</code> <p>Tooltip text</p> <code>''</code> <code>icon</code> <code>Optional[Dict[str, Any]]</code> <p>Icon configuration</p> <code>None</code> <code>**options</code> <p>Additional marker options</p> <code>{}</code> <p>Returns:</p> Type Description <code>str</code> <p>Marker ID</p> Source code in <code>anymap/openlayers.py</code> <pre><code>def add_marker(\n    self,\n    coordinate: List[float],\n    popup: str = \"\",\n    tooltip: str = \"\",\n    icon: Optional[Dict[str, Any]] = None,\n    **options,\n) -&gt; str:\n    \"\"\"Add a marker to the map.\n\n    Args:\n        coordinate: Marker position as [longitude, latitude]\n        popup: Popup text\n        tooltip: Tooltip text\n        icon: Icon configuration\n        **options: Additional marker options\n\n    Returns:\n        Marker ID\n    \"\"\"\n    marker_id = f\"marker_{len(self._layers)}\"\n\n    marker_config = {\n        \"type\": \"marker\",\n        \"coordinate\": coordinate,\n        \"popup\": popup,\n        \"tooltip\": tooltip,\n        **options,\n    }\n\n    if icon:\n        marker_config[\"icon\"] = icon\n\n    self.add_layer(marker_id, marker_config)\n    return marker_id\n</code></pre>"},{"location":"openlayers/#anymap.openlayers.OpenLayersMap.add_polygon","title":"<code>add_polygon(self, coordinates, color='blue', fillColor='blue', fillOpacity=0.2, strokeWidth=2, **options)</code>","text":"<p>Add a polygon to the map.</p> <p>Parameters:</p> Name Type Description Default <code>coordinates</code> <code>List[List[List[float]]]</code> <p>Polygon coordinates as [[[lon, lat], [lon, lat], ...]]</p> required <code>color</code> <code>str</code> <p>Polygon stroke color</p> <code>'blue'</code> <code>fillColor</code> <code>str</code> <p>Polygon fill color</p> <code>'blue'</code> <code>fillOpacity</code> <code>float</code> <p>Polygon fill opacity</p> <code>0.2</code> <code>strokeWidth</code> <code>float</code> <p>Polygon stroke width</p> <code>2</code> <code>**options</code> <p>Additional polygon options</p> <code>{}</code> <p>Returns:</p> Type Description <code>str</code> <p>Polygon ID</p> Source code in <code>anymap/openlayers.py</code> <pre><code>def add_polygon(\n    self,\n    coordinates: List[List[List[float]]],\n    color: str = \"blue\",\n    fillColor: str = \"blue\",\n    fillOpacity: float = 0.2,\n    strokeWidth: float = 2,\n    **options,\n) -&gt; str:\n    \"\"\"Add a polygon to the map.\n\n    Args:\n        coordinates: Polygon coordinates as [[[lon, lat], [lon, lat], ...]]\n        color: Polygon stroke color\n        fillColor: Polygon fill color\n        fillOpacity: Polygon fill opacity\n        strokeWidth: Polygon stroke width\n        **options: Additional polygon options\n\n    Returns:\n        Polygon ID\n    \"\"\"\n    polygon_id = f\"polygon_{len(self._layers)}\"\n\n    polygon_config = {\n        \"type\": \"polygon\",\n        \"coordinates\": coordinates,\n        \"color\": color,\n        \"fillColor\": fillColor,\n        \"fillOpacity\": fillOpacity,\n        \"strokeWidth\": strokeWidth,\n        **options,\n    }\n\n    self.add_layer(polygon_id, polygon_config)\n    return polygon_id\n</code></pre>"},{"location":"openlayers/#anymap.openlayers.OpenLayersMap.add_tile_layer","title":"<code>add_tile_layer(self, url_template, attribution='', layer_id=None, **options)</code>","text":"<p>Add a tile layer to the map.</p> <p>Parameters:</p> Name Type Description Default <code>url_template</code> <code>str</code> <p>URL template for the tile layer</p> required <code>attribution</code> <code>str</code> <p>Attribution text for the layer</p> <code>''</code> <code>layer_id</code> <code>str</code> <p>Unique identifier for the layer</p> <code>None</code> <code>**options</code> <p>Additional layer options</p> <code>{}</code> Source code in <code>anymap/openlayers.py</code> <pre><code>def add_tile_layer(\n    self,\n    url_template: str,\n    attribution: str = \"\",\n    layer_id: str = None,\n    **options,\n) -&gt; None:\n    \"\"\"Add a tile layer to the map.\n\n    Args:\n        url_template: URL template for the tile layer\n        attribution: Attribution text for the layer\n        layer_id: Unique identifier for the layer\n        **options: Additional layer options\n    \"\"\"\n    if layer_id is None:\n        layer_id = f\"tile_layer_{len(self._layers)}\"\n\n    layer_config = {\n        \"type\": \"tile\",\n        \"url\": url_template,\n        \"attribution\": attribution,\n        **options,\n    }\n    self.add_layer(layer_id, layer_config)\n</code></pre>"},{"location":"openlayers/#anymap.openlayers.OpenLayersMap.add_vector_layer","title":"<code>add_vector_layer(self, features, style=None, layer_id=None, **options)</code>","text":"<p>Add a vector layer with features.</p> <p>Parameters:</p> Name Type Description Default <code>features</code> <code>List[Dict[str, Any]]</code> <p>List of feature objects</p> required <code>style</code> <code>Optional[Dict[str, Any]]</code> <p>Style configuration for the layer</p> <code>None</code> <code>layer_id</code> <code>str</code> <p>Unique identifier for the layer</p> <code>None</code> <code>**options</code> <p>Additional layer options</p> <code>{}</code> <p>Returns:</p> Type Description <code>str</code> <p>Vector layer ID</p> Source code in <code>anymap/openlayers.py</code> <pre><code>def add_vector_layer(\n    self,\n    features: List[Dict[str, Any]],\n    style: Optional[Dict[str, Any]] = None,\n    layer_id: str = None,\n    **options,\n) -&gt; str:\n    \"\"\"Add a vector layer with features.\n\n    Args:\n        features: List of feature objects\n        style: Style configuration for the layer\n        layer_id: Unique identifier for the layer\n        **options: Additional layer options\n\n    Returns:\n        Vector layer ID\n    \"\"\"\n    if layer_id is None:\n        layer_id = f\"vector_{len(self._layers)}\"\n\n    layer_config = {\n        \"type\": \"vector\",\n        \"features\": features,\n        \"style\": style or {},\n        **options,\n    }\n\n    self.add_layer(layer_id, layer_config)\n    return layer_id\n</code></pre>"},{"location":"openlayers/#anymap.openlayers.OpenLayersMap.fit_extent","title":"<code>fit_extent(self, extent)</code>","text":"<p>Fit the map view to given extent.</p> <p>Parameters:</p> Name Type Description Default <code>extent</code> <code>List[float]</code> <p>Extent as [minX, minY, maxX, maxY]</p> required Source code in <code>anymap/openlayers.py</code> <pre><code>def fit_extent(self, extent: List[float]) -&gt; None:\n    \"\"\"Fit the map view to given extent.\n\n    Args:\n        extent: Extent as [minX, minY, maxX, maxY]\n    \"\"\"\n    self.call_js_method(\"fitExtent\", extent)\n</code></pre>"},{"location":"openlayers/#anymap.openlayers.OpenLayersMap.transform_coordinate","title":"<code>transform_coordinate(self, coordinate, from_proj, to_proj)</code>","text":"<p>Transform coordinate from one projection to another.</p> <p>Parameters:</p> Name Type Description Default <code>coordinate</code> <code>List[float]</code> <p>Coordinate as [x, y]</p> required <code>from_proj</code> <code>str</code> <p>Source projection</p> required <code>to_proj</code> <code>str</code> <p>Target projection</p> required <p>Returns:</p> Type Description <code>List[float]</code> <p>Transformed coordinate</p> Source code in <code>anymap/openlayers.py</code> <pre><code>def transform_coordinate(\n    self, coordinate: List[float], from_proj: str, to_proj: str\n) -&gt; List[float]:\n    \"\"\"Transform coordinate from one projection to another.\n\n    Args:\n        coordinate: Coordinate as [x, y]\n        from_proj: Source projection\n        to_proj: Target projection\n\n    Returns:\n        Transformed coordinate\n    \"\"\"\n    # This would typically be handled on the JavaScript side\n    self.call_js_method(\"transformCoordinate\", coordinate, from_proj, to_proj)\n    return coordinate  # Placeholder - real transformation happens in JS\n</code></pre>"},{"location":"potree/","title":"potree module","text":"<p>Potree point cloud viewer implementation of the map widget.</p>"},{"location":"potree/#anymap.potree.PotreeMap","title":"<code> PotreeMap            (MapWidget)         </code>","text":"<p>Potree point cloud viewer implementation of the map widget.</p> Source code in <code>anymap/potree.py</code> <pre><code>class PotreeMap(MapWidget):\n    \"\"\"Potree point cloud viewer implementation of the map widget.\"\"\"\n\n    # Potree-specific traits\n\n    # Appearance\n    point_budget = traitlets.Int(1_000_000).tag(sync=True)\n    fov = traitlets.Float(60.0).tag(sync=True)\n    background = traitlets.Enum(\n        values=[\"skybox\", \"gradient\", \"black\", \"white\", \"none\"],\n        default_value=\"gradient\",\n    ).tag(sync=True)\n\n    # Appearance: Eye-Dome Lighting\n    edl_enabled = traitlets.Bool(True).tag(sync=True)\n    edl_radius = traitlets.Float(1.4).tag(sync=True)\n    edl_strength = traitlets.Float(0.4).tag(sync=True)\n    edl_opacity = traitlets.Float(1.0).tag(sync=True)\n\n    description = traitlets.Unicode(\"\").tag(sync=True)\n    point_cloud_url = traitlets.Unicode(\"\").tag(sync=True)\n    point_size = traitlets.Float(1.0).tag(sync=True)\n    point_size_type = traitlets.Unicode(\"adaptive\").tag(\n        sync=True\n    )  # \"fixed\", \"adaptive\", \"attenuation\"\n    point_shape = traitlets.Unicode(\"square\").tag(sync=True)  # \"square\", \"circle\"\n    min_node_size = traitlets.Float(100.0).tag(sync=True)\n    show_grid = traitlets.Bool(False).tag(sync=True)\n    grid_size = traitlets.Float(10.0).tag(sync=True)\n    grid_color = traitlets.Unicode(\"#aaaaaa\").tag(sync=True)\n    background_color = traitlets.Unicode(\"#000000\").tag(sync=True)\n\n    # Camera controls\n    camera_position = traitlets.List([0.0, 0.0, 10.0]).tag(sync=True)\n    camera_target = traitlets.List([0.0, 0.0, 0.0]).tag(sync=True)\n    near_clip = traitlets.Float(0.1).tag(sync=True)\n    far_clip = traitlets.Float(1000.0).tag(sync=True)\n\n    # Define the JavaScript module path\n    _esm = _esm_potree\n    _css = _css_potree\n\n    POTREE_LIBS_DIR = traitlets.Unicode(read_only=True).tag(sync=True)\n\n    def __init__(\n        self,\n        point_cloud_url: str = \"\",\n        width: str = \"100%\",\n        height: str = \"600px\",\n        point_budget: int = 1_000_000,\n        point_size: float = 1.0,\n        point_size_type: str = \"adaptive\",\n        point_shape: str = \"square\",\n        camera_position: List[float] = [0.0, 0.0, 10.0],\n        camera_target: List[float] = [0.0, 0.0, 0.0],\n        fov: float = 60.0,\n        background_color: str = \"#000000\",\n        edl_enabled: bool = True,\n        show_grid: bool = False,\n        quiet: bool = False,\n        **kwargs,\n    ):\n        \"\"\"Initialize Potree map widget.\n\n        Args:\n            point_cloud_url: URL to the point cloud metadata.json file\n            width: Widget width\n            height: Widget height\n            point_budget: Point budget: influences the point density on screen\n            point_size: Size of rendered points\n            point_size_type: How point size is calculated (\"fixed\", \"adaptive\", \"attenuation\")\n            point_shape: Shape of rendered points (\"square\", \"circle\")\n            camera_position: Initial camera position [x, y, z]\n            camera_target: Camera look-at target [x, y, z]\n            fov: Field of view in degrees\n            background_color: Background color of the viewer\n            edl_enabled: Enable Eye Dome Lighting for better depth perception\n            show_grid: Show coordinate grid\n            quiet: Don't print any information messages\n        \"\"\"\n        self.JUPYTER_ROOT = _get_jupyter_root()\n\n        if not self.JUPYTER_ROOT:\n            warnings.warn(\n                \"PotreeMap is currently only supported through a JupyterLab environment.\"\n            )\n            self._css = \"\"\"\n            .potree-warning {\n                font-family: sans-serif;\n                padding: 1rem;\n                background-color: #fff3cd;\n                color: #856404;\n                border: 1px solid #ffeeba;\n                border-radius: 8px;\n                margin: 1rem 0;\n                box-shadow: 0 2px 4px rgba(0,0,0,0.05);\n            }\n            \"\"\"\n            self._esm = \"\"\"\n            function render({ model, el }) {\n                let div = document.createElement(\"div\");\n                div.className = \"potree-warning\";\n                const msg = document.createTextNode(\"\ud83d\udeab PotreeMap is not yet supported in your environment. Try running it in JupyterLab instead.\");\n                div.appendChild(msg);\n                el.appendChild(div);\n            }\n            export default { render };\n            \"\"\"\n            super().__init__()\n            return\n\n        self.set_trait(\"POTREE_LIBS_DIR\", str(\"/files/potreelibs\"))\n\n        got_potree_libs = _get_potree_libs(self.JUPYTER_ROOT, quiet=quiet)\n        if not got_potree_libs:\n            raise RuntimeError(\"Something went wrong -- could not get potree libs\")\n\n        super().__init__(\n            width=width,\n            height=height,\n            point_budget=point_budget,\n            point_cloud_url=point_cloud_url,\n            point_size=point_size,\n            point_size_type=point_size_type,\n            point_shape=point_shape,\n            camera_position=camera_position,\n            camera_target=camera_target,\n            fov=fov,\n            background_color=background_color,\n            edl_enabled=edl_enabled,\n            show_grid=show_grid,\n            **kwargs,\n        )\n\n    def set_description(self, description: str) -&gt; None:\n        \"\"\"Sets the description.\"\"\"\n        self.description = description\n\n    # Appearance\n    def set_point_budget(self, point_budget: int) -&gt; None:\n        \"\"\"Sets the point budget\"\"\"\n        self.point_budget = point_budget\n\n    def load_point_cloud(\n        self, point_cloud_url: str, point_cloud_name: Optional[str] = None\n    ) -&gt; None:\n        \"\"\"Load a point cloud from URL.\n\n        Args:\n            point_cloud_url: URL to the point cloud metadata.json file\n            point_cloud_name: Optional name for the point cloud\n        \"\"\"\n        self.point_cloud_url = point_cloud_url\n        options = {\"url\": point_cloud_url}\n        if point_cloud_name:\n            options[\"name\"] = point_cloud_name\n        self.call_js_method(\"loadPointCloud\", options)\n\n    def set_point_size(self, size: float) -&gt; None:\n        \"\"\"Set the point size.\"\"\"\n        self.point_size = size\n\n    def set_point_size_type(self, size_type: str) -&gt; None:\n        \"\"\"Set the point size type.\n\n        Args:\n            size_type: \"fixed\", \"adaptive\", or \"attenuation\"\n        \"\"\"\n        if size_type not in [\"fixed\", \"adaptive\", \"attenuation\"]:\n            raise ValueError(\"size_type must be 'fixed', 'adaptive', or 'attenuation'\")\n        self.point_size_type = size_type\n\n    def set_point_shape(self, shape: str) -&gt; None:\n        \"\"\"Set the point shape.\n\n        Args:\n            shape: \"square\" or \"circle\"\n        \"\"\"\n        if shape not in [\"square\", \"circle\"]:\n            raise ValueError(\"shape must be 'square' or 'circle'\")\n        self.point_shape = shape\n\n    def set_camera_position(\n        self, position: List[float], target: Optional[List[float]] = None\n    ) -&gt; None:\n        \"\"\"Set camera position and optionally target.\n\n        Args:\n            position: Camera position [x, y, z]\n            target: Camera target [x, y, z] (optional)\n        \"\"\"\n        self.camera_position = position\n        if target:\n            self.camera_target = target\n\n    def fit_to_screen(self) -&gt; None:\n        \"\"\"Fit the point cloud to the screen.\"\"\"\n        self.call_js_method(\"fitToScreen\")\n\n    def enable_edl(self, enabled: bool = True) -&gt; None:\n        \"\"\"Enable or disable Eye Dome Lighting.\n\n        Args:\n            enabled: Whether to enable EDL\n        \"\"\"\n        self.edl_enabled = enabled\n\n    def set_edl_settings(\n        self, radius: float = 1.4, strength: float = 0.4, opacity: float = 1.0\n    ) -&gt; None:\n        \"\"\"Set Eye Dome Lighting parameters.\n\n        Args:\n            radius: EDL radius\n            strength: EDL strength\n            opacity: EDL opacity\n        \"\"\"\n        self.edl_radius = radius\n        self.edl_strength = strength\n        self.edl_opacity = opacity\n\n    def show_coordinate_grid(\n        self, show: bool = True, size: float = 10.0, color: str = \"#aaaaaa\"\n    ) -&gt; None:\n        \"\"\"Show or hide coordinate grid.\n\n        Args:\n            show: Whether to show the grid\n            size: Grid size\n            color: Grid color\n        \"\"\"\n        self.show_grid = show\n        self.grid_size = size\n        self.grid_color = color\n\n    def set_background_color(self, color: str) -&gt; None:\n        \"\"\"Set the background color.\n\n        Args:\n            color: Background color (hex format like \"#000000\")\n        \"\"\"\n        self.background_color = color\n\n    def clear_point_clouds(self) -&gt; None:\n        \"\"\"Clear all point clouds from the viewer.\"\"\"\n        self.call_js_method(\"clearPointClouds\")\n\n    def get_camera_position(self) -&gt; List[float]:\n        \"\"\"Get current camera position.\"\"\"\n        return list(self.camera_position)\n\n    def get_camera_target(self) -&gt; List[float]:\n        \"\"\"Get current camera target.\"\"\"\n        return list(self.camera_target)\n\n    def take_screenshot(self) -&gt; None:\n        \"\"\"Take a screenshot of the current view.\"\"\"\n        self.call_js_method(\"takeScreenshot\")\n\n    def set_fov(self, fov: float) -&gt; None:\n        \"\"\"Set field of view.\n\n        Args:\n            fov: Field of view in degrees\n        \"\"\"\n        self.fov = fov\n\n    def set_clip_distances(self, near: float, far: float) -&gt; None:\n        \"\"\"Set near and far clipping distances.\n\n        Args:\n            near: Near clipping distance\n            far: Far clipping distance\n        \"\"\"\n        self.near_clip = near\n        self.far_clip = far\n\n    def add_measurement(self, measurement_type: str = \"distance\") -&gt; None:\n        \"\"\"Add measurement tool.\n\n        Args:\n            measurement_type: Type of measurement (\"distance\", \"area\", \"volume\", \"angle\")\n        \"\"\"\n        self.call_js_method(\"addMeasurement\", measurement_type)\n\n    def clear_measurements(self) -&gt; None:\n        \"\"\"Clear all measurements.\"\"\"\n        self.call_js_method(\"clearMeasurements\")\n\n    def set_quality(self, quality: str = \"medium\") -&gt; None:\n        \"\"\"Set rendering quality.\n\n        Args:\n            quality: Rendering quality (\"low\", \"medium\", \"high\")\n        \"\"\"\n        if quality not in [\"low\", \"medium\", \"high\"]:\n            raise ValueError(\"quality must be 'low', 'medium', or 'high'\")\n        self.call_js_method(\"setQuality\", quality)\n\n    def load_multiple_point_clouds(self, point_clouds: List[Dict[str, str]]) -&gt; None:\n        \"\"\"Load multiple point clouds.\n\n        Args:\n            point_clouds: List of point cloud configs with 'url' and optional 'name' keys\n        \"\"\"\n        self.call_js_method(\"loadMultiplePointClouds\", point_clouds)\n\n    def set_classification_visibility(self, classifications: Dict[int, bool]) -&gt; None:\n        \"\"\"Set visibility of point classifications.\n\n        Args:\n            classifications: Dict mapping classification codes to visibility\n        \"\"\"\n        self.call_js_method(\"setClassificationVisibility\", classifications)\n\n    def filter_by_elevation(\n        self,\n        min_elevation: Optional[float] = None,\n        max_elevation: Optional[float] = None,\n    ) -&gt; None:\n        \"\"\"Filter points by elevation.\n\n        Args:\n            min_elevation: Minimum elevation to show\n            max_elevation: Maximum elevation to show\n        \"\"\"\n        options = {}\n        if min_elevation is not None:\n            options[\"min\"] = min_elevation\n        if max_elevation is not None:\n            options[\"max\"] = max_elevation\n        self.call_js_method(\"filterByElevation\", options)\n\n    def clear_filters(self) -&gt; None:\n        \"\"\"Clear all filters.\"\"\"\n        self.call_js_method(\"clearFilters\")\n</code></pre>"},{"location":"potree/#anymap.potree.PotreeMap.__init__","title":"<code>__init__(self, point_cloud_url='', width='100%', height='600px', point_budget=1000000, point_size=1.0, point_size_type='adaptive', point_shape='square', camera_position=[0.0, 0.0, 10.0], camera_target=[0.0, 0.0, 0.0], fov=60.0, background_color='#000000', edl_enabled=True, show_grid=False, quiet=False, **kwargs)</code>  <code>special</code>","text":"<p>Initialize Potree map widget.</p> <p>Parameters:</p> Name Type Description Default <code>point_cloud_url</code> <code>str</code> <p>URL to the point cloud metadata.json file</p> <code>''</code> <code>width</code> <code>str</code> <p>Widget width</p> <code>'100%'</code> <code>height</code> <code>str</code> <p>Widget height</p> <code>'600px'</code> <code>point_budget</code> <code>int</code> <p>Point budget: influences the point density on screen</p> <code>1000000</code> <code>point_size</code> <code>float</code> <p>Size of rendered points</p> <code>1.0</code> <code>point_size_type</code> <code>str</code> <p>How point size is calculated (\"fixed\", \"adaptive\", \"attenuation\")</p> <code>'adaptive'</code> <code>point_shape</code> <code>str</code> <p>Shape of rendered points (\"square\", \"circle\")</p> <code>'square'</code> <code>camera_position</code> <code>List[float]</code> <p>Initial camera position [x, y, z]</p> <code>[0.0, 0.0, 10.0]</code> <code>camera_target</code> <code>List[float]</code> <p>Camera look-at target [x, y, z]</p> <code>[0.0, 0.0, 0.0]</code> <code>fov</code> <code>float</code> <p>Field of view in degrees</p> <code>60.0</code> <code>background_color</code> <code>str</code> <p>Background color of the viewer</p> <code>'#000000'</code> <code>edl_enabled</code> <code>bool</code> <p>Enable Eye Dome Lighting for better depth perception</p> <code>True</code> <code>show_grid</code> <code>bool</code> <p>Show coordinate grid</p> <code>False</code> <code>quiet</code> <code>bool</code> <p>Don't print any information messages</p> <code>False</code> Source code in <code>anymap/potree.py</code> <pre><code>def __init__(\n    self,\n    point_cloud_url: str = \"\",\n    width: str = \"100%\",\n    height: str = \"600px\",\n    point_budget: int = 1_000_000,\n    point_size: float = 1.0,\n    point_size_type: str = \"adaptive\",\n    point_shape: str = \"square\",\n    camera_position: List[float] = [0.0, 0.0, 10.0],\n    camera_target: List[float] = [0.0, 0.0, 0.0],\n    fov: float = 60.0,\n    background_color: str = \"#000000\",\n    edl_enabled: bool = True,\n    show_grid: bool = False,\n    quiet: bool = False,\n    **kwargs,\n):\n    \"\"\"Initialize Potree map widget.\n\n    Args:\n        point_cloud_url: URL to the point cloud metadata.json file\n        width: Widget width\n        height: Widget height\n        point_budget: Point budget: influences the point density on screen\n        point_size: Size of rendered points\n        point_size_type: How point size is calculated (\"fixed\", \"adaptive\", \"attenuation\")\n        point_shape: Shape of rendered points (\"square\", \"circle\")\n        camera_position: Initial camera position [x, y, z]\n        camera_target: Camera look-at target [x, y, z]\n        fov: Field of view in degrees\n        background_color: Background color of the viewer\n        edl_enabled: Enable Eye Dome Lighting for better depth perception\n        show_grid: Show coordinate grid\n        quiet: Don't print any information messages\n    \"\"\"\n    self.JUPYTER_ROOT = _get_jupyter_root()\n\n    if not self.JUPYTER_ROOT:\n        warnings.warn(\n            \"PotreeMap is currently only supported through a JupyterLab environment.\"\n        )\n        self._css = \"\"\"\n        .potree-warning {\n            font-family: sans-serif;\n            padding: 1rem;\n            background-color: #fff3cd;\n            color: #856404;\n            border: 1px solid #ffeeba;\n            border-radius: 8px;\n            margin: 1rem 0;\n            box-shadow: 0 2px 4px rgba(0,0,0,0.05);\n        }\n        \"\"\"\n        self._esm = \"\"\"\n        function render({ model, el }) {\n            let div = document.createElement(\"div\");\n            div.className = \"potree-warning\";\n            const msg = document.createTextNode(\"\ud83d\udeab PotreeMap is not yet supported in your environment. Try running it in JupyterLab instead.\");\n            div.appendChild(msg);\n            el.appendChild(div);\n        }\n        export default { render };\n        \"\"\"\n        super().__init__()\n        return\n\n    self.set_trait(\"POTREE_LIBS_DIR\", str(\"/files/potreelibs\"))\n\n    got_potree_libs = _get_potree_libs(self.JUPYTER_ROOT, quiet=quiet)\n    if not got_potree_libs:\n        raise RuntimeError(\"Something went wrong -- could not get potree libs\")\n\n    super().__init__(\n        width=width,\n        height=height,\n        point_budget=point_budget,\n        point_cloud_url=point_cloud_url,\n        point_size=point_size,\n        point_size_type=point_size_type,\n        point_shape=point_shape,\n        camera_position=camera_position,\n        camera_target=camera_target,\n        fov=fov,\n        background_color=background_color,\n        edl_enabled=edl_enabled,\n        show_grid=show_grid,\n        **kwargs,\n    )\n</code></pre>"},{"location":"potree/#anymap.potree.PotreeMap.add_measurement","title":"<code>add_measurement(self, measurement_type='distance')</code>","text":"<p>Add measurement tool.</p> <p>Parameters:</p> Name Type Description Default <code>measurement_type</code> <code>str</code> <p>Type of measurement (\"distance\", \"area\", \"volume\", \"angle\")</p> <code>'distance'</code> Source code in <code>anymap/potree.py</code> <pre><code>def add_measurement(self, measurement_type: str = \"distance\") -&gt; None:\n    \"\"\"Add measurement tool.\n\n    Args:\n        measurement_type: Type of measurement (\"distance\", \"area\", \"volume\", \"angle\")\n    \"\"\"\n    self.call_js_method(\"addMeasurement\", measurement_type)\n</code></pre>"},{"location":"potree/#anymap.potree.PotreeMap.clear_filters","title":"<code>clear_filters(self)</code>","text":"<p>Clear all filters.</p> Source code in <code>anymap/potree.py</code> <pre><code>def clear_filters(self) -&gt; None:\n    \"\"\"Clear all filters.\"\"\"\n    self.call_js_method(\"clearFilters\")\n</code></pre>"},{"location":"potree/#anymap.potree.PotreeMap.clear_measurements","title":"<code>clear_measurements(self)</code>","text":"<p>Clear all measurements.</p> Source code in <code>anymap/potree.py</code> <pre><code>def clear_measurements(self) -&gt; None:\n    \"\"\"Clear all measurements.\"\"\"\n    self.call_js_method(\"clearMeasurements\")\n</code></pre>"},{"location":"potree/#anymap.potree.PotreeMap.clear_point_clouds","title":"<code>clear_point_clouds(self)</code>","text":"<p>Clear all point clouds from the viewer.</p> Source code in <code>anymap/potree.py</code> <pre><code>def clear_point_clouds(self) -&gt; None:\n    \"\"\"Clear all point clouds from the viewer.\"\"\"\n    self.call_js_method(\"clearPointClouds\")\n</code></pre>"},{"location":"potree/#anymap.potree.PotreeMap.enable_edl","title":"<code>enable_edl(self, enabled=True)</code>","text":"<p>Enable or disable Eye Dome Lighting.</p> <p>Parameters:</p> Name Type Description Default <code>enabled</code> <code>bool</code> <p>Whether to enable EDL</p> <code>True</code> Source code in <code>anymap/potree.py</code> <pre><code>def enable_edl(self, enabled: bool = True) -&gt; None:\n    \"\"\"Enable or disable Eye Dome Lighting.\n\n    Args:\n        enabled: Whether to enable EDL\n    \"\"\"\n    self.edl_enabled = enabled\n</code></pre>"},{"location":"potree/#anymap.potree.PotreeMap.filter_by_elevation","title":"<code>filter_by_elevation(self, min_elevation=None, max_elevation=None)</code>","text":"<p>Filter points by elevation.</p> <p>Parameters:</p> Name Type Description Default <code>min_elevation</code> <code>Optional[float]</code> <p>Minimum elevation to show</p> <code>None</code> <code>max_elevation</code> <code>Optional[float]</code> <p>Maximum elevation to show</p> <code>None</code> Source code in <code>anymap/potree.py</code> <pre><code>def filter_by_elevation(\n    self,\n    min_elevation: Optional[float] = None,\n    max_elevation: Optional[float] = None,\n) -&gt; None:\n    \"\"\"Filter points by elevation.\n\n    Args:\n        min_elevation: Minimum elevation to show\n        max_elevation: Maximum elevation to show\n    \"\"\"\n    options = {}\n    if min_elevation is not None:\n        options[\"min\"] = min_elevation\n    if max_elevation is not None:\n        options[\"max\"] = max_elevation\n    self.call_js_method(\"filterByElevation\", options)\n</code></pre>"},{"location":"potree/#anymap.potree.PotreeMap.fit_to_screen","title":"<code>fit_to_screen(self)</code>","text":"<p>Fit the point cloud to the screen.</p> Source code in <code>anymap/potree.py</code> <pre><code>def fit_to_screen(self) -&gt; None:\n    \"\"\"Fit the point cloud to the screen.\"\"\"\n    self.call_js_method(\"fitToScreen\")\n</code></pre>"},{"location":"potree/#anymap.potree.PotreeMap.get_camera_position","title":"<code>get_camera_position(self)</code>","text":"<p>Get current camera position.</p> Source code in <code>anymap/potree.py</code> <pre><code>def get_camera_position(self) -&gt; List[float]:\n    \"\"\"Get current camera position.\"\"\"\n    return list(self.camera_position)\n</code></pre>"},{"location":"potree/#anymap.potree.PotreeMap.get_camera_target","title":"<code>get_camera_target(self)</code>","text":"<p>Get current camera target.</p> Source code in <code>anymap/potree.py</code> <pre><code>def get_camera_target(self) -&gt; List[float]:\n    \"\"\"Get current camera target.\"\"\"\n    return list(self.camera_target)\n</code></pre>"},{"location":"potree/#anymap.potree.PotreeMap.load_multiple_point_clouds","title":"<code>load_multiple_point_clouds(self, point_clouds)</code>","text":"<p>Load multiple point clouds.</p> <p>Parameters:</p> Name Type Description Default <code>point_clouds</code> <code>List[Dict[str, str]]</code> <p>List of point cloud configs with 'url' and optional 'name' keys</p> required Source code in <code>anymap/potree.py</code> <pre><code>def load_multiple_point_clouds(self, point_clouds: List[Dict[str, str]]) -&gt; None:\n    \"\"\"Load multiple point clouds.\n\n    Args:\n        point_clouds: List of point cloud configs with 'url' and optional 'name' keys\n    \"\"\"\n    self.call_js_method(\"loadMultiplePointClouds\", point_clouds)\n</code></pre>"},{"location":"potree/#anymap.potree.PotreeMap.load_point_cloud","title":"<code>load_point_cloud(self, point_cloud_url, point_cloud_name=None)</code>","text":"<p>Load a point cloud from URL.</p> <p>Parameters:</p> Name Type Description Default <code>point_cloud_url</code> <code>str</code> <p>URL to the point cloud metadata.json file</p> required <code>point_cloud_name</code> <code>Optional[str]</code> <p>Optional name for the point cloud</p> <code>None</code> Source code in <code>anymap/potree.py</code> <pre><code>def load_point_cloud(\n    self, point_cloud_url: str, point_cloud_name: Optional[str] = None\n) -&gt; None:\n    \"\"\"Load a point cloud from URL.\n\n    Args:\n        point_cloud_url: URL to the point cloud metadata.json file\n        point_cloud_name: Optional name for the point cloud\n    \"\"\"\n    self.point_cloud_url = point_cloud_url\n    options = {\"url\": point_cloud_url}\n    if point_cloud_name:\n        options[\"name\"] = point_cloud_name\n    self.call_js_method(\"loadPointCloud\", options)\n</code></pre>"},{"location":"potree/#anymap.potree.PotreeMap.set_background_color","title":"<code>set_background_color(self, color)</code>","text":"<p>Set the background color.</p> <p>Parameters:</p> Name Type Description Default <code>color</code> <code>str</code> <p>Background color (hex format like \"#000000\")</p> required Source code in <code>anymap/potree.py</code> <pre><code>def set_background_color(self, color: str) -&gt; None:\n    \"\"\"Set the background color.\n\n    Args:\n        color: Background color (hex format like \"#000000\")\n    \"\"\"\n    self.background_color = color\n</code></pre>"},{"location":"potree/#anymap.potree.PotreeMap.set_camera_position","title":"<code>set_camera_position(self, position, target=None)</code>","text":"<p>Set camera position and optionally target.</p> <p>Parameters:</p> Name Type Description Default <code>position</code> <code>List[float]</code> <p>Camera position [x, y, z]</p> required <code>target</code> <code>Optional[List[float]]</code> <p>Camera target [x, y, z] (optional)</p> <code>None</code> Source code in <code>anymap/potree.py</code> <pre><code>def set_camera_position(\n    self, position: List[float], target: Optional[List[float]] = None\n) -&gt; None:\n    \"\"\"Set camera position and optionally target.\n\n    Args:\n        position: Camera position [x, y, z]\n        target: Camera target [x, y, z] (optional)\n    \"\"\"\n    self.camera_position = position\n    if target:\n        self.camera_target = target\n</code></pre>"},{"location":"potree/#anymap.potree.PotreeMap.set_classification_visibility","title":"<code>set_classification_visibility(self, classifications)</code>","text":"<p>Set visibility of point classifications.</p> <p>Parameters:</p> Name Type Description Default <code>classifications</code> <code>Dict[int, bool]</code> <p>Dict mapping classification codes to visibility</p> required Source code in <code>anymap/potree.py</code> <pre><code>def set_classification_visibility(self, classifications: Dict[int, bool]) -&gt; None:\n    \"\"\"Set visibility of point classifications.\n\n    Args:\n        classifications: Dict mapping classification codes to visibility\n    \"\"\"\n    self.call_js_method(\"setClassificationVisibility\", classifications)\n</code></pre>"},{"location":"potree/#anymap.potree.PotreeMap.set_clip_distances","title":"<code>set_clip_distances(self, near, far)</code>","text":"<p>Set near and far clipping distances.</p> <p>Parameters:</p> Name Type Description Default <code>near</code> <code>float</code> <p>Near clipping distance</p> required <code>far</code> <code>float</code> <p>Far clipping distance</p> required Source code in <code>anymap/potree.py</code> <pre><code>def set_clip_distances(self, near: float, far: float) -&gt; None:\n    \"\"\"Set near and far clipping distances.\n\n    Args:\n        near: Near clipping distance\n        far: Far clipping distance\n    \"\"\"\n    self.near_clip = near\n    self.far_clip = far\n</code></pre>"},{"location":"potree/#anymap.potree.PotreeMap.set_description","title":"<code>set_description(self, description)</code>","text":"<p>Sets the description.</p> Source code in <code>anymap/potree.py</code> <pre><code>def set_description(self, description: str) -&gt; None:\n    \"\"\"Sets the description.\"\"\"\n    self.description = description\n</code></pre>"},{"location":"potree/#anymap.potree.PotreeMap.set_edl_settings","title":"<code>set_edl_settings(self, radius=1.4, strength=0.4, opacity=1.0)</code>","text":"<p>Set Eye Dome Lighting parameters.</p> <p>Parameters:</p> Name Type Description Default <code>radius</code> <code>float</code> <p>EDL radius</p> <code>1.4</code> <code>strength</code> <code>float</code> <p>EDL strength</p> <code>0.4</code> <code>opacity</code> <code>float</code> <p>EDL opacity</p> <code>1.0</code> Source code in <code>anymap/potree.py</code> <pre><code>def set_edl_settings(\n    self, radius: float = 1.4, strength: float = 0.4, opacity: float = 1.0\n) -&gt; None:\n    \"\"\"Set Eye Dome Lighting parameters.\n\n    Args:\n        radius: EDL radius\n        strength: EDL strength\n        opacity: EDL opacity\n    \"\"\"\n    self.edl_radius = radius\n    self.edl_strength = strength\n    self.edl_opacity = opacity\n</code></pre>"},{"location":"potree/#anymap.potree.PotreeMap.set_fov","title":"<code>set_fov(self, fov)</code>","text":"<p>Set field of view.</p> <p>Parameters:</p> Name Type Description Default <code>fov</code> <code>float</code> <p>Field of view in degrees</p> required Source code in <code>anymap/potree.py</code> <pre><code>def set_fov(self, fov: float) -&gt; None:\n    \"\"\"Set field of view.\n\n    Args:\n        fov: Field of view in degrees\n    \"\"\"\n    self.fov = fov\n</code></pre>"},{"location":"potree/#anymap.potree.PotreeMap.set_point_budget","title":"<code>set_point_budget(self, point_budget)</code>","text":"<p>Sets the point budget</p> Source code in <code>anymap/potree.py</code> <pre><code>def set_point_budget(self, point_budget: int) -&gt; None:\n    \"\"\"Sets the point budget\"\"\"\n    self.point_budget = point_budget\n</code></pre>"},{"location":"potree/#anymap.potree.PotreeMap.set_point_shape","title":"<code>set_point_shape(self, shape)</code>","text":"<p>Set the point shape.</p> <p>Parameters:</p> Name Type Description Default <code>shape</code> <code>str</code> <p>\"square\" or \"circle\"</p> required Source code in <code>anymap/potree.py</code> <pre><code>def set_point_shape(self, shape: str) -&gt; None:\n    \"\"\"Set the point shape.\n\n    Args:\n        shape: \"square\" or \"circle\"\n    \"\"\"\n    if shape not in [\"square\", \"circle\"]:\n        raise ValueError(\"shape must be 'square' or 'circle'\")\n    self.point_shape = shape\n</code></pre>"},{"location":"potree/#anymap.potree.PotreeMap.set_point_size","title":"<code>set_point_size(self, size)</code>","text":"<p>Set the point size.</p> Source code in <code>anymap/potree.py</code> <pre><code>def set_point_size(self, size: float) -&gt; None:\n    \"\"\"Set the point size.\"\"\"\n    self.point_size = size\n</code></pre>"},{"location":"potree/#anymap.potree.PotreeMap.set_point_size_type","title":"<code>set_point_size_type(self, size_type)</code>","text":"<p>Set the point size type.</p> <p>Parameters:</p> Name Type Description Default <code>size_type</code> <code>str</code> <p>\"fixed\", \"adaptive\", or \"attenuation\"</p> required Source code in <code>anymap/potree.py</code> <pre><code>def set_point_size_type(self, size_type: str) -&gt; None:\n    \"\"\"Set the point size type.\n\n    Args:\n        size_type: \"fixed\", \"adaptive\", or \"attenuation\"\n    \"\"\"\n    if size_type not in [\"fixed\", \"adaptive\", \"attenuation\"]:\n        raise ValueError(\"size_type must be 'fixed', 'adaptive', or 'attenuation'\")\n    self.point_size_type = size_type\n</code></pre>"},{"location":"potree/#anymap.potree.PotreeMap.set_quality","title":"<code>set_quality(self, quality='medium')</code>","text":"<p>Set rendering quality.</p> <p>Parameters:</p> Name Type Description Default <code>quality</code> <code>str</code> <p>Rendering quality (\"low\", \"medium\", \"high\")</p> <code>'medium'</code> Source code in <code>anymap/potree.py</code> <pre><code>def set_quality(self, quality: str = \"medium\") -&gt; None:\n    \"\"\"Set rendering quality.\n\n    Args:\n        quality: Rendering quality (\"low\", \"medium\", \"high\")\n    \"\"\"\n    if quality not in [\"low\", \"medium\", \"high\"]:\n        raise ValueError(\"quality must be 'low', 'medium', or 'high'\")\n    self.call_js_method(\"setQuality\", quality)\n</code></pre>"},{"location":"potree/#anymap.potree.PotreeMap.show_coordinate_grid","title":"<code>show_coordinate_grid(self, show=True, size=10.0, color='#aaaaaa')</code>","text":"<p>Show or hide coordinate grid.</p> <p>Parameters:</p> Name Type Description Default <code>show</code> <code>bool</code> <p>Whether to show the grid</p> <code>True</code> <code>size</code> <code>float</code> <p>Grid size</p> <code>10.0</code> <code>color</code> <code>str</code> <p>Grid color</p> <code>'#aaaaaa'</code> Source code in <code>anymap/potree.py</code> <pre><code>def show_coordinate_grid(\n    self, show: bool = True, size: float = 10.0, color: str = \"#aaaaaa\"\n) -&gt; None:\n    \"\"\"Show or hide coordinate grid.\n\n    Args:\n        show: Whether to show the grid\n        size: Grid size\n        color: Grid color\n    \"\"\"\n    self.show_grid = show\n    self.grid_size = size\n    self.grid_color = color\n</code></pre>"},{"location":"potree/#anymap.potree.PotreeMap.take_screenshot","title":"<code>take_screenshot(self)</code>","text":"<p>Take a screenshot of the current view.</p> Source code in <code>anymap/potree.py</code> <pre><code>def take_screenshot(self) -&gt; None:\n    \"\"\"Take a screenshot of the current view.\"\"\"\n    self.call_js_method(\"takeScreenshot\")\n</code></pre>"},{"location":"stac/","title":"stac module","text":""},{"location":"stac/#anymap.stac.PlanetaryComputerEndpoint","title":"<code> PlanetaryComputerEndpoint            (TitilerEndpoint)         </code>","text":"<p>This class contains the methods for the Microsoft Planetary Computer endpoint.</p> Source code in <code>anymap/stac.py</code> <pre><code>class PlanetaryComputerEndpoint(TitilerEndpoint):\n    \"\"\"This class contains the methods for the Microsoft Planetary Computer endpoint.\"\"\"\n\n    def __init__(\n        self,\n        endpoint: Optional[str] = \"https://planetarycomputer.microsoft.com/api/data/v1\",\n        name: Optional[str] = \"item\",\n        TileMatrixSetId: Optional[str] = \"WebMercatorQuad\",\n    ) -&gt; None:\n        \"\"\"Initialize the PlanetaryComputerEndpoint object.\n\n        Args:\n            endpoint: The endpoint of the titiler server. Defaults to Microsoft\n                Planetary Computer API endpoint.\n            name: The name to be used in the file path. Defaults to \"item\".\n            TileMatrixSetId: The TileMatrixSetId to be used in the file path.\n                Defaults to \"WebMercatorQuad\".\n        \"\"\"\n        super().__init__(endpoint, name, TileMatrixSetId)\n\n    def url_for_stac_collection(self) -&gt; str:\n        \"\"\"Generate URL for STAC collection tilejson.\n\n        Returns:\n            URL string for STAC collection tilejson endpoint.\n        \"\"\"\n        return f\"{self.endpoint}/collection/{self.TileMatrixSetId}/tilejson.json\"\n\n    def url_for_collection_assets(self) -&gt; str:\n        \"\"\"Generate URL for collection assets.\n\n        Returns:\n            URL string for collection assets endpoint.\n        \"\"\"\n        return f\"{self.endpoint}/collection/assets\"\n\n    def url_for_collection_bounds(self) -&gt; str:\n        \"\"\"Generate URL for collection bounds.\n\n        Returns:\n            URL string for collection bounds endpoint.\n        \"\"\"\n        return f\"{self.endpoint}/collection/bounds\"\n\n    def url_for_collection_info(self) -&gt; str:\n        \"\"\"Generate URL for collection info.\n\n        Returns:\n            URL string for collection info endpoint.\n        \"\"\"\n        return f\"{self.endpoint}/collection/info\"\n\n    def url_for_collection_info_geojson(self) -&gt; str:\n        \"\"\"Generate URL for collection info as GeoJSON.\n\n        Returns:\n            URL string for collection info GeoJSON endpoint.\n        \"\"\"\n        return f\"{self.endpoint}/collection/info.geojson\"\n\n    def url_for_collection_pixel_value(self, lon: float, lat: float) -&gt; str:\n        \"\"\"Generate URL for collection pixel value at coordinates.\n\n        Args:\n            lon: Longitude coordinate.\n            lat: Latitude coordinate.\n\n        Returns:\n            URL string for collection pixel value endpoint.\n        \"\"\"\n        return f\"{self.endpoint}/collection/point/{lon},{lat}\"\n\n    def url_for_collection_wmts(self) -&gt; str:\n        \"\"\"Generate URL for collection WMTS capabilities.\n\n        Returns:\n            URL string for collection WMTS capabilities endpoint.\n        \"\"\"\n        return f\"{self.endpoint}/collection/{self.TileMatrixSetId}/WMTSCapabilities.xml\"\n\n    def url_for_collection_lat_lon_assets(self, lng: float, lat: float) -&gt; str:\n        \"\"\"Generate URL for collection assets at coordinates.\n\n        Args:\n            lng: Longitude coordinate.\n            lat: Latitude coordinate.\n\n        Returns:\n            URL string for collection assets at coordinates endpoint.\n        \"\"\"\n        return f\"{self.endpoint}/collection/{lng},{lat}/assets\"\n\n    def url_for_collection_bbox_assets(\n        self, minx: float, miny: float, maxx: float, maxy: float\n    ) -&gt; str:\n        \"\"\"Generate URL for collection assets within bounding box.\n\n        Args:\n            minx: Minimum x coordinate.\n            miny: Minimum y coordinate.\n            maxx: Maximum x coordinate.\n            maxy: Maximum y coordinate.\n\n        Returns:\n            URL string for collection assets within bounding box endpoint.\n        \"\"\"\n        return f\"{self.endpoint}/collection/{minx},{miny},{maxx},{maxy}/assets\"\n\n    def url_for_stac_mosaic(self, searchid: str) -&gt; str:\n        \"\"\"Generate URL for STAC mosaic tilejson.\n\n        Args:\n            searchid: Search ID for the mosaic.\n\n        Returns:\n            URL string for STAC mosaic tilejson endpoint.\n        \"\"\"\n        return f\"{self.endpoint}/mosaic/{searchid}/{self.TileMatrixSetId}/tilejson.json\"\n\n    def url_for_mosaic_info(self, searchid: str) -&gt; str:\n        \"\"\"Generate URL for mosaic info.\n\n        Args:\n            searchid: Search ID for the mosaic.\n\n        Returns:\n            URL string for mosaic info endpoint.\n        \"\"\"\n        return f\"{self.endpoint}/mosaic/{searchid}/info\"\n\n    def url_for_mosaic_lat_lon_assets(\n        self, searchid: str, lon: float, lat: float\n    ) -&gt; str:\n        \"\"\"Generate URL for mosaic assets at coordinates.\n\n        Args:\n            searchid: Search ID for the mosaic.\n            lon: Longitude coordinate.\n            lat: Latitude coordinate.\n\n        Returns:\n            URL string for mosaic assets at coordinates endpoint.\n        \"\"\"\n        return f\"{self.endpoint}/mosaic/{searchid}/{lon},{lat}/assets\"\n</code></pre>"},{"location":"stac/#anymap.stac.PlanetaryComputerEndpoint.__init__","title":"<code>__init__(self, endpoint='https://planetarycomputer.microsoft.com/api/data/v1', name='item', TileMatrixSetId='WebMercatorQuad')</code>  <code>special</code>","text":"<p>Initialize the PlanetaryComputerEndpoint object.</p> <p>Parameters:</p> Name Type Description Default <code>endpoint</code> <code>Optional[str]</code> <p>The endpoint of the titiler server. Defaults to Microsoft Planetary Computer API endpoint.</p> <code>'https://planetarycomputer.microsoft.com/api/data/v1'</code> <code>name</code> <code>Optional[str]</code> <p>The name to be used in the file path. Defaults to \"item\".</p> <code>'item'</code> <code>TileMatrixSetId</code> <code>Optional[str]</code> <p>The TileMatrixSetId to be used in the file path. Defaults to \"WebMercatorQuad\".</p> <code>'WebMercatorQuad'</code> Source code in <code>anymap/stac.py</code> <pre><code>def __init__(\n    self,\n    endpoint: Optional[str] = \"https://planetarycomputer.microsoft.com/api/data/v1\",\n    name: Optional[str] = \"item\",\n    TileMatrixSetId: Optional[str] = \"WebMercatorQuad\",\n) -&gt; None:\n    \"\"\"Initialize the PlanetaryComputerEndpoint object.\n\n    Args:\n        endpoint: The endpoint of the titiler server. Defaults to Microsoft\n            Planetary Computer API endpoint.\n        name: The name to be used in the file path. Defaults to \"item\".\n        TileMatrixSetId: The TileMatrixSetId to be used in the file path.\n            Defaults to \"WebMercatorQuad\".\n    \"\"\"\n    super().__init__(endpoint, name, TileMatrixSetId)\n</code></pre>"},{"location":"stac/#anymap.stac.PlanetaryComputerEndpoint.url_for_collection_assets","title":"<code>url_for_collection_assets(self)</code>","text":"<p>Generate URL for collection assets.</p> <p>Returns:</p> Type Description <code>str</code> <p>URL string for collection assets endpoint.</p> Source code in <code>anymap/stac.py</code> <pre><code>def url_for_collection_assets(self) -&gt; str:\n    \"\"\"Generate URL for collection assets.\n\n    Returns:\n        URL string for collection assets endpoint.\n    \"\"\"\n    return f\"{self.endpoint}/collection/assets\"\n</code></pre>"},{"location":"stac/#anymap.stac.PlanetaryComputerEndpoint.url_for_collection_bbox_assets","title":"<code>url_for_collection_bbox_assets(self, minx, miny, maxx, maxy)</code>","text":"<p>Generate URL for collection assets within bounding box.</p> <p>Parameters:</p> Name Type Description Default <code>minx</code> <code>float</code> <p>Minimum x coordinate.</p> required <code>miny</code> <code>float</code> <p>Minimum y coordinate.</p> required <code>maxx</code> <code>float</code> <p>Maximum x coordinate.</p> required <code>maxy</code> <code>float</code> <p>Maximum y coordinate.</p> required <p>Returns:</p> Type Description <code>str</code> <p>URL string for collection assets within bounding box endpoint.</p> Source code in <code>anymap/stac.py</code> <pre><code>def url_for_collection_bbox_assets(\n    self, minx: float, miny: float, maxx: float, maxy: float\n) -&gt; str:\n    \"\"\"Generate URL for collection assets within bounding box.\n\n    Args:\n        minx: Minimum x coordinate.\n        miny: Minimum y coordinate.\n        maxx: Maximum x coordinate.\n        maxy: Maximum y coordinate.\n\n    Returns:\n        URL string for collection assets within bounding box endpoint.\n    \"\"\"\n    return f\"{self.endpoint}/collection/{minx},{miny},{maxx},{maxy}/assets\"\n</code></pre>"},{"location":"stac/#anymap.stac.PlanetaryComputerEndpoint.url_for_collection_bounds","title":"<code>url_for_collection_bounds(self)</code>","text":"<p>Generate URL for collection bounds.</p> <p>Returns:</p> Type Description <code>str</code> <p>URL string for collection bounds endpoint.</p> Source code in <code>anymap/stac.py</code> <pre><code>def url_for_collection_bounds(self) -&gt; str:\n    \"\"\"Generate URL for collection bounds.\n\n    Returns:\n        URL string for collection bounds endpoint.\n    \"\"\"\n    return f\"{self.endpoint}/collection/bounds\"\n</code></pre>"},{"location":"stac/#anymap.stac.PlanetaryComputerEndpoint.url_for_collection_info","title":"<code>url_for_collection_info(self)</code>","text":"<p>Generate URL for collection info.</p> <p>Returns:</p> Type Description <code>str</code> <p>URL string for collection info endpoint.</p> Source code in <code>anymap/stac.py</code> <pre><code>def url_for_collection_info(self) -&gt; str:\n    \"\"\"Generate URL for collection info.\n\n    Returns:\n        URL string for collection info endpoint.\n    \"\"\"\n    return f\"{self.endpoint}/collection/info\"\n</code></pre>"},{"location":"stac/#anymap.stac.PlanetaryComputerEndpoint.url_for_collection_info_geojson","title":"<code>url_for_collection_info_geojson(self)</code>","text":"<p>Generate URL for collection info as GeoJSON.</p> <p>Returns:</p> Type Description <code>str</code> <p>URL string for collection info GeoJSON endpoint.</p> Source code in <code>anymap/stac.py</code> <pre><code>def url_for_collection_info_geojson(self) -&gt; str:\n    \"\"\"Generate URL for collection info as GeoJSON.\n\n    Returns:\n        URL string for collection info GeoJSON endpoint.\n    \"\"\"\n    return f\"{self.endpoint}/collection/info.geojson\"\n</code></pre>"},{"location":"stac/#anymap.stac.PlanetaryComputerEndpoint.url_for_collection_lat_lon_assets","title":"<code>url_for_collection_lat_lon_assets(self, lng, lat)</code>","text":"<p>Generate URL for collection assets at coordinates.</p> <p>Parameters:</p> Name Type Description Default <code>lng</code> <code>float</code> <p>Longitude coordinate.</p> required <code>lat</code> <code>float</code> <p>Latitude coordinate.</p> required <p>Returns:</p> Type Description <code>str</code> <p>URL string for collection assets at coordinates endpoint.</p> Source code in <code>anymap/stac.py</code> <pre><code>def url_for_collection_lat_lon_assets(self, lng: float, lat: float) -&gt; str:\n    \"\"\"Generate URL for collection assets at coordinates.\n\n    Args:\n        lng: Longitude coordinate.\n        lat: Latitude coordinate.\n\n    Returns:\n        URL string for collection assets at coordinates endpoint.\n    \"\"\"\n    return f\"{self.endpoint}/collection/{lng},{lat}/assets\"\n</code></pre>"},{"location":"stac/#anymap.stac.PlanetaryComputerEndpoint.url_for_collection_pixel_value","title":"<code>url_for_collection_pixel_value(self, lon, lat)</code>","text":"<p>Generate URL for collection pixel value at coordinates.</p> <p>Parameters:</p> Name Type Description Default <code>lon</code> <code>float</code> <p>Longitude coordinate.</p> required <code>lat</code> <code>float</code> <p>Latitude coordinate.</p> required <p>Returns:</p> Type Description <code>str</code> <p>URL string for collection pixel value endpoint.</p> Source code in <code>anymap/stac.py</code> <pre><code>def url_for_collection_pixel_value(self, lon: float, lat: float) -&gt; str:\n    \"\"\"Generate URL for collection pixel value at coordinates.\n\n    Args:\n        lon: Longitude coordinate.\n        lat: Latitude coordinate.\n\n    Returns:\n        URL string for collection pixel value endpoint.\n    \"\"\"\n    return f\"{self.endpoint}/collection/point/{lon},{lat}\"\n</code></pre>"},{"location":"stac/#anymap.stac.PlanetaryComputerEndpoint.url_for_collection_wmts","title":"<code>url_for_collection_wmts(self)</code>","text":"<p>Generate URL for collection WMTS capabilities.</p> <p>Returns:</p> Type Description <code>str</code> <p>URL string for collection WMTS capabilities endpoint.</p> Source code in <code>anymap/stac.py</code> <pre><code>def url_for_collection_wmts(self) -&gt; str:\n    \"\"\"Generate URL for collection WMTS capabilities.\n\n    Returns:\n        URL string for collection WMTS capabilities endpoint.\n    \"\"\"\n    return f\"{self.endpoint}/collection/{self.TileMatrixSetId}/WMTSCapabilities.xml\"\n</code></pre>"},{"location":"stac/#anymap.stac.PlanetaryComputerEndpoint.url_for_mosaic_info","title":"<code>url_for_mosaic_info(self, searchid)</code>","text":"<p>Generate URL for mosaic info.</p> <p>Parameters:</p> Name Type Description Default <code>searchid</code> <code>str</code> <p>Search ID for the mosaic.</p> required <p>Returns:</p> Type Description <code>str</code> <p>URL string for mosaic info endpoint.</p> Source code in <code>anymap/stac.py</code> <pre><code>def url_for_mosaic_info(self, searchid: str) -&gt; str:\n    \"\"\"Generate URL for mosaic info.\n\n    Args:\n        searchid: Search ID for the mosaic.\n\n    Returns:\n        URL string for mosaic info endpoint.\n    \"\"\"\n    return f\"{self.endpoint}/mosaic/{searchid}/info\"\n</code></pre>"},{"location":"stac/#anymap.stac.PlanetaryComputerEndpoint.url_for_mosaic_lat_lon_assets","title":"<code>url_for_mosaic_lat_lon_assets(self, searchid, lon, lat)</code>","text":"<p>Generate URL for mosaic assets at coordinates.</p> <p>Parameters:</p> Name Type Description Default <code>searchid</code> <code>str</code> <p>Search ID for the mosaic.</p> required <code>lon</code> <code>float</code> <p>Longitude coordinate.</p> required <code>lat</code> <code>float</code> <p>Latitude coordinate.</p> required <p>Returns:</p> Type Description <code>str</code> <p>URL string for mosaic assets at coordinates endpoint.</p> Source code in <code>anymap/stac.py</code> <pre><code>def url_for_mosaic_lat_lon_assets(\n    self, searchid: str, lon: float, lat: float\n) -&gt; str:\n    \"\"\"Generate URL for mosaic assets at coordinates.\n\n    Args:\n        searchid: Search ID for the mosaic.\n        lon: Longitude coordinate.\n        lat: Latitude coordinate.\n\n    Returns:\n        URL string for mosaic assets at coordinates endpoint.\n    \"\"\"\n    return f\"{self.endpoint}/mosaic/{searchid}/{lon},{lat}/assets\"\n</code></pre>"},{"location":"stac/#anymap.stac.PlanetaryComputerEndpoint.url_for_stac_collection","title":"<code>url_for_stac_collection(self)</code>","text":"<p>Generate URL for STAC collection tilejson.</p> <p>Returns:</p> Type Description <code>str</code> <p>URL string for STAC collection tilejson endpoint.</p> Source code in <code>anymap/stac.py</code> <pre><code>def url_for_stac_collection(self) -&gt; str:\n    \"\"\"Generate URL for STAC collection tilejson.\n\n    Returns:\n        URL string for STAC collection tilejson endpoint.\n    \"\"\"\n    return f\"{self.endpoint}/collection/{self.TileMatrixSetId}/tilejson.json\"\n</code></pre>"},{"location":"stac/#anymap.stac.PlanetaryComputerEndpoint.url_for_stac_mosaic","title":"<code>url_for_stac_mosaic(self, searchid)</code>","text":"<p>Generate URL for STAC mosaic tilejson.</p> <p>Parameters:</p> Name Type Description Default <code>searchid</code> <code>str</code> <p>Search ID for the mosaic.</p> required <p>Returns:</p> Type Description <code>str</code> <p>URL string for STAC mosaic tilejson endpoint.</p> Source code in <code>anymap/stac.py</code> <pre><code>def url_for_stac_mosaic(self, searchid: str) -&gt; str:\n    \"\"\"Generate URL for STAC mosaic tilejson.\n\n    Args:\n        searchid: Search ID for the mosaic.\n\n    Returns:\n        URL string for STAC mosaic tilejson endpoint.\n    \"\"\"\n    return f\"{self.endpoint}/mosaic/{searchid}/{self.TileMatrixSetId}/tilejson.json\"\n</code></pre>"},{"location":"stac/#anymap.stac.TitilerEndpoint","title":"<code> TitilerEndpoint        </code>","text":"<p>This class contains the methods for the titiler endpoint.</p> Source code in <code>anymap/stac.py</code> <pre><code>class TitilerEndpoint:\n    \"\"\"This class contains the methods for the titiler endpoint.\"\"\"\n\n    def __init__(\n        self,\n        endpoint: Optional[str] = None,\n        name: Optional[str] = \"stac\",\n        TileMatrixSetId: Optional[str] = \"WebMercatorQuad\",\n    ) -&gt; None:\n        \"\"\"Initialize the TiTilerEndpoint object.\n\n        Args:\n            endpoint: The endpoint of the titiler server. Defaults to None.\n            name: The name to be used in the file path. Defaults to \"stac\".\n            TileMatrixSetId: The TileMatrixSetId to be used in the file path.\n                Defaults to \"WebMercatorQuad\".\n        \"\"\"\n        self.endpoint = endpoint\n        self.name = name\n        self.TileMatrixSetId = TileMatrixSetId\n\n    def url_for_stac_item(self) -&gt; str:\n        \"\"\"Generate URL for STAC item tilejson.\n\n        Returns:\n            URL string for STAC item tilejson endpoint.\n        \"\"\"\n        return f\"{self.endpoint}/{self.name}/{self.TileMatrixSetId}/tilejson.json\"\n\n    def url_for_stac_assets(self) -&gt; str:\n        \"\"\"Generate URL for STAC assets.\n\n        Returns:\n            URL string for STAC assets endpoint.\n        \"\"\"\n        return f\"{self.endpoint}/{self.name}/assets\"\n\n    def url_for_stac_bounds(self) -&gt; str:\n        \"\"\"Generate URL for STAC bounds.\n\n        Returns:\n            URL string for STAC bounds endpoint.\n        \"\"\"\n        return f\"{self.endpoint}/{self.name}/bounds\"\n\n    def url_for_stac_info(self) -&gt; str:\n        \"\"\"Generate URL for STAC info.\n\n        Returns:\n            URL string for STAC info endpoint.\n        \"\"\"\n        return f\"{self.endpoint}/{self.name}/info\"\n\n    def url_for_stac_info_geojson(self) -&gt; str:\n        \"\"\"Generate URL for STAC info as GeoJSON.\n\n        Returns:\n            URL string for STAC info GeoJSON endpoint.\n        \"\"\"\n        return f\"{self.endpoint}/{self.name}/info.geojson\"\n\n    def url_for_stac_statistics(self) -&gt; str:\n        \"\"\"Generate URL for STAC statistics.\n\n        Returns:\n            URL string for STAC statistics endpoint.\n        \"\"\"\n        return f\"{self.endpoint}/{self.name}/statistics\"\n\n    def url_for_stac_pixel_value(self, lon: float, lat: float) -&gt; str:\n        \"\"\"Generate URL for STAC pixel value at coordinates.\n\n        Args:\n            lon: Longitude coordinate.\n            lat: Latitude coordinate.\n\n        Returns:\n            URL string for STAC pixel value endpoint.\n        \"\"\"\n        return f\"{self.endpoint}/{self.name}/point/{lon},{lat}\"\n\n    def url_for_stac_wmts(self) -&gt; str:\n        \"\"\"Generate URL for STAC WMTS capabilities.\n\n        Returns:\n            URL string for STAC WMTS capabilities endpoint.\n        \"\"\"\n        return (\n            f\"{self.endpoint}/{self.name}/{self.TileMatrixSetId}/WMTSCapabilities.xml\"\n        )\n</code></pre>"},{"location":"stac/#anymap.stac.TitilerEndpoint.__init__","title":"<code>__init__(self, endpoint=None, name='stac', TileMatrixSetId='WebMercatorQuad')</code>  <code>special</code>","text":"<p>Initialize the TiTilerEndpoint object.</p> <p>Parameters:</p> Name Type Description Default <code>endpoint</code> <code>Optional[str]</code> <p>The endpoint of the titiler server. Defaults to None.</p> <code>None</code> <code>name</code> <code>Optional[str]</code> <p>The name to be used in the file path. Defaults to \"stac\".</p> <code>'stac'</code> <code>TileMatrixSetId</code> <code>Optional[str]</code> <p>The TileMatrixSetId to be used in the file path. Defaults to \"WebMercatorQuad\".</p> <code>'WebMercatorQuad'</code> Source code in <code>anymap/stac.py</code> <pre><code>def __init__(\n    self,\n    endpoint: Optional[str] = None,\n    name: Optional[str] = \"stac\",\n    TileMatrixSetId: Optional[str] = \"WebMercatorQuad\",\n) -&gt; None:\n    \"\"\"Initialize the TiTilerEndpoint object.\n\n    Args:\n        endpoint: The endpoint of the titiler server. Defaults to None.\n        name: The name to be used in the file path. Defaults to \"stac\".\n        TileMatrixSetId: The TileMatrixSetId to be used in the file path.\n            Defaults to \"WebMercatorQuad\".\n    \"\"\"\n    self.endpoint = endpoint\n    self.name = name\n    self.TileMatrixSetId = TileMatrixSetId\n</code></pre>"},{"location":"stac/#anymap.stac.TitilerEndpoint.url_for_stac_assets","title":"<code>url_for_stac_assets(self)</code>","text":"<p>Generate URL for STAC assets.</p> <p>Returns:</p> Type Description <code>str</code> <p>URL string for STAC assets endpoint.</p> Source code in <code>anymap/stac.py</code> <pre><code>def url_for_stac_assets(self) -&gt; str:\n    \"\"\"Generate URL for STAC assets.\n\n    Returns:\n        URL string for STAC assets endpoint.\n    \"\"\"\n    return f\"{self.endpoint}/{self.name}/assets\"\n</code></pre>"},{"location":"stac/#anymap.stac.TitilerEndpoint.url_for_stac_bounds","title":"<code>url_for_stac_bounds(self)</code>","text":"<p>Generate URL for STAC bounds.</p> <p>Returns:</p> Type Description <code>str</code> <p>URL string for STAC bounds endpoint.</p> Source code in <code>anymap/stac.py</code> <pre><code>def url_for_stac_bounds(self) -&gt; str:\n    \"\"\"Generate URL for STAC bounds.\n\n    Returns:\n        URL string for STAC bounds endpoint.\n    \"\"\"\n    return f\"{self.endpoint}/{self.name}/bounds\"\n</code></pre>"},{"location":"stac/#anymap.stac.TitilerEndpoint.url_for_stac_info","title":"<code>url_for_stac_info(self)</code>","text":"<p>Generate URL for STAC info.</p> <p>Returns:</p> Type Description <code>str</code> <p>URL string for STAC info endpoint.</p> Source code in <code>anymap/stac.py</code> <pre><code>def url_for_stac_info(self) -&gt; str:\n    \"\"\"Generate URL for STAC info.\n\n    Returns:\n        URL string for STAC info endpoint.\n    \"\"\"\n    return f\"{self.endpoint}/{self.name}/info\"\n</code></pre>"},{"location":"stac/#anymap.stac.TitilerEndpoint.url_for_stac_info_geojson","title":"<code>url_for_stac_info_geojson(self)</code>","text":"<p>Generate URL for STAC info as GeoJSON.</p> <p>Returns:</p> Type Description <code>str</code> <p>URL string for STAC info GeoJSON endpoint.</p> Source code in <code>anymap/stac.py</code> <pre><code>def url_for_stac_info_geojson(self) -&gt; str:\n    \"\"\"Generate URL for STAC info as GeoJSON.\n\n    Returns:\n        URL string for STAC info GeoJSON endpoint.\n    \"\"\"\n    return f\"{self.endpoint}/{self.name}/info.geojson\"\n</code></pre>"},{"location":"stac/#anymap.stac.TitilerEndpoint.url_for_stac_item","title":"<code>url_for_stac_item(self)</code>","text":"<p>Generate URL for STAC item tilejson.</p> <p>Returns:</p> Type Description <code>str</code> <p>URL string for STAC item tilejson endpoint.</p> Source code in <code>anymap/stac.py</code> <pre><code>def url_for_stac_item(self) -&gt; str:\n    \"\"\"Generate URL for STAC item tilejson.\n\n    Returns:\n        URL string for STAC item tilejson endpoint.\n    \"\"\"\n    return f\"{self.endpoint}/{self.name}/{self.TileMatrixSetId}/tilejson.json\"\n</code></pre>"},{"location":"stac/#anymap.stac.TitilerEndpoint.url_for_stac_pixel_value","title":"<code>url_for_stac_pixel_value(self, lon, lat)</code>","text":"<p>Generate URL for STAC pixel value at coordinates.</p> <p>Parameters:</p> Name Type Description Default <code>lon</code> <code>float</code> <p>Longitude coordinate.</p> required <code>lat</code> <code>float</code> <p>Latitude coordinate.</p> required <p>Returns:</p> Type Description <code>str</code> <p>URL string for STAC pixel value endpoint.</p> Source code in <code>anymap/stac.py</code> <pre><code>def url_for_stac_pixel_value(self, lon: float, lat: float) -&gt; str:\n    \"\"\"Generate URL for STAC pixel value at coordinates.\n\n    Args:\n        lon: Longitude coordinate.\n        lat: Latitude coordinate.\n\n    Returns:\n        URL string for STAC pixel value endpoint.\n    \"\"\"\n    return f\"{self.endpoint}/{self.name}/point/{lon},{lat}\"\n</code></pre>"},{"location":"stac/#anymap.stac.TitilerEndpoint.url_for_stac_statistics","title":"<code>url_for_stac_statistics(self)</code>","text":"<p>Generate URL for STAC statistics.</p> <p>Returns:</p> Type Description <code>str</code> <p>URL string for STAC statistics endpoint.</p> Source code in <code>anymap/stac.py</code> <pre><code>def url_for_stac_statistics(self) -&gt; str:\n    \"\"\"Generate URL for STAC statistics.\n\n    Returns:\n        URL string for STAC statistics endpoint.\n    \"\"\"\n    return f\"{self.endpoint}/{self.name}/statistics\"\n</code></pre>"},{"location":"stac/#anymap.stac.TitilerEndpoint.url_for_stac_wmts","title":"<code>url_for_stac_wmts(self)</code>","text":"<p>Generate URL for STAC WMTS capabilities.</p> <p>Returns:</p> Type Description <code>str</code> <p>URL string for STAC WMTS capabilities endpoint.</p> Source code in <code>anymap/stac.py</code> <pre><code>def url_for_stac_wmts(self) -&gt; str:\n    \"\"\"Generate URL for STAC WMTS capabilities.\n\n    Returns:\n        URL string for STAC WMTS capabilities endpoint.\n    \"\"\"\n    return (\n        f\"{self.endpoint}/{self.name}/{self.TileMatrixSetId}/WMTSCapabilities.xml\"\n    )\n</code></pre>"},{"location":"stac/#anymap.stac.check_titiler_endpoint","title":"<code>check_titiler_endpoint(titiler_endpoint=None)</code>","text":"<p>Returns the default titiler endpoint.</p> <p>Parameters:</p> Name Type Description Default <code>titiler_endpoint</code> <code>Optional[str]</code> <p>Optional titiler endpoint. If None, will check environment variables or use default endpoint.</p> <code>None</code> <p>Returns:</p> Type Description <code>Union[str, anymap.stac.TitilerEndpoint, anymap.stac.PlanetaryComputerEndpoint]</code> <p>A titiler endpoint (string URL or endpoint object).</p> Source code in <code>anymap/stac.py</code> <pre><code>def check_titiler_endpoint(\n    titiler_endpoint: Optional[str] = None,\n) -&gt; Union[str, TitilerEndpoint, PlanetaryComputerEndpoint]:\n    \"\"\"Returns the default titiler endpoint.\n\n    Args:\n        titiler_endpoint: Optional titiler endpoint. If None, will check environment\n            variables or use default endpoint.\n\n    Returns:\n        A titiler endpoint (string URL or endpoint object).\n    \"\"\"\n    if titiler_endpoint is None:\n        if os.environ.get(\"TITILER_ENDPOINT\") is not None:\n            titiler_endpoint = os.environ.get(\"TITILER_ENDPOINT\")\n\n            if titiler_endpoint == \"planetary-computer\":\n                titiler_endpoint = PlanetaryComputerEndpoint()\n        else:\n            titiler_endpoint = \"https://giswqs-titiler-endpoint.hf.space\"\n    elif titiler_endpoint in [\"planetary-computer\", \"pc\"]:\n        titiler_endpoint = PlanetaryComputerEndpoint()\n\n    return titiler_endpoint\n</code></pre>"},{"location":"stac/#anymap.stac.cog_bands","title":"<code>cog_bands(url, titiler_endpoint=None)</code>","text":"<p>Get band names of a Cloud Optimized GeoTIFF (COG).</p> <p>Parameters:</p> Name Type Description Default <code>url</code> <code>str</code> <p>HTTP URL to a COG, e.g., https://opendata.digitalglobe.com/events/mauritius-oil-spill/post-event/2020-08-12/105001001F1B5B00/105001001F1B5B00.tif</p> required <code>titiler_endpoint</code> <code>str</code> <p>TiTiler endpoint. Defaults to \"https://giswqs-titiler-endpoint.hf.space\".</p> <code>None</code> <p>Returns:</p> Type Description <code>list</code> <p>A list of band names</p> Source code in <code>anymap/stac.py</code> <pre><code>def cog_bands(\n    url: str,\n    titiler_endpoint: Optional[str] = None,\n) -&gt; List:\n    \"\"\"Get band names of a Cloud Optimized GeoTIFF (COG).\n\n    Args:\n        url (str): HTTP URL to a COG, e.g., https://opendata.digitalglobe.com/events/mauritius-oil-spill/post-event/2020-08-12/105001001F1B5B00/105001001F1B5B00.tif\n        titiler_endpoint (str, optional): TiTiler endpoint. Defaults to \"https://giswqs-titiler-endpoint.hf.space\".\n\n    Returns:\n        list: A list of band names\n    \"\"\"\n\n    titiler_endpoint = check_titiler_endpoint(titiler_endpoint)\n    r = requests.get(\n        f\"{titiler_endpoint}/cog/info\",\n        params={\n            \"url\": url,\n        },\n    ).json()\n\n    bands = [b[0] for b in r[\"band_descriptions\"]]\n    return bands\n</code></pre>"},{"location":"stac/#anymap.stac.cog_bounds","title":"<code>cog_bounds(url, titiler_endpoint=None)</code>","text":"<p>Get the bounding box of a Cloud Optimized GeoTIFF (COG).</p> <p>Parameters:</p> Name Type Description Default <code>url</code> <code>str</code> <p>HTTP URL to a COG, e.g., https://opendata.digitalglobe.com/events/mauritius-oil-spill/post-event/2020-08-12/105001001F1B5B00/105001001F1B5B00.tif</p> required <code>titiler_endpoint</code> <code>Optional[str]</code> <p>TiTiler endpoint. Defaults to \"https://giswqs-titiler-endpoint.hf.space\".</p> <code>None</code> <p>Returns:</p> Type Description <code>List[float]</code> <p>A list of values representing [left, bottom, right, top].</p> Source code in <code>anymap/stac.py</code> <pre><code>def cog_bounds(\n    url: str,\n    titiler_endpoint: Optional[str] = None,\n) -&gt; List[float]:\n    \"\"\"Get the bounding box of a Cloud Optimized GeoTIFF (COG).\n\n    Args:\n        url: HTTP URL to a COG, e.g.,\n            https://opendata.digitalglobe.com/events/mauritius-oil-spill/post-event/2020-08-12/105001001F1B5B00/105001001F1B5B00.tif\n        titiler_endpoint: TiTiler endpoint. Defaults to \"https://giswqs-titiler-endpoint.hf.space\".\n\n    Returns:\n        A list of values representing [left, bottom, right, top].\n    \"\"\"\n\n    titiler_endpoint = check_titiler_endpoint(titiler_endpoint)\n    r = requests.get(f\"{titiler_endpoint}/cog/bounds\", params={\"url\": url}).json()\n\n    if \"bounds\" in r.keys():\n        bounds = r[\"bounds\"]\n    else:\n        bounds = None\n    return bounds\n</code></pre>"},{"location":"stac/#anymap.stac.cog_center","title":"<code>cog_center(url, titiler_endpoint=None)</code>","text":"<p>Get the centroid of a Cloud Optimized GeoTIFF (COG).</p> <p>Parameters:</p> Name Type Description Default <code>url</code> <code>str</code> <p>HTTP URL to a COG, e.g., https://opendata.digitalglobe.com/events/mauritius-oil-spill/post-event/2020-08-12/105001001F1B5B00/105001001F1B5B00.tif</p> required <code>titiler_endpoint</code> <code>str</code> <p>TiTiler endpoint. Defaults to \"https://giswqs-titiler-endpoint.hf.space\".</p> <code>None</code> <p>Returns:</p> Type Description <code>tuple</code> <p>A tuple representing (longitude, latitude)</p> Source code in <code>anymap/stac.py</code> <pre><code>def cog_center(\n    url: str,\n    titiler_endpoint: Optional[str] = None,\n) -&gt; Tuple:\n    \"\"\"Get the centroid of a Cloud Optimized GeoTIFF (COG).\n\n    Args:\n        url (str): HTTP URL to a COG, e.g., https://opendata.digitalglobe.com/events/mauritius-oil-spill/post-event/2020-08-12/105001001F1B5B00/105001001F1B5B00.tif\n        titiler_endpoint (str, optional): TiTiler endpoint. Defaults to \"https://giswqs-titiler-endpoint.hf.space\".\n\n    Returns:\n        tuple: A tuple representing (longitude, latitude)\n    \"\"\"\n    titiler_endpoint = check_titiler_endpoint(titiler_endpoint)\n    bounds = cog_bounds(url, titiler_endpoint)\n    center = ((bounds[0] + bounds[2]) / 2, (bounds[1] + bounds[3]) / 2)  # (lat, lon)\n    return center\n</code></pre>"},{"location":"stac/#anymap.stac.cog_info","title":"<code>cog_info(url, titiler_endpoint=None, return_geojson=False)</code>","text":"<p>Get band statistics of a Cloud Optimized GeoTIFF (COG).</p> <p>Parameters:</p> Name Type Description Default <code>url</code> <code>str</code> <p>HTTP URL to a COG, e.g., https://opendata.digitalglobe.com/events/mauritius-oil-spill/post-event/2020-08-12/105001001F1B5B00/105001001F1B5B00.tif</p> required <code>titiler_endpoint</code> <code>str</code> <p>TiTiler endpoint. Defaults to \"https://giswqs-titiler-endpoint.hf.space\".</p> <code>None</code> <p>Returns:</p> Type Description <code>list</code> <p>A dictionary of band info.</p> Source code in <code>anymap/stac.py</code> <pre><code>def cog_info(\n    url: str,\n    titiler_endpoint: Optional[str] = None,\n    return_geojson: Optional[bool] = False,\n) -&gt; List:\n    \"\"\"Get band statistics of a Cloud Optimized GeoTIFF (COG).\n\n    Args:\n        url (str): HTTP URL to a COG, e.g., https://opendata.digitalglobe.com/events/mauritius-oil-spill/post-event/2020-08-12/105001001F1B5B00/105001001F1B5B00.tif\n        titiler_endpoint (str, optional): TiTiler endpoint. Defaults to \"https://giswqs-titiler-endpoint.hf.space\".\n\n    Returns:\n        list: A dictionary of band info.\n    \"\"\"\n\n    titiler_endpoint = check_titiler_endpoint(titiler_endpoint)\n    info = \"info\"\n    if return_geojson:\n        info = \"info.geojson\"\n\n    try:\n        r = requests.get(\n            f\"{titiler_endpoint}/cog/{info}\",\n            params={\n                \"url\": url,\n            },\n            timeout=10,\n        ).json()\n    except Exception as e:\n        titiler_endpoint = \"https://giswqs-titiler-endpoint.hf.space\"\n        r = requests.get(\n            f\"{titiler_endpoint}/cog/{info}\",\n            params={\n                \"url\": url,\n            },\n            timeout=10,\n        ).json()\n\n    return r\n</code></pre>"},{"location":"stac/#anymap.stac.cog_mosaic","title":"<code>cog_mosaic(links, titiler_endpoint=None, username='anonymous', layername=None, overwrite=False, verbose=True, **kwargs)</code>","text":"<p>Creates a COG mosaic from a list of COG URLs.</p> <p>Parameters:</p> Name Type Description Default <code>links</code> <code>list</code> <p>A list containing COG HTTP URLs.</p> required <code>titiler_endpoint</code> <code>str</code> <p>TiTiler endpoint. Defaults to \"https://giswqs-titiler-endpoint.hf.space\".</p> <code>None</code> <code>username</code> <code>str</code> <p>User name for the titiler endpoint. Defaults to \"anonymous\".</p> <code>'anonymous'</code> <code>layername</code> <code>[type]</code> <p>Layer name to use. Defaults to None.</p> <code>None</code> <code>overwrite</code> <code>bool</code> <p>Whether to overwrite the layer name if existing. Defaults to False.</p> <code>False</code> <code>verbose</code> <code>bool</code> <p>Whether to print out descriptive information. Defaults to True.</p> <code>True</code> <p>Exceptions:</p> Type Description <code>Exception</code> <p>If the COG mosaic fails to create.</p> <p>Returns:</p> Type Description <code>str</code> <p>The tile URL for the COG mosaic.</p> Source code in <code>anymap/stac.py</code> <pre><code>def cog_mosaic(\n    links: List,\n    titiler_endpoint: Optional[str] = None,\n    username: Optional[str] = \"anonymous\",\n    layername=None,\n    overwrite: Optional[bool] = False,\n    verbose: Optional[bool] = True,\n    **kwargs,\n) -&gt; str:\n    \"\"\"Creates a COG mosaic from a list of COG URLs.\n\n    Args:\n        links (list): A list containing COG HTTP URLs.\n        titiler_endpoint (str, optional): TiTiler endpoint. Defaults to \"https://giswqs-titiler-endpoint.hf.space\".\n        username (str, optional): User name for the titiler endpoint. Defaults to \"anonymous\".\n        layername ([type], optional): Layer name to use. Defaults to None.\n        overwrite (bool, optional): Whether to overwrite the layer name if existing. Defaults to False.\n        verbose (bool, optional): Whether to print out descriptive information. Defaults to True.\n\n    Raises:\n        Exception: If the COG mosaic fails to create.\n\n    Returns:\n        str: The tile URL for the COG mosaic.\n    \"\"\"\n\n    titiler_endpoint = check_titiler_endpoint(titiler_endpoint)\n    if layername is None:\n        layername = \"layer_X\"\n\n    try:\n        if verbose:\n            print(\"Creating COG masaic ...\")\n\n        # Create token\n        r = requests.post(\n            f\"{titiler_endpoint}/tokens/create\",\n            json={\"username\": username, \"scope\": [\"mosaic:read\", \"mosaic:create\"]},\n        ).json()\n        token = r[\"token\"]\n\n        # Create mosaic\n        requests.post(\n            f\"{titiler_endpoint}/mosaicjson/create\",\n            json={\n                \"username\": username,\n                \"layername\": layername,\n                \"files\": links,\n                # \"overwrite\": overwrite\n            },\n            params={\n                \"access_token\": token,\n            },\n        ).json()\n\n        r2 = requests.get(\n            f\"{titiler_endpoint}/mosaicjson/{username}.{layername}/tilejson.json\",\n        ).json()\n\n        return r2[\"tiles\"][0]\n\n    except Exception as e:\n        raise Exception(e)\n</code></pre>"},{"location":"stac/#anymap.stac.cog_mosaic_from_file","title":"<code>cog_mosaic_from_file(filepath, skip_rows=0, titiler_endpoint=None, username='anonymous', layername=None, overwrite=False, verbose=True, **kwargs)</code>","text":"<p>Creates a COG mosaic from a csv/txt file stored locally for through HTTP URL.</p> <p>Parameters:</p> Name Type Description Default <code>filepath</code> <code>str</code> <p>Local path or HTTP URL to the csv/txt file containing COG URLs.</p> required <code>skip_rows</code> <code>int</code> <p>The number of rows to skip in the file. Defaults to 0.</p> <code>0</code> <code>titiler_endpoint</code> <code>str</code> <p>TiTiler endpoint. Defaults to \"https://giswqs-titiler-endpoint.hf.space\".</p> <code>None</code> <code>username</code> <code>str</code> <p>User name for the titiler endpoint. Defaults to \"anonymous\".</p> <code>'anonymous'</code> <code>layername</code> <code>[type]</code> <p>Layer name to use. Defaults to None.</p> <code>None</code> <code>overwrite</code> <code>bool</code> <p>Whether to overwrite the layer name if existing. Defaults to False.</p> <code>False</code> <code>verbose</code> <code>bool</code> <p>Whether to print out descriptive information. Defaults to True.</p> <code>True</code> <p>Returns:</p> Type Description <code>str</code> <p>The tile URL for the COG mosaic.</p> Source code in <code>anymap/stac.py</code> <pre><code>def cog_mosaic_from_file(\n    filepath: str,\n    skip_rows: Optional[int] = 0,\n    titiler_endpoint: Optional[str] = None,\n    username: Optional[str] = \"anonymous\",\n    layername=None,\n    overwrite: Optional[bool] = False,\n    verbose: Optional[bool] = True,\n    **kwargs,\n) -&gt; str:\n    \"\"\"Creates a COG mosaic from a csv/txt file stored locally for through HTTP URL.\n\n    Args:\n        filepath (str): Local path or HTTP URL to the csv/txt file containing COG URLs.\n        skip_rows (int, optional): The number of rows to skip in the file. Defaults to 0.\n        titiler_endpoint (str, optional): TiTiler endpoint. Defaults to \"https://giswqs-titiler-endpoint.hf.space\".\n        username (str, optional): User name for the titiler endpoint. Defaults to \"anonymous\".\n        layername ([type], optional): Layer name to use. Defaults to None.\n        overwrite (bool, optional): Whether to overwrite the layer name if existing. Defaults to False.\n        verbose (bool, optional): Whether to print out descriptive information. Defaults to True.\n\n    Returns:\n        str: The tile URL for the COG mosaic.\n    \"\"\"\n    import urllib\n\n    titiler_endpoint = check_titiler_endpoint(titiler_endpoint)\n    links = []\n    if filepath.startswith(\"http\"):\n        data = urllib.request.urlopen(filepath)\n        for line in data:\n            links.append(line.decode(\"utf-8\").strip())\n\n    else:\n        with open(filepath) as f:\n            links = [line.strip() for line in f.readlines()]\n\n    links = links[skip_rows:]\n    # print(links)\n    mosaic = cog_mosaic(\n        links, titiler_endpoint, username, layername, overwrite, verbose, **kwargs\n    )\n    return mosaic\n</code></pre>"},{"location":"stac/#anymap.stac.cog_pixel_value","title":"<code>cog_pixel_value(lon, lat, url, bidx, titiler_endpoint=None, verbose=True, **kwargs)</code>","text":"<p>Get pixel value from COG.</p> <p>Parameters:</p> Name Type Description Default <code>lon</code> <code>float</code> <p>Longitude of the pixel.</p> required <code>lat</code> <code>float</code> <p>Latitude of the pixel.</p> required <code>url</code> <code>str</code> <p>HTTP URL to a COG, e.g., 'https://github.com/opengeos/data/releases/download/raster/Libya-2023-07-01.tif'</p> required <code>bidx</code> <code>str</code> <p>Dataset band indexes (e.g bidx=1, bidx=1&amp;bidx=2&amp;bidx=3). Defaults to None.</p> required <code>titiler_endpoint</code> <code>str</code> <p>TiTiler endpoint, e.g., \"https://giswqs-titiler-endpoint.hf.space\", \"planetary-computer\", \"pc\". Defaults to None.</p> <code>None</code> <code>verbose</code> <code>bool</code> <p>Print status messages. Defaults to True.</p> <code>True</code> <p>Returns:</p> Type Description <code>list</code> <p>A dictionary of band info.</p> Source code in <code>anymap/stac.py</code> <pre><code>def cog_pixel_value(\n    lon: float,\n    lat: float,\n    url: str,\n    bidx: Optional[str],\n    titiler_endpoint: Optional[str] = None,\n    verbose: Optional[bool] = True,\n    **kwargs,\n) -&gt; List:\n    \"\"\"Get pixel value from COG.\n\n    Args:\n        lon (float): Longitude of the pixel.\n        lat (float): Latitude of the pixel.\n        url (str): HTTP URL to a COG, e.g., 'https://github.com/opengeos/data/releases/download/raster/Libya-2023-07-01.tif'\n        bidx (str, optional): Dataset band indexes (e.g bidx=1, bidx=1&amp;bidx=2&amp;bidx=3). Defaults to None.\n        titiler_endpoint (str, optional): TiTiler endpoint, e.g., \"https://giswqs-titiler-endpoint.hf.space\", \"planetary-computer\", \"pc\". Defaults to None.\n        verbose (bool, optional): Print status messages. Defaults to True.\n\n    Returns:\n        list: A dictionary of band info.\n    \"\"\"\n\n    titiler_endpoint = check_titiler_endpoint(titiler_endpoint)\n    kwargs[\"url\"] = url\n    if bidx is not None:\n        kwargs[\"bidx\"] = bidx\n\n    r = requests.get(f\"{titiler_endpoint}/cog/point/{lon},{lat}\", params=kwargs).json()\n    bands = cog_bands(url, titiler_endpoint)\n    # if isinstance(titiler_endpoint, str):\n    #     r = requests.get(f\"{titiler_endpoint}/cog/point/{lon},{lat}\", params=kwargs).json()\n    # else:\n    #     r = requests.get(\n    #         titiler_endpoint.url_for_stac_pixel_value(lon, lat), params=kwargs\n    #     ).json()\n\n    if \"detail\" in r:\n        if verbose:\n            print(r[\"detail\"])\n        return None\n    else:\n        values = r[\"values\"]\n        result = dict(zip(bands, values))\n        return result\n</code></pre>"},{"location":"stac/#anymap.stac.cog_stats","title":"<code>cog_stats(url, titiler_endpoint=None)</code>","text":"<p>Get band statistics of a Cloud Optimized GeoTIFF (COG).</p> <p>Parameters:</p> Name Type Description Default <code>url</code> <code>str</code> <p>HTTP URL to a COG, e.g., https://opendata.digitalglobe.com/events/mauritius-oil-spill/post-event/2020-08-12/105001001F1B5B00/105001001F1B5B00.tif</p> required <code>titiler_endpoint</code> <code>str</code> <p>TiTiler endpoint. Defaults to \"https://giswqs-titiler-endpoint.hf.space\".</p> <code>None</code> <p>Returns:</p> Type Description <code>list</code> <p>A dictionary of band statistics.</p> Source code in <code>anymap/stac.py</code> <pre><code>def cog_stats(\n    url: str,\n    titiler_endpoint: Optional[str] = None,\n) -&gt; List:\n    \"\"\"Get band statistics of a Cloud Optimized GeoTIFF (COG).\n\n    Args:\n        url (str): HTTP URL to a COG, e.g., https://opendata.digitalglobe.com/events/mauritius-oil-spill/post-event/2020-08-12/105001001F1B5B00/105001001F1B5B00.tif\n        titiler_endpoint (str, optional): TiTiler endpoint. Defaults to \"https://giswqs-titiler-endpoint.hf.space\".\n\n    Returns:\n        list: A dictionary of band statistics.\n    \"\"\"\n\n    titiler_endpoint = check_titiler_endpoint(titiler_endpoint)\n    try:\n        r = requests.get(\n            f\"{titiler_endpoint}/cog/statistics\",\n            params={\n                \"url\": url,\n            },\n            timeout=10,\n        ).json()\n    except Exception as e:\n        titiler_endpoint = \"https://giswqs-titiler-endpoint.hf.space\"\n        r = requests.get(\n            f\"{titiler_endpoint}/cog/statistics\",\n            params={\n                \"url\": url,\n            },\n            timeout=10,\n        ).json()\n\n    return r\n</code></pre>"},{"location":"stac/#anymap.stac.cog_tile","title":"<code>cog_tile(url, bands=None, titiler_endpoint=None, **kwargs)</code>","text":"<p>Get a tile layer from a Cloud Optimized GeoTIFF (COG).</p> <p>Source code adapted from https://developmentseed.org/titiler/examples/notebooks/Working_with_CloudOptimizedGeoTIFF_simple/</p> <p>Parameters:</p> Name Type Description Default <code>url</code> <code>str</code> <p>HTTP URL to a COG, e.g., https://opendata.digitalglobe.com/events/mauritius-oil-spill/post-event/2020-08-12/105001001F1B5B00/105001001F1B5B00.tif</p> required <code>bands</code> <code>Union[str, List[Union[str, int]]]</code> <p>List of bands to use. Can be band names (strings) or indices (integers). Defaults to None.</p> <code>None</code> <code>titiler_endpoint</code> <code>Optional[str]</code> <p>TiTiler endpoint. Defaults to \"https://giswqs-titiler-endpoint.hf.space\".</p> <code>None</code> <code>**kwargs</code> <code>Any</code> <p>Additional arguments to pass to the titiler endpoint. For more information about the available arguments, see https://developmentseed.org/titiler/endpoints/cog/#tiles. For example, to apply a rescaling to multiple bands, use something like <code>rescale=[\"164,223\",\"130,211\",\"99,212\"]</code>.</p> <code>{}</code> <p>Returns:</p> Type Description <code>Tuple[str, List[float]]</code> <p>A tuple containing the COG tile layer URL and bounds.</p> Source code in <code>anymap/stac.py</code> <pre><code>def cog_tile(\n    url: str,\n    bands: Optional[Union[str, List[Union[str, int]]]] = None,\n    titiler_endpoint: Optional[str] = None,\n    **kwargs: Any,\n) -&gt; Tuple[str, List[float]]:\n    \"\"\"Get a tile layer from a Cloud Optimized GeoTIFF (COG).\n\n    Source code adapted from https://developmentseed.org/titiler/examples/notebooks/Working_with_CloudOptimizedGeoTIFF_simple/\n\n    Args:\n        url: HTTP URL to a COG, e.g.,\n            https://opendata.digitalglobe.com/events/mauritius-oil-spill/post-event/2020-08-12/105001001F1B5B00/105001001F1B5B00.tif\n        bands: List of bands to use. Can be band names (strings) or indices (integers).\n            Defaults to None.\n        titiler_endpoint: TiTiler endpoint. Defaults to\n            \"https://giswqs-titiler-endpoint.hf.space\".\n        **kwargs: Additional arguments to pass to the titiler endpoint. For more\n            information about the available arguments, see\n            https://developmentseed.org/titiler/endpoints/cog/#tiles.\n            For example, to apply a rescaling to multiple bands, use something like\n            `rescale=[\"164,223\",\"130,211\",\"99,212\"]`.\n\n    Returns:\n        A tuple containing the COG tile layer URL and bounds.\n    \"\"\"\n    import json\n\n    titiler_endpoint = check_titiler_endpoint(titiler_endpoint)\n\n    kwargs[\"url\"] = url\n\n    try:\n        band_names = cog_bands(url, titiler_endpoint)\n    except Exception as e:\n        titiler_endpoint = \"https://giswqs-titiler-endpoint.hf.space\"\n        band_names = cog_bands(url, titiler_endpoint)\n\n    if isinstance(bands, str):\n        bands = [bands]\n\n    if bands is None and \"bidx\" not in kwargs:\n        if len(band_names) &gt;= 3:\n            kwargs[\"bidx\"] = [1, 2, 3]\n    elif isinstance(bands, list) and \"bidx\" not in kwargs:\n        if all(isinstance(x, int) for x in bands):\n            if len(set(bands)) == 1:\n                bands = bands[0]\n            kwargs[\"bidx\"] = bands\n        elif all(isinstance(x, str) for x in bands):\n            if len(set(bands)) == 1:\n                bands = bands[0]\n            kwargs[\"bidx\"] = [band_names.index(x) + 1 for x in bands]\n        else:\n            raise ValueError(\"Bands must be a list of integers or strings.\")\n\n    if \"palette\" in kwargs:\n        kwargs[\"colormap_name\"] = kwargs[\"palette\"].lower()\n        del kwargs[\"palette\"]\n\n    if \"bidx\" not in kwargs:\n        kwargs[\"bidx\"] = [1]\n    elif isinstance(kwargs[\"bidx\"], int):\n        kwargs[\"bidx\"] = [kwargs[\"bidx\"]]\n\n    if len(kwargs[\"bidx\"]) == 1 and (\"colormap\" not in kwargs):\n        colormap = _get_image_colormap(url)\n        if colormap is not None:\n            kwargs[\"colormap\"] = colormap\n\n    if \"rescale\" not in kwargs and (\"colormap\" not in kwargs):\n        try:\n            stats = cog_stats(url, titiler_endpoint)\n        except Exception as e:\n            titiler_endpoint = \"https://giswqs-titiler-endpoint.hf.space\"\n            stats = cog_stats(url, titiler_endpoint)\n\n        if \"message\" not in stats:\n            try:\n                rescale = []\n                for i in band_names:\n                    rescale.append(\n                        \"{},{}\".format(\n                            stats[i][\"percentile_2\"],\n                            stats[i][\"percentile_98\"],\n                        )\n                    )\n                kwargs[\"rescale\"] = rescale\n            except Exception as e:\n                pass\n\n    if \"colormap\" in kwargs and isinstance(kwargs[\"colormap\"], dict):\n        kwargs[\"colormap\"] = json.dumps(kwargs[\"colormap\"])\n\n    TileMatrixSetId = \"WebMercatorQuad\"\n    if \"TileMatrixSetId\" in kwargs.keys():\n        TileMatrixSetId = kwargs[\"TileMatrixSetId\"]\n        kwargs.pop(\"TileMatrixSetId\")\n\n    if \"default_vis\" in kwargs.keys() and kwargs[\"default_vis\"]:\n        kwargs = {\"url\": url}\n\n    try:\n        r = requests.get(\n            f\"{titiler_endpoint}/cog/{TileMatrixSetId}/tilejson.json\",\n            params=kwargs,\n            timeout=10,\n        ).json()\n    except Exception as e:\n        titiler_endpoint = \"https://giswqs-titiler-endpoint.hf.space\"\n        r = requests.get(\n            f\"{titiler_endpoint}/cog/{TileMatrixSetId}/tilejson.json\",\n            params=kwargs,\n            timeout=10,\n        ).json()\n    return r[\"tiles\"][0]\n</code></pre>"},{"location":"stac/#anymap.stac.cog_tile_vmin_vmax","title":"<code>cog_tile_vmin_vmax(url, bands=None, titiler_endpoint=None, percentile=True, **kwargs)</code>","text":"<p>Get a tile layer from a Cloud Optimized GeoTIFF (COG) and return the minimum and maximum values.</p> <p>Parameters:</p> Name Type Description Default <code>url</code> <code>str</code> <p>HTTP URL to a COG, e.g., https://opendata.digitalglobe.com/events/mauritius-oil-spill/post-event/2020-08-12/105001001F1B5B00/105001001F1B5B00.tif</p> required <code>bands</code> <code>Optional[List[str]]</code> <p>List of bands to use. Defaults to None.</p> <code>None</code> <code>titiler_endpoint</code> <code>Optional[str]</code> <p>TiTiler endpoint. Defaults to \"https://giswqs-titiler-endpoint.hf.space\".</p> <code>None</code> <code>percentile</code> <code>Optional[bool]</code> <p>Whether to use percentiles or not. Defaults to True.</p> <code>True</code> <code>**kwargs</code> <code>Any</code> <p>Additional keyword arguments.</p> <code>{}</code> <p>Returns:</p> Type Description <code>Tuple[float, float]</code> <p>A tuple containing the minimum and maximum values.</p> Source code in <code>anymap/stac.py</code> <pre><code>def cog_tile_vmin_vmax(\n    url: str,\n    bands: Optional[List[str]] = None,\n    titiler_endpoint: Optional[str] = None,\n    percentile: Optional[bool] = True,\n    **kwargs: Any,\n) -&gt; Tuple[float, float]:\n    \"\"\"Get a tile layer from a Cloud Optimized GeoTIFF (COG) and return the minimum and maximum values.\n\n    Args:\n        url: HTTP URL to a COG, e.g.,\n            https://opendata.digitalglobe.com/events/mauritius-oil-spill/post-event/2020-08-12/105001001F1B5B00/105001001F1B5B00.tif\n        bands: List of bands to use. Defaults to None.\n        titiler_endpoint: TiTiler endpoint. Defaults to \"https://giswqs-titiler-endpoint.hf.space\".\n        percentile: Whether to use percentiles or not. Defaults to True.\n        **kwargs: Additional keyword arguments.\n\n    Returns:\n        A tuple containing the minimum and maximum values.\n    \"\"\"\n\n    titiler_endpoint = check_titiler_endpoint(titiler_endpoint)\n    stats = cog_stats(url, titiler_endpoint)\n\n    if isinstance(bands, str):\n        bands = [bands]\n\n    if bands is not None:\n        stats = {s: stats[s] for s in stats if s in bands}\n\n    if percentile:\n        vmin = min([stats[s][\"percentile_2\"] for s in stats])\n        vmax = max([stats[s][\"percentile_98\"] for s in stats])\n    else:\n        vmin = min([stats[s][\"min\"] for s in stats])\n        vmax = max([stats[s][\"max\"] for s in stats])\n\n    return vmin, vmax\n</code></pre>"},{"location":"stac/#anymap.stac.create_mosaicjson","title":"<code>create_mosaicjson(images, output)</code>","text":"<p>Create a mosaicJSON file from a list of images.</p> <p>Parameters:</p> Name Type Description Default <code>images</code> <code>str | list</code> <p>A list of image URLs or a URL to a text file containing a list of image URLs.</p> required <code>output</code> <code>str</code> <p>The output mosaicJSON file path.</p> required Source code in <code>anymap/stac.py</code> <pre><code>def create_mosaicjson(images, output):\n    \"\"\"Create a mosaicJSON file from a list of images.\n\n    Args:\n        images (str | list): A list of image URLs or a URL to a text file containing a list of image URLs.\n        output (str): The output mosaicJSON file path.\n\n    \"\"\"\n    try:\n        from cogeo_mosaic.mosaic import MosaicJSON\n        from cogeo_mosaic.backends import MosaicBackend\n    except ImportError:\n        raise ImportError(\n            \"cogeo-mosaic is required to use this function. \"\n            \"Install with `pip install cogeo-mosaic`.\"\n        )\n\n    if isinstance(images, str):\n        if images.startswith(\"http\"):\n            import urllib.request\n\n            with urllib.request.urlopen(images) as f:\n                file_contents = f.read().decode(\"utf-8\")\n                images = file_contents.strip().split(\"\\n\")\n        elif not os.path.exists(images):\n            raise FileNotFoundError(f\"{images} does not exist.\")\n\n    elif not isinstance(images, list):\n        raise ValueError(\"images must be a list or a URL.\")\n\n    mosaic = MosaicJSON.from_urls(images)\n    with MosaicBackend(output, mosaic_def=mosaic) as f:\n        f.write(overwrite=True)\n</code></pre>"},{"location":"stac/#anymap.stac.download_data_catalogs","title":"<code>download_data_catalogs(out_dir=None, quiet=True, overwrite=False)</code>","text":"<p>Download geospatial data catalogs from https://github.com/giswqs/geospatial-data-catalogs.</p> <p>Parameters:</p> Name Type Description Default <code>out_dir</code> <code>str</code> <p>The output directory. Defaults to None.</p> <code>None</code> <code>quiet</code> <code>bool</code> <p>Whether to suppress the download progress bar. Defaults to True.</p> <code>True</code> <code>overwrite</code> <code>bool</code> <p>Whether to overwrite the existing data catalog. Defaults to False.</p> <code>False</code> <p>Returns:</p> Type Description <code>str</code> <p>The path to the downloaded data catalog.</p> Source code in <code>anymap/stac.py</code> <pre><code>def download_data_catalogs(\n    out_dir: Optional[str] = None,\n    quiet: Optional[bool] = True,\n    overwrite: Optional[bool] = False,\n) -&gt; str:\n    \"\"\"Download geospatial data catalogs from https://github.com/giswqs/geospatial-data-catalogs.\n\n    Args:\n        out_dir (str, optional): The output directory. Defaults to None.\n        quiet (bool, optional): Whether to suppress the download progress bar. Defaults to True.\n        overwrite (bool, optional): Whether to overwrite the existing data catalog. Defaults to False.\n\n    Returns:\n        str: The path to the downloaded data catalog.\n    \"\"\"\n    import tempfile\n    import gdown\n    import zipfile\n\n    if out_dir is None:\n        out_dir = tempfile.gettempdir()\n    elif not os.path.exists(out_dir):\n        os.makedirs(out_dir)\n\n    url = \"https://github.com/giswqs/geospatial-data-catalogs/archive/refs/heads/master.zip\"\n\n    out_file = os.path.join(out_dir, \"geospatial-data-catalogs.zip\")\n    work_dir = os.path.join(out_dir, \"geospatial-data-catalogs-master\")\n\n    if os.path.exists(work_dir) and not overwrite:\n        return work_dir\n    else:\n        gdown.download(url, out_file, quiet=quiet)\n        with zipfile.ZipFile(out_file, \"r\") as zip_ref:\n            zip_ref.extractall(out_dir)\n        return work_dir\n</code></pre>"},{"location":"stac/#anymap.stac.flatten_dict","title":"<code>flatten_dict(my_dict, parent_key=False, sep='.')</code>","text":"<p>Flattens a nested dictionary.</p> <p>Parameters:</p> Name Type Description Default <code>my_dict</code> <code>dict</code> <p>The dictionary to flatten.</p> required <code>parent_key</code> <code>bool</code> <p>Whether to include the parent key. Defaults to False.</p> <code>False</code> <code>sep</code> <code>str</code> <p>The separator to use. Defaults to '.'.</p> <code>'.'</code> <p>Returns:</p> Type Description <code>dict</code> <p>The flattened dictionary.</p> Source code in <code>anymap/stac.py</code> <pre><code>def flatten_dict(my_dict, parent_key=False, sep=\".\"):\n    \"\"\"Flattens a nested dictionary.\n\n    Args:\n        my_dict (dict): The dictionary to flatten.\n        parent_key (bool, optional): Whether to include the parent key. Defaults to False.\n        sep (str, optional): The separator to use. Defaults to '.'.\n\n    Returns:\n        dict: The flattened dictionary.\n    \"\"\"\n\n    flat_dict = {}\n    for key, value in my_dict.items():\n        if not isinstance(value, dict):\n            flat_dict[key] = value\n        else:\n            sub_dict = flatten_dict(value)\n            for sub_key, sub_value in sub_dict.items():\n                if parent_key:\n                    flat_dict[parent_key + sep + sub_key] = sub_value\n                else:\n                    flat_dict[sub_key] = sub_value\n\n    return flat_dict\n</code></pre>"},{"location":"stac/#anymap.stac.get_cog_link_from_stac_item","title":"<code>get_cog_link_from_stac_item(item_url)</code>","text":"<p>Retrieve the URL of the GeoTIFF asset from a STAC Item.</p> <p>Parameters:</p> Name Type Description Default <code>item_url</code> <code>str</code> <p>The URL to a STAC Item JSON.</p> required <p>Returns:</p> Type Description <code>str</code> <p>URL of the first .tif asset, or None if not found.</p> Source code in <code>anymap/stac.py</code> <pre><code>def get_cog_link_from_stac_item(item_url: str) -&gt; str:\n    \"\"\"\n    Retrieve the URL of the GeoTIFF asset from a STAC Item.\n\n    Args:\n        item_url (str): The URL to a STAC Item JSON.\n\n    Returns:\n        str: URL of the first .tif asset, or None if not found.\n    \"\"\"\n    try:\n        response = requests.get(item_url)\n        response.raise_for_status()\n        item = response.json()\n\n        # Look for any asset ending in .tif\n        for asset_key, asset in item.get(\"assets\", {}).items():\n            href = asset.get(\"href\", \"\")\n            if href.endswith(\".tif\") or \".tif?\" in href:\n                return href\n\n        print(\"No .tif asset found in item.\")\n        return None\n    except Exception as e:\n        print(f\"Failed to retrieve STAC item: {e}\")\n        return None\n</code></pre>"},{"location":"stac/#anymap.stac.maxar_all_items","title":"<code>maxar_all_items(collection_id, return_gdf=True, assets=['visual'], verbose=True, **kwargs)</code>","text":"<p>Retrieve STAC items from Maxar's public STAC API.</p> <p>Parameters:</p> Name Type Description Default <code>collection_id</code> <code>str</code> <p>The collection ID, e.g., Kahramanmaras-turkey-earthquake-23 Use maxar_collections() to retrieve all available collection IDs.</p> required <code>return_gdf</code> <code>bool</code> <p>If True, return a GeoDataFrame. Defaults to True.</p> <code>True</code> <code>assets</code> <code>list</code> <p>A list of asset names to include in the GeoDataFrame. It can be \"visual\", \"ms_analytic\", \"pan_analytic\", \"data-mask\". Defaults to ['visual'].</p> <code>['visual']</code> <code>verbose</code> <code>bool</code> <p>If True, print progress. Defaults to True.</p> <code>True</code> <code>**kwargs</code> <p>Additional keyword arguments to pass to the pystac Catalog.from_file() method.</p> <code>{}</code> <p>Returns:</p> Type Description <code>GeoDataFrame | pystac.ItemCollection</code> <p>If return_gdf is True, return a GeoDataFrame.</p> Source code in <code>anymap/stac.py</code> <pre><code>def maxar_all_items(\n    collection_id: str,\n    return_gdf: Optional[bool] = True,\n    assets: Optional[List] = [\"visual\"],\n    verbose: Optional[bool] = True,\n    **kwargs,\n):\n    \"\"\"Retrieve STAC items from Maxar's public STAC API.\n\n    Args:\n        collection_id (str): The collection ID, e.g., Kahramanmaras-turkey-earthquake-23\n            Use maxar_collections() to retrieve all available collection IDs.\n        return_gdf (bool, optional): If True, return a GeoDataFrame. Defaults to True.\n        assets (list, optional): A list of asset names to include in the GeoDataFrame.\n            It can be \"visual\", \"ms_analytic\", \"pan_analytic\", \"data-mask\". Defaults to ['visual'].\n        verbose (bool, optional): If True, print progress. Defaults to True.\n        **kwargs: Additional keyword arguments to pass to the pystac Catalog.from_file() method.\n\n    Returns:\n        GeoDataFrame | pystac.ItemCollection: If return_gdf is True, return a GeoDataFrame.\n    \"\"\"\n\n    child_ids = maxar_child_collections(collection_id, **kwargs)\n    for index, child_id in enumerate(child_ids):\n        if verbose:\n            print(\n                f\"Processing ({str(index+1).zfill(len(str(len(child_ids))))} out of {len(child_ids)}): {child_id} ...\"\n            )\n        items = maxar_items(collection_id, child_id, return_gdf, assets, **kwargs)\n        if return_gdf:\n            if child_id == child_ids[0]:\n                gdf = items\n            else:\n                gdf = pd.concat([gdf, items], ignore_index=True)\n        else:\n            if child_id == child_ids[0]:\n                items_all = items\n            else:\n                items_all.extend(items)\n\n    if return_gdf:\n        return gdf\n    else:\n        return items_all\n</code></pre>"},{"location":"stac/#anymap.stac.maxar_child_collections","title":"<code>maxar_child_collections(collection_id, return_ids=True, **kwargs)</code>","text":"<p>Get a list of Maxar child collections.</p> <p>Parameters:</p> Name Type Description Default <code>collection_id</code> <code>str</code> <p>The collection ID, e.g., Kahramanmaras-turkey-earthquake-23 Use maxar_collections() to retrieve all available collection IDs.</p> required <code>return_ids</code> <code>bool</code> <p>Whether to return the collection ids. Defaults to True.</p> <code>True</code> <code>**kwargs</code> <p>Additional keyword arguments to pass to the pystac Catalog.from_file() method.</p> <code>{}</code> <p>Returns:</p> Type Description <code>list</code> <p>A list of Maxar child collections.</p> Source code in <code>anymap/stac.py</code> <pre><code>def maxar_child_collections(\n    collection_id: str, return_ids: Optional[bool] = True, **kwargs\n) -&gt; List:\n    \"\"\"Get a list of Maxar child collections.\n\n    Args:\n        collection_id (str): The collection ID, e.g., Kahramanmaras-turkey-earthquake-23\n            Use maxar_collections() to retrieve all available collection IDs.\n        return_ids (bool, optional): Whether to return the collection ids. Defaults to True.\n        **kwargs: Additional keyword arguments to pass to the pystac Catalog.from_file() method.\n\n    Returns:\n        list: A list of Maxar child collections.\n    \"\"\"\n\n    import tempfile\n    from pystac import Catalog\n\n    file_path = os.path.join(tempfile.gettempdir(), f\"maxar-{collection_id}.txt\")\n    if return_ids:\n        if os.path.exists(file_path):\n            with open(file_path, \"r\") as f:\n                return [line.strip() for line in f.readlines()]\n\n    if \"MAXAR_STAC_API\" in os.environ:\n        url = os.environ[\"MAXAR_STAC_API\"]\n    else:\n        url = \"https://maxar-opendata.s3.amazonaws.com/events/catalog.json\"\n\n    root_catalog = Catalog.from_file(url, **kwargs)\n\n    collections = root_catalog.get_child(collection_id).get_collections()\n\n    if return_ids:\n        collection_ids = [collection.id for collection in collections]\n        with open(file_path, \"w\") as f:\n            f.write(\"\\n\".join(collection_ids))\n        return collection_ids\n\n    else:\n        return collections\n</code></pre>"},{"location":"stac/#anymap.stac.maxar_collection_url","title":"<code>maxar_collection_url(collection, dtype='geojson', raw=True)</code>","text":"<p>Retrieve the URL to a Maxar Open Data collection.</p> <p>Parameters:</p> Name Type Description Default <code>collection</code> <code>str</code> <p>The collection ID, e.g., Kahramanmaras-turkey-earthquake-23. Use maxar_collections() to retrieve all available collection IDs.</p> required <code>dtype</code> <code>str</code> <p>The data type. It can be 'geojson' or 'tsv'. Defaults to 'geojson'.</p> <code>'geojson'</code> <code>raw</code> <code>bool</code> <p>If True, return the raw URL. Defaults to True.</p> <code>True</code> <p>Returns:</p> Type Description <code>str</code> <p>The URL to the collection.</p> Source code in <code>anymap/stac.py</code> <pre><code>def maxar_collection_url(collection, dtype=\"geojson\", raw=True):\n    \"\"\"Retrieve the URL to a Maxar Open Data collection.\n\n    Args:\n        collection (str): The collection ID, e.g., Kahramanmaras-turkey-earthquake-23.\n            Use maxar_collections() to retrieve all available collection IDs.\n        dtype (str, optional): The data type. It can be 'geojson' or 'tsv'. Defaults to 'geojson'.\n        raw (bool, optional): If True, return the raw URL. Defaults to True.\n\n    Returns:\n        str: The URL to the collection.\n    \"\"\"\n    collections = maxar_collections()\n    if collection not in collections:\n        raise ValueError(\n            f\"Invalid collection name. Use maxar_collections() to retrieve all available collection IDs.\"\n        )\n\n    if dtype not in [\"geojson\", \"tsv\"]:\n        raise ValueError(f\"Invalid dtype. It can be 'geojson' or 'tsv'.\")\n\n    if raw:\n        url = f\"https://raw.githubusercontent.com/giswqs/maxar-open-data/master/datasets/{collection}.{dtype}\"\n    else:\n        url = f\"https://github.com/giswqs/maxar-open-data/blob/master/datasets/{collection}.{dtype}\"\n    return url\n</code></pre>"},{"location":"stac/#anymap.stac.maxar_collections","title":"<code>maxar_collections(return_ids=True, **kwargs)</code>","text":"<p>Get a list of Maxar collections.</p> <p>Parameters:</p> Name Type Description Default <code>return_ids</code> <code>bool</code> <p>Whether to return the collection ids. Defaults to True.</p> <code>True</code> <code>**kwargs</code> <p>Additional keyword arguments to pass to the pystac Catalog.from_file() method.</p> <code>{}</code> <p>Returns:</p> Type Description <code>list </code> <p>A list of Maxar collections.</p> Source code in <code>anymap/stac.py</code> <pre><code>def maxar_collections(return_ids: Optional[bool] = True, **kwargs) -&gt; List:\n    \"\"\"Get a list of Maxar collections.\n\n    Args:\n        return_ids (bool, optional): Whether to return the collection ids. Defaults to True.\n        **kwargs: Additional keyword arguments to pass to the pystac Catalog.from_file() method.\n\n    Returns:\n        list : A list of Maxar collections.\n    \"\"\"\n\n    import tempfile\n    from pystac import Catalog\n    import pandas as pd\n\n    if return_ids:\n        url = \"https://raw.githubusercontent.com/giswqs/maxar-open-data/master/datasets.csv\"\n        df = pd.read_csv(url)\n        return df[\"dataset\"].tolist()\n\n    file_path = os.path.join(tempfile.gettempdir(), \"maxar-collections.txt\")\n    if return_ids:\n        if os.path.exists(file_path):\n            with open(file_path, \"r\") as f:\n                return [line.strip() for line in f.readlines()]\n\n    if \"MAXAR_STAC_API\" in os.environ:\n        url = os.environ[\"MAXAR_STAC_API\"]\n    else:\n        url = \"https://maxar-opendata.s3.amazonaws.com/events/catalog.json\"\n\n    root_catalog = Catalog.from_file(url, **kwargs)\n\n    collections = root_catalog.get_collections()\n\n    # if return_ids:\n    #     collection_ids = [collection.id for collection in collections]\n    #     with open(file_path, \"w\") as f:\n    #         f.write(\"\\n\".join(collection_ids))\n\n    #     return collection_ids\n    # else:\n    return collections\n</code></pre>"},{"location":"stac/#anymap.stac.maxar_download","title":"<code>maxar_download(images, out_dir=None, quiet=False, proxy=None, speed=None, use_cookies=True, verify=True, id=None, fuzzy=False, resume=False, overwrite=False)</code>","text":"<p>Download Mxar Open Data images.</p> <p>Parameters:</p> Name Type Description Default <code>images</code> <code>str | images</code> <p>The list of image links or a file path to a geojson or tsv containing the Maxar download links.</p> required <code>out_dir</code> <code>str</code> <p>The output directory. Defaults to None.</p> <code>None</code> <code>quiet</code> <code>bool</code> <p>Suppress terminal output. Default is False.</p> <code>False</code> <code>proxy</code> <code>str</code> <p>Proxy. Defaults to None.</p> <code>None</code> <code>speed</code> <code>float</code> <p>Download byte size per second (e.g., 256KB/s = 256 * 1024). Defaults to None.</p> <code>None</code> <code>use_cookies</code> <code>bool</code> <p>Flag to use cookies. Defaults to True.</p> <code>True</code> <code>verify</code> <code>bool | str</code> <p>Either a bool, in which case it controls whether the server's TLS certificate is verified, or a string, in which case it must be a path to a CA bundle to use. Default is True.. Defaults to True.</p> <code>True</code> <code>id</code> <code>str</code> <p>Google Drive's file ID. Defaults to None.</p> <code>None</code> <code>fuzzy</code> <code>bool</code> <p>Fuzzy extraction of Google Drive's file Id. Defaults to False.</p> <code>False</code> <code>resume</code> <code>bool</code> <p>Resume the download from existing tmp file if possible. Defaults to False.</p> <code>False</code> <code>overwrite</code> <code>bool</code> <p>Overwrite the file if it already exists. Defaults to False.</p> <code>False</code> Source code in <code>anymap/stac.py</code> <pre><code>def maxar_download(\n    images,\n    out_dir=None,\n    quiet=False,\n    proxy=None,\n    speed=None,\n    use_cookies=True,\n    verify=True,\n    id=None,\n    fuzzy=False,\n    resume=False,\n    overwrite=False,\n):\n    \"\"\"Download Mxar Open Data images.\n\n    Args:\n        images (str | images): The list of image links or a file path to a geojson or tsv containing the Maxar download links.\n        out_dir (str, optional): The output directory. Defaults to None.\n        quiet (bool, optional): Suppress terminal output. Default is False.\n        proxy (str, optional): Proxy. Defaults to None.\n        speed (float, optional): Download byte size per second (e.g., 256KB/s = 256 * 1024). Defaults to None.\n        use_cookies (bool, optional): Flag to use cookies. Defaults to True.\n        verify (bool | str, optional): Either a bool, in which case it controls whether the server's TLS certificate is verified, or a string,\n            in which case it must be a path to a CA bundle to use. Default is True.. Defaults to True.\n        id (str, optional): Google Drive's file ID. Defaults to None.\n        fuzzy (bool, optional): Fuzzy extraction of Google Drive's file Id. Defaults to False.\n        resume (bool, optional): Resume the download from existing tmp file if possible. Defaults to False.\n        overwrite (bool, optional): Overwrite the file if it already exists. Defaults to False.\n\n    \"\"\"\n    import gdown\n\n    if out_dir is None:\n        out_dir = os.getcwd()\n\n    if isinstance(images, str):\n        if images.endswith(\".geojson\"):\n            import geopandas as gpd\n\n            data = gpd.read_file(images)\n            images = data[\"visual\"].tolist()\n        elif images.endswith(\".tsv\"):\n            import pandas as pd\n\n            data = pd.read_csv(images, sep=\"\\t\")\n            images = data[\"visual\"].tolist()\n        else:\n            raise ValueError(f\"Invalid file type. It can be 'geojson' or 'tsv'.\")\n\n    if not os.path.exists(out_dir):\n        os.makedirs(out_dir)\n\n    for index, image in enumerate(images):\n        items = image.split(\"/\")\n        file_name = items[7] + \".tif\"\n        dir_name = items[-1].split(\"-\")[0]\n        if not os.path.exists(os.path.join(out_dir, dir_name)):\n            os.makedirs(os.path.join(out_dir, dir_name))\n        out_file = os.path.join(out_dir, dir_name, file_name)\n        if os.path.exists(out_file) and (not overwrite):\n            print(f\"{out_file} already exists. Skipping...\")\n            continue\n        if not quiet:\n            print(\n                f\"Downloading {str(index+1).zfill(len(str(len(images))))} out of {len(images)}: {dir_name}/{file_name}\"\n            )\n\n        gdown.download(\n            image, out_file, quiet, proxy, speed, use_cookies, verify, id, fuzzy, resume\n        )\n</code></pre>"},{"location":"stac/#anymap.stac.maxar_items","title":"<code>maxar_items(collection_id, child_id, return_gdf=True, assets=['visual'], **kwargs)</code>","text":"<p>Retrieve STAC items from Maxar's public STAC API.</p> <p>Parameters:</p> Name Type Description Default <code>collection_id</code> <code>str</code> <p>The collection ID, e.g., Kahramanmaras-turkey-earthquake-23 Use maxar_collections() to retrieve all available collection IDs.</p> required <code>child_id</code> <code>str</code> <p>The child collection ID, e.g., 1050050044DE7E00 Use maxar_child_collections() to retrieve all available child collection IDs.</p> required <code>return_gdf</code> <code>bool</code> <p>If True, return a GeoDataFrame. Defaults to True.</p> <code>True</code> <code>assets</code> <code>list</code> <p>A list of asset names to include in the GeoDataFrame. It can be \"visual\", \"ms_analytic\", \"pan_analytic\", \"data-mask\". Defaults to ['visual'].</p> <code>['visual']</code> <code>**kwargs</code> <p>Additional keyword arguments to pass to the pystac Catalog.from_file() method.</p> <code>{}</code> <p>Returns:</p> Type Description <code>GeoDataFrame | pystac.ItemCollection</code> <p>If return_gdf is True, return a GeoDataFrame.</p> Source code in <code>anymap/stac.py</code> <pre><code>def maxar_items(\n    collection_id: str,\n    child_id: str,\n    return_gdf: Optional[bool] = True,\n    assets: Optional[List] = [\"visual\"],\n    **kwargs,\n):\n    \"\"\"Retrieve STAC items from Maxar's public STAC API.\n\n    Args:\n        collection_id (str): The collection ID, e.g., Kahramanmaras-turkey-earthquake-23\n            Use maxar_collections() to retrieve all available collection IDs.\n        child_id (str): The child collection ID, e.g., 1050050044DE7E00\n            Use maxar_child_collections() to retrieve all available child collection IDs.\n        return_gdf (bool, optional): If True, return a GeoDataFrame. Defaults to True.\n        assets (list, optional): A list of asset names to include in the GeoDataFrame.\n            It can be \"visual\", \"ms_analytic\", \"pan_analytic\", \"data-mask\". Defaults to ['visual'].\n        **kwargs: Additional keyword arguments to pass to the pystac Catalog.from_file() method.\n\n    Returns:\n        GeoDataFrame | pystac.ItemCollection: If return_gdf is True, return a GeoDataFrame.\n    \"\"\"\n\n    import pickle\n    import tempfile\n    from pystac import Catalog, ItemCollection\n\n    file_path = os.path.join(\n        tempfile.gettempdir(), f\"maxar-{collection_id}-{child_id}.pkl\"\n    )\n\n    if os.path.exists(file_path):\n        with open(file_path, \"rb\") as f:\n            items = pickle.load(f)\n        if return_gdf:\n            import geopandas as gpd\n\n            gdf = gpd.GeoDataFrame.from_features(\n                pystac.ItemCollection(items).to_dict(), crs=\"EPSG:4326\"\n            )\n            # convert bbox column type from list to string\n            gdf[\"proj:bbox\"] = [\",\".join(map(str, l)) for l in gdf[\"proj:bbox\"]]\n            if assets is not None:\n                if isinstance(assets, str):\n                    assets = [assets]\n                elif not isinstance(assets, list):\n                    raise ValueError(\"assets must be a list or a string.\")\n\n                for asset in assets:\n                    links = []\n                    for item in items:\n                        if asset in item.get_assets():\n                            link = item.get_assets()[asset].get_absolute_href()\n                            links.append(link)\n                        else:\n                            links.append(\"\")\n\n                    gdf[asset] = links\n\n            return gdf\n        else:\n            return items\n\n    if \"MAXAR_STAC_API\" in os.environ:\n        url = os.environ[\"MAXAR_STAC_API\"]\n    else:\n        url = \"https://maxar-opendata.s3.amazonaws.com/events/catalog.json\"\n\n    root_catalog = Catalog.from_file(url, **kwargs)\n\n    collection = root_catalog.get_child(collection_id)\n    child = collection.get_child(child_id)\n\n    items = ItemCollection(child.get_all_items())\n\n    with open(file_path, \"wb\") as f:\n        pickle.dump(items, f)\n\n    if return_gdf:\n        import geopandas as gpd\n\n        gdf = gpd.GeoDataFrame.from_features(\n            pystac.ItemCollection(items).to_dict(), crs=\"EPSG:4326\"\n        )\n        # convert bbox column type from list to string\n        gdf[\"proj:bbox\"] = [\",\".join(map(str, l)) for l in gdf[\"proj:bbox\"]]\n        if assets is not None:\n            if isinstance(assets, str):\n                assets = [assets]\n            elif not isinstance(assets, list):\n                raise ValueError(\"assets must be a list or a string.\")\n\n            for asset in assets:\n                links = []\n                for item in items:\n                    if asset in item.get_assets():\n                        link = item.get_assets()[asset].get_absolute_href()\n                        links.append(link)\n                    else:\n                        links.append(\"\")\n\n                gdf[asset] = links\n\n        return gdf\n    else:\n        return items\n</code></pre>"},{"location":"stac/#anymap.stac.maxar_refresh","title":"<code>maxar_refresh()</code>","text":"<p>Refresh the cached Maxar STAC items.</p> Source code in <code>anymap/stac.py</code> <pre><code>def maxar_refresh():\n    \"\"\"Refresh the cached Maxar STAC items.\"\"\"\n    import tempfile\n\n    temp_dir = tempfile.gettempdir()\n    for f in os.listdir(temp_dir):\n        if f.startswith(\"maxar-\"):\n            os.remove(os.path.join(temp_dir, f))\n\n    print(\"Maxar STAC items cache has been refreshed.\")\n</code></pre>"},{"location":"stac/#anymap.stac.maxar_search","title":"<code>maxar_search(collection, start_date=None, end_date=None, bbox=None, within=False, align=True)</code>","text":"<p>Search Maxar Open Data by collection ID, date range, and/or bounding box.</p> <p>Parameters:</p> Name Type Description Default <code>collection</code> <code>str</code> <p>The collection ID, e.g., Kahramanmaras-turkey-earthquake-23. Use maxar_collections() to retrieve all available collection IDs.</p> required <code>start_date</code> <code>str</code> <p>The start date, e.g., 2023-01-01. Defaults to None.</p> <code>None</code> <code>end_date</code> <code>str</code> <p>The end date, e.g., 2023-12-31. Defaults to None.</p> <code>None</code> <code>bbox</code> <code>list | GeoDataFrame</code> <p>The bounding box to filter by. Can be a list of 4 coordinates or a file path or a GeoDataFrame.</p> <code>None</code> <code>within</code> <code>bool</code> <p>Whether to filter by the bounding box or the bounding box's interior. Defaults to False.</p> <code>False</code> <code>align</code> <code>bool</code> <p>If True, automatically aligns GeoSeries based on their indices. If False, the order of elements is preserved.</p> <code>True</code> <p>Returns:</p> Type Description <code>GeoDataFrame</code> <p>A GeoDataFrame containing the search results.</p> Source code in <code>anymap/stac.py</code> <pre><code>def maxar_search(\n    collection, start_date=None, end_date=None, bbox=None, within=False, align=True\n):\n    \"\"\"Search Maxar Open Data by collection ID, date range, and/or bounding box.\n\n    Args:\n        collection (str): The collection ID, e.g., Kahramanmaras-turkey-earthquake-23.\n            Use maxar_collections() to retrieve all available collection IDs.\n        start_date (str, optional): The start date, e.g., 2023-01-01. Defaults to None.\n        end_date (str, optional): The end date, e.g., 2023-12-31. Defaults to None.\n        bbox (list | GeoDataFrame): The bounding box to filter by. Can be a list of 4 coordinates or a file path or a GeoDataFrame.\n        within (bool, optional): Whether to filter by the bounding box or the bounding box's interior. Defaults to False.\n        align (bool, optional): If True, automatically aligns GeoSeries based on their indices. If False, the order of elements is preserved.\n\n    Returns:\n        GeoDataFrame: A GeoDataFrame containing the search results.\n    \"\"\"\n    import datetime\n    import pandas as pd\n    import geopandas as gpd\n    from shapely.geometry import Polygon\n\n    collections = maxar_collections()\n    if collection not in collections:\n        raise ValueError(\n            f\"Invalid collection name. Use maxar_collections() to retrieve all available collection IDs.\"\n        )\n\n    url = f\"https://raw.githubusercontent.com/giswqs/maxar-open-data/master/datasets/{collection}.geojson\"\n    data = gpd.read_file(url)\n\n    if bbox is not None:\n        bbox = gpd.GeoDataFrame(\n            geometry=[Polygon.from_bounds(*bbox)],\n            crs=\"epsg:4326\",\n        )\n        if within:\n            data = data[data.within(bbox.unary_union, align=align)]\n        else:\n            data = data[data.intersects(bbox.unary_union, align=align)]\n\n    date_field = \"datetime\"\n    new_field = f\"{date_field}_temp\"\n    data[new_field] = pd.to_datetime(data[date_field])\n\n    if end_date is None:\n        end_date = datetime.datetime.now().strftime(\"%Y-%m-%d\")\n\n    if start_date is None:\n        start_date = data[new_field].min()\n\n    mask = (data[new_field] &gt;= start_date) &amp; (data[new_field] &lt;= end_date)\n    result = data.loc[mask]\n    return result.drop(columns=[new_field], axis=1)\n</code></pre>"},{"location":"stac/#anymap.stac.maxar_tile_url","title":"<code>maxar_tile_url(collection, tile, dtype='geojson', raw=True)</code>","text":"<p>Retrieve the URL to a Maxar Open Data tile.</p> <p>Parameters:</p> Name Type Description Default <code>collection</code> <code>str</code> <p>The collection ID, e.g., Kahramanmaras-turkey-earthquake-23. Use maxar_collections() to retrieve all available collection IDs.</p> required <code>tile</code> <code>str</code> <p>The tile ID, e.g., 10300500D9F8E600.</p> required <code>dtype</code> <code>str</code> <p>The data type. It can be 'geojson', 'json' or 'tsv'. Defaults to 'geojson'.</p> <code>'geojson'</code> <code>raw</code> <code>bool</code> <p>If True, return the raw URL. Defaults to True.</p> <code>True</code> <p>Returns:</p> Type Description <code>str</code> <p>The URL to the tile.</p> Source code in <code>anymap/stac.py</code> <pre><code>def maxar_tile_url(collection, tile, dtype=\"geojson\", raw=True):\n    \"\"\"Retrieve the URL to a Maxar Open Data tile.\n\n    Args:\n\n        collection (str): The collection ID, e.g., Kahramanmaras-turkey-earthquake-23.\n            Use maxar_collections() to retrieve all available collection IDs.\n        tile (str): The tile ID, e.g., 10300500D9F8E600.\n        dtype (str, optional): The data type. It can be 'geojson', 'json' or 'tsv'. Defaults to 'geojson'.\n        raw (bool, optional): If True, return the raw URL. Defaults to True.\n\n    Returns:\n        str: The URL to the tile.\n    \"\"\"\n\n    collections = maxar_collections()\n    if collection not in collections:\n        raise ValueError(\n            f\"Invalid collection name. Use maxar_collections() to retrieve all available collection IDs.\"\n        )\n\n    if dtype not in [\"geojson\", \"json\", \"tsv\"]:\n        raise ValueError(f\"Invalid dtype. It can be 'geojson', 'json' or 'tsv'.\")\n\n    if raw:\n        url = f\"https://raw.githubusercontent.com/giswqs/maxar-open-data/master/datasets/{collection}/{tile}.{dtype}\"\n    else:\n        url = f\"https://github.com/giswqs/maxar-open-data/blob/master/datasets/{collection}/{tile}.{dtype}\"\n\n    return url\n</code></pre>"},{"location":"stac/#anymap.stac.oam_search","title":"<code>oam_search(bbox=None, start_date=None, end_date=None, limit=100, return_gdf=True, **kwargs)</code>","text":"<p>Search OpenAerialMap (https://openaerialmap.org) and return a GeoDataFrame or list of image metadata.</p> <p>Parameters:</p> Name Type Description Default <code>bbox</code> <code>list | str</code> <p>The bounding box [xmin, ymin, xmax, ymax] to search within. Defaults to None.</p> <code>None</code> <code>start_date</code> <code>str</code> <p>The start date to search within, such as \"2015-04-20T00:00:00.000Z\". Defaults to None.</p> <code>None</code> <code>end_date</code> <code>str</code> <p>The end date to search within, such as \"2015-04-21T00:00:00.000Z\". Defaults to None.</p> <code>None</code> <code>limit</code> <code>int</code> <p>The maximum number of results to return. Defaults to 100.</p> <code>100</code> <code>return_gdf</code> <code>bool</code> <p>If True, return a GeoDataFrame, otherwise return a list. Defaults to True.</p> <code>True</code> <code>**kwargs</code> <p>Additional keyword arguments to pass to the API. See https://hotosm.github.io/oam-api/</p> <code>{}</code> <p>Returns:</p> Type Description <code>GeoDataFrame | list</code> <p>If return_gdf is True, return a GeoDataFrame. Otherwise, return a list.</p> Source code in <code>anymap/stac.py</code> <pre><code>def oam_search(\n    bbox=None, start_date=None, end_date=None, limit=100, return_gdf=True, **kwargs\n):\n    \"\"\"Search OpenAerialMap (https://openaerialmap.org) and return a GeoDataFrame or list of image metadata.\n\n    Args:\n        bbox (list | str, optional): The bounding box [xmin, ymin, xmax, ymax] to search within. Defaults to None.\n        start_date (str, optional): The start date to search within, such as \"2015-04-20T00:00:00.000Z\". Defaults to None.\n        end_date (str, optional): The end date to search within, such as \"2015-04-21T00:00:00.000Z\". Defaults to None.\n        limit (int, optional): The maximum number of results to return. Defaults to 100.\n        return_gdf (bool, optional): If True, return a GeoDataFrame, otherwise return a list. Defaults to True.\n        **kwargs: Additional keyword arguments to pass to the API. See https://hotosm.github.io/oam-api/\n\n    Returns:\n        GeoDataFrame | list: If return_gdf is True, return a GeoDataFrame. Otherwise, return a list.\n    \"\"\"\n\n    from shapely.geometry import Polygon\n    import geopandas as gpd\n\n    url = \"https://api.openaerialmap.org/meta\"\n    if bbox is not None:\n        if isinstance(bbox, str):\n            bbox = [float(x) for x in bbox.split(\",\")]\n        if not isinstance(bbox, list):\n            raise ValueError(\"bbox must be a list.\")\n        if len(bbox) != 4:\n            raise ValueError(\"bbox must be a list of 4 numbers.\")\n        bbox = \",\".join(map(str, bbox))\n        kwargs[\"bbox\"] = bbox\n\n    if start_date is not None:\n        kwargs[\"acquisition_from\"] = start_date\n\n    if end_date is not None:\n        kwargs[\"acquisition_to\"] = end_date\n\n    if limit is not None:\n        kwargs[\"limit\"] = limit\n\n    try:\n        r = requests.get(url, params=kwargs).json()\n        if \"results\" in r:\n            results = []\n            for result in r[\"results\"]:\n                if \"geojson\" in result:\n                    del result[\"geojson\"]\n                if \"projection\" in result:\n                    del result[\"projection\"]\n                if \"footprint\" in result:\n                    del result[\"footprint\"]\n                result = flatten_dict(result)\n                results.append(result)\n\n            if not return_gdf:\n                return results\n            else:\n                df = pd.DataFrame(results)\n\n                polygons = [Polygon.from_bounds(*bbox) for bbox in df[\"bbox\"]]\n                gdf = gpd.GeoDataFrame(geometry=polygons, crs=\"epsg:4326\")\n\n                return pd.concat([gdf, df], axis=1)\n\n        else:\n            print(\"No results found.\")\n            return None\n\n    except Exception as e:\n        return None\n</code></pre>"},{"location":"stac/#anymap.stac.stac_assets","title":"<code>stac_assets(url=None, collection=None, item=None, titiler_endpoint=None, **kwargs)</code>","text":"<p>Get all assets of a STAC item.</p> <p>Parameters:</p> Name Type Description Default <code>url</code> <code>str</code> <p>HTTP URL to a STAC item, e.g., https://canada-spot-ortho.s3.amazonaws.com/canada_spot_orthoimages/canada_spot5_orthoimages/S5_2007/S5_11055_6057_20070622/S5_11055_6057_20070622.json</p> <code>None</code> <code>collection</code> <code>str</code> <p>The Microsoft Planetary Computer STAC collection ID, e.g., landsat-8-c2-l2.</p> <code>None</code> <code>item</code> <code>str</code> <p>The Microsoft Planetary Computer STAC item ID, e.g., LC08_L2SP_047027_20201204_02_T1.</p> <code>None</code> <code>titiler_endpoint</code> <code>str</code> <p>TiTiler endpoint, e.g., \"https://giswqs-titiler-endpoint.hf.space\", \"planetary-computer\", \"pc\". Defaults to None.</p> <code>None</code> <p>Returns:</p> Type Description <code>list</code> <p>A list of assets.</p> Source code in <code>anymap/stac.py</code> <pre><code>def stac_assets(\n    url: str = None,\n    collection: str = None,\n    item: str = None,\n    titiler_endpoint: Optional[str] = None,\n    **kwargs,\n) -&gt; List:\n    \"\"\"Get all assets of a STAC item.\n\n    Args:\n        url (str): HTTP URL to a STAC item, e.g., https://canada-spot-ortho.s3.amazonaws.com/canada_spot_orthoimages/canada_spot5_orthoimages/S5_2007/S5_11055_6057_20070622/S5_11055_6057_20070622.json\n        collection (str): The Microsoft Planetary Computer STAC collection ID, e.g., landsat-8-c2-l2.\n        item (str): The Microsoft Planetary Computer STAC item ID, e.g., LC08_L2SP_047027_20201204_02_T1.\n        titiler_endpoint (str, optional): TiTiler endpoint, e.g., \"https://giswqs-titiler-endpoint.hf.space\", \"planetary-computer\", \"pc\". Defaults to None.\n\n    Returns:\n        list: A list of assets.\n    \"\"\"\n\n    if url is None and collection is None:\n        raise ValueError(\"Either url or collection must be specified.\")\n\n    if collection is not None and titiler_endpoint is None:\n        titiler_endpoint = \"planetary-computer\"\n\n    if isinstance(url, pystac.Item):\n        try:\n            url = url.self_href\n        except Exception as e:\n            print(e)\n\n    if url is not None:\n        kwargs[\"url\"] = url\n    if collection is not None:\n        kwargs[\"collection\"] = collection\n    if item is not None:\n        kwargs[\"item\"] = item\n\n    titiler_endpoint = check_titiler_endpoint(titiler_endpoint)\n    if isinstance(titiler_endpoint, str):\n        r = requests.get(f\"{titiler_endpoint}/stac/assets\", params=kwargs).json()\n    else:\n        r = requests.get(titiler_endpoint.url_for_stac_assets(), params=kwargs).json()\n\n    return r\n</code></pre>"},{"location":"stac/#anymap.stac.stac_bands","title":"<code>stac_bands(url=None, collection=None, item=None, titiler_endpoint=None, **kwargs)</code>","text":"<p>Get band names of a single SpatialTemporal Asset Catalog (STAC) item.</p> <p>Parameters:</p> Name Type Description Default <code>url</code> <code>str</code> <p>HTTP URL to a STAC item, e.g., https://canada-spot-ortho.s3.amazonaws.com/canada_spot_orthoimages/canada_spot5_orthoimages/S5_2007/S5_11055_6057_20070622/S5_11055_6057_20070622.json</p> <code>None</code> <code>collection</code> <code>str</code> <p>The Microsoft Planetary Computer STAC collection ID, e.g., landsat-8-c2-l2.</p> <code>None</code> <code>item</code> <code>str</code> <p>The Microsoft Planetary Computer STAC item ID, e.g., LC08_L2SP_047027_20201204_02_T1.</p> <code>None</code> <code>titiler_endpoint</code> <code>str</code> <p>TiTiler endpoint, e.g., \"https://giswqs-titiler-endpoint.hf.space\", \"planetary-computer\", \"pc\". Defaults to None.</p> <code>None</code> <p>Returns:</p> Type Description <code>list</code> <p>A list of band names</p> Source code in <code>anymap/stac.py</code> <pre><code>def stac_bands(\n    url: str = None,\n    collection: str = None,\n    item: str = None,\n    titiler_endpoint: Optional[str] = None,\n    **kwargs,\n) -&gt; List:\n    \"\"\"Get band names of a single SpatialTemporal Asset Catalog (STAC) item.\n\n    Args:\n        url (str): HTTP URL to a STAC item, e.g., https://canada-spot-ortho.s3.amazonaws.com/canada_spot_orthoimages/canada_spot5_orthoimages/S5_2007/S5_11055_6057_20070622/S5_11055_6057_20070622.json\n        collection (str): The Microsoft Planetary Computer STAC collection ID, e.g., landsat-8-c2-l2.\n        item (str): The Microsoft Planetary Computer STAC item ID, e.g., LC08_L2SP_047027_20201204_02_T1.\n        titiler_endpoint (str, optional): TiTiler endpoint, e.g., \"https://giswqs-titiler-endpoint.hf.space\", \"planetary-computer\", \"pc\". Defaults to None.\n\n    Returns:\n        list: A list of band names\n    \"\"\"\n\n    if url is None and collection is None:\n        raise ValueError(\"Either url or collection must be specified.\")\n\n    if collection is not None and titiler_endpoint is None:\n        titiler_endpoint = \"planetary-computer\"\n\n    if isinstance(url, pystac.Item):\n        try:\n            url = url.self_href\n        except Exception as e:\n            print(e)\n\n    if url is not None:\n        kwargs[\"url\"] = url\n    if collection is not None:\n        kwargs[\"collection\"] = collection\n    if item is not None:\n        kwargs[\"item\"] = item\n\n    titiler_endpoint = check_titiler_endpoint(titiler_endpoint)\n    if isinstance(titiler_endpoint, str):\n        r = requests.get(f\"{titiler_endpoint}/stac/assets\", params=kwargs).json()\n    else:\n        r = requests.get(titiler_endpoint.url_for_stac_assets(), params=kwargs).json()\n\n    return r\n</code></pre>"},{"location":"stac/#anymap.stac.stac_bounds","title":"<code>stac_bounds(url=None, collection=None, item=None, titiler_endpoint=None, **kwargs)</code>","text":"<p>Get the bounding box of a single SpatialTemporal Asset Catalog (STAC) item.</p> <p>Parameters:</p> Name Type Description Default <code>url</code> <code>str</code> <p>HTTP URL to a STAC item, e.g., https://canada-spot-ortho.s3.amazonaws.com/canada_spot_orthoimages/canada_spot5_orthoimages/S5_2007/S5_11055_6057_20070622/S5_11055_6057_20070622.json</p> <code>None</code> <code>collection</code> <code>str</code> <p>The Microsoft Planetary Computer STAC collection ID, e.g., landsat-8-c2-l2.</p> <code>None</code> <code>item</code> <code>str</code> <p>The Microsoft Planetary Computer STAC item ID, e.g., LC08_L2SP_047027_20201204_02_T1.</p> <code>None</code> <code>titiler_endpoint</code> <code>str</code> <p>TiTiler endpoint, e.g., \"https://giswqs-titiler-endpoint.hf.space\", \"planetary-computer\", \"pc\". Defaults to None.</p> <code>None</code> <p>Returns:</p> Type Description <code>list</code> <p>A list of values representing [left, bottom, right, top]</p> Source code in <code>anymap/stac.py</code> <pre><code>def stac_bounds(\n    url: str = None,\n    collection: str = None,\n    item: str = None,\n    titiler_endpoint: Optional[str] = None,\n    **kwargs,\n) -&gt; List:\n    \"\"\"Get the bounding box of a single SpatialTemporal Asset Catalog (STAC) item.\n\n    Args:\n        url (str): HTTP URL to a STAC item, e.g., https://canada-spot-ortho.s3.amazonaws.com/canada_spot_orthoimages/canada_spot5_orthoimages/S5_2007/S5_11055_6057_20070622/S5_11055_6057_20070622.json\n        collection (str): The Microsoft Planetary Computer STAC collection ID, e.g., landsat-8-c2-l2.\n        item (str): The Microsoft Planetary Computer STAC item ID, e.g., LC08_L2SP_047027_20201204_02_T1.\n        titiler_endpoint (str, optional): TiTiler endpoint, e.g., \"https://giswqs-titiler-endpoint.hf.space\", \"planetary-computer\", \"pc\". Defaults to None.\n\n    Returns:\n        list: A list of values representing [left, bottom, right, top]\n    \"\"\"\n\n    if url is None and collection is None:\n        raise ValueError(\"Either url or collection must be specified.\")\n\n    if collection is not None and titiler_endpoint is None:\n        titiler_endpoint = \"planetary-computer\"\n\n    if isinstance(url, pystac.Item):\n        try:\n            url = url.self_href\n        except Exception as e:\n            print(e)\n\n    if url is not None:\n        kwargs[\"url\"] = url\n        response = requests.get(url)\n        r = response.json()\n        if \"mosaicjson\" in r:\n            if \"bounds\" in r:\n                return r[\"bounds\"]\n\n    if collection is not None:\n        kwargs[\"collection\"] = collection\n    if item is not None:\n        kwargs[\"item\"] = item\n\n    titiler_endpoint = check_titiler_endpoint(titiler_endpoint)\n\n    if isinstance(titiler_endpoint, str):\n        r = requests.get(f\"{titiler_endpoint}/stac/bounds\", params=kwargs).json()\n    else:\n        r = requests.get(titiler_endpoint.url_for_stac_bounds(), params=kwargs).json()\n\n    bounds = r[\"bounds\"]\n    return bounds\n</code></pre>"},{"location":"stac/#anymap.stac.stac_center","title":"<code>stac_center(url=None, collection=None, item=None, titiler_endpoint=None, **kwargs)</code>","text":"<p>Get the centroid of a single SpatialTemporal Asset Catalog (STAC) item.</p> <p>Parameters:</p> Name Type Description Default <code>url</code> <code>str</code> <p>HTTP URL to a STAC item, e.g., https://canada-spot-ortho.s3.amazonaws.com/canada_spot_orthoimages/canada_spot5_orthoimages/S5_2007/S5_11055_6057_20070622/S5_11055_6057_20070622.json</p> <code>None</code> <code>collection</code> <code>str</code> <p>The Microsoft Planetary Computer STAC collection ID, e.g., landsat-8-c2-l2.</p> <code>None</code> <code>item</code> <code>str</code> <p>The Microsoft Planetary Computer STAC item ID, e.g., LC08_L2SP_047027_20201204_02_T1.</p> <code>None</code> <code>titiler_endpoint</code> <code>str</code> <p>TiTiler endpoint, e.g., \"https://giswqs-titiler-endpoint.hf.space\", \"planetary-computer\", \"pc\". Defaults to None.</p> <code>None</code> <p>Returns:</p> Type Description <code>tuple</code> <p>A tuple representing (longitude, latitude)</p> Source code in <code>anymap/stac.py</code> <pre><code>def stac_center(\n    url: str = None,\n    collection: str = None,\n    item: str = None,\n    titiler_endpoint: Optional[str] = None,\n    **kwargs,\n) -&gt; Tuple[float, float]:\n    \"\"\"Get the centroid of a single SpatialTemporal Asset Catalog (STAC) item.\n\n    Args:\n        url (str): HTTP URL to a STAC item, e.g., https://canada-spot-ortho.s3.amazonaws.com/canada_spot_orthoimages/canada_spot5_orthoimages/S5_2007/S5_11055_6057_20070622/S5_11055_6057_20070622.json\n        collection (str): The Microsoft Planetary Computer STAC collection ID, e.g., landsat-8-c2-l2.\n        item (str): The Microsoft Planetary Computer STAC item ID, e.g., LC08_L2SP_047027_20201204_02_T1.\n        titiler_endpoint (str, optional): TiTiler endpoint, e.g., \"https://giswqs-titiler-endpoint.hf.space\", \"planetary-computer\", \"pc\". Defaults to None.\n\n    Returns:\n        tuple: A tuple representing (longitude, latitude)\n    \"\"\"\n\n    if isinstance(url, pystac.Item):\n        try:\n            url = url.self_href\n        except Exception as e:\n            print(e)\n\n    bounds = stac_bounds(url, collection, item, titiler_endpoint, **kwargs)\n    center = ((bounds[0] + bounds[2]) / 2, (bounds[1] + bounds[3]) / 2)  # (lon, lat)\n    return center\n</code></pre>"},{"location":"stac/#anymap.stac.stac_client","title":"<code>stac_client(url, headers=None, parameters=None, ignore_conformance=False, modifier=None, request_modifier=None, stac_io=None, return_col_id=False, get_root=True, **kwargs)</code>","text":"<p>Get the STAC client. It wraps the pystac.Client.open() method. See     https://pystac-client.readthedocs.io/en/stable/api.html#pystac_client.Client.open</p> <p>Parameters:</p> Name Type Description Default <code>url</code> <code>str</code> <p>The URL of a STAC Catalog.</p> required <code>headers</code> <code>dict</code> <p>A dictionary of additional headers to use in all requests made to any part of this Catalog/API. Defaults to None.</p> <code>None</code> <code>parameters</code> <code>dict</code> <p>Optional dictionary of query string parameters to include in all requests. Defaults to None.</p> <code>None</code> <code>ignore_conformance</code> <code>bool</code> <p>Ignore any advertised Conformance Classes in this Catalog/API. This means that functions will skip checking conformance, and may throw an unknown error if that feature is not supported, rather than a NotImplementedError. Defaults to False.</p> <code>False</code> <code>modifier</code> <code>function</code> <p>A callable that modifies the children collection and items returned by this Client. This can be useful for injecting authentication parameters into child assets to access data from non-public sources. Defaults to None.</p> <code>None</code> <code>request_modifier</code> <code>function</code> <p>A callable that either modifies a Request instance or returns a new one. This can be useful for injecting Authentication headers and/or signing fully-formed requests (e.g. signing requests using AWS SigV4). The callable should expect a single argument, which will be an instance of requests.Request. If the callable returns a requests.Request, that will be used. Alternately, the callable may simply modify the provided request object and return None.</p> <code>None</code> <code>stac_io</code> <code>pystac.stac_io</code> <p>A StacApiIO object to use for I/O requests. Generally, leave this to the default. However in cases where customized I/O processing is required, a custom instance can be provided here.</p> <code>None</code> <code>return_col_id</code> <code>bool</code> <p>Return the collection ID. Defaults to False.</p> <code>False</code> <code>get_root</code> <code>bool</code> <p>Get the root link of the STAC object. Defaults to True.</p> <code>True</code> <code>**kwargs</code> <p>Additional keyword arguments to pass to the pystac.Client.open() method.</p> <code>{}</code> <p>Returns:</p> Type Description <code>pystac.Client</code> <p>The STAC client.</p> Source code in <code>anymap/stac.py</code> <pre><code>def stac_client(\n    url: str,\n    headers: Optional[Dict] = None,\n    parameters: Optional[Dict] = None,\n    ignore_conformance: Optional[bool] = False,\n    modifier: Optional[Callable] = None,\n    request_modifier: Optional[Callable] = None,\n    stac_io=None,\n    return_col_id: Optional[bool] = False,\n    get_root: Optional[bool] = True,\n    **kwargs,\n):\n    \"\"\"Get the STAC client. It wraps the pystac.Client.open() method. See\n        https://pystac-client.readthedocs.io/en/stable/api.html#pystac_client.Client.open\n\n    Args:\n        url (str): The URL of a STAC Catalog.\n        headers (dict, optional):  A dictionary of additional headers to use in all requests\n            made to any part of this Catalog/API. Defaults to None.\n        parameters (dict, optional): Optional dictionary of query string parameters to include in all requests.\n            Defaults to None.\n        ignore_conformance (bool, optional): Ignore any advertised Conformance Classes in this Catalog/API.\n            This means that functions will skip checking conformance, and may throw an unknown error\n            if that feature is not supported, rather than a NotImplementedError. Defaults to False.\n        modifier (function, optional): A callable that modifies the children collection and items\n            returned by this Client. This can be useful for injecting authentication parameters\n            into child assets to access data from non-public sources. Defaults to None.\n        request_modifier (function, optional): A callable that either modifies a Request instance or returns\n            a new one. This can be useful for injecting Authentication headers and/or signing fully-formed\n            requests (e.g. signing requests using AWS SigV4). The callable should expect a single argument,\n            which will be an instance of requests.Request. If the callable returns a requests.Request, that\n            will be used. Alternately, the callable may simply modify the provided request object and\n            return None.\n        stac_io (pystac.stac_io, optional): A StacApiIO object to use for I/O requests. Generally, leave\n            this to the default. However in cases where customized I/O processing is required, a custom\n            instance can be provided here.\n        return_col_id (bool, optional): Return the collection ID. Defaults to False.\n        get_root (bool, optional): Get the root link of the STAC object. Defaults to True.\n        **kwargs: Additional keyword arguments to pass to the pystac.Client.open() method.\n\n    Returns:\n        pystac.Client: The STAC client.\n    \"\"\"\n    from pystac_client import Client\n\n    collection_id = None\n\n    if not get_root:\n        return_col_id = False\n\n    try:\n        if get_root:\n            root = stac_root_link(url, return_col_id=return_col_id)\n            # Handle case where root is None\n            if root is None:\n                if return_col_id:\n                    root = (url, None)\n                else:\n                    root = url\n        else:\n            root = url\n\n        if return_col_id:\n            client = Client.open(\n                root[0],\n                headers,\n                parameters,\n                ignore_conformance,\n                modifier,\n                request_modifier,\n                stac_io,\n                **kwargs,\n            )\n            collection_id = root[1]\n            return client, collection_id\n        else:\n            client = Client.open(\n                root,\n                headers,\n                parameters,\n                ignore_conformance,\n                modifier,\n                request_modifier,\n                stac_io,\n                **kwargs,\n            )\n            return client, client.id\n\n    except Exception as e:\n        print(e)\n        return None\n</code></pre>"},{"location":"stac/#anymap.stac.stac_collections","title":"<code>stac_collections(url, return_ids=False, get_root=True, **kwargs)</code>","text":"<p>Get the collection IDs of a STAC catalog.</p> <p>Parameters:</p> Name Type Description Default <code>url</code> <code>str</code> <p>The STAC catalog URL.</p> required <code>return_ids</code> <code>bool</code> <p>Return collection IDs. Defaults to False.</p> <code>False</code> <code>get_root</code> <code>bool</code> <p>Get the root link of the STAC object. Defaults to True.</p> <code>True</code> <code>**kwargs</code> <p>Additional keyword arguments to pass to the stac_client() method.</p> <code>{}</code> <p>Returns:</p> Type Description <code>list</code> <p>A list of collection IDs.</p> Source code in <code>anymap/stac.py</code> <pre><code>def stac_collections(\n    url: str, return_ids: Optional[bool] = False, get_root=True, **kwargs\n) -&gt; List:\n    \"\"\"Get the collection IDs of a STAC catalog.\n\n    Args:\n        url (str): The STAC catalog URL.\n        return_ids (bool, optional): Return collection IDs. Defaults to False.\n        get_root (bool, optional): Get the root link of the STAC object. Defaults to True.\n        **kwargs: Additional keyword arguments to pass to the stac_client() method.\n\n    Returns:\n        list: A list of collection IDs.\n    \"\"\"\n    try:\n        client, _ = stac_client(url, get_root=get_root, **kwargs)\n        collections = client.get_all_collections()\n\n        if return_ids:\n            return [c.id for c in collections]\n        else:\n            return collections\n\n    except Exception as e:\n        print(e)\n        return None\n</code></pre>"},{"location":"stac/#anymap.stac.stac_info","title":"<code>stac_info(url=None, collection=None, item=None, assets=None, titiler_endpoint=None, **kwargs)</code>","text":"<p>Get band info of a STAC item.</p> <p>Parameters:</p> Name Type Description Default <code>url</code> <code>str</code> <p>HTTP URL to a STAC item, e.g., https://canada-spot-ortho.s3.amazonaws.com/canada_spot_orthoimages/canada_spot5_orthoimages/S5_2007/S5_11055_6057_20070622/S5_11055_6057_20070622.json</p> <code>None</code> <code>collection</code> <code>str</code> <p>The Microsoft Planetary Computer STAC collection ID, e.g., landsat-8-c2-l2.</p> <code>None</code> <code>item</code> <code>str</code> <p>The Microsoft Planetary Computer STAC item ID, e.g., LC08_L2SP_047027_20201204_02_T1.</p> <code>None</code> <code>assets</code> <code>str | list</code> <p>The Microsoft Planetary Computer STAC asset ID, e.g., [\"SR_B7\", \"SR_B5\", \"SR_B4\"].</p> <code>None</code> <code>titiler_endpoint</code> <code>str</code> <p>TiTiler endpoint, e.g., \"https://giswqs-titiler-endpoint.hf.space\", \"planetary-computer\", \"pc\". Defaults to None.</p> <code>None</code> <p>Returns:</p> Type Description <code>list</code> <p>A dictionary of band info.</p> Source code in <code>anymap/stac.py</code> <pre><code>def stac_info(\n    url: str = None,\n    collection: str = None,\n    item: str = None,\n    assets: Union[str, List] = None,\n    titiler_endpoint: Optional[str] = None,\n    **kwargs,\n) -&gt; List:\n    \"\"\"Get band info of a STAC item.\n\n    Args:\n        url (str): HTTP URL to a STAC item, e.g., https://canada-spot-ortho.s3.amazonaws.com/canada_spot_orthoimages/canada_spot5_orthoimages/S5_2007/S5_11055_6057_20070622/S5_11055_6057_20070622.json\n        collection (str): The Microsoft Planetary Computer STAC collection ID, e.g., landsat-8-c2-l2.\n        item (str): The Microsoft Planetary Computer STAC item ID, e.g., LC08_L2SP_047027_20201204_02_T1.\n        assets (str | list): The Microsoft Planetary Computer STAC asset ID, e.g., [\"SR_B7\", \"SR_B5\", \"SR_B4\"].\n        titiler_endpoint (str, optional): TiTiler endpoint, e.g., \"https://giswqs-titiler-endpoint.hf.space\", \"planetary-computer\", \"pc\". Defaults to None.\n\n    Returns:\n        list: A dictionary of band info.\n    \"\"\"\n\n    if url is None and collection is None:\n        raise ValueError(\"Either url or collection must be specified.\")\n\n    if collection is not None and titiler_endpoint is None:\n        titiler_endpoint = \"planetary-computer\"\n\n    if isinstance(url, pystac.Item):\n        try:\n            url = url.self_href\n        except Exception as e:\n            print(e)\n\n    if url is not None:\n        kwargs[\"url\"] = url\n    if collection is not None:\n        kwargs[\"collection\"] = collection\n    if item is not None:\n        kwargs[\"item\"] = item\n    if assets is not None:\n        kwargs[\"assets\"] = assets\n\n    titiler_endpoint = check_titiler_endpoint(titiler_endpoint)\n    if isinstance(titiler_endpoint, str):\n        r = requests.get(f\"{titiler_endpoint}/stac/info\", params=kwargs).json()\n    else:\n        r = requests.get(titiler_endpoint.url_for_stac_info(), params=kwargs).json()\n\n    return r\n</code></pre>"},{"location":"stac/#anymap.stac.stac_info_geojson","title":"<code>stac_info_geojson(url=None, collection=None, item=None, assets=None, titiler_endpoint=None, **kwargs)</code>","text":"<p>Get band info of a STAC item.</p> <p>Parameters:</p> Name Type Description Default <code>url</code> <code>str</code> <p>HTTP URL to a STAC item, e.g., https://canada-spot-ortho.s3.amazonaws.com/canada_spot_orthoimages/canada_spot5_orthoimages/S5_2007/S5_11055_6057_20070622/S5_11055_6057_20070622.json</p> <code>None</code> <code>collection</code> <code>str</code> <p>The Microsoft Planetary Computer STAC collection ID, e.g., landsat-8-c2-l2.</p> <code>None</code> <code>item</code> <code>str</code> <p>The Microsoft Planetary Computer STAC item ID, e.g., LC08_L2SP_047027_20201204_02_T1.</p> <code>None</code> <code>assets</code> <code>str | list</code> <p>The Microsoft Planetary Computer STAC asset ID, e.g., [\"SR_B7\", \"SR_B5\", \"SR_B4\"].</p> <code>None</code> <code>titiler_endpoint</code> <code>str</code> <p>TiTiler endpoint, e.g., \"https://giswqs-titiler-endpoint.hf.space\", \"planetary-computer\", \"pc\". Defaults to None.</p> <code>None</code> <p>Returns:</p> Type Description <code>list</code> <p>A dictionary of band info.</p> Source code in <code>anymap/stac.py</code> <pre><code>def stac_info_geojson(\n    url: str = None,\n    collection: str = None,\n    item: str = None,\n    assets: Union[str, List] = None,\n    titiler_endpoint: Optional[str] = None,\n    **kwargs,\n) -&gt; List:\n    \"\"\"Get band info of a STAC item.\n\n    Args:\n        url (str): HTTP URL to a STAC item, e.g., https://canada-spot-ortho.s3.amazonaws.com/canada_spot_orthoimages/canada_spot5_orthoimages/S5_2007/S5_11055_6057_20070622/S5_11055_6057_20070622.json\n        collection (str): The Microsoft Planetary Computer STAC collection ID, e.g., landsat-8-c2-l2.\n        item (str): The Microsoft Planetary Computer STAC item ID, e.g., LC08_L2SP_047027_20201204_02_T1.\n        assets (str | list): The Microsoft Planetary Computer STAC asset ID, e.g., [\"SR_B7\", \"SR_B5\", \"SR_B4\"].\n        titiler_endpoint (str, optional): TiTiler endpoint, e.g., \"https://giswqs-titiler-endpoint.hf.space\", \"planetary-computer\", \"pc\". Defaults to None.\n\n    Returns:\n        list: A dictionary of band info.\n    \"\"\"\n\n    if url is None and collection is None:\n        raise ValueError(\"Either url or collection must be specified.\")\n\n    if collection is not None and titiler_endpoint is None:\n        titiler_endpoint = \"planetary-computer\"\n\n    if isinstance(url, pystac.Item):\n        try:\n            url = url.self_href\n        except Exception as e:\n            print(e)\n\n    if url is not None:\n        kwargs[\"url\"] = url\n    if collection is not None:\n        kwargs[\"collection\"] = collection\n    if item is not None:\n        kwargs[\"item\"] = item\n    if assets is not None:\n        kwargs[\"assets\"] = assets\n\n    titiler_endpoint = check_titiler_endpoint(titiler_endpoint)\n    if isinstance(titiler_endpoint, str):\n        r = requests.get(f\"{titiler_endpoint}/stac/info.geojson\", params=kwargs).json()\n    else:\n        r = requests.get(\n            titiler_endpoint.url_for_stac_info_geojson(), params=kwargs\n        ).json()\n\n    return r\n</code></pre>"},{"location":"stac/#anymap.stac.stac_min_max","title":"<code>stac_min_max(url=None, collection=None, item=None, assets=None, titiler_endpoint=None, **kwargs)</code>","text":"<p>Get the min and max values of a STAC item.</p> <p>Parameters:</p> Name Type Description Default <code>url</code> <code>str</code> <p>HTTP URL to a STAC item, e.g., https://canada-spot-ortho.s3.amazonaws.com/canada_spot_orthoimages/canada_spot5_orthoimages/S5_2007/S5_11055_6057_20070622/S5_11055_6057_20070622.json</p> <code>None</code> <code>collection</code> <code>str</code> <p>The Microsoft Planetary Computer STAC collection ID, e.g., landsat-8-c2-l2.</p> <code>None</code> <code>item</code> <code>str</code> <p>The Microsoft Planetary Computer STAC item ID, e.g., LC08_L2SP_047027_20201204_02_T1.</p> <code>None</code> <code>assets</code> <code>str | list</code> <p>The Microsoft Planetary Computer STAC asset ID, e.g., [\"SR_B7\", \"SR_B5\", \"SR_B4\"].</p> <code>None</code> <code>titiler_endpoint</code> <code>str</code> <p>TiTiler endpoint, e.g., \"https://giswqs-titiler-endpoint.hf.space\", \"planetary-computer\", \"pc\". Defaults to None.</p> <code>None</code> <p>Returns:</p> Type Description <code>list</code> <p>A dictionary of band statistics.</p> Source code in <code>anymap/stac.py</code> <pre><code>def stac_min_max(\n    url: str = None,\n    collection: str = None,\n    item: str = None,\n    assets: Union[str, List] = None,\n    titiler_endpoint: Optional[str] = None,\n    **kwargs,\n) -&gt; List:\n    \"\"\"Get the min and max values of a STAC item.\n\n    Args:\n        url (str): HTTP URL to a STAC item, e.g., https://canada-spot-ortho.s3.amazonaws.com/canada_spot_orthoimages/canada_spot5_orthoimages/S5_2007/S5_11055_6057_20070622/S5_11055_6057_20070622.json\n        collection (str): The Microsoft Planetary Computer STAC collection ID, e.g., landsat-8-c2-l2.\n        item (str): The Microsoft Planetary Computer STAC item ID, e.g., LC08_L2SP_047027_20201204_02_T1.\n        assets (str | list): The Microsoft Planetary Computer STAC asset ID, e.g., [\"SR_B7\", \"SR_B5\", \"SR_B4\"].\n        titiler_endpoint (str, optional): TiTiler endpoint, e.g., \"https://giswqs-titiler-endpoint.hf.space\", \"planetary-computer\", \"pc\". Defaults to None.\n\n    Returns:\n        list: A dictionary of band statistics.\n    \"\"\"\n\n    stats = stac_stats(url, collection, item, assets, titiler_endpoint, **kwargs)\n\n    values = stats.values()\n\n    try:\n        min_values = [v[\"min\"] for v in values]\n        max_values = [v[\"max\"] for v in values]\n\n        return min(min_values), max(max_values)\n    except Exception as e:\n        return None, None\n</code></pre>"},{"location":"stac/#anymap.stac.stac_object_type","title":"<code>stac_object_type(url, **kwargs)</code>","text":"<p>Get the STAC object type.</p> <p>Parameters:</p> Name Type Description Default <code>url</code> <code>str</code> <p>The STAC object URL.</p> required <code>**kwargs</code> <code>Any</code> <p>Keyword arguments for pystac.STACObject.from_file().</p> <code>{}</code> <p>Returns:</p> Type Description <code>Optional[str]</code> <p>The STAC object type, can be \"catalog\", \"collection\", or \"item\". Returns None if unable to determine type.</p> Source code in <code>anymap/stac.py</code> <pre><code>def stac_object_type(url: str, **kwargs: Any) -&gt; Optional[str]:\n    \"\"\"Get the STAC object type.\n\n    Args:\n        url: The STAC object URL.\n        **kwargs: Keyword arguments for pystac.STACObject.from_file().\n\n    Returns:\n        The STAC object type, can be \"catalog\", \"collection\", or \"item\".\n        Returns None if unable to determine type.\n    \"\"\"\n    try:\n        obj = pystac.STACObject.from_file(url, **kwargs)\n\n        if isinstance(obj, pystac.Collection):\n            return \"collection\"\n        elif isinstance(obj, pystac.Item):\n            return \"item\"\n        elif isinstance(obj, pystac.Catalog):\n            return \"catalog\"\n\n    except Exception as e:\n        print(e)\n        return None\n</code></pre>"},{"location":"stac/#anymap.stac.stac_pixel_value","title":"<code>stac_pixel_value(lon, lat, url=None, collection=None, item=None, assets=None, titiler_endpoint=None, verbose=True, **kwargs)</code>","text":"<p>Get pixel value from STAC assets.</p> <p>Parameters:</p> Name Type Description Default <code>lon</code> <code>float</code> <p>Longitude of the pixel.</p> required <code>lat</code> <code>float</code> <p>Latitude of the pixel.</p> required <code>url</code> <code>str</code> <p>HTTP URL to a STAC item, e.g., https://canada-spot-ortho.s3.amazonaws.com/canada_spot_orthoimages/canada_spot5_orthoimages/S5_2007/S5_11055_6057_20070622/S5_11055_6057_20070622.json</p> <code>None</code> <code>collection</code> <code>str</code> <p>The Microsoft Planetary Computer STAC collection ID, e.g., landsat-8-c2-l2.</p> <code>None</code> <code>item</code> <code>str</code> <p>The Microsoft Planetary Computer STAC item ID, e.g., LC08_L2SP_047027_20201204_02_T1.</p> <code>None</code> <code>assets</code> <code>str | list</code> <p>The Microsoft Planetary Computer STAC asset ID, e.g., [\"SR_B7\", \"SR_B5\", \"SR_B4\"].</p> <code>None</code> <code>titiler_endpoint</code> <code>str</code> <p>TiTiler endpoint, e.g., \"https://giswqs-titiler-endpoint.hf.space\", \"planetary-computer\", \"pc\". Defaults to None.</p> <code>None</code> <code>verbose</code> <code>bool</code> <p>Print out the error message. Defaults to True.</p> <code>True</code> <p>Returns:</p> Type Description <code>list</code> <p>A dictionary of pixel values for each asset.</p> Source code in <code>anymap/stac.py</code> <pre><code>def stac_pixel_value(\n    lon: float,\n    lat: float,\n    url: str = None,\n    collection: str = None,\n    item: str = None,\n    assets: Union[str, List] = None,\n    titiler_endpoint: Optional[str] = None,\n    verbose: Optional[bool] = True,\n    **kwargs,\n):\n    \"\"\"Get pixel value from STAC assets.\n\n    Args:\n        lon (float): Longitude of the pixel.\n        lat (float): Latitude of the pixel.\n        url (str): HTTP URL to a STAC item, e.g., https://canada-spot-ortho.s3.amazonaws.com/canada_spot_orthoimages/canada_spot5_orthoimages/S5_2007/S5_11055_6057_20070622/S5_11055_6057_20070622.json\n        collection (str): The Microsoft Planetary Computer STAC collection ID, e.g., landsat-8-c2-l2.\n        item (str): The Microsoft Planetary Computer STAC item ID, e.g., LC08_L2SP_047027_20201204_02_T1.\n        assets (str | list): The Microsoft Planetary Computer STAC asset ID, e.g., [\"SR_B7\", \"SR_B5\", \"SR_B4\"].\n        titiler_endpoint (str, optional): TiTiler endpoint, e.g., \"https://giswqs-titiler-endpoint.hf.space\", \"planetary-computer\", \"pc\". Defaults to None.\n        verbose (bool, optional): Print out the error message. Defaults to True.\n\n    Returns:\n        list: A dictionary of pixel values for each asset.\n    \"\"\"\n\n    if url is None and collection is None:\n        raise ValueError(\"Either url or collection must be specified.\")\n\n    if collection is not None and titiler_endpoint is None:\n        titiler_endpoint = \"planetary-computer\"\n\n    if isinstance(url, pystac.Item):\n        try:\n            url = url.self_href\n        except Exception as e:\n            print(e)\n\n    if url is not None:\n        kwargs[\"url\"] = url\n    if collection is not None:\n        kwargs[\"collection\"] = collection\n    if item is not None:\n        kwargs[\"item\"] = item\n\n    if assets is None:\n        assets = stac_assets(\n            url=url,\n            collection=collection,\n            item=item,\n            titiler_endpoint=titiler_endpoint,\n        )\n    kwargs[\"assets\"] = assets\n\n    titiler_endpoint = check_titiler_endpoint(titiler_endpoint)\n    if isinstance(titiler_endpoint, str):\n\n        r = requests.get(\n            f\"{titiler_endpoint}/stac/point/{lon},{lat}\", params=kwargs\n        ).json()\n    else:\n        r = requests.get(\n            titiler_endpoint.url_for_stac_pixel_value(lon, lat), params=kwargs\n        ).json()\n\n    if \"detail\" in r:\n        if verbose:\n            print(r[\"detail\"])\n        return None\n    else:\n        values = r[\"values\"]\n        if isinstance(assets, str):\n            assets = assets.split(\",\")\n        result = dict(zip(assets, values))\n        return result\n</code></pre>"},{"location":"stac/#anymap.stac.stac_root_link","title":"<code>stac_root_link(url, return_col_id=False, **kwargs)</code>","text":"<p>Get the root link of a STAC object.</p> <p>Parameters:</p> Name Type Description Default <code>url</code> <code>str</code> <p>The STAC object URL.</p> required <code>return_col_id</code> <code>Optional[bool]</code> <p>Return the collection ID if the STAC object is a collection. Defaults to False.</p> <code>False</code> <code>**kwargs</code> <code>Any</code> <p>Keyword arguments for pystac.STACObject.from_file().</p> <code>{}</code> <p>Returns:</p> Type Description <code>Union[str, Tuple[str, Optional[str]]]</code> <p>The root link of the STAC object. Returns None if no root link found. If return_col_id is True, returns (root_link, collection_id).</p> <p>Exceptions:</p> Type Description <code>ValueError</code> <p>If FeatureCollection contains no features.</p> Source code in <code>anymap/stac.py</code> <pre><code>def stac_root_link(\n    url: str, return_col_id: Optional[bool] = False, **kwargs: Any\n) -&gt; Union[str, Tuple[str, Optional[str]], None]:\n    \"\"\"Get the root link of a STAC object.\n\n    Args:\n        url: The STAC object URL.\n        return_col_id: Return the collection ID if the STAC object\n            is a collection. Defaults to False.\n        **kwargs: Keyword arguments for pystac.STACObject.from_file().\n\n    Returns:\n        The root link of the STAC object. Returns None if no root link found.\n        If return_col_id is True, returns (root_link, collection_id).\n\n    Raises:\n        ValueError: If FeatureCollection contains no features.\n    \"\"\"\n    collection_id = None\n    try:\n        response = requests.get(url, **kwargs)\n        response.raise_for_status()\n        data = response.json()\n\n        # Handle FeatureCollection from /items endpoint\n        if data.get(\"type\") == \"FeatureCollection\":\n            features = data.get(\"features\", [])\n            if not features:\n                raise ValueError(\"FeatureCollection contains no features.\")\n            item = pystac.Item.from_dict(features[0])\n            collection_id = item.collection_id\n            root = item.get_root_link()\n            return (\n                (root.get_href() if root else item.get_self_href(), collection_id)\n                if return_col_id\n                else root.get_href() if root else item.get_self_href()\n            )\n\n        # Handle STAC API objects (Collection, Catalog, etc.)\n        links = data.get(\"links\", [])\n        root_href = None\n        self_href = None\n\n        for link in links:\n            if link.get(\"rel\") == \"root\":\n                root_href = link.get(\"href\")\n            elif link.get(\"rel\") == \"self\":\n                self_href = link.get(\"href\")\n\n        # Get collection/catalog ID if requested\n        if return_col_id:\n            if data.get(\"type\") in [\"Collection\", \"Catalog\"]:\n                collection_id = data.get(\"id\")\n\n        # Determine the root href:\n        # 1. If there's an explicit root link, use it\n        # 2. If there's no root link but there's a self link, the self link is the root\n        #    (this is common for root catalogs in STAC APIs)\n        # 3. Otherwise, fall back to parsing as a regular STAC object\n        if root_href:\n            return (root_href, collection_id) if return_col_id else root_href\n        elif self_href and not root_href:\n            # When there's no root link, self link often indicates this IS the root\n            return (self_href, collection_id) if return_col_id else self_href\n\n        # Fallback: parse as regular STAC object using pystac\n        obj = pystac.STACObject.from_dict(data)\n        if isinstance(obj, (pystac.Collection, pystac.Catalog)):\n            collection_id = obj.id\n\n        root = obj.get_root_link()\n        href = root.get_href() if root else obj.get_self_href()\n        return (href, collection_id) if return_col_id else href\n\n    except Exception as e:\n        print(f\"Failed to resolve STAC root from {url}: {e}\")\n        return (None, None) if return_col_id else None\n</code></pre>"},{"location":"stac/#anymap.stac.stac_search","title":"<code>stac_search(url, method='POST', max_items=None, limit=100, ids=None, collections=None, bbox=None, intersects=None, datetime=None, query=None, filter=None, filter_lang=None, sortby=None, fields=None, get_collection=False, get_items=False, get_assets=False, get_links=False, get_gdf=False, get_info=False, get_root=True, **kwargs)</code>","text":"<p>Search a STAC API. The function wraps the pysatc_client.Client.search() method. See     https://pystac-client.readthedocs.io/en/stable/api.html#pystac_client.Client.search</p> <p>Parameters:</p> Name Type Description Default <code>url</code> <code>str</code> <p>The STAC API URL.</p> required <code>method</code> <code>str</code> <p>The HTTP method to use when making a request to the service. This must be either \"GET\", \"POST\", or None. If None, this will default to \"POST\". If a \"POST\" request receives a 405 status for the response, it will automatically retry with \"GET\" for all subsequent requests. Defaults to \"POST\".</p> <code>'POST'</code> <code>max_items</code> <code>init</code> <p>The maximum number of items to return from the search, even if there are more matching results. This client to limit the total number of Items returned from the items(), item_collections(), and items_as_dicts methods(). The client will continue to request pages of items until the number of max items is reached. This parameter defaults to 100. Setting this to None will allow iteration over a possibly very large number of results.. Defaults to None.</p> <code>None</code> <code>limit</code> <code>int</code> <p>A recommendation to the service as to the number of items to return per page of results. Defaults to 100.</p> <code>100</code> <code>ids</code> <code>list</code> <p>List of one or more Item ids to filter on. Defaults to None.</p> <code>None</code> <code>collections</code> <code>list</code> <p>List of one or more Collection IDs or pystac.Collection instances. Only Items in one of the provided Collections will be searched. Defaults to None.</p> <code>None</code> <code>bbox</code> <code>list | tuple</code> <p>A list, tuple, or iterator representing a bounding box of 2D or 3D coordinates. Results will be filtered to only those intersecting the bounding box. Defaults to None.</p> <code>None</code> <code>intersects</code> <code>str | dict</code> <p>A string or dictionary representing a GeoJSON geometry, or an object that implements a geo_interface property, as supported by several libraries including Shapely, ArcPy, PySAL, and geojson. Results filtered to only those intersecting the geometry. Defaults to None.</p> <code>None</code> <code>datetime</code> <code>str</code> <p>Either a single datetime or datetime range used to filter results. You may express a single datetime using a datetime.datetime instance, a RFC 3339-compliant timestamp, or a simple date string (see below). Instances of datetime.datetime may be either timezone aware or unaware. Timezone aware instances will be converted to a UTC timestamp before being passed to the endpoint. Timezone unaware instances are assumed to represent UTC timestamps. You may represent a datetime range using a \"/\" separated string as described in the spec, or a list, tuple, or iterator of 2 timestamps or datetime instances. For open-ended ranges, use either \"..\" ('2020-01-01:00:00:00Z/..', ['2020-01-01:00:00:00Z', '..']) or a value of None (['2020-01-01:00:00:00Z', None]). If using a simple date string, the datetime can be specified in YYYY-mm-dd format, optionally truncating to YYYY-mm or just YYYY. Simple date strings will be expanded to include the entire time period. Defaults to None.</p> <code>None</code> <code>query</code> <code>list</code> <p>List or JSON of query parameters as per the STAC API query extension. such as {\"eo:cloud_cover\":{\"lt\":10}}. Defaults to None.</p> <code>None</code> <code>filter</code> <code>dict</code> <p>JSON of query parameters as per the STAC API filter extension. Defaults to None.</p> <code>None</code> <code>filter_lang</code> <code>str</code> <p>Language variant used in the filter body. If filter is a dictionary or not provided, defaults to \u2018cql2-json\u2019. If filter is a string, defaults to cql2-text. Defaults to None.</p> <code>None</code> <code>sortby</code> <code>str | list</code> <p>A single field or list of fields to sort the response by. such as [{ 'field': 'properties.eo:cloud_cover', 'direction': 'asc' }]. Defaults to None.</p> <code>None</code> <code>fields</code> <code>list</code> <p>A list of fields to include in the response. Note this may result in invalid STAC objects, as they may not have required fields. Use items_as_dicts to avoid object unmarshalling errors. Defaults to None.</p> <code>None</code> <code>get_collection</code> <code>bool</code> <p>True to return a pystac.ItemCollection. Defaults to False.</p> <code>False</code> <code>get_items</code> <code>bool</code> <p>True to return a list of pystac.Item. Defaults to False.</p> <code>False</code> <code>get_assets</code> <code>bool</code> <p>True to return a list of pystac.Asset. Defaults to False.</p> <code>False</code> <code>get_links</code> <code>bool</code> <p>True to return a list of links. Defaults to False.</p> <code>False</code> <code>get_gdf</code> <code>bool</code> <p>True to return a GeoDataFrame. Defaults to False.</p> <code>False</code> <code>get_info</code> <code>bool</code> <p>True to return a dictionary of STAC items. Defaults to False.</p> <code>False</code> <code>get_root</code> <code>bool</code> <p>Get the root link of the STAC object. Defaults to True.</p> <code>True</code> <code>**kwargs</code> <p>Additional keyword arguments to pass to the stac_client() function.</p> <code>{}</code> <p>Returns:</p> Type Description <code>list | pystac.ItemCollection </code> <p>The search results as a list of links or a pystac.ItemCollection.</p> Source code in <code>anymap/stac.py</code> <pre><code>def stac_search(\n    url: str,\n    method: Optional[str] = \"POST\",\n    max_items: Optional[int] = None,\n    limit: Optional[int] = 100,\n    ids: Optional[List] = None,\n    collections: Optional[List] = None,\n    bbox: Optional[Union[List, Tuple]] = None,\n    intersects: Optional[Union[str, Dict]] = None,\n    datetime: Optional[str] = None,\n    query: Optional[List] = None,\n    filter: Optional[Dict] = None,\n    filter_lang: Optional[str] = None,\n    sortby: Optional[Union[List, str]] = None,\n    fields: Optional[List] = None,\n    get_collection: Optional[bool] = False,\n    get_items: Optional[bool] = False,\n    get_assets: Optional[bool] = False,\n    get_links: Optional[bool] = False,\n    get_gdf: Optional[bool] = False,\n    get_info: Optional[bool] = False,\n    get_root: Optional[bool] = True,\n    **kwargs,\n) -&gt; List:\n    \"\"\"Search a STAC API. The function wraps the pysatc_client.Client.search() method. See\n        https://pystac-client.readthedocs.io/en/stable/api.html#pystac_client.Client.search\n\n    Args:\n        url (str): The STAC API URL.\n        method (str, optional): The HTTP method to use when making a request to the service.\n            This must be either \"GET\", \"POST\", or None. If None, this will default to \"POST\".\n            If a \"POST\" request receives a 405 status for the response, it will automatically\n            retry with \"GET\" for all subsequent requests. Defaults to \"POST\".\n        max_items (init, optional): The maximum number of items to return from the search,\n            even if there are more matching results. This client to limit the total number of\n            Items returned from the items(), item_collections(), and items_as_dicts methods().\n            The client will continue to request pages of items until the number of max items\n            is reached. This parameter defaults to 100. Setting this to None will allow iteration\n            over a possibly very large number of results.. Defaults to None.\n        limit (int, optional): A recommendation to the service as to the number of items to\n            return per page of results. Defaults to 100.\n        ids (list, optional): List of one or more Item ids to filter on. Defaults to None.\n        collections (list, optional): List of one or more Collection IDs or pystac.Collection instances.\n            Only Items in one of the provided Collections will be searched. Defaults to None.\n        bbox (list | tuple, optional): A list, tuple, or iterator representing a bounding box of 2D\n            or 3D coordinates. Results will be filtered to only those intersecting the bounding box.\n            Defaults to None.\n        intersects (str | dict, optional):  A string or dictionary representing a GeoJSON geometry, or\n            an object that implements a __geo_interface__ property, as supported by several\n            libraries including Shapely, ArcPy, PySAL, and geojson. Results filtered to only\n            those intersecting the geometry. Defaults to None.\n        datetime (str, optional): Either a single datetime or datetime range used to filter results.\n            You may express a single datetime using a datetime.datetime instance, a RFC 3339-compliant\n            timestamp, or a simple date string (see below). Instances of datetime.datetime may be either\n            timezone aware or unaware. Timezone aware instances will be converted to a UTC timestamp\n            before being passed to the endpoint. Timezone unaware instances are assumed to represent\n            UTC timestamps. You may represent a datetime range using a \"/\" separated string as described\n            in the spec, or a list, tuple, or iterator of 2 timestamps or datetime instances.\n            For open-ended ranges, use either \"..\" ('2020-01-01:00:00:00Z/..', ['2020-01-01:00:00:00Z', '..'])\n            or a value of None (['2020-01-01:00:00:00Z', None]). If using a simple date string,\n            the datetime can be specified in YYYY-mm-dd format, optionally truncating to\n            YYYY-mm or just YYYY. Simple date strings will be expanded to include the entire\n            time period. Defaults to None.\n        query (list, optional): List or JSON of query parameters as per the STAC API query extension.\n            such as {\"eo:cloud_cover\":{\"lt\":10}}. Defaults to None.\n        filter (dict, optional): JSON of query parameters as per the STAC API filter extension. Defaults to None.\n        filter_lang (str, optional): Language variant used in the filter body. If filter is a dictionary\n            or not provided, defaults to \u2018cql2-json\u2019. If filter is a string, defaults to cql2-text. Defaults to None.\n        sortby (str | list, optional): A single field or list of fields to sort the response by.\n            such as [{ 'field': 'properties.eo:cloud_cover', 'direction': 'asc' }]. Defaults to None.\n        fields (list, optional): A list of fields to include in the response. Note this may result in\n            invalid STAC objects, as they may not have required fields. Use items_as_dicts to avoid object\n            unmarshalling errors. Defaults to None.\n        get_collection (bool, optional): True to return a pystac.ItemCollection. Defaults to False.\n        get_items (bool, optional): True to return a list of pystac.Item. Defaults to False.\n        get_assets (bool, optional): True to return a list of pystac.Asset. Defaults to False.\n        get_links (bool, optional): True to return a list of links. Defaults to False.\n        get_gdf (bool, optional): True to return a GeoDataFrame. Defaults to False.\n        get_info (bool, optional): True to return a dictionary of STAC items. Defaults to False.\n        get_root (bool, optional): Get the root link of the STAC object. Defaults to True.\n        **kwargs: Additional keyword arguments to pass to the stac_client() function.\n\n    Returns:\n        list | pystac.ItemCollection : The search results as a list of links or a pystac.ItemCollection.\n    \"\"\"\n\n    client, collection_id = stac_client(\n        url, return_col_id=True, get_root=get_root, **kwargs\n    )\n\n    if client is None:\n        return None\n    else:\n        if isinstance(intersects, dict) and \"geometry\" in intersects:\n            intersects = intersects[\"geometry\"]\n\n        if collection_id is not None and collections is None:\n            collections = [collection_id]\n\n        search = client.search(\n            method=method,\n            max_items=max_items,\n            limit=limit,\n            ids=ids,\n            collections=collections,\n            bbox=bbox,\n            intersects=intersects,\n            datetime=datetime,\n            query=query,\n            filter=filter,\n            filter_lang=filter_lang,\n            sortby=sortby,\n            fields=fields,\n        )\n\n        if get_collection:\n            return search.item_collection()\n        elif get_items:\n            return list(search.items())\n        elif get_assets:\n            assets = {}\n            for item in search.items():\n                assets[item.id] = {}\n                for key, value in item.get_assets().items():\n                    assets[item.id][key] = value.href\n            return assets\n        elif get_links:\n            return [item.get_self_href() for item in search.items()]\n        elif get_gdf:\n            import geopandas as gpd\n\n            gdf = gpd.GeoDataFrame.from_features(\n                search.item_collection().to_dict(), crs=\"EPSG:4326\"\n            )\n            return gdf\n        elif get_info:\n            items = search.items()\n            info = {}\n            for item in items:\n                info[item.id] = {\n                    \"id\": item.id,\n                    \"href\": item.get_self_href(),\n                    \"bands\": list(item.get_assets().keys()),\n                    \"assets\": item.get_assets(),\n                }\n            return info\n        else:\n            return search\n</code></pre>"},{"location":"stac/#anymap.stac.stac_search_to_df","title":"<code>stac_search_to_df(search, **kwargs)</code>","text":"<p>Convert STAC search result to a DataFrame.</p> <p>Parameters:</p> Name Type Description Default <code>search</code> <code>pystac_client.item_search</code> <p>The search result returned by leafmap.stac_search().</p> required <code>**kwargs</code> <p>Additional keyword arguments to pass to the DataFrame.drop() function.</p> <code>{}</code> <p>Returns:</p> Type Description <code>DataFrame</code> <p>A Pandas DataFrame object.</p> Source code in <code>anymap/stac.py</code> <pre><code>def stac_search_to_df(search, **kwargs) -&gt; pd.DataFrame:\n    \"\"\"Convert STAC search result to a DataFrame.\n\n    Args:\n        search (pystac_client.item_search): The search result returned by leafmap.stac_search().\n        **kwargs: Additional keyword arguments to pass to the DataFrame.drop() function.\n\n    Returns:\n        DataFrame: A Pandas DataFrame object.\n    \"\"\"\n    gdf = stac_search_to_gdf(search)\n    return gdf.drop(columns=[\"geometry\"], **kwargs)\n</code></pre>"},{"location":"stac/#anymap.stac.stac_search_to_dict","title":"<code>stac_search_to_dict(search, **kwargs)</code>","text":"<p>Convert STAC search result to a dictionary.</p> <p>Parameters:</p> Name Type Description Default <code>search</code> <code>pystac_client.item_search</code> <p>The search result returned by leafmap.stac_search().</p> required <p>Returns:</p> Type Description <code>dict</code> <p>A dictionary of STAC items, with the stac item id as the key, and the stac item as the value.</p> Source code in <code>anymap/stac.py</code> <pre><code>def stac_search_to_dict(search, **kwargs) -&gt; Dict:\n    \"\"\"Convert STAC search result to a dictionary.\n\n    Args:\n        search (pystac_client.item_search): The search result returned by leafmap.stac_search().\n\n    Returns:\n        dict: A dictionary of STAC items, with the stac item id as the key, and the stac item as the value.\n    \"\"\"\n\n    items = list(search.item_collection())\n    info = {}\n    for item in items:\n        info[item.id] = {\n            \"id\": item.id,\n            \"href\": item.get_self_href(),\n            \"bands\": list(item.get_assets().keys()),\n            \"assets\": item.get_assets(),\n        }\n        links = {}\n        assets = item.get_assets()\n        for key, value in assets.items():\n            links[key] = value.href\n        info[item.id][\"links\"] = links\n    return info\n</code></pre>"},{"location":"stac/#anymap.stac.stac_search_to_gdf","title":"<code>stac_search_to_gdf(search, **kwargs)</code>","text":"<p>Convert STAC search result to a GeoDataFrame.</p> <p>Parameters:</p> Name Type Description Default <code>search</code> <code>pystac_client.item_search</code> <p>The search result returned by leafmap.stac_search().</p> required <code>**kwargs</code> <p>Additional keyword arguments to pass to the GeoDataFrame.from_features() function.</p> <code>{}</code> <p>Returns:</p> Type Description <code>GeoDataFrame</code> <p>A GeoPandas GeoDataFrame object.</p> Source code in <code>anymap/stac.py</code> <pre><code>def stac_search_to_gdf(search, **kwargs):\n    \"\"\"Convert STAC search result to a GeoDataFrame.\n\n    Args:\n        search (pystac_client.item_search): The search result returned by leafmap.stac_search().\n        **kwargs: Additional keyword arguments to pass to the GeoDataFrame.from_features() function.\n\n    Returns:\n        GeoDataFrame: A GeoPandas GeoDataFrame object.\n    \"\"\"\n    import geopandas as gpd\n\n    gdf = gpd.GeoDataFrame.from_features(\n        search.item_collection().to_dict(), crs=\"EPSG:4326\", **kwargs\n    )\n    return gdf\n</code></pre>"},{"location":"stac/#anymap.stac.stac_search_to_list","title":"<code>stac_search_to_list(search, **kwargs)</code>","text":"<p>Convert STAC search result to a list.</p> <p>Parameters:</p> Name Type Description Default <code>search</code> <code>pystac_client.item_search</code> <p>The search result returned by leafmap.stac_search().</p> required <p>Returns:</p> Type Description <code>list</code> <p>A list of STAC items.</p> Source code in <code>anymap/stac.py</code> <pre><code>def stac_search_to_list(search, **kwargs) -&gt; List:\n    \"\"\"Convert STAC search result to a list.\n\n    Args:\n        search (pystac_client.item_search): The search result returned by leafmap.stac_search().\n\n    Returns:\n        list: A list of STAC items.\n    \"\"\"\n\n    return search.item_collections()\n</code></pre>"},{"location":"stac/#anymap.stac.stac_stats","title":"<code>stac_stats(url=None, collection=None, item=None, assets=None, titiler_endpoint=None, **kwargs)</code>","text":"<p>Get band statistics of a STAC item.</p> <p>Parameters:</p> Name Type Description Default <code>url</code> <code>str</code> <p>HTTP URL to a STAC item, e.g., https://canada-spot-ortho.s3.amazonaws.com/canada_spot_orthoimages/canada_spot5_orthoimages/S5_2007/S5_11055_6057_20070622/S5_11055_6057_20070622.json</p> <code>None</code> <code>collection</code> <code>str</code> <p>The Microsoft Planetary Computer STAC collection ID, e.g., landsat-8-c2-l2.</p> <code>None</code> <code>item</code> <code>str</code> <p>The Microsoft Planetary Computer STAC item ID, e.g., LC08_L2SP_047027_20201204_02_T1.</p> <code>None</code> <code>assets</code> <code>str | list</code> <p>The Microsoft Planetary Computer STAC asset ID, e.g., [\"SR_B7\", \"SR_B5\", \"SR_B4\"].</p> <code>None</code> <code>titiler_endpoint</code> <code>str</code> <p>TiTiler endpoint, e.g., \"https://giswqs-titiler-endpoint.hf.space\", \"planetary-computer\", \"pc\". Defaults to None.</p> <code>None</code> <p>Returns:</p> Type Description <code>list</code> <p>A dictionary of band statistics.</p> Source code in <code>anymap/stac.py</code> <pre><code>def stac_stats(\n    url: str = None,\n    collection: str = None,\n    item: str = None,\n    assets: Union[str, List] = None,\n    titiler_endpoint: Optional[str] = None,\n    **kwargs,\n) -&gt; List:\n    \"\"\"Get band statistics of a STAC item.\n\n    Args:\n        url (str): HTTP URL to a STAC item, e.g., https://canada-spot-ortho.s3.amazonaws.com/canada_spot_orthoimages/canada_spot5_orthoimages/S5_2007/S5_11055_6057_20070622/S5_11055_6057_20070622.json\n        collection (str): The Microsoft Planetary Computer STAC collection ID, e.g., landsat-8-c2-l2.\n        item (str): The Microsoft Planetary Computer STAC item ID, e.g., LC08_L2SP_047027_20201204_02_T1.\n        assets (str | list): The Microsoft Planetary Computer STAC asset ID, e.g., [\"SR_B7\", \"SR_B5\", \"SR_B4\"].\n        titiler_endpoint (str, optional): TiTiler endpoint, e.g., \"https://giswqs-titiler-endpoint.hf.space\", \"planetary-computer\", \"pc\". Defaults to None.\n\n    Returns:\n        list: A dictionary of band statistics.\n    \"\"\"\n\n    if url is None and collection is None:\n        raise ValueError(\"Either url or collection must be specified.\")\n\n    if collection is not None and titiler_endpoint is None:\n        titiler_endpoint = \"planetary-computer\"\n\n    if isinstance(url, pystac.Item):\n        try:\n            url = url.self_href\n        except Exception as e:\n            print(e)\n\n    if url is not None:\n        kwargs[\"url\"] = url\n    if collection is not None:\n        kwargs[\"collection\"] = collection\n    if item is not None:\n        kwargs[\"item\"] = item\n    if assets is not None:\n        kwargs[\"assets\"] = assets\n\n    titiler_endpoint = check_titiler_endpoint(titiler_endpoint)\n    if isinstance(titiler_endpoint, str):\n        r = requests.get(f\"{titiler_endpoint}/stac/statistics\", params=kwargs).json()\n    else:\n        r = requests.get(\n            titiler_endpoint.url_for_stac_statistics(), params=kwargs\n        ).json()\n\n    return r\n</code></pre>"},{"location":"stac/#anymap.stac.stac_tile","title":"<code>stac_tile(url=None, collection=None, item=None, assets=None, bands=None, titiler_endpoint=None, **kwargs)</code>","text":"<p>Get a tile layer from a single SpatialTemporal Asset Catalog (STAC) item.</p> <p>Parameters:</p> Name Type Description Default <code>url</code> <code>str</code> <p>HTTP URL to a STAC item, e.g., https://canada-spot-ortho.s3.amazonaws.com/canada_spot_orthoimages/canada_spot5_orthoimages/S5_2007/S5_11055_6057_20070622/S5_11055_6057_20070622.json</p> <code>None</code> <code>collection</code> <code>str</code> <p>The Microsoft Planetary Computer STAC collection ID, e.g., landsat-8-c2-l2.</p> <code>None</code> <code>item</code> <code>str</code> <p>The Microsoft Planetary Computer STAC item ID, e.g., LC08_L2SP_047027_20201204_02_T1.</p> <code>None</code> <code>assets</code> <code>str | list</code> <p>The Microsoft Planetary Computer STAC asset ID, e.g., [\"SR_B7\", \"SR_B5\", \"SR_B4\"].</p> <code>None</code> <code>bands</code> <code>list</code> <p>A list of band names, e.g., [\"SR_B7\", \"SR_B5\", \"SR_B4\"]</p> <code>None</code> <code>titiler_endpoint</code> <code>str</code> <p>TiTiler endpoint, e.g., \"https://giswqs-titiler-endpoint.hf.space\", \"https://planetarycomputer.microsoft.com/api/data/v1\", \"planetary-computer\", \"pc\". Defaults to None.</p> <code>None</code> <p>Returns:</p> Type Description <code>str</code> <p>Returns the STAC Tile layer URL.</p> Source code in <code>anymap/stac.py</code> <pre><code>def stac_tile(\n    url: str = None,\n    collection: str = None,\n    item: str = None,\n    assets: Union[str, List] = None,\n    bands: list = None,\n    titiler_endpoint: Optional[str] = None,\n    **kwargs,\n) -&gt; str:\n    \"\"\"Get a tile layer from a single SpatialTemporal Asset Catalog (STAC) item.\n\n    Args:\n        url (str): HTTP URL to a STAC item, e.g., https://canada-spot-ortho.s3.amazonaws.com/canada_spot_orthoimages/canada_spot5_orthoimages/S5_2007/S5_11055_6057_20070622/S5_11055_6057_20070622.json\n        collection (str): The Microsoft Planetary Computer STAC collection ID, e.g., landsat-8-c2-l2.\n        item (str): The Microsoft Planetary Computer STAC item ID, e.g., LC08_L2SP_047027_20201204_02_T1.\n        assets (str | list): The Microsoft Planetary Computer STAC asset ID, e.g., [\"SR_B7\", \"SR_B5\", \"SR_B4\"].\n        bands (list): A list of band names, e.g., [\"SR_B7\", \"SR_B5\", \"SR_B4\"]\n        titiler_endpoint (str, optional): TiTiler endpoint, e.g., \"https://giswqs-titiler-endpoint.hf.space\", \"https://planetarycomputer.microsoft.com/api/data/v1\", \"planetary-computer\", \"pc\". Defaults to None.\n\n    Returns:\n        str: Returns the STAC Tile layer URL.\n    \"\"\"\n    import json\n\n    if url is None and collection is None:\n        raise ValueError(\"Either url or collection must be specified.\")\n\n    if collection is not None and titiler_endpoint is None:\n        titiler_endpoint = \"planetary-computer\"\n\n    if isinstance(url, pystac.Item):\n        try:\n            url = url.self_href\n        except Exception as e:\n            print(e)\n\n    if url is not None:\n        kwargs[\"url\"] = url\n    if collection is not None:\n        kwargs[\"collection\"] = collection\n    if item is not None:\n        kwargs[\"item\"] = item\n\n    if \"palette\" in kwargs:\n        kwargs[\"colormap_name\"] = kwargs[\"palette\"].lower()\n        del kwargs[\"palette\"]\n\n    if isinstance(bands, list) and len(set(bands)) == 1:\n        bands = bands[0]\n\n    if isinstance(assets, list) and len(set(assets)) == 1:\n        assets = assets[0]\n\n    titiler_endpoint = check_titiler_endpoint(titiler_endpoint)\n\n    if \"expression\" in kwargs and (\"asset_as_band\" not in kwargs):\n        kwargs[\"asset_as_band\"] = True\n\n    mosaic_json = False\n\n    if isinstance(titiler_endpoint, PlanetaryComputerEndpoint):\n        if isinstance(bands, str):\n            bands = bands.split(\",\")\n        if isinstance(assets, str):\n            assets = assets.split(\",\")\n        if assets is None and (bands is not None):\n            assets = bands\n        else:\n            kwargs[\"bidx\"] = bands\n\n        kwargs[\"assets\"] = assets\n\n        if (\n            (assets is not None)\n            and (\"asset_expression\" not in kwargs)\n            and (\"expression\" not in kwargs)\n            and (\"rescale\" not in kwargs)\n        ):\n            try:\n                stats = stac_stats(\n                    collection=collection,\n                    item=item,\n                    assets=assets,\n                    titiler_endpoint=titiler_endpoint,\n                )\n            except Exception as e:\n                titiler_endpoint = \"https://giswqs-titiler-endpoint.hf.space\"\n                stats = stac_stats(\n                    collection=collection,\n                    item=item,\n                    assets=assets,\n                    titiler_endpoint=titiler_endpoint,\n                )\n\n            if \"detail\" not in stats:\n                try:\n                    percentile_2 = min([stats[s][\"percentile_2\"] for s in stats])\n                    percentile_98 = max([stats[s][\"percentile_98\"] for s in stats])\n                except:\n                    percentile_2 = min(\n                        [\n                            stats[s][list(stats[s].keys())[0]][\"percentile_2\"]\n                            for s in stats\n                        ]\n                    )\n                    percentile_98 = max(\n                        [\n                            stats[s][list(stats[s].keys())[0]][\"percentile_98\"]\n                            for s in stats\n                        ]\n                    )\n                kwargs[\"rescale\"] = f\"{percentile_2},{percentile_98}\"\n            else:\n                print(stats[\"detail\"])  # When operation times out.\n\n    else:\n        data = requests.get(url).json()\n        if \"mosaicjson\" in data:\n            mosaic_json = True\n\n        if isinstance(bands, str):\n            bands = bands.split(\",\")\n        if isinstance(assets, str):\n            assets = assets.split(\",\")\n\n        if assets is None:\n            if bands is not None:\n                assets = bands\n            else:\n                bnames = stac_bands(url)\n                if isinstance(bnames, list):\n                    if len(bnames) &gt;= 3:\n                        assets = bnames[0:3]\n                    else:\n                        assets = bnames[0]\n                else:\n                    assets = None\n\n        else:\n            if bands is not None:\n                kwargs[\"asset_bidx\"] = bands\n        if assets is not None:\n            kwargs[\"assets\"] = assets\n\n            if len(kwargs[\"assets\"]) == 1 and (\"colormap\" not in kwargs):\n                cog_url = get_cog_link_from_stac_item(url)\n                colormap = _get_image_colormap(cog_url)\n                if colormap is not None:\n                    kwargs[\"colormap\"] = colormap\n\n        if (\n            (assets is not None)\n            and (\"asset_expression\" not in kwargs)\n            and (\"expression\" not in kwargs)\n            and (\"rescale\" not in kwargs)\n            and (\"colormap\" not in kwargs)\n        ):\n            try:\n                stats = stac_stats(\n                    url=url,\n                    assets=assets,\n                    titiler_endpoint=titiler_endpoint,\n                )\n            except Exception as e:\n                titiler_endpoint = \"https://giswqs-titiler-endpoint.hf.space\"\n                stats = stac_stats(\n                    url=url,\n                    assets=assets,\n                    titiler_endpoint=titiler_endpoint,\n                )\n\n            if \"detail\" not in stats:\n                try:\n                    percentile_2 = min([stats[s][\"percentile_2\"] for s in stats])\n                    percentile_98 = max([stats[s][\"percentile_98\"] for s in stats])\n                except:\n                    percentile_2 = min(\n                        [\n                            stats[s][list(stats[s].keys())[0]][\"percentile_2\"]\n                            for s in stats\n                        ]\n                    )\n                    percentile_98 = max(\n                        [\n                            stats[s][list(stats[s].keys())[0]][\"percentile_98\"]\n                            for s in stats\n                        ]\n                    )\n                kwargs[\"rescale\"] = f\"{percentile_2},{percentile_98}\"\n            else:\n                print(stats[\"detail\"])  # When operation times out.\n\n    TileMatrixSetId = \"WebMercatorQuad\"\n    if \"TileMatrixSetId\" in kwargs.keys():\n        TileMatrixSetId = kwargs[\"TileMatrixSetId\"]\n        kwargs.pop(\"TileMatrixSetId\")\n\n    if \"colormap\" in kwargs and isinstance(kwargs[\"colormap\"], dict):\n        kwargs[\"colormap\"] = json.dumps(kwargs[\"colormap\"])\n\n    if mosaic_json:\n        try:\n            r = requests.get(\n                f\"{titiler_endpoint}/mosaicjson/{TileMatrixSetId}/tilejson.json\",\n                params=kwargs,\n                timeout=10,\n            ).json()\n        except Exception as e:\n            titiler_endpoint = \"https://giswqs-titiler-endpoint.hf.space\"\n            r = requests.get(\n                f\"{titiler_endpoint}/mosaicjson/{TileMatrixSetId}/tilejson.json\",\n                params=kwargs,\n                timeout=10,\n            ).json()\n    else:\n        if isinstance(titiler_endpoint, str):\n            try:\n                r = requests.get(\n                    f\"{titiler_endpoint}/stac/{TileMatrixSetId}/tilejson.json\",\n                    params=kwargs,\n                    timeout=10,\n                ).json()\n            except Exception as e:\n                titiler_endpoint = \"https://giswqs-titiler-endpoint.hf.space\"\n                r = requests.get(\n                    f\"{titiler_endpoint}/stac/{TileMatrixSetId}/tilejson.json\",\n                    params=kwargs,\n                    timeout=10,\n                ).json()\n        else:\n            r = requests.get(\n                titiler_endpoint.url_for_stac_item(), params=kwargs, timeout=10\n            ).json()\n\n    return r[\"tiles\"][0]\n</code></pre>"},{"location":"usage/","title":"Usage","text":"<p>To use anymap in a project:</p> <pre><code>import anymap\n</code></pre>"},{"location":"utils/","title":"utils module","text":"<p>Utility functions for anymap library.</p> <p>This module contains common utility functions used across the anymap library, including functions for constructing map style URLs, handling API keys, and working with different mapping service providers.</p> <p>Functions</p> <p>get_env_var: Retrieve environment variables or user data keys. construct_carto_style: Construct URL for Carto style. construct_amazon_style: Construct URL for Amazon Map style. construct_maptiler_style: Construct URL for MapTiler style. maptiler_3d_style: Generate 3D terrain style configuration. construct_maplibre_style: Construct MapLibre style configuration.</p> <p>Examples:</p> <p>Getting an environment variable:</p> <pre><code>&gt;&gt;&gt; from anymap.utils import get_env_var\n&gt;&gt;&gt; api_key = get_env_var(\"MAPTILER_KEY\")\n</code></pre> <p>Constructing a style URL:</p> <pre><code>&gt;&gt;&gt; from anymap.utils import construct_maplibre_style\n&gt;&gt;&gt; style = construct_maplibre_style(\"dark-matter\")\n</code></pre>"},{"location":"utils/#anymap.utils.array_to_image","title":"<code>array_to_image(array, output=None, source=None, dtype=None, compress='deflate', transpose=True, cellsize=None, crs=None, transform=None, driver='COG', colormap=None, **kwargs)</code>","text":"<p>Save a NumPy array as a GeoTIFF using the projection information from an existing GeoTIFF file.</p> <p>Parameters:</p> Name Type Description Default <code>array</code> <code>np.ndarray</code> <p>The NumPy array to be saved as a GeoTIFF.</p> required <code>output</code> <code>str</code> <p>The path to the output image. If None, a temporary file will be created. Defaults to None.</p> <code>None</code> <code>source</code> <code>str</code> <p>The path to an existing GeoTIFF file with map projection information. Defaults to None.</p> <code>None</code> <code>dtype</code> <code>np.dtype</code> <p>The data type of the output array. Defaults to None.</p> <code>None</code> <code>compress</code> <code>str</code> <p>The compression method. Can be one of the following: \"deflate\", \"lzw\", \"packbits\", \"jpeg\". Defaults to \"deflate\".</p> <code>'deflate'</code> <code>transpose</code> <code>bool</code> <p>Whether to transpose the array from (bands, rows, columns) to (rows, columns, bands). Defaults to True.</p> <code>True</code> <code>cellsize</code> <code>float</code> <p>The resolution of the output image in meters. Defaults to None.</p> <code>None</code> <code>crs</code> <code>str</code> <p>The CRS of the output image. Defaults to None.</p> <code>None</code> <code>transform</code> <code>tuple</code> <p>The affine transformation matrix, can be rio.transform() or a tuple like (0.5, 0.0, -180.25, 0.0, -0.5, 83.780361). Defaults to None.</p> <code>None</code> <code>driver</code> <code>str</code> <p>The driver to use for creating the output file, such as 'GTiff'. Defaults to \"COG\".</p> <code>'COG'</code> <code>colormap</code> <code>dict</code> <p>A dictionary defining the colormap (value: (R, G, B, A)).</p> <code>None</code> <code>**kwargs</code> <code>Any</code> <p>Additional keyword arguments to be passed to the rasterio.open() function.</p> <code>{}</code> Source code in <code>anymap/utils.py</code> <pre><code>def array_to_image(\n    array,\n    output: str = None,\n    source: str = None,\n    dtype: str = None,\n    compress: str = \"deflate\",\n    transpose: bool = True,\n    cellsize: float = None,\n    crs: str = None,\n    transform: tuple = None,\n    driver: str = \"COG\",\n    colormap: dict = None,\n    **kwargs: Any,\n) -&gt; str:\n    \"\"\"Save a NumPy array as a GeoTIFF using the projection information from an existing GeoTIFF file.\n\n    Args:\n        array (np.ndarray): The NumPy array to be saved as a GeoTIFF.\n        output (str): The path to the output image. If None, a temporary file will be created. Defaults to None.\n        source (str, optional): The path to an existing GeoTIFF file with map projection information. Defaults to None.\n        dtype (np.dtype, optional): The data type of the output array. Defaults to None.\n        compress (str, optional): The compression method. Can be one of the following: \"deflate\", \"lzw\", \"packbits\", \"jpeg\". Defaults to \"deflate\".\n        transpose (bool, optional): Whether to transpose the array from (bands, rows, columns) to (rows, columns, bands). Defaults to True.\n        cellsize (float, optional): The resolution of the output image in meters. Defaults to None.\n        crs (str, optional): The CRS of the output image. Defaults to None.\n        transform (tuple, optional): The affine transformation matrix, can be rio.transform() or a tuple like (0.5, 0.0, -180.25, 0.0, -0.5, 83.780361).\n            Defaults to None.\n        driver (str, optional): The driver to use for creating the output file, such as 'GTiff'. Defaults to \"COG\".\n        colormap (dict, optional): A dictionary defining the colormap (value: (R, G, B, A)).\n        **kwargs (Any): Additional keyword arguments to be passed to the rasterio.open() function.\n    \"\"\"\n\n    import numpy as np\n    import rasterio\n    import rioxarray\n    import xarray as xr\n    from rasterio.transform import Affine\n\n    if output is None:\n        return array_to_memory_file(\n            array,\n            source,\n            dtype,\n            compress,\n            transpose,\n            cellsize,\n            crs=crs,\n            transform=transform,\n            driver=driver,\n            colormap=colormap,\n            **kwargs,\n        )\n\n    if isinstance(array, xr.DataArray):\n        if (\n            hasattr(array, \"rio\")\n            and (array.rio.crs is not None)\n            and (array.rio.transform() is not None)\n        ):\n\n            if \"latitude\" in array.dims and \"longitude\" in array.dims:\n                array = array.rename({\"latitude\": \"y\", \"longitude\": \"x\"})\n            elif \"lat\" in array.dims and \"lon\" in array.dims:\n                array = array.rename({\"lat\": \"y\", \"lon\": \"x\"})\n\n            if array.ndim == 2 and (\"x\" in array.dims) and (\"y\" in array.dims):\n                array = array.transpose(\"y\", \"x\")\n            elif array.ndim == 3 and (\"x\" in array.dims) and (\"y\" in array.dims):\n                dims = list(array.dims)\n                dims.remove(\"x\")\n                dims.remove(\"y\")\n                array = array.transpose(dims[0], \"y\", \"x\")\n            if \"long_name\" in array.attrs:\n                array.attrs.pop(\"long_name\")\n\n            array.rio.to_raster(\n                output, driver=driver, compress=compress, dtype=dtype, **kwargs\n            )\n            if colormap:\n                write_image_colormap(output, colormap, output)\n            return output\n\n    if array.ndim == 3 and transpose:\n        array = np.transpose(array, (1, 2, 0))\n\n    out_dir = os.path.dirname(os.path.abspath(output))\n    if not os.path.exists(out_dir):\n        os.makedirs(out_dir)\n\n    ext = os.path.splitext(output)[-1].lower()\n    if ext == \"\":\n        output += \".tif\"\n        driver = \"COG\"\n    elif ext == \".png\":\n        driver = \"PNG\"\n    elif ext == \".jpg\" or ext == \".jpeg\":\n        driver = \"JPEG\"\n    elif ext == \".jp2\":\n        driver = \"JP2OpenJPEG\"\n    elif ext == \".tiff\":\n        driver = \"GTiff\"\n    else:\n        driver = \"COG\"\n\n    if source is not None:\n        with rasterio.open(source) as src:\n            crs = src.crs\n            transform = src.transform\n            if compress is None:\n                compress = src.compression\n    else:\n        if cellsize is None:\n            raise ValueError(\"resolution must be provided if source is not provided\")\n        if crs is None:\n            raise ValueError(\n                \"crs must be provided if source is not provided, such as EPSG:3857\"\n            )\n\n        if transform is None:\n            # Define the geotransformation parameters\n            xmin, ymin, xmax, ymax = (\n                0,\n                0,\n                cellsize * array.shape[1],\n                cellsize * array.shape[0],\n            )\n            transform = rasterio.transform.from_bounds(\n                xmin, ymin, xmax, ymax, array.shape[1], array.shape[0]\n            )\n        elif isinstance(transform, Affine):\n            pass\n        elif isinstance(transform, (tuple, list)):\n            transform = Affine(*transform)\n\n        kwargs[\"transform\"] = transform\n\n    if dtype is None:\n        # Determine the minimum and maximum values in the array\n        min_value = np.min(array)\n        max_value = np.max(array)\n        # Determine the best dtype for the array\n        if min_value &gt;= 0 and max_value &lt;= 1:\n            dtype = np.float32\n        elif min_value &gt;= 0 and max_value &lt;= 255:\n            dtype = np.uint8\n        elif min_value &gt;= -128 and max_value &lt;= 127:\n            dtype = np.int8\n        elif min_value &gt;= 0 and max_value &lt;= 65535:\n            dtype = np.uint16\n        elif min_value &gt;= -32768 and max_value &lt;= 32767:\n            dtype = np.int16\n        else:\n            dtype = np.float64\n\n    # Convert the array to the best dtype\n    array = array.astype(dtype)\n\n    # Define the GeoTIFF metadata\n    metadata = {\n        \"driver\": driver,\n        \"height\": array.shape[0],\n        \"width\": array.shape[1],\n        \"dtype\": array.dtype,\n        \"crs\": crs,\n        \"transform\": transform,\n    }\n\n    if array.ndim == 2:\n        metadata[\"count\"] = 1\n    elif array.ndim == 3:\n        metadata[\"count\"] = array.shape[2]\n    if compress is not None and (driver in [\"GTiff\", \"COG\"]):\n        metadata[\"compress\"] = compress\n\n    metadata.update(**kwargs)\n    # Create a new GeoTIFF file and write the array to it\n    with rasterio.open(output, \"w\", **metadata) as dst:\n        if array.ndim == 2:\n            dst.write(array, 1)\n            if colormap:\n                dst.write_colormap(1, colormap)\n        elif array.ndim == 3:\n            for i in range(array.shape[2]):\n                dst.write(array[:, :, i], i + 1)\n                if colormap:\n                    dst.write_colormap(i + 1, colormap)\n    return output\n</code></pre>"},{"location":"utils/#anymap.utils.array_to_memory_file","title":"<code>array_to_memory_file(array, source=None, dtype=None, compress='deflate', transpose=True, cellsize=None, crs=None, transform=None, driver='COG', colormap=None, **kwargs)</code>","text":"<p>Convert a NumPy array to a memory file.</p> <p>Parameters:</p> Name Type Description Default <code>array</code> <code>numpy.ndarray</code> <p>The input NumPy array.</p> required <code>source</code> <code>str</code> <p>Path to the source file to extract metadata from. Defaults to None.</p> <code>None</code> <code>dtype</code> <code>str</code> <p>The desired data type of the array. Defaults to None.</p> <code>None</code> <code>compress</code> <code>str</code> <p>The compression method for the output file. Defaults to \"deflate\".</p> <code>'deflate'</code> <code>transpose</code> <code>bool</code> <p>Whether to transpose the array from (bands, rows, columns) to (rows, columns, bands). Defaults to True.</p> <code>True</code> <code>cellsize</code> <code>float</code> <p>The cell size of the array if source is not provided. Defaults to None.</p> <code>None</code> <code>crs</code> <code>str</code> <p>The coordinate reference system of the array if source is not provided. Defaults to None.</p> <code>None</code> <code>transform</code> <code>tuple</code> <p>The affine transformation matrix if source is not provided. Can be rio.transform() or a tuple like (0.5, 0.0, -180.25, 0.0, -0.5, 83.780361). Defaults to None.</p> <code>None</code> <code>driver</code> <code>str</code> <p>The driver to use for creating the output file, such as 'GTiff'. Defaults to \"COG\".</p> <code>'COG'</code> <code>colormap</code> <code>dict</code> <p>A dictionary defining the colormap (value: (R, G, B, A)).</p> <code>None</code> <code>**kwargs</code> <code>Any</code> <p>Additional keyword arguments to be passed to the rasterio.open() function.</p> <code>{}</code> <p>Returns:</p> Type Description <code>Any</code> <p>The rasterio dataset reader object for the converted array.</p> Source code in <code>anymap/utils.py</code> <pre><code>def array_to_memory_file(\n    array,\n    source: str = None,\n    dtype: str = None,\n    compress: str = \"deflate\",\n    transpose: bool = True,\n    cellsize: float = None,\n    crs: str = None,\n    transform: tuple = None,\n    driver=\"COG\",\n    colormap: dict = None,\n    **kwargs: Any,\n) -&gt; Any:\n    \"\"\"Convert a NumPy array to a memory file.\n\n    Args:\n        array (numpy.ndarray): The input NumPy array.\n        source (str, optional): Path to the source file to extract metadata from. Defaults to None.\n        dtype (str, optional): The desired data type of the array. Defaults to None.\n        compress (str, optional): The compression method for the output file. Defaults to \"deflate\".\n        transpose (bool, optional): Whether to transpose the array from (bands, rows, columns) to (rows, columns, bands). Defaults to True.\n        cellsize (float, optional): The cell size of the array if source is not provided. Defaults to None.\n        crs (str, optional): The coordinate reference system of the array if source is not provided. Defaults to None.\n        transform (tuple, optional): The affine transformation matrix if source is not provided.\n            Can be rio.transform() or a tuple like (0.5, 0.0, -180.25, 0.0, -0.5, 83.780361). Defaults to None.\n        driver (str, optional): The driver to use for creating the output file, such as 'GTiff'. Defaults to \"COG\".\n        colormap (dict, optional): A dictionary defining the colormap (value: (R, G, B, A)).\n        **kwargs (Any): Additional keyword arguments to be passed to the rasterio.open() function.\n\n    Returns:\n        The rasterio dataset reader object for the converted array.\n    \"\"\"\n    import numpy as np\n    import rasterio\n    import xarray as xr\n    from rasterio.transform import Affine\n\n    if isinstance(array, xr.DataArray):\n        coords = [coord for coord in array.coords]\n        if coords[0] == \"time\":\n            x_dim = coords[1]\n            y_dim = coords[2]\n            array = (\n                array.isel(time=0).rename({y_dim: \"y\", x_dim: \"x\"}).transpose(\"y\", \"x\")\n            )\n        if hasattr(array, \"rio\"):\n            if hasattr(array.rio, \"crs\"):\n                if array.rio.crs is not None:\n                    crs = array.rio.crs\n            if transform is None and hasattr(array.rio, \"transform\"):\n                transform = array.rio.transform()\n        elif source is None:\n            if hasattr(array, \"encoding\"):\n                if \"source\" in array.encoding:\n                    source = array.encoding[\"source\"]\n        array = array.values\n\n    if array.ndim == 3 and transpose:\n        array = np.transpose(array, (1, 2, 0))\n    if source is not None:\n        with rasterio.open(source) as src:\n            crs = src.crs\n            transform = src.transform\n            if compress is None:\n                compress = src.compression\n    else:\n        if crs is None:\n            raise ValueError(\n                \"crs must be provided if source is not provided, such as EPSG:3857\"\n            )\n\n        if transform is None:\n            if cellsize is None:\n                raise ValueError(\"cellsize must be provided if source is not provided\")\n            # Define the geotransformation parameters\n            xmin, ymin, xmax, ymax = (\n                0,\n                0,\n                cellsize * array.shape[1],\n                cellsize * array.shape[0],\n            )\n            # (west, south, east, north, width, height)\n            transform = rasterio.transform.from_bounds(\n                xmin, ymin, xmax, ymax, array.shape[1], array.shape[0]\n            )\n        elif isinstance(transform, Affine):\n            pass\n        elif isinstance(transform, (tuple, list)):\n            transform = Affine(*transform)\n\n        kwargs[\"transform\"] = transform\n\n    if dtype is None:\n        # Determine the minimum and maximum values in the array\n        min_value = np.min(array)\n        max_value = np.max(array)\n        # Determine the best dtype for the array\n        if min_value &gt;= 0 and max_value &lt;= 1:\n            dtype = np.float32\n        elif min_value &gt;= 0 and max_value &lt;= 255:\n            dtype = np.uint8\n        elif min_value &gt;= -128 and max_value &lt;= 127:\n            dtype = np.int8\n        elif min_value &gt;= 0 and max_value &lt;= 65535:\n            dtype = np.uint16\n        elif min_value &gt;= -32768 and max_value &lt;= 32767:\n            dtype = np.int16\n        else:\n            dtype = np.float64\n\n    # Convert the array to the best dtype\n    array = array.astype(dtype)\n    # Define the GeoTIFF metadata\n    metadata = {\n        \"driver\": driver,\n        \"height\": array.shape[0],\n        \"width\": array.shape[1],\n        \"dtype\": array.dtype,\n        \"crs\": crs,\n        \"transform\": transform,\n    }\n\n    if array.ndim == 2:\n        metadata[\"count\"] = 1\n    elif array.ndim == 3:\n        metadata[\"count\"] = array.shape[2]\n    if compress is not None:\n        metadata[\"compress\"] = compress\n\n    metadata.update(**kwargs)\n\n    # Create a new memory file and write the array to it\n    memory_file = rasterio.MemoryFile()\n    dst = memory_file.open(**metadata)\n\n    # Check and sanitize colormap\n    fixed_colormap = {}\n\n    if colormap is None:\n        colormap = {}\n\n    for k, v in colormap.items():\n        if not isinstance(k, int):\n            k = int(k)\n        if len(v) == 3:  # RGB\n            fixed_colormap[k] = tuple(int(c) for c in v)\n        elif len(v) == 4:  # RGBA\n            fixed_colormap[k] = tuple(\n                int(c) for c in v[:3]\n            )  # Drop alpha for compatibility\n        else:\n            raise ValueError(f\"Invalid colormap value: {v}\")\n\n    if array.ndim == 2:\n        dst.write(array, 1)\n        if colormap:\n            dst.write_colormap(1, fixed_colormap)\n    elif array.ndim == 3:\n        for i in range(array.shape[2]):\n            dst.write(array[:, :, i], i + 1)\n            if colormap:\n                dst.write_colormap(i + 1, fixed_colormap)\n\n    dst.close()\n    # Read the dataset from memory\n    dataset_reader = rasterio.open(dst.name, mode=\"r\")\n\n    return dataset_reader\n</code></pre>"},{"location":"utils/#anymap.utils.check_color","title":"<code>check_color(in_color)</code>","text":"<p>Checks the input color and returns the corresponding hex color code.</p> <p>Parameters:</p> Name Type Description Default <code>in_color</code> <code>str or tuple or list</code> <p>It can be a string (e.g., 'red', '#ffff00', 'ffff00', 'ff0') or RGB tuple/list (e.g., (255, 127, 0)).</p> required <p>Returns:</p> Type Description <code>str</code> <p>A hex color code.</p> Source code in <code>anymap/utils.py</code> <pre><code>def check_color(in_color: Union[str, Tuple, List]) -&gt; str:\n    \"\"\"Checks the input color and returns the corresponding hex color code.\n\n    Args:\n        in_color (str or tuple or list): It can be a string (e.g., 'red', '#ffff00', 'ffff00', 'ff0') or RGB tuple/list (e.g., (255, 127, 0)).\n\n    Returns:\n        str: A hex color code.\n    \"\"\"\n    from matplotlib import colors\n\n    out_color = \"#000000\"  # default black color\n    # Handle RGB tuple or list\n    if isinstance(in_color, (tuple, list)) and len(in_color) == 3:\n        # rescale color if necessary\n        if all(isinstance(item, int) for item in in_color):\n            # Ensure values are floats between 0 and 1 for to_hex\n            in_color = [c / 255.0 for c in in_color]\n        try:\n            return colors.to_hex(in_color)\n        except ValueError:\n            print(\n                f\"The provided RGB color ({in_color}) is invalid. Using the default black color.\"\n            )\n            return out_color\n\n    # Handle string color input\n    elif isinstance(in_color, str):\n        try:\n            # Try converting directly (handles color names and hex with #)\n            return colors.to_hex(in_color)\n        except ValueError:\n            try:\n                # Try again by adding an extra # (handles hex without #)\n                return colors.to_hex(f\"#{in_color}\")\n            except ValueError:\n                print(\n                    f\"The provided color string ({in_color}) is invalid. Using the default black color.\"\n                )\n                return out_color\n    else:\n        print(\n            f\"The provided color type ({type(in_color)}) is invalid. Using the default black color.\"\n        )\n        return out_color\n</code></pre>"},{"location":"utils/#anymap.utils.construct_amazon_style","title":"<code>construct_amazon_style(map_style='standard', region='us-east-1', api_key=None, token='AWS_MAPS_API_KEY')</code>","text":"<p>Constructs a URL for an Amazon Map style.</p> <p>Parameters:</p> Name Type Description Default <code>map_style</code> <code>str</code> <p>The name of the MapTiler style to be accessed. It can be one of the following: standard, monochrome, satellite, hybrid.</p> <code>'standard'</code> <code>region</code> <code>str</code> <p>The region of the Amazon Map. It can be one of the following: us-east-1, us-west-2, eu-central-1, eu-west-1, ap-northeast-1, ap-northeast-2, ap-southeast-1, etc.</p> <code>'us-east-1'</code> <code>api_key</code> <code>str</code> <p>The API key for the Amazon Map. If None, the function attempts to retrieve the API key using a predefined method.</p> <code>None</code> <code>token</code> <code>str</code> <p>The token for the Amazon Map. If None, the function attempts to retrieve the API key using a predefined method.</p> <code>'AWS_MAPS_API_KEY'</code> <p>Returns:</p> Type Description <code>str</code> <p>The URL for the requested Amazon Map style.</p> Source code in <code>anymap/utils.py</code> <pre><code>def construct_amazon_style(\n    map_style: str = \"standard\",\n    region: str = \"us-east-1\",\n    api_key: str = None,\n    token: str = \"AWS_MAPS_API_KEY\",\n) -&gt; str:\n    \"\"\"\n    Constructs a URL for an Amazon Map style.\n\n    Args:\n        map_style (str): The name of the MapTiler style to be accessed. It can be one of the following:\n            standard, monochrome, satellite, hybrid.\n        region (str): The region of the Amazon Map. It can be one of the following:\n            us-east-1, us-west-2, eu-central-1, eu-west-1, ap-northeast-1, ap-northeast-2, ap-southeast-1, etc.\n        api_key (str): The API key for the Amazon Map. If None, the function attempts to retrieve the API key using a predefined method.\n        token (str): The token for the Amazon Map. If None, the function attempts to retrieve the API key using a predefined method.\n\n    Returns:\n        str: The URL for the requested Amazon Map style.\n    \"\"\"\n\n    if map_style.lower() not in [\"standard\", \"monochrome\", \"satellite\", \"hybrid\"]:\n        print(\n            \"Invalid map style. Please choose from amazon-standard, amazon-monochrome, amazon-satellite, or amazon-hybrid.\"\n        )\n        return None\n\n    if api_key is None:\n        api_key = get_env_var(token)\n        if api_key is None:\n            print(\"An API key is required to use the Amazon Map style.\")\n            return None\n\n    url = f\"https://maps.geo.{region}.amazonaws.com/v2/styles/{map_style.title()}/descriptor?key={api_key}\"\n    return url\n</code></pre>"},{"location":"utils/#anymap.utils.construct_carto_style","title":"<code>construct_carto_style(style)</code>","text":"<p>Constructs a URL for a Carto style with an optional API key. The URL looks like this: https://basemaps.cartocdn.com/gl/dark-matter-gl-style/style.json https://basemaps.cartocdn.com/gl/positron-gl-style/style.json</p> Source code in <code>anymap/utils.py</code> <pre><code>def construct_carto_style(style: str) -&gt; str:\n    \"\"\"\n    Constructs a URL for a Carto style with an optional API key.\n    The URL looks like this:\n    https://basemaps.cartocdn.com/gl/dark-matter-gl-style/style.json\n    https://basemaps.cartocdn.com/gl/positron-gl-style/style.json\n    \"\"\"\n\n    return f\"https://basemaps.cartocdn.com/gl/{style.lower()}-gl-style/style.json\"\n</code></pre>"},{"location":"utils/#anymap.utils.construct_maplibre_style","title":"<code>construct_maplibre_style(style, **kwargs)</code>","text":"<p>Constructs a URL for a MapLibre style.</p> <p>Parameters:</p> Name Type Description Default <code>style</code> <code>str</code> <p>The name of the MapLibre style to be accessed.</p> required Source code in <code>anymap/utils.py</code> <pre><code>def construct_maplibre_style(style: str, **kwargs) -&gt; str:\n    \"\"\"\n    Constructs a URL for a MapLibre style.\n\n    Args:\n        style (str): The name of the MapLibre style to be accessed.\n    \"\"\"\n    carto_basemaps = [\n        \"dark-matter\",\n        \"positron\",\n        \"voyager\",\n        \"positron-nolabels\",\n        \"dark-matter-nolabels\",\n        \"voyager-nolabels\",\n    ]\n    openfreemap_basemaps = [\n        \"liberty\",\n        \"bright\",\n        \"positron2\",\n    ]\n\n    if isinstance(style, str):\n\n        if style.startswith(\"https\"):\n            response = requests.get(style, timeout=10)\n            if response.status_code != 200:\n                print(\n                    \"The provided style URL is invalid. Falling back to 'dark-matter'.\"\n                )\n                style = \"dark-matter\"\n            else:\n                style = json.loads(response.text)\n        elif style.startswith(\"3d-\"):\n            style = maptiler_3d_style(\n                style=style.replace(\"3d-\", \"\").lower(),\n                exaggeration=kwargs.pop(\"exaggeration\", 1),\n                tile_size=kwargs.pop(\"tile_size\", 512),\n                hillshade=kwargs.pop(\"hillshade\", True),\n            )\n        elif style.startswith(\"amazon-\"):\n            style = construct_amazon_style(\n                map_style=style.replace(\"amazon-\", \"\").lower(),\n                region=kwargs.pop(\"region\", \"us-east-1\"),\n                api_key=kwargs.pop(\"api_key\", None),\n                token=kwargs.pop(\"token\", \"AWS_MAPS_API_KEY\"),\n            )\n\n        elif style.lower() in carto_basemaps:\n            style = construct_carto_style(style.lower())\n        elif style.lower() in openfreemap_basemaps:\n            if style == \"positron2\":\n                style = \"positron\"\n            style = f\"https://tiles.openfreemap.org/styles/{style.lower()}\"\n        elif style == \"demotiles\":\n            style = \"https://demotiles.maplibre.org/style.json\"\n        else:\n            style = construct_maptiler_style(style)\n\n        if style in carto_basemaps:\n            style = construct_carto_style(style)\n\n    return style\n</code></pre>"},{"location":"utils/#anymap.utils.construct_maptiler_style","title":"<code>construct_maptiler_style(style, api_key=None)</code>","text":"<p>Constructs a URL for a MapTiler style with an optional API key.</p> <p>This function generates a URL for accessing a specific MapTiler map style. If an API key is not provided, it attempts to retrieve one using a predefined method. If the request to MapTiler fails, it defaults to a \"liberty\" style.</p> <p>Parameters:</p> Name Type Description Default <code>style</code> <code>str</code> <p>The name of the MapTiler style to be accessed. It can be one of the following: aquarelle, backdrop, basic, bright, dataviz, landscape, ocean, openstreetmap, outdoor, satellite, streets, toner, topo, winter, etc.</p> required <code>api_key</code> <code>Optional[str]</code> <p>An optional API key for accessing MapTiler services. If None, the function attempts to retrieve the API key using a predefined method. Defaults to None.</p> <code>None</code> <p>Returns:</p> Type Description <code>str</code> <p>The URL for the requested MapTiler style. If the request fails, returns a URL for the \"liberty\" style.</p> <p>Exceptions:</p> Type Description <code>requests.exceptions.RequestException</code> <p>If the request to the MapTiler API fails.</p> Source code in <code>anymap/utils.py</code> <pre><code>def construct_maptiler_style(style: str, api_key: Optional[str] = None) -&gt; str:\n    \"\"\"\n    Constructs a URL for a MapTiler style with an optional API key.\n\n    This function generates a URL for accessing a specific MapTiler map style. If an API key is not provided,\n    it attempts to retrieve one using a predefined method. If the request to MapTiler fails, it defaults to\n    a \"liberty\" style.\n\n    Args:\n        style (str): The name of the MapTiler style to be accessed. It can be one of the following:\n            aquarelle, backdrop, basic, bright, dataviz, landscape, ocean, openstreetmap, outdoor,\n            satellite, streets, toner, topo, winter, etc.\n        api_key (Optional[str]): An optional API key for accessing MapTiler services. If None, the function\n            attempts to retrieve the API key using a predefined method. Defaults to None.\n\n    Returns:\n        str: The URL for the requested MapTiler style. If the request fails, returns a URL for the \"liberty\" style.\n\n    Raises:\n        requests.exceptions.RequestException: If the request to the MapTiler API fails.\n    \"\"\"\n\n    if api_key is None:\n        api_key = get_env_var(\"MAPTILER_KEY\")\n\n    url = f\"https://api.maptiler.com/maps/{style}/style.json?key={api_key}\"\n\n    response = requests.get(url, timeout=10)\n    if response.status_code != 200:\n        # print(\n        #     \"Failed to retrieve the MapTiler style. Defaulting to OpenFreeMap 'liberty' style.\"\n        # )\n        url = \"https://tiles.openfreemap.org/styles/liberty\"\n\n    return url\n</code></pre>"},{"location":"utils/#anymap.utils.download_file","title":"<code>download_file(url=None, output=None, quiet=False, proxy=None, speed=None, use_cookies=True, verify=True, id=None, fuzzy=False, resume=False, unzip=True, overwrite=False, subfolder=False)</code>","text":"<p>Download a file from URL, including Google Drive shared URL.</p> <p>Parameters:</p> Name Type Description Default <code>url</code> <code>str</code> <p>Google Drive URL is also supported. Defaults to None.</p> <code>None</code> <code>output</code> <code>str</code> <p>Output filename. Default is basename of URL.</p> <code>None</code> <code>quiet</code> <code>bool</code> <p>Suppress terminal output. Default is False.</p> <code>False</code> <code>proxy</code> <code>str</code> <p>Proxy. Defaults to None.</p> <code>None</code> <code>speed</code> <code>float</code> <p>Download byte size per second (e.g., 256KB/s = 256 * 1024). Defaults to None.</p> <code>None</code> <code>use_cookies</code> <code>bool</code> <p>Flag to use cookies. Defaults to True.</p> <code>True</code> <code>verify</code> <code>bool | str</code> <p>Either a bool, in which case it controls whether the server's TLS certificate is verified, or a string, in which case it must be a path to a CA bundle to use. Default is True.. Defaults to True.</p> <code>True</code> <code>id</code> <code>str</code> <p>Google Drive's file ID. Defaults to None.</p> <code>None</code> <code>fuzzy</code> <code>bool</code> <p>Fuzzy extraction of Google Drive's file Id. Defaults to False.</p> <code>False</code> <code>resume</code> <code>bool</code> <p>Resume the download from existing tmp file if possible. Defaults to False.</p> <code>False</code> <code>unzip</code> <code>bool</code> <p>Unzip the file. Defaults to True.</p> <code>True</code> <code>overwrite</code> <code>bool</code> <p>Overwrite the file if it already exists. Defaults to False.</p> <code>False</code> <code>subfolder</code> <code>bool</code> <p>Create a subfolder with the same name as the file. Defaults to False.</p> <code>False</code> <p>Returns:</p> Type Description <code>str</code> <p>The output file path.</p> Source code in <code>anymap/utils.py</code> <pre><code>def download_file(\n    url=None,\n    output=None,\n    quiet=False,\n    proxy=None,\n    speed=None,\n    use_cookies=True,\n    verify=True,\n    id=None,\n    fuzzy=False,\n    resume=False,\n    unzip=True,\n    overwrite=False,\n    subfolder=False,\n) -&gt; str:\n    \"\"\"Download a file from URL, including Google Drive shared URL.\n\n    Args:\n        url (str, optional): Google Drive URL is also supported. Defaults to None.\n        output (str, optional): Output filename. Default is basename of URL.\n        quiet (bool, optional): Suppress terminal output. Default is False.\n        proxy (str, optional): Proxy. Defaults to None.\n        speed (float, optional): Download byte size per second (e.g., 256KB/s = 256 * 1024). Defaults to None.\n        use_cookies (bool, optional): Flag to use cookies. Defaults to True.\n        verify (bool | str, optional): Either a bool, in which case it controls whether the server's TLS certificate is verified, or a string,\n            in which case it must be a path to a CA bundle to use. Default is True.. Defaults to True.\n        id (str, optional): Google Drive's file ID. Defaults to None.\n        fuzzy (bool, optional): Fuzzy extraction of Google Drive's file Id. Defaults to False.\n        resume (bool, optional): Resume the download from existing tmp file if possible. Defaults to False.\n        unzip (bool, optional): Unzip the file. Defaults to True.\n        overwrite (bool, optional): Overwrite the file if it already exists. Defaults to False.\n        subfolder (bool, optional): Create a subfolder with the same name as the file. Defaults to False.\n\n    Returns:\n        The output file path.\n    \"\"\"\n    import tarfile\n    import zipfile\n\n    try:\n        import gdown\n    except ImportError:\n        print(\n            \"The gdown package is required for this function. Use `pip install gdown` to install it.\"\n        )\n        return\n\n    if output is None:\n        if isinstance(url, str) and url.startswith(\"http\"):\n            output = os.path.basename(url)\n\n    out_dir = os.path.abspath(os.path.dirname(output))\n    if not os.path.exists(out_dir):\n        os.makedirs(out_dir)\n\n    if isinstance(url, str):\n        if os.path.exists(os.path.abspath(output)) and (not overwrite):\n            print(\n                f\"{output} already exists. Skip downloading. Set overwrite=True to overwrite.\"\n            )\n            return os.path.abspath(output)\n        else:\n            url = github_raw_url(url)\n\n    if \"https://drive.google.com/file/d/\" in url:\n        fuzzy = True\n\n    output = gdown.download(\n        url, output, quiet, proxy, speed, use_cookies, verify, id, fuzzy, resume\n    )\n\n    if unzip:\n        if output.endswith(\".zip\"):\n            with zipfile.ZipFile(output, \"r\") as zip_ref:\n                if not quiet:\n                    print(\"Extracting files...\")\n                if subfolder:\n                    basename = os.path.splitext(os.path.basename(output))[0]\n\n                    output = os.path.join(out_dir, basename)\n                    if not os.path.exists(output):\n                        os.makedirs(output)\n                    zip_ref.extractall(output)\n                else:\n                    zip_ref.extractall(os.path.dirname(output))\n        elif output.endswith(\".tar.gz\") or output.endswith(\".tar\"):\n            if output.endswith(\".tar.gz\"):\n                mode = \"r:gz\"\n            else:\n                mode = \"r\"\n\n            with tarfile.open(output, mode) as tar_ref:\n                if not quiet:\n                    print(\"Extracting files...\")\n                if subfolder:\n                    basename = os.path.splitext(os.path.basename(output))[0]\n                    output = os.path.join(out_dir, basename)\n                    if not os.path.exists(output):\n                        os.makedirs(output)\n                    tar_ref.extractall(output)\n                else:\n                    tar_ref.extractall(os.path.dirname(output))\n\n    return os.path.abspath(output)\n</code></pre>"},{"location":"utils/#anymap.utils.get_api_key","title":"<code>get_api_key(name=None, key=None)</code>","text":"<p>Retrieves an API key. If a key is provided, it is returned directly. If a name is provided, the function attempts to retrieve the key from user data (if running in Google Colab) or from environment variables.</p> <p>Parameters:</p> Name Type Description Default <code>name</code> <code>Optional[str]</code> <p>The name of the key to retrieve. Defaults to None.</p> <code>None</code> <code>key</code> <code>Optional[str]</code> <p>The key to return directly. Defaults to None.</p> <code>None</code> <p>Returns:</p> Type Description <code>Optional[str]</code> <p>The retrieved key, or None if no key was found.</p> Source code in <code>anymap/utils.py</code> <pre><code>def get_api_key(name: Optional[str] = None, key: Optional[str] = None) -&gt; Optional[str]:\n    \"\"\"\n    Retrieves an API key. If a key is provided, it is returned directly. If a\n    name is provided, the function attempts to retrieve the key from user data\n    (if running in Google Colab) or from environment variables.\n\n    Args:\n        name (Optional[str], optional): The name of the key to retrieve. Defaults to None.\n        key (Optional[str], optional): The key to return directly. Defaults to None.\n\n    Returns:\n        The retrieved key, or None if no key was found.\n    \"\"\"\n    if key is not None:\n        return key\n    if name is not None:\n        try:\n            if _in_colab_shell():\n                from google.colab import userdata  # pylint: disable=E0611\n\n                return userdata.get(name)\n        except Exception:\n            pass\n        return os.environ.get(name)\n    return None\n</code></pre>"},{"location":"utils/#anymap.utils.get_cog_metadata","title":"<code>get_cog_metadata(url, crs='EPSG:4326')</code>","text":"<p>Retrieve metadata from a Cloud Optimized GeoTIFF (COG) file.</p> <p>This function fetches metadata from a COG file using rasterio. The metadata includes information such as offset, scale, NoData value, and bounding box.</p> <p>Note</p> <p>This feature corresponds to the getCogMetadata function in maplibre-cog-protocol, which is marked as [unstable] in the library documentation. Some metadata internals may change in future releases.</p> <p>Parameters:</p> Name Type Description Default <code>url</code> <code>str</code> <p>The URL of the COG file to retrieve metadata from.</p> required <code>crs</code> <code>str</code> <p>The coordinate reference system to use for the output bbox. Defaults to \"EPSG:4326\" (WGS84 lat/lon). Set to None to use the COG's native CRS.</p> <code>'EPSG:4326'</code> <p>Returns:</p> Type Description <code>Optional[Dict[str, Any]]</code> <p>A dictionary containing COG metadata with keys such as:     - bounds: BoundingBox in the specified CRS     - bbox: Bounding box coordinates [west, south, east, north] in the specified CRS     - width: Width of the raster in pixels     - height: Height of the raster in pixels     - crs: Original coordinate reference system of the COG     - output_crs: CRS of the returned bbox (if reprojected)     - transform: Affine transformation matrix     - count: Number of bands     - dtypes: Data types for each band     - nodata: NoData value     - scale: Scale value (if available)     - offset: Offset value (if available) Returns None if metadata retrieval fails.</p> <p>Examples:</p> <pre><code>&gt;&gt;&gt; from anymap.utils import get_cog_metadata\n&gt;&gt;&gt; url = \"https://example.com/data.tif\"\n&gt;&gt;&gt; # Get metadata with bbox in WGS84 (default)\n&gt;&gt;&gt; metadata = get_cog_metadata(url)\n&gt;&gt;&gt; if metadata:\n...     print(f\"Bounding box (WGS84): {metadata.get('bbox')}\")\n&gt;&gt;&gt;\n&gt;&gt;&gt; # Get metadata in native CRS\n&gt;&gt;&gt; metadata = get_cog_metadata(url, crs=None)\n&gt;&gt;&gt; if metadata:\n...     print(f\"Bounding box (native): {metadata.get('bbox')}\")\n</code></pre> <p>Exceptions:</p> Type Description <code>ImportError</code> <p>If rasterio is not installed.</p> Source code in <code>anymap/utils.py</code> <pre><code>def get_cog_metadata(url: str, crs: str = \"EPSG:4326\") -&gt; Optional[Dict[str, Any]]:\n    \"\"\"Retrieve metadata from a Cloud Optimized GeoTIFF (COG) file.\n\n    This function fetches metadata from a COG file using rasterio.\n    The metadata includes information such as offset, scale, NoData value, and bounding box.\n\n    Note:\n        This feature corresponds to the getCogMetadata function in maplibre-cog-protocol,\n        which is marked as [unstable] in the library documentation. Some metadata internals\n        may change in future releases.\n\n    Args:\n        url (str): The URL of the COG file to retrieve metadata from.\n        crs (str, optional): The coordinate reference system to use for the output bbox.\n            Defaults to \"EPSG:4326\" (WGS84 lat/lon). Set to None to use the COG's native CRS.\n\n    Returns:\n        Optional[Dict[str, Any]]: A dictionary containing COG metadata with keys such as:\n            - bounds: BoundingBox in the specified CRS\n            - bbox: Bounding box coordinates [west, south, east, north] in the specified CRS\n            - width: Width of the raster in pixels\n            - height: Height of the raster in pixels\n            - crs: Original coordinate reference system of the COG\n            - output_crs: CRS of the returned bbox (if reprojected)\n            - transform: Affine transformation matrix\n            - count: Number of bands\n            - dtypes: Data types for each band\n            - nodata: NoData value\n            - scale: Scale value (if available)\n            - offset: Offset value (if available)\n        Returns None if metadata retrieval fails.\n\n    Example:\n        &gt;&gt;&gt; from anymap.utils import get_cog_metadata\n        &gt;&gt;&gt; url = \"https://example.com/data.tif\"\n        &gt;&gt;&gt; # Get metadata with bbox in WGS84 (default)\n        &gt;&gt;&gt; metadata = get_cog_metadata(url)\n        &gt;&gt;&gt; if metadata:\n        ...     print(f\"Bounding box (WGS84): {metadata.get('bbox')}\")\n        &gt;&gt;&gt;\n        &gt;&gt;&gt; # Get metadata in native CRS\n        &gt;&gt;&gt; metadata = get_cog_metadata(url, crs=None)\n        &gt;&gt;&gt; if metadata:\n        ...     print(f\"Bounding box (native): {metadata.get('bbox')}\")\n\n    Raises:\n        ImportError: If rasterio is not installed.\n    \"\"\"\n    try:\n        import rasterio\n        from rasterio.errors import RasterioIOError\n        from rasterio.warp import transform_bounds\n\n        with rasterio.open(url) as src:\n            # Get bounds in native CRS\n            native_bounds = src.bounds\n            native_crs = src.crs\n\n            # Determine output CRS and bbox\n            if crs and native_crs and str(native_crs) != crs:\n                # Reproject bounds to target CRS\n                try:\n                    reprojected_bounds = transform_bounds(\n                        native_crs,\n                        crs,\n                        native_bounds.left,\n                        native_bounds.bottom,\n                        native_bounds.right,\n                        native_bounds.top,\n                    )\n                    output_bbox = [\n                        reprojected_bounds[0],  # west\n                        reprojected_bounds[1],  # south\n                        reprojected_bounds[2],  # east\n                        reprojected_bounds[3],  # north\n                    ]\n                    output_crs = crs\n                except Exception as e:\n                    print(f\"Warning: Failed to reproject bounds to {crs}: {e}\")\n                    print(f\"Using native CRS {native_crs} instead.\")\n                    output_bbox = [\n                        native_bounds.left,\n                        native_bounds.bottom,\n                        native_bounds.right,\n                        native_bounds.top,\n                    ]\n                    output_crs = str(native_crs)\n            else:\n                # Use native CRS\n                output_bbox = [\n                    native_bounds.left,\n                    native_bounds.bottom,\n                    native_bounds.right,\n                    native_bounds.top,\n                ]\n                output_crs = str(native_crs) if native_crs else None\n\n            metadata = {\n                \"bounds\": native_bounds,\n                \"bbox\": output_bbox,\n                \"width\": src.width,\n                \"height\": src.height,\n                \"crs\": str(native_crs) if native_crs else None,\n                \"output_crs\": output_crs,\n                \"transform\": list(src.transform),\n                \"count\": src.count,\n                \"dtypes\": src.dtypes,\n                \"nodata\": src.nodata,\n            }\n\n            # Add scale and offset if available\n            if src.scales and len(src.scales) &gt; 0:\n                metadata[\"scale\"] = src.scales[0]\n            if src.offsets and len(src.offsets) &gt; 0:\n                metadata[\"offset\"] = src.offsets[0]\n\n            return metadata\n\n    except ImportError:\n        # If rasterio is not available, provide a helpful message\n        print(\n            \"COG metadata retrieval requires rasterio. Install it with: pip install rasterio\"\n        )\n        print(\n            \"Alternatively, use the get_cog_metadata method on a MapLibreMap instance \"\n            \"which uses the JavaScript maplibre-cog-protocol library.\"\n        )\n        return None\n    except RasterioIOError as e:\n        print(f\"Failed to open COG file: {e}\")\n        return None\n    except Exception as e:\n        print(f\"Failed to retrieve COG metadata: {e}\")\n        return None\n</code></pre>"},{"location":"utils/#anymap.utils.get_env_var","title":"<code>get_env_var(name=None, key=None)</code>","text":"<p>Retrieves an environment variable. If a key is provided, it is returned directly. If a name is provided, the function attempts to retrieve the key from user data (if running in Google Colab) or from environment variables.</p> <p>Parameters:</p> Name Type Description Default <code>name</code> <code>Optional[str]</code> <p>The name of the key to retrieve. Defaults to None.</p> <code>None</code> <code>key</code> <code>Optional[str]</code> <p>The key to return directly. Defaults to None.</p> <code>None</code> <p>Returns:</p> Type Description <code>Optional[str]</code> <p>The retrieved key, or None if no key was found.</p> Source code in <code>anymap/utils.py</code> <pre><code>def get_env_var(name: Optional[str] = None, key: Optional[str] = None) -&gt; Optional[str]:\n    \"\"\"\n    Retrieves an environment variable. If a key is provided, it is returned directly. If a\n    name is provided, the function attempts to retrieve the key from user data\n    (if running in Google Colab) or from environment variables.\n\n    Args:\n        name (Optional[str], optional): The name of the key to retrieve. Defaults to None.\n        key (Optional[str], optional): The key to return directly. Defaults to None.\n\n    Returns:\n        Optional[str]: The retrieved key, or None if no key was found.\n    \"\"\"\n    if key is not None:\n        return key\n    if name is not None:\n        try:\n            if _in_colab_shell():\n                from google.colab import userdata  # pylint: disable=E0611\n\n                return userdata.get(name)\n        except Exception:\n            pass\n        return os.environ.get(name)\n    return None\n</code></pre>"},{"location":"utils/#anymap.utils.get_local_tile_url","title":"<code>get_local_tile_url(source, port='default', indexes=None, colormap=None, vmin=None, vmax=None, nodata=None, client_args={'cors_all': True}, return_client=False, **kwargs)</code>","text":"<p>Generate an ipyleaflet/folium TileLayer from a local raster dataset or remote Cloud Optimized GeoTIFF (COG).     If you are using this function in JupyterHub on a remote server and the raster does not render properly, try     running the following two lines before calling this function:</p> <pre><code>import os\nos.environ['LOCALTILESERVER_CLIENT_PREFIX'] = 'proxy/{port}'\n</code></pre> <p>Parameters:</p> Name Type Description Default <code>source</code> <code>str</code> <p>The path to the GeoTIFF file or the URL of the Cloud Optimized GeoTIFF.</p> required <code>port</code> <code>str</code> <p>The port to use for the server. Defaults to \"default\".</p> <code>'default'</code> <code>indexes</code> <code>int</code> <p>The band(s) to use. Band indexing starts at 1. Defaults to None.</p> <code>None</code> <code>colormap</code> <code>str</code> <p>The name of the colormap from <code>matplotlib</code> to use when plotting a single band. See <code>https://matplotlib.org/stable/gallery/color/colormap_reference.html</code> Default is greyscale.</p> <code>None</code> <code>vmin</code> <code>float</code> <p>The minimum value to use when colormapping the colormap when plotting a single band. Defaults to None.</p> <code>None</code> <code>vmax</code> <code>float</code> <p>The maximum value to use when colormapping the colormap when plotting a single band. Defaults to None.</p> <code>None</code> <code>nodata</code> <code>float</code> <p>The value from the band to use to interpret as not valid data. Defaults to None.</p> <code>None</code> <code>client_args</code> <code>dict</code> <p>Additional arguments to pass to the TileClient. Defaults to {}.</p> <code>{'cors_all': True}</code> <code>return_client</code> <code>bool</code> <p>If True, the tile client will be returned. Defaults to False.</p> <code>False</code> <p>Returns:</p> Type Description <p>An ipyleaflet.TileLayer or folium.TileLayer.</p> Source code in <code>anymap/utils.py</code> <pre><code>def get_local_tile_url(\n    source,\n    port=\"default\",\n    indexes=None,\n    colormap=None,\n    vmin=None,\n    vmax=None,\n    nodata=None,\n    client_args={\"cors_all\": True},\n    return_client=False,\n    **kwargs: Any,\n):\n    \"\"\"Generate an ipyleaflet/folium TileLayer from a local raster dataset or remote Cloud Optimized GeoTIFF (COG).\n        If you are using this function in JupyterHub on a remote server and the raster does not render properly, try\n        running the following two lines before calling this function:\n\n        import os\n        os.environ['LOCALTILESERVER_CLIENT_PREFIX'] = 'proxy/{port}'\n\n    Args:\n        source (str): The path to the GeoTIFF file or the URL of the Cloud Optimized GeoTIFF.\n        port (str, optional): The port to use for the server. Defaults to \"default\".\n        indexes (int, optional): The band(s) to use. Band indexing starts at 1. Defaults to None.\n        colormap (str, optional): The name of the colormap from `matplotlib` to use when plotting a single band. See\n          `https://matplotlib.org/stable/gallery/color/colormap_reference.html` Default is greyscale.\n        vmin (float, optional): The minimum value to use when colormapping the colormap when plotting a single band. Defaults to None.\n        vmax (float, optional): The maximum value to use when colormapping the colormap when plotting a single band. Defaults to None.\n        nodata (float, optional): The value from the band to use to interpret as not valid data. Defaults to None.\n        client_args (dict, optional): Additional arguments to pass to the TileClient. Defaults to {}.\n        return_client (bool, optional): If True, the tile client will be returned. Defaults to False.\n\n    Returns:\n        An ipyleaflet.TileLayer or folium.TileLayer.\n    \"\"\"\n    import rasterio\n    from localtileserver import TileClient\n\n    # Handle legacy localtileserver kwargs\n    if \"cmap\" in kwargs:\n        warnings.warn(\n            \"`cmap` is a deprecated keyword argument for get_local_tile_layer. Please use `colormap`.\"\n        )\n    if \"palette\" in kwargs:\n        warnings.warn(\n            \"`palette` is a deprecated keyword argument for get_local_tile_layer. Please use `colormap`.\"\n        )\n    if \"band\" in kwargs or \"bands\" in kwargs:\n        warnings.warn(\n            \"`band` and `bands` are deprecated keyword arguments for get_local_tile_layer. Please use `indexes`.\"\n        )\n    if \"projection\" in kwargs:\n        warnings.warn(\n            \"`projection` is a deprecated keyword argument for get_local_tile_layer and will be ignored.\"\n        )\n    if \"style\" in kwargs:\n        warnings.warn(\n            \"`style` is a deprecated keyword argument for get_local_tile_layer and will be ignored.\"\n        )\n\n    if \"max_zoom\" not in kwargs:\n        kwargs[\"max_zoom\"] = 30\n    if \"max_native_zoom\" not in kwargs:\n        kwargs[\"max_native_zoom\"] = 30\n    if \"cmap\" in kwargs:\n        colormap = kwargs.pop(\"cmap\")\n    if \"palette\" in kwargs:\n        colormap = kwargs.pop(\"palette\")\n    if \"band\" in kwargs:\n        indexes = kwargs.pop(\"band\")\n    if \"bands\" in kwargs:\n        indexes = kwargs.pop(\"bands\")\n\n    for key in client_args:\n        kwargs[key] = client_args[key]\n\n    # Make it compatible with binder and JupyterHub\n    if os.environ.get(\"JUPYTERHUB_SERVICE_PREFIX\") is not None:\n        os.environ[\"LOCALTILESERVER_CLIENT_PREFIX\"] = (\n            f\"{os.environ['JUPYTERHUB_SERVICE_PREFIX'].lstrip('/')}/proxy/{{port}}\"\n        )\n\n    if \"prefix\" in kwargs:\n        os.environ[\"LOCALTILESERVER_CLIENT_PREFIX\"] = kwargs[\"prefix\"]\n        kwargs.pop(\"prefix\")\n\n    # if \"show_loading\" not in kwargs:\n    #     kwargs[\"show_loading\"] = False\n\n    if isinstance(source, str):\n        if not source.startswith(\"http\"):\n            if source.startswith(\"~\"):\n                source = os.path.expanduser(source)\n    elif isinstance(source, TileClient) or isinstance(\n        source, rasterio.io.DatasetReader\n    ):\n        pass\n\n    else:\n        raise ValueError(\"The source must either be a string or TileClient\")\n\n    if nodata is None:\n        nodata = get_api_key(\"NODATA\")\n        if isinstance(nodata, str):\n            nodata = float(nodata)\n\n    if isinstance(colormap, str):\n        colormap = colormap.lower()\n\n    client = TileClient(source, port=port, **client_args)\n    url = client.get_tile_url(\n        indexes=indexes,\n        colormap=colormap,\n        vmin=vmin,\n        vmax=vmax,\n        nodata=nodata,\n    )\n\n    if return_client:\n        return url, client\n    else:\n        return url\n</code></pre>"},{"location":"utils/#anymap.utils.get_unique_name","title":"<code>get_unique_name(name, names, overwrite=False)</code>","text":"<p>Generates a unique name based on the input name and existing names.</p> <p>Parameters:</p> Name Type Description Default <code>name</code> <code>str</code> <p>The base name to generate a unique name from.</p> required <code>names</code> <code>list</code> <p>A list of existing names to check against.</p> required <code>overwrite</code> <code>bool</code> <p>If True, the function will return the original name even if it exists in the list. Defaults to False.</p> <code>False</code> <p>Returns:</p> Type Description <code>str</code> <p>A unique name based on the input name.</p> Source code in <code>anymap/utils.py</code> <pre><code>def get_unique_name(name: str, names: list, overwrite: bool = False) -&gt; str:\n    \"\"\"\n    Generates a unique name based on the input name and existing names.\n\n    Args:\n        name (str): The base name to generate a unique name from.\n        names (list): A list of existing names to check against.\n        overwrite (bool, optional): If True, the function will return the original name even if it exists in the list. Defaults to False.\n\n    Returns:\n        str: A unique name based on the input name.\n    \"\"\"\n    if overwrite or name not in names:\n        return name\n    else:\n        counter = 1\n        while True:\n            unique_name = f\"{name}_{counter}\"\n            if unique_name not in names:\n                return unique_name\n            counter += 1\n</code></pre>"},{"location":"utils/#anymap.utils.github_raw_url","title":"<code>github_raw_url(url)</code>","text":"<p>Get the raw URL for a GitHub file.</p> <p>Parameters:</p> Name Type Description Default <code>url</code> <code>str</code> <p>The GitHub URL.</p> required <p>Returns:</p> Type Description <p>The raw URL.</p> Source code in <code>anymap/utils.py</code> <pre><code>def github_raw_url(url):\n    \"\"\"Get the raw URL for a GitHub file.\n\n    Args:\n        url (str): The GitHub URL.\n    Returns:\n        The raw URL.\n    \"\"\"\n    if isinstance(url, str) and url.startswith(\"https://github.com/\") and \"blob\" in url:\n        url = url.replace(\"github.com\", \"raw.githubusercontent.com\").replace(\n            \"blob/\", \"\"\n        )\n    return url\n</code></pre>"},{"location":"utils/#anymap.utils.maptiler_3d_style","title":"<code>maptiler_3d_style(style='satellite', exaggeration=1, tile_size=512, tile_type=None, max_zoom=24, hillshade=True, token='MAPTILER_KEY', api_key=None)</code>","text":"<p>Get the 3D terrain style for the map.</p> <p>This function generates a style dictionary for the map that includes 3D terrain features. The terrain exaggeration and API key can be specified. If the API key is not provided, it will be retrieved using the specified token.</p> <p>Parameters:</p> Name Type Description Default <code>style</code> <code>str</code> <p>The name of the MapTiler style to be accessed. It can be one of the following: aquarelle, backdrop, basic, bright, dataviz, hillshade, landscape, ocean, openstreetmap, outdoor, satellite, streets, toner, topo, winter, etc.</p> <code>'satellite'</code> <code>exaggeration</code> <code>float</code> <p>The terrain exaggeration. Defaults to 1.</p> <code>1</code> <code>tile_size</code> <code>int</code> <p>The size of the tiles. Defaults to 512.</p> <code>512</code> <code>tile_type</code> <code>str</code> <p>The type of the tiles. It can be one of the following: webp, png, jpg. Defaults to None.</p> <code>None</code> <code>max_zoom</code> <code>int</code> <p>The maximum zoom level. Defaults to 24.</p> <code>24</code> <code>hillshade</code> <code>bool</code> <p>Whether to include hillshade. Defaults to True.</p> <code>True</code> <code>token</code> <code>str</code> <p>The token to use to retrieve the API key. Defaults to \"MAPTILER_KEY\".</p> <code>'MAPTILER_KEY'</code> <code>api_key</code> <code>Optional[str]</code> <p>The API key. If not provided, it will be retrieved using the token.</p> <code>None</code> <p>Returns:</p> Type Description <code>Dict[str, Any]</code> <p>The style dictionary for the map.</p> <p>Exceptions:</p> Type Description <code>ValueError</code> <p>If the API key is not provided and cannot be retrieved using the token.</p> Source code in <code>anymap/utils.py</code> <pre><code>def maptiler_3d_style(\n    style=\"satellite\",\n    exaggeration: float = 1,\n    tile_size: int = 512,\n    tile_type: str = None,\n    max_zoom: int = 24,\n    hillshade: bool = True,\n    token: str = \"MAPTILER_KEY\",\n    api_key: Optional[str] = None,\n) -&gt; Dict[str, Any]:\n    \"\"\"\n    Get the 3D terrain style for the map.\n\n    This function generates a style dictionary for the map that includes 3D terrain features.\n    The terrain exaggeration and API key can be specified. If the API key is not provided,\n    it will be retrieved using the specified token.\n\n    Args:\n        style (str): The name of the MapTiler style to be accessed. It can be one of the following:\n            aquarelle, backdrop, basic, bright, dataviz, hillshade, landscape, ocean, openstreetmap, outdoor,\n            satellite, streets, toner, topo, winter, etc.\n        exaggeration (float, optional): The terrain exaggeration. Defaults to 1.\n        tile_size (int, optional): The size of the tiles. Defaults to 512.\n        tile_type (str, optional): The type of the tiles. It can be one of the following:\n            webp, png, jpg. Defaults to None.\n        max_zoom (int, optional): The maximum zoom level. Defaults to 24.\n        hillshade (bool, optional): Whether to include hillshade. Defaults to True.\n        token (str, optional): The token to use to retrieve the API key. Defaults to \"MAPTILER_KEY\".\n        api_key (Optional[str], optional): The API key. If not provided, it will be retrieved using the token.\n\n    Returns:\n        Dict[str, Any]: The style dictionary for the map.\n\n    Raises:\n        ValueError: If the API key is not provided and cannot be retrieved using the token.\n    \"\"\"\n\n    if api_key is None:\n        api_key = get_env_var(token)\n\n    if api_key is None:\n        print(\"An API key is required to use the 3D terrain feature.\")\n        return \"dark-matter\"\n\n    if style == \"terrain\":\n        style = \"satellite\"\n    elif style == \"hillshade\":\n        style = None\n\n    if tile_type is None:\n\n        image_types = {\n            \"aquarelle\": \"webp\",\n            \"backdrop\": \"png\",\n            \"basic\": \"png\",\n            \"basic-v2\": \"png\",\n            \"bright\": \"png\",\n            \"bright-v2\": \"png\",\n            \"dataviz\": \"png\",\n            \"hybrid\": \"jpg\",\n            \"landscape\": \"png\",\n            \"ocean\": \"png\",\n            \"openstreetmap\": \"jpg\",\n            \"outdoor\": \"png\",\n            \"outdoor-v2\": \"png\",\n            \"satellite\": \"jpg\",\n            \"toner\": \"png\",\n            \"toner-v2\": \"png\",\n            \"topo\": \"png\",\n            \"topo-v2\": \"png\",\n            \"winter\": \"png\",\n            \"winter-v2\": \"png\",\n        }\n        if style in image_types:\n            tile_type = image_types[style]\n        else:\n            tile_type = \"png\"\n\n    layers = []\n\n    if isinstance(style, str):\n        layers.append({\"id\": style, \"type\": \"raster\", \"source\": style})\n\n    if hillshade:\n        layers.append(\n            {\n                \"id\": \"hillshade\",\n                \"type\": \"hillshade\",\n                \"source\": \"hillshadeSource\",\n                \"layout\": {\"visibility\": \"visible\"},\n                \"paint\": {\"hillshade-shadow-color\": \"#473B24\"},\n            }\n        )\n\n    if style == \"ocean\":\n        sources = {\n            \"terrainSource\": {\n                \"type\": \"raster-dem\",\n                \"url\": f\"https://api.maptiler.com/tiles/ocean-rgb/tiles.json?key={api_key}\",\n                \"tileSize\": tile_size,\n            },\n            \"hillshadeSource\": {\n                \"type\": \"raster-dem\",\n                \"url\": f\"https://api.maptiler.com/tiles/ocean-rgb/tiles.json?key={api_key}\",\n                \"tileSize\": tile_size,\n            },\n        }\n    else:\n        sources = {\n            \"terrainSource\": {\n                \"type\": \"raster-dem\",\n                \"url\": f\"https://api.maptiler.com/tiles/terrain-rgb-v2/tiles.json?key={api_key}\",\n                \"tileSize\": tile_size,\n            },\n            \"hillshadeSource\": {\n                \"type\": \"raster-dem\",\n                \"url\": f\"https://api.maptiler.com/tiles/terrain-rgb-v2/tiles.json?key={api_key}\",\n                \"tileSize\": tile_size,\n            },\n        }\n    if isinstance(style, str):\n        sources[style] = {\n            \"type\": \"raster\",\n            \"tiles\": [\n                \"https://api.maptiler.com/maps/\"\n                + style\n                + \"/{z}/{x}/{y}.\"\n                + tile_type\n                + \"?key=\"\n                + api_key\n            ],\n            \"tileSize\": tile_size,\n            \"attribution\": \"&amp;copy; MapTiler\",\n            \"maxzoom\": max_zoom,\n        }\n\n    style = {\n        \"version\": 8,\n        \"sources\": sources,\n        \"layers\": layers,\n        \"terrain\": {\"source\": \"terrainSource\", \"exaggeration\": exaggeration},\n    }\n\n    return style\n</code></pre>"},{"location":"utils/#anymap.utils.replace_hyphens_in_keys","title":"<code>replace_hyphens_in_keys(d)</code>","text":"<p>Recursively replaces hyphens with underscores in dictionary keys.</p> <p>Parameters:</p> Name Type Description Default <code>d</code> <code>Union[Dict, List, Any]</code> <p>The input dictionary, list or any other data type.</p> required <p>Returns:</p> Type Description <code>Union[Dict, List, Any]</code> <p>The modified dictionary or list with keys having hyphens replaced with underscores, or the original input if it's not a dictionary or list.</p> Source code in <code>anymap/utils.py</code> <pre><code>def replace_hyphens_in_keys(d: Union[Dict, List, Any]) -&gt; Union[Dict, List, Any]:\n    \"\"\"\n    Recursively replaces hyphens with underscores in dictionary keys.\n\n    Args:\n        d (Union[Dict, List, Any]): The input dictionary, list or any other data type.\n\n    Returns:\n        Union[Dict, List, Any]: The modified dictionary or list with keys having hyphens replaced with underscores,\n        or the original input if it's not a dictionary or list.\n    \"\"\"\n    if isinstance(d, dict):\n        return {k.replace(\"-\", \"_\"): replace_hyphens_in_keys(v) for k, v in d.items()}\n    elif isinstance(d, list):\n        return [replace_hyphens_in_keys(i) for i in d]\n    else:\n        return d\n</code></pre>"},{"location":"utils/#anymap.utils.replace_top_level_hyphens","title":"<code>replace_top_level_hyphens(d)</code>","text":"<p>Replaces hyphens with underscores in top-level dictionary keys.</p> <p>Parameters:</p> Name Type Description Default <code>d</code> <code>Union[Dict, Any]</code> <p>The input dictionary or any other data type.</p> required <p>Returns:</p> Type Description <code>Union[Dict, Any]</code> <p>The modified dictionary with top-level keys having hyphens replaced with underscores, or the original input if it's not a dictionary.</p> Source code in <code>anymap/utils.py</code> <pre><code>def replace_top_level_hyphens(d: Union[Dict, Any]) -&gt; Union[Dict, Any]:\n    \"\"\"\n    Replaces hyphens with underscores in top-level dictionary keys.\n\n    Args:\n        d (Union[Dict, Any]): The input dictionary or any other data type.\n\n    Returns:\n        Union[Dict, Any]: The modified dictionary with top-level keys having hyphens replaced with underscores,\n        or the original input if it's not a dictionary.\n    \"\"\"\n    if isinstance(d, dict):\n        return {k.replace(\"-\", \"_\"): v for k, v in d.items()}\n    return d\n</code></pre>"},{"location":"utils/#anymap.utils.replace_underscores_in_keys","title":"<code>replace_underscores_in_keys(d)</code>","text":"<p>Recursively replaces underscores with hyphens in dictionary keys.</p> <p>Parameters:</p> Name Type Description Default <code>d</code> <code>Union[Dict, List, Any]</code> <p>The input dictionary, list or any other data type.</p> required <p>Returns:</p> Type Description <code>Union[Dict, List, Any]</code> <p>The modified dictionary or list with keys having underscores replaced with hyphens, or the original input if it's not a dictionary or list.</p> Source code in <code>anymap/utils.py</code> <pre><code>def replace_underscores_in_keys(d: Union[Dict, List, Any]) -&gt; Union[Dict, List, Any]:\n    \"\"\"\n    Recursively replaces underscores with hyphens in dictionary keys.\n\n    Args:\n        d (Union[Dict, List, Any]): The input dictionary, list or any other data type.\n\n    Returns:\n        Union[Dict, List, Any]: The modified dictionary or list with keys having underscores replaced with hyphens,\n        or the original input if it's not a dictionary or list.\n    \"\"\"\n    if isinstance(d, dict):\n        return {\n            k.replace(\"_\", \"-\"): replace_underscores_in_keys(v) for k, v in d.items()\n        }\n    elif isinstance(d, list):\n        return [replace_underscores_in_keys(i) for i in d]\n    else:\n        return d\n</code></pre>"},{"location":"utils/#anymap.utils.write_image_colormap","title":"<code>write_image_colormap(image, colormap, output_path=None)</code>","text":"<p>Apply or update a colormap to a raster image.</p> <p>Parameters:</p> Name Type Description Default <code>image</code> <code>str, rasterio.io.DatasetReader, rioxarray.DataArray</code> <p>The input image. It can be: - A file path to a raster image (string). - A rasterio dataset. - A rioxarray DataArray.</p> required <code>colormap</code> <code>dict</code> <p>A dictionary defining the colormap (value: (R, G, B, A)).</p> required <code>output_path</code> <code>str</code> <p>Path to save the updated raster image. If None, the original file is updated in-memory.</p> <code>None</code> <p>Returns:</p> Type Description <p>Path to the updated raster image.</p> <p>Exceptions:</p> Type Description <code>ValueError</code> <p>If the input image type is unsupported.</p> Source code in <code>anymap/utils.py</code> <pre><code>def write_image_colormap(image, colormap, output_path=None):\n    \"\"\"\n    Apply or update a colormap to a raster image.\n\n    Args:\n        image (str, rasterio.io.DatasetReader, rioxarray.DataArray):\n            The input image. It can be:\n            - A file path to a raster image (string).\n            - A rasterio dataset.\n            - A rioxarray DataArray.\n        colormap (dict): A dictionary defining the colormap (value: (R, G, B, A)).\n        output_path (str, optional): Path to save the updated raster image.\n            If None, the original file is updated in-memory.\n\n    Returns:\n        Path to the updated raster image.\n\n    Raises:\n        ValueError: If the input image type is unsupported.\n    \"\"\"\n    import rasterio\n    import rioxarray\n    import xarray as xr\n\n    dataset = None\n    src_profile = None\n    src_data = None\n\n    if isinstance(image, str):  # File path\n        with rasterio.open(image) as ds:\n            dataset = ds\n            src_profile = ds.profile\n            src_data = ds.read(1)  # Assuming single-band\n    elif isinstance(image, rasterio.io.DatasetReader):  # rasterio dataset\n        dataset = image\n        src_profile = dataset.profile\n        src_data = dataset.read(1)  # Assuming single-band\n    elif isinstance(image, xr.DataArray):  # rioxarray DataArray\n        source = image.encoding.get(\"source\")\n        if source:\n            with rasterio.open(source) as ds:\n                dataset = ds\n                src_profile = ds.profile\n                src_data = ds.read(1)  # Assuming single-band\n        else:\n            raise ValueError(\"Cannot apply colormap: DataArray does not have a source.\")\n    else:\n        raise ValueError(\n            \"Unsupported input type. Provide a file path, rasterio dataset, or rioxarray DataArray.\"\n        )\n\n    # Ensure the dataset is single-band\n    if dataset.count != 1:\n        raise ValueError(\n            \"Colormaps can only be applied to single-band raster datasets.\"\n        )\n\n    # Update the profile and colormap\n    src_profile.update(dtype=src_data.dtype, count=1)\n\n    if not output_path:\n        output_path = \"output_with_colormap.tif\"\n\n    # Check and sanitize colormap\n    fixed_colormap = {}\n    for k, v in colormap.items():\n        if not isinstance(k, int):\n            k = int(k)\n        if len(v) == 3:  # RGB\n            fixed_colormap[k] = tuple(int(c) for c in v)\n        elif len(v) == 4:  # RGBA\n            fixed_colormap[k] = tuple(\n                int(c) for c in v[:3]\n            )  # Drop alpha for compatibility\n        else:\n            raise ValueError(f\"Invalid colormap value: {v}\")\n\n    # Write the updated dataset with the colormap\n    with rasterio.open(output_path, \"w\", **src_profile) as dst:\n        dst.write(src_data, 1)\n        dst.write_colormap(1, fixed_colormap)\n\n    return output_path\n</code></pre>"},{"location":"examples/cesium/cesium_example/","title":"Cesium example","text":"In\u00a0[\u00a0]: Copied! <pre>import os\nfrom anymap import CesiumMap\n\n# Set your Cesium token (get a free one at https://cesium.com/ion/signup)\n# You can either set it as an environment variable CESIUM_TOKEN or pass it directly\n# os.environ['CESIUM_TOKEN'] = 'your_token_here'\n\nprint(\"Cesium backend loaded successfully!\")\n</pre> import os from anymap import CesiumMap  # Set your Cesium token (get a free one at https://cesium.com/ion/signup) # You can either set it as an environment variable CESIUM_TOKEN or pass it directly # os.environ['CESIUM_TOKEN'] = 'your_token_here'  print(\"Cesium backend loaded successfully!\") In\u00a0[\u00a0]: Copied! <pre>from anymap import CesiumMap\n\n# Create a basic Cesium map centered on New York City\nglobe = CesiumMap(\n    center=[40.7128, -74.0060],  # NYC coordinates\n    camera_height=2000000,  # 2000 km above surface\n    width=\"100%\",\n    height=\"600px\",\n    navigation_help_button=False,\n)\n\nglobe\n</pre> from anymap import CesiumMap  # Create a basic Cesium map centered on New York City globe = CesiumMap(     center=[40.7128, -74.0060],  # NYC coordinates     camera_height=2000000,  # 2000 km above surface     width=\"100%\",     height=\"600px\",     navigation_help_button=False, )  globe In\u00a0[\u00a0]: Copied! <pre># Add some famous landmarks as points\nglobe.add_point(\n    40.7128,\n    -74.0060,\n    height=200000,  # 200 km above NYC\n    name=\"New York City\",\n    description=\"The Big Apple\",\n    color=\"#ff0000\",\n    pixel_size=20,\n)\n\nglobe.add_point(\n    51.5074,\n    -0.1278,\n    height=150000,  # 150 km above London\n    name=\"London\",\n    description=\"Capital of England\",\n    color=\"#0000ff\",\n    pixel_size=15,\n)\n\nglobe.add_point(\n    35.6762,\n    139.6503,\n    height=100000,  # 100 km above Tokyo\n    name=\"Tokyo\",\n    description=\"Capital of Japan\",\n    color=\"#00ff00\",\n    pixel_size=18,\n)\n\nprint(\"Added landmark points to the globe!\")\n</pre> # Add some famous landmarks as points globe.add_point(     40.7128,     -74.0060,     height=200000,  # 200 km above NYC     name=\"New York City\",     description=\"The Big Apple\",     color=\"#ff0000\",     pixel_size=20, )  globe.add_point(     51.5074,     -0.1278,     height=150000,  # 150 km above London     name=\"London\",     description=\"Capital of England\",     color=\"#0000ff\",     pixel_size=15, )  globe.add_point(     35.6762,     139.6503,     height=100000,  # 100 km above Tokyo     name=\"Tokyo\",     description=\"Capital of Japan\",     color=\"#00ff00\",     pixel_size=18, )  print(\"Added landmark points to the globe!\") In\u00a0[\u00a0]: Copied! <pre># Fly to different locations with smooth transitions\nglobe.fly_to(\n    51.5074,\n    -0.1278,  # London\n    height=5000000,  # 5000 km above\n    duration=3.0,\n    heading=45,\n    pitch=-30,\n)\n\nprint(\"Flying to London...\")\n</pre> # Fly to different locations with smooth transitions globe.fly_to(     51.5074,     -0.1278,  # London     height=5000000,  # 5000 km above     duration=3.0,     heading=45,     pitch=-30, )  print(\"Flying to London...\") In\u00a0[\u00a0]: Copied! <pre># Fly to Tokyo with different camera angle\nglobe.fly_to(\n    35.6762,\n    139.6503,  # Tokyo\n    height=3000000,  # 3000 km above\n    duration=4.0,\n    heading=90,\n    pitch=-45,\n)\n\nprint(\"Flying to Tokyo...\")\n</pre> # Fly to Tokyo with different camera angle globe.fly_to(     35.6762,     139.6503,  # Tokyo     height=3000000,  # 3000 km above     duration=4.0,     heading=90,     pitch=-45, )  print(\"Flying to Tokyo...\") In\u00a0[\u00a0]: Copied! <pre># Add a flight path polyline from NYC to London\nflight_path = [\n    [40.7128, -74.0060, 10000],  # NYC at 10km altitude\n    [45.0, -30.0, 12000],  # Midpoint over Atlantic\n    [51.5074, -0.1278, 10000],  # London at 10km altitude\n]\n\nglobe.add_polyline(\n    flight_path,\n    width=3,\n    color=\"#ffff00\",\n    name=\"NYC to London Flight Path\",\n    description=\"Transatlantic flight route\",\n)\n\nprint(\"Added flight path polyline!\")\n</pre> # Add a flight path polyline from NYC to London flight_path = [     [40.7128, -74.0060, 10000],  # NYC at 10km altitude     [45.0, -30.0, 12000],  # Midpoint over Atlantic     [51.5074, -0.1278, 10000],  # London at 10km altitude ]  globe.add_polyline(     flight_path,     width=3,     color=\"#ffff00\",     name=\"NYC to London Flight Path\",     description=\"Transatlantic flight route\", )  print(\"Added flight path polyline!\") In\u00a0[\u00a0]: Copied! <pre># Add a polygon area around the Mediterranean Sea\nmediterranean_bounds = [\n    [30.0, -6.0, 0],  # Gibraltar area\n    [30.0, 36.0, 0],  # Eastern Mediterranean\n    [46.0, 36.0, 0],  # Turkey area\n    [46.0, -6.0, 0],  # Spain area\n    [30.0, -6.0, 0],  # Close the polygon\n]\n\nglobe.add_polygon(\n    mediterranean_bounds,\n    color=\"rgba(0, 100, 255, 0.3)\",  # Semi-transparent blue\n    outline_color=\"#0064ff\",\n    name=\"Mediterranean Region\",\n    description=\"Mediterranean Sea region\",\n)\n\nprint(\"Added Mediterranean polygon!\")\n</pre> # Add a polygon area around the Mediterranean Sea mediterranean_bounds = [     [30.0, -6.0, 0],  # Gibraltar area     [30.0, 36.0, 0],  # Eastern Mediterranean     [46.0, 36.0, 0],  # Turkey area     [46.0, -6.0, 0],  # Spain area     [30.0, -6.0, 0],  # Close the polygon ]  globe.add_polygon(     mediterranean_bounds,     color=\"rgba(0, 100, 255, 0.3)\",  # Semi-transparent blue     outline_color=\"#0064ff\",     name=\"Mediterranean Region\",     description=\"Mediterranean Sea region\", )  print(\"Added Mediterranean polygon!\") In\u00a0[\u00a0]: Copied! <pre># Sample GeoJSON data with world capitals\nworld_capitals_geojson = {\n    \"type\": \"FeatureCollection\",\n    \"features\": [\n        {\n            \"type\": \"Feature\",\n            \"geometry\": {\n                \"type\": \"Point\",\n                \"coordinates\": [-77.0369, 38.9072],  # Washington DC\n            },\n            \"properties\": {\n                \"name\": \"Washington DC\",\n                \"country\": \"USA\",\n                \"population\": 705749,\n            },\n        },\n        {\n            \"type\": \"Feature\",\n            \"geometry\": {\"type\": \"Point\", \"coordinates\": [2.3522, 48.8566]},  # Paris\n            \"properties\": {\"name\": \"Paris\", \"country\": \"France\", \"population\": 2161000},\n        },\n        {\n            \"type\": \"Feature\",\n            \"geometry\": {\n                \"type\": \"Point\",\n                \"coordinates\": [116.4074, 39.9042],  # Beijing\n            },\n            \"properties\": {\n                \"name\": \"Beijing\",\n                \"country\": \"China\",\n                \"population\": 21540000,\n            },\n        },\n    ],\n}\n\n# Add GeoJSON data to the globe\nglobe.add_geojson(\n    world_capitals_geojson, options={\"name\": \"World Capitals\", \"clampToGround\": True}\n)\n\nprint(\"Added world capitals GeoJSON data!\")\n</pre> # Sample GeoJSON data with world capitals world_capitals_geojson = {     \"type\": \"FeatureCollection\",     \"features\": [         {             \"type\": \"Feature\",             \"geometry\": {                 \"type\": \"Point\",                 \"coordinates\": [-77.0369, 38.9072],  # Washington DC             },             \"properties\": {                 \"name\": \"Washington DC\",                 \"country\": \"USA\",                 \"population\": 705749,             },         },         {             \"type\": \"Feature\",             \"geometry\": {\"type\": \"Point\", \"coordinates\": [2.3522, 48.8566]},  # Paris             \"properties\": {\"name\": \"Paris\", \"country\": \"France\", \"population\": 2161000},         },         {             \"type\": \"Feature\",             \"geometry\": {                 \"type\": \"Point\",                 \"coordinates\": [116.4074, 39.9042],  # Beijing             },             \"properties\": {                 \"name\": \"Beijing\",                 \"country\": \"China\",                 \"population\": 21540000,             },         },     ], }  # Add GeoJSON data to the globe globe.add_geojson(     world_capitals_geojson, options={\"name\": \"World Capitals\", \"clampToGround\": True} )  print(\"Added world capitals GeoJSON data!\") In\u00a0[\u00a0]: Copied! <pre># Enable Cesium World Terrain for realistic 3D terrain\nglobe.set_cesium_world_terrain(request_water_mask=True, request_vertex_normals=True)\n\nprint(\"Enabled Cesium World Terrain!\")\n</pre> # Enable Cesium World Terrain for realistic 3D terrain globe.set_cesium_world_terrain(request_water_mask=True, request_vertex_normals=True)  print(\"Enabled Cesium World Terrain!\") In\u00a0[\u00a0]: Copied! <pre># Switch to satellite imagery (requires Bing Maps key for best results)\n# You can get a Bing Maps key at https://www.bingmapsportal.com/\nglobe.set_imagery(\n    {\n        \"type\": \"osm\",  # Using OpenStreetMap as fallback\n        \"url\": \"https://tile.openstreetmap.org/\",\n    }\n)\n\nprint(\"Changed to OpenStreetMap imagery!\")\n</pre> # Switch to satellite imagery (requires Bing Maps key for best results) # You can get a Bing Maps key at https://www.bingmapsportal.com/ globe.set_imagery(     {         \"type\": \"osm\",  # Using OpenStreetMap as fallback         \"url\": \"https://tile.openstreetmap.org/\",     } )  print(\"Changed to OpenStreetMap imagery!\") In\u00a0[\u00a0]: Copied! <pre># Enable atmospheric effects\nglobe.enable_lighting(True)\nglobe.enable_fog(True)\n\nprint(\"Enabled lighting and atmospheric fog!\")\n</pre> # Enable atmospheric effects globe.enable_lighting(True) globe.enable_fog(True)  print(\"Enabled lighting and atmospheric fog!\") In\u00a0[\u00a0]: Copied! <pre># Switch to 2D mode for flat map view\nglobe.set_scene_mode_2d()\n\nprint(\"Switched to 2D mode!\")\n</pre> # Switch to 2D mode for flat map view globe.set_scene_mode_2d()  print(\"Switched to 2D mode!\") In\u00a0[\u00a0]: Copied! <pre># Switch to Columbus view (2.5D)\nglobe.set_scene_mode_columbus()\n\nprint(\"Switched to Columbus view!\")\n</pre> # Switch to Columbus view (2.5D) globe.set_scene_mode_columbus()  print(\"Switched to Columbus view!\") In\u00a0[\u00a0]: Copied! <pre># Back to full 3D mode\nglobe.set_scene_mode_3d()\n\nprint(\"Switched back to 3D mode!\")\n</pre> # Back to full 3D mode globe.set_scene_mode_3d()  print(\"Switched back to 3D mode!\") In\u00a0[\u00a0]: Copied! <pre># Define event handler functions\ndef on_click(event):\n    print(\n        f\"Globe clicked at: Lat {event['latitude']:.4f}, Lon {event['longitude']:.4f}, Height {event['height']:.0f}m\"\n    )\n    if event.get(\"pickedObject\"):\n        print(f\"Clicked on object: {event['pickedObject']}\")\n\n\ndef on_camera_move(event):\n    print(\n        f\"Camera moved to: Lat {event['latitude']:.4f}, Lon {event['longitude']:.4f}, Height {event['height']:.0f}m\"\n    )\n\n\n# Register event handlers\nglobe.on_map_event(\"click\", on_click)\nglobe.on_map_event(\"moveend\", on_camera_move)\n\nprint(\"Event handlers registered! Click on the globe or move the camera to see events.\")\n</pre> # Define event handler functions def on_click(event):     print(         f\"Globe clicked at: Lat {event['latitude']:.4f}, Lon {event['longitude']:.4f}, Height {event['height']:.0f}m\"     )     if event.get(\"pickedObject\"):         print(f\"Clicked on object: {event['pickedObject']}\")   def on_camera_move(event):     print(         f\"Camera moved to: Lat {event['latitude']:.4f}, Lon {event['longitude']:.4f}, Height {event['height']:.0f}m\"     )   # Register event handlers globe.on_map_event(\"click\", on_click) globe.on_map_event(\"moveend\", on_camera_move)  print(\"Event handlers registered! Click on the globe or move the camera to see events.\") In\u00a0[\u00a0]: Copied! <pre># Display the same globe instance again\n# This should maintain all the data and state from above\nglobe\n</pre> # Display the same globe instance again # This should maintain all the data and state from above globe In\u00a0[\u00a0]: Copied! <pre># Add another point while displayed in multiple cells\nglobe.add_point(\n    -33.8688,\n    151.2093,  # Sydney\n    height=500000,\n    name=\"Sydney\",\n    description=\"Largest city in Australia\",\n    color=\"#ff8800\",\n    pixel_size=16,\n)\n\nprint(\"Added Sydney! The point should appear on all globe instances above.\")\n</pre> # Add another point while displayed in multiple cells globe.add_point(     -33.8688,     151.2093,  # Sydney     height=500000,     name=\"Sydney\",     description=\"Largest city in Australia\",     color=\"#ff8800\",     pixel_size=16, )  print(\"Added Sydney! The point should appear on all globe instances above.\") In\u00a0[\u00a0]: Copied! <pre># Create a second, independent globe\nglobe2 = CesiumMap(\n    center=[-33.8688, 151.2093],  # Centered on Sydney\n    camera_height=1000000,  # 1000 km above\n    width=\"100%\",\n    height=\"500px\",\n    timeline=False,  # Disable timeline for cleaner look\n    animation=False,  # Disable animation controls\n)\n\n# Add different content to the second globe\nglobe2.add_point(\n    -33.8688,\n    151.2093,\n    height=50000,\n    name=\"Sydney Opera House Area\",\n    color=\"#9900ff\",\n    pixel_size=25,\n)\n\nglobe2.add_point(\n    -37.8136,\n    144.9631,  # Melbourne\n    height=40000,\n    name=\"Melbourne\",\n    color=\"#00ffff\",\n    pixel_size=20,\n)\n\nglobe2\n</pre> # Create a second, independent globe globe2 = CesiumMap(     center=[-33.8688, 151.2093],  # Centered on Sydney     camera_height=1000000,  # 1000 km above     width=\"100%\",     height=\"500px\",     timeline=False,  # Disable timeline for cleaner look     animation=False,  # Disable animation controls )  # Add different content to the second globe globe2.add_point(     -33.8688,     151.2093,     height=50000,     name=\"Sydney Opera House Area\",     color=\"#9900ff\",     pixel_size=25, )  globe2.add_point(     -37.8136,     144.9631,  # Melbourne     height=40000,     name=\"Melbourne\",     color=\"#00ffff\",     pixel_size=20, )  globe2 In\u00a0[\u00a0]: Copied! <pre># Reset camera to home position\nglobe.home()\n\nprint(\"Camera reset to home position!\")\n</pre> # Reset camera to home position globe.home()  print(\"Camera reset to home position!\")"},{"location":"examples/cesium/cesium_example/#cesium-3d-globe-example","title":"Cesium 3D Globe Example\u00b6","text":"<p>This notebook demonstrates the capabilities of the anymap CesiumMap widget for creating interactive 3D globe visualizations.</p>"},{"location":"examples/cesium/cesium_example/#setup","title":"Setup\u00b6","text":"<p>First, make sure you have a Cesium ion access token. You can get a free one at https://cesium.com/ion/signup</p>"},{"location":"examples/cesium/cesium_example/#basic-3d-globe","title":"Basic 3D Globe\u00b6","text":"<p>Create a basic 3D globe centered on a specific location:</p>"},{"location":"examples/cesium/cesium_example/#adding-points-and-markers","title":"Adding Points and Markers\u00b6","text":"<p>Add various points and billboards to the globe:</p>"},{"location":"examples/cesium/cesium_example/#camera-controls-and-navigation","title":"Camera Controls and Navigation\u00b6","text":"<p>Demonstrate camera movement and positioning:</p>"},{"location":"examples/cesium/cesium_example/#adding-3d-geometries","title":"Adding 3D Geometries\u00b6","text":"<p>Add polylines and polygons to show connections and regions:</p>"},{"location":"examples/cesium/cesium_example/#working-with-geojson-data","title":"Working with GeoJSON Data\u00b6","text":"<p>Load and display GeoJSON data on the globe:</p>"},{"location":"examples/cesium/cesium_example/#terrain-and-imagery","title":"Terrain and Imagery\u00b6","text":"<p>Configure terrain and satellite imagery:</p>"},{"location":"examples/cesium/cesium_example/#scene-modes-and-effects","title":"Scene Modes and Effects\u00b6","text":"<p>Experiment with different viewing modes and atmospheric effects:</p>"},{"location":"examples/cesium/cesium_example/#event-handling","title":"Event Handling\u00b6","text":"<p>Set up event handlers to respond to user interactions:</p>"},{"location":"examples/cesium/cesium_example/#multi-cell-rendering-test","title":"Multi-cell Rendering Test\u00b6","text":"<p>Test that the globe works correctly when displayed in multiple cells:</p>"},{"location":"examples/cesium/cesium_example/#creating-a-second-globe-instance","title":"Creating a Second Globe Instance\u00b6","text":"<p>Create a separate globe to verify independence:</p>"},{"location":"examples/cesium/cesium_example/#reset-and-home-view","title":"Reset and Home View\u00b6","text":"<p>Return to the home view:</p>"},{"location":"examples/cesium/cesium_example/#summary","title":"Summary\u00b6","text":"<p>This notebook demonstrated the key features of the anymap CesiumMap widget:</p> <ol> <li>3D Globe Visualization: Interactive 3D globe with realistic Earth rendering</li> <li>Points and Markers: Adding labeled points at various heights</li> <li>3D Geometries: Polylines and polygons for paths and regions</li> <li>GeoJSON Support: Loading external geographic data</li> <li>Terrain and Imagery: Realistic 3D terrain and satellite imagery</li> <li>Scene Modes: 3D, 2D, and Columbus view modes</li> <li>Camera Controls: Smooth fly-to animations and positioning</li> <li>Event Handling: Responding to user interactions</li> <li>Multi-cell Rendering: Persistent state across notebook cells</li> <li>Multiple Instances: Independent globe widgets</li> </ol> <p>The CesiumMap widget provides a powerful platform for creating interactive 3D geospatial visualizations with the full capabilities of Cesium.js in a Jupyter environment.</p>"},{"location":"examples/deckgl/deckgl_example/","title":"Deckgl example","text":"In\u00a0[\u00a0]: Copied! <pre>import sys\nimport os\n\nfrom anymap.maplibre import MapLibreMap\n\n# Create a MapLibre map\nm = MapLibreMap(\n    center=[2.345885, 48.860412],  # Paris\n    zoom=12,\n    style=\"https://tiles.openfreemap.org/styles/bright\",\n)\n\n# Sample data for gardens in Paris (from the HTML example)\ngarden_data = [\n    {\"name\": \"Jardins du Trocad\u00e9ro\", \"position\": [2.289207, 48.861561], \"district\": 16},\n    {\"name\": \"Jardin des Plantes\", \"position\": [2.359823, 48.843995], \"district\": 5},\n    {\"name\": \"Jardins des Tuileries\", \"position\": [2.327092, 48.863608], \"district\": 1},\n    {\"name\": \"Parc de Bercy\", \"position\": [2.382094, 48.835962], \"district\": 12},\n    {\"name\": \"Jardin du Luxembourg\", \"position\": [2.336975, 48.846421], \"district\": 6},\n]\n\n\n# Add DeckGL ScatterplotLayer - using strings instead of lambda functions\nm.add_deckgl_layer(\n    \"gardens\",\n    \"ScatterplotLayer\",\n    garden_data,\n    props={\n        \"getPosition\": \"position\",  # String accessor instead of lambda\n        \"getRadius\": 100,\n        \"getFillColor\": [49, 130, 206],\n        \"getLineColor\": [175, 0, 32],\n        \"lineWidthMinPixels\": 5,\n        \"radiusMinPixels\": 20,\n        \"radiusMaxPixels\": 100,\n        \"pickable\": True,\n        \"opacity\": 0.8,\n        \"stroked\": True,\n        \"filled\": True,\n    },\n)\n\nprint(f\"DeckGL layers: {list(m.get_deckgl_layers().keys())}\")\n\n# Toggle visibility\nm.set_deckgl_layer_visibility(\"gardens\", False)\nm.set_deckgl_layer_visibility(\"gardens\", True)\n\ngeojson_data = {\n    \"type\": \"FeatureCollection\",\n    \"features\": [\n        {\n            \"type\": \"Feature\",\n            \"geometry\": {\n                \"type\": \"Point\",\n                \"coordinates\": [2.3522, 48.8566],  # Paris center\n            },\n            \"properties\": {\"name\": \"Paris Center\", \"size\": 200},\n        },\n        {\n            \"type\": \"Feature\",\n            \"geometry\": {\n                \"type\": \"Point\",\n                \"coordinates\": [2.2945, 48.8534],  # Eiffel Tower\n            },\n            \"properties\": {\"name\": \"Eiffel Tower\", \"size\": 150},\n        },\n    ],\n}\n\nm.add_deckgl_layer(\n    \"landmarks\",\n    \"GeoJsonLayer\",\n    geojson_data,\n    props={\n        \"pickable\": True,\n        \"stroked\": True,\n        \"filled\": True,\n        \"pointType\": \"circle\",\n        \"getFillColor\": [255, 140, 0, 200],\n        \"getLineColor\": [255, 0, 0],\n        \"getPointRadius\": 80,\n        \"lineWidthMinPixels\": 2,\n    },\n)\n\n\nhtml_file = \"test_deckgl_maplibre.html\"\nm.to_html(html_file, title=\"DeckGL + MapLibre Test\")\nm\n</pre> import sys import os  from anymap.maplibre import MapLibreMap  # Create a MapLibre map m = MapLibreMap(     center=[2.345885, 48.860412],  # Paris     zoom=12,     style=\"https://tiles.openfreemap.org/styles/bright\", )  # Sample data for gardens in Paris (from the HTML example) garden_data = [     {\"name\": \"Jardins du Trocad\u00e9ro\", \"position\": [2.289207, 48.861561], \"district\": 16},     {\"name\": \"Jardin des Plantes\", \"position\": [2.359823, 48.843995], \"district\": 5},     {\"name\": \"Jardins des Tuileries\", \"position\": [2.327092, 48.863608], \"district\": 1},     {\"name\": \"Parc de Bercy\", \"position\": [2.382094, 48.835962], \"district\": 12},     {\"name\": \"Jardin du Luxembourg\", \"position\": [2.336975, 48.846421], \"district\": 6}, ]   # Add DeckGL ScatterplotLayer - using strings instead of lambda functions m.add_deckgl_layer(     \"gardens\",     \"ScatterplotLayer\",     garden_data,     props={         \"getPosition\": \"position\",  # String accessor instead of lambda         \"getRadius\": 100,         \"getFillColor\": [49, 130, 206],         \"getLineColor\": [175, 0, 32],         \"lineWidthMinPixels\": 5,         \"radiusMinPixels\": 20,         \"radiusMaxPixels\": 100,         \"pickable\": True,         \"opacity\": 0.8,         \"stroked\": True,         \"filled\": True,     }, )  print(f\"DeckGL layers: {list(m.get_deckgl_layers().keys())}\")  # Toggle visibility m.set_deckgl_layer_visibility(\"gardens\", False) m.set_deckgl_layer_visibility(\"gardens\", True)  geojson_data = {     \"type\": \"FeatureCollection\",     \"features\": [         {             \"type\": \"Feature\",             \"geometry\": {                 \"type\": \"Point\",                 \"coordinates\": [2.3522, 48.8566],  # Paris center             },             \"properties\": {\"name\": \"Paris Center\", \"size\": 200},         },         {             \"type\": \"Feature\",             \"geometry\": {                 \"type\": \"Point\",                 \"coordinates\": [2.2945, 48.8534],  # Eiffel Tower             },             \"properties\": {\"name\": \"Eiffel Tower\", \"size\": 150},         },     ], }  m.add_deckgl_layer(     \"landmarks\",     \"GeoJsonLayer\",     geojson_data,     props={         \"pickable\": True,         \"stroked\": True,         \"filled\": True,         \"pointType\": \"circle\",         \"getFillColor\": [255, 140, 0, 200],         \"getLineColor\": [255, 0, 0],         \"getPointRadius\": 80,         \"lineWidthMinPixels\": 2,     }, )   html_file = \"test_deckgl_maplibre.html\" m.to_html(html_file, title=\"DeckGL + MapLibre Test\") m In\u00a0[\u00a0]: Copied! <pre>\n</pre>"},{"location":"examples/deckgl/deckgl_example/#deckgl-integration-examples","title":"DeckGL Integration Examples\u00b6","text":"<p>This notebook demonstrates both the standalone DeckGL backend and the new DeckGL layer integration with MapLibre in anymap.</p>"},{"location":"examples/deckgl/deckgl_example/#whats-new-deckgl-layers-in-maplibre","title":"What's New: DeckGL Layers in MapLibre\u00b6","text":"<p>The MapLibre backend now supports adding DeckGL layers directly, providing the best of both worlds:</p> <ul> <li>MapLibre's vector tiles and styling capabilities</li> <li>DeckGL's high-performance data visualization layers</li> </ul>"},{"location":"examples/deckgl/deckgl_example/#installation","title":"Installation\u00b6","text":"<p>Make sure you have anymap installed:</p> <pre>pip install anymap\n</pre>"},{"location":"examples/keplergl/keplergl_example/","title":"Keplergl example","text":"# Real KeplerGL Interactive Map Test  Testing the updated KeplerGL widget that displays an actual interactive map. In\u00a0[\u00a0]: Copied! <pre>import anymap\n\n# Create KeplerGL map with data\nkepler = anymap.KeplerGLMap(center=[37.7749, -122.4194], zoom=10, height=\"600px\")\n\n# Add sample data\nsample_data = {\n    \"type\": \"FeatureCollection\",\n    \"features\": [\n        {\n            \"type\": \"Feature\",\n            \"geometry\": {\"type\": \"Point\", \"coordinates\": [-122.4194, 37.7749]},\n            \"properties\": {\"name\": \"San Francisco\", \"population\": 874961},\n        },\n        {\n            \"type\": \"Feature\",\n            \"geometry\": {\"type\": \"Point\", \"coordinates\": [-122.0832, 37.4221]},\n            \"properties\": {\"name\": \"Palo Alto\", \"population\": 66666},\n        },\n    ],\n}\n\nkepler.add_geojson(sample_data, \"cities\")\n\n# Display the interactive map\nkepler\n</pre> import anymap  # Create KeplerGL map with data kepler = anymap.KeplerGLMap(center=[37.7749, -122.4194], zoom=10, height=\"600px\")  # Add sample data sample_data = {     \"type\": \"FeatureCollection\",     \"features\": [         {             \"type\": \"Feature\",             \"geometry\": {\"type\": \"Point\", \"coordinates\": [-122.4194, 37.7749]},             \"properties\": {\"name\": \"San Francisco\", \"population\": 874961},         },         {             \"type\": \"Feature\",             \"geometry\": {\"type\": \"Point\", \"coordinates\": [-122.0832, 37.4221]},             \"properties\": {\"name\": \"Palo Alto\", \"population\": 66666},         },     ], }  kepler.add_geojson(sample_data, \"cities\")  # Display the interactive map kepler"},{"location":"examples/leaflet/leaflet_example/","title":"Leaflet example","text":"In\u00a0[\u00a0]: Copied! <pre>import anymap\nimport json\n</pre> import anymap import json In\u00a0[\u00a0]: Copied! <pre># Create a basic Leaflet map\nleaflet_map = anymap.LeafletMap(\n    center=[29.5, -95.9], zoom=12, width=\"100%\", height=\"600px\"\n)\nurl = \"https://huggingface.co/datasets/giswqs/geospatial/resolve/main/las_vegas_train_naip.tif\"\nleaflet_map.add_geotiff(url, resolution=128, nodata=0)\nleaflet_map\n</pre> # Create a basic Leaflet map leaflet_map = anymap.LeafletMap(     center=[29.5, -95.9], zoom=12, width=\"100%\", height=\"600px\" ) url = \"https://huggingface.co/datasets/giswqs/geospatial/resolve/main/las_vegas_train_naip.tif\" leaflet_map.add_geotiff(url, resolution=128, nodata=0) leaflet_map In\u00a0[\u00a0]: Copied! <pre>import anymap\nimport json\n</pre> import anymap import json In\u00a0[\u00a0]: Copied! <pre># Create a basic Leaflet map\nleaflet_map = anymap.LeafletMap(\n    center=[0, 0], zoom=12, width=\"100%\", height=\"600px\"  # London coordinates\n)\nurl = \"https://storage.googleapis.com/pdd-stac/disasters/hurricane-harvey/0831/20170831_172754_101c_3b_Visual.tif\"\n# url = \"https://huggingface.co/datasets/giswqs/geospatial/resolve/main/las_vegas_train_naip.tif\"\nleaflet_map.add_geotiff(\n    url,\n    resolution=128,\n    # resampleMethod='bilinear',\n    # noDataValue=0,\n    # opacity=1.0\n)\nleaflet_map\n</pre> # Create a basic Leaflet map leaflet_map = anymap.LeafletMap(     center=[0, 0], zoom=12, width=\"100%\", height=\"600px\"  # London coordinates ) url = \"https://storage.googleapis.com/pdd-stac/disasters/hurricane-harvey/0831/20170831_172754_101c_3b_Visual.tif\" # url = \"https://huggingface.co/datasets/giswqs/geospatial/resolve/main/las_vegas_train_naip.tif\" leaflet_map.add_geotiff(     url,     resolution=128,     # resampleMethod='bilinear',     # noDataValue=0,     # opacity=1.0 ) leaflet_map In\u00a0[\u00a0]: Copied! <pre>html_content = leaflet_map.to_html(\n    title=\"Tokyo Map - Leaflet Example\", width=\"100%\", height=\"600px\"\n)\n\n# Save to file\nwith open(\"tokyo_map.html\", \"w\") as f:\n    f.write(html_content)\n</pre> html_content = leaflet_map.to_html(     title=\"Tokyo Map - Leaflet Example\", width=\"100%\", height=\"600px\" )  # Save to file with open(\"tokyo_map.html\", \"w\") as f:     f.write(html_content) In\u00a0[\u00a0]: Copied! <pre># Create a Leaflet map with advanced options\nmap_with_options = anymap.LeafletMap(\n    height=\"400px\",\n    map_options={\n        \"zoomControl\": False,\n        \"attributionControl\": False,\n        \"scrollWheelZoom\": False,\n        \"dragging\": False,\n        \"doubleClickZoom\": False,\n        \"boxZoom\": False,\n    },\n)\n\nmap_with_options\n</pre> # Create a Leaflet map with advanced options map_with_options = anymap.LeafletMap(     height=\"400px\",     map_options={         \"zoomControl\": False,         \"attributionControl\": False,         \"scrollWheelZoom\": False,         \"dragging\": False,         \"doubleClickZoom\": False,         \"boxZoom\": False,     }, )  map_with_options In\u00a0[\u00a0]: Copied! <pre># OpenStreetMap (default)\nosm_map = anymap.LeafletMap(\n    center=[40.7128, -74.0060], zoom=10, tile_layer=\"OpenStreetMap\"  # New York\n)\n\nosm_map\n</pre> # OpenStreetMap (default) osm_map = anymap.LeafletMap(     center=[40.7128, -74.0060], zoom=10, tile_layer=\"OpenStreetMap\"  # New York )  osm_map In\u00a0[\u00a0]: Copied! <pre># CartoDB Positron (light theme)\npositron_map = anymap.LeafletMap(\n    center=[40.7128, -74.0060], zoom=10, tile_layer=\"CartoDB.Positron\"\n)\n\npositron_map\n</pre> # CartoDB Positron (light theme) positron_map = anymap.LeafletMap(     center=[40.7128, -74.0060], zoom=10, tile_layer=\"CartoDB.Positron\" )  positron_map In\u00a0[\u00a0]: Copied! <pre># CartoDB Dark Matter (dark theme)\ndark_map = anymap.LeafletMap(\n    center=[40.7128, -74.0060], zoom=10, tile_layer=\"CartoDB.DarkMatter\"\n)\n\ndark_map\n</pre> # CartoDB Dark Matter (dark theme) dark_map = anymap.LeafletMap(     center=[40.7128, -74.0060], zoom=10, tile_layer=\"CartoDB.DarkMatter\" )  dark_map In\u00a0[\u00a0]: Copied! <pre># Create a map with markers\nmarker_map = anymap.LeafletMap(center=[51.5074, -0.1278], zoom=12)  # London\n\n# Add markers for famous London landmarks\nmarker_map.add_marker(\n    [51.5074, -0.1278],\n    popup=\"&lt;b&gt;London&lt;/b&gt;&lt;br&gt;Capital of the United Kingdom\",\n    tooltip=\"London City Center\",\n)\n\nmarker_map.add_marker(\n    [51.5007, -0.1246],\n    popup=\"&lt;b&gt;Big Ben&lt;/b&gt;&lt;br&gt;Famous clock tower\",\n    tooltip=\"Big Ben's permanent tooltip\",\n    # https://leafletjs.com/reference.html#tooltip-option\n    tooltip_options=dict(permanent=True, direction=\"right\", opacity=0.7),\n)\n\nmarker_map.add_marker(\n    [51.5033, -0.1195],\n    popup=\"&lt;b&gt;London Eye&lt;/b&gt;&lt;br&gt;Giant Ferris wheel\",\n    tooltip=\"London Eye\",\n)\n\nmarker_map\n</pre> # Create a map with markers marker_map = anymap.LeafletMap(center=[51.5074, -0.1278], zoom=12)  # London  # Add markers for famous London landmarks marker_map.add_marker(     [51.5074, -0.1278],     popup=\"LondonCapital of the United Kingdom\",     tooltip=\"London City Center\", )  marker_map.add_marker(     [51.5007, -0.1246],     popup=\"Big BenFamous clock tower\",     tooltip=\"Big Ben's permanent tooltip\",     # https://leafletjs.com/reference.html#tooltip-option     tooltip_options=dict(permanent=True, direction=\"right\", opacity=0.7), )  marker_map.add_marker(     [51.5033, -0.1195],     popup=\"London EyeGiant Ferris wheel\",     tooltip=\"London Eye\", )  marker_map In\u00a0[\u00a0]: Copied! <pre># Create a map with shapes\nshapes_map = anymap.LeafletMap(center=[40.7128, -74.0060], zoom=11)  # New York\n\n# Add a circle around Central Park\nshapes_map.add_circle(\n    [40.7829, -73.9654],  # Central Park\n    radius=1000,  # 1km radius\n    color=\"green\",\n    fillColor=\"lightgreen\",\n    fillOpacity=0.3,\n    tooltip=\"Central Park\ud83c\udf33&lt;br /&gt;Permanent tooltip\",\n    tooltip_options=dict(permanent=True, direction=\"top\"),\n)\n\n# Add a polygon for Manhattan (simplified)\nmanhattan_coords = [\n    [40.7831, -73.9712],\n    [40.7489, -73.9441],\n    [40.7061, -73.9969],\n    [40.7194, -74.0113],\n    [40.7831, -73.9712],\n]\n\nshapes_map.add_polygon(\n    manhattan_coords,\n    color=\"blue\",\n    fillColor=\"lightblue\",\n    fillOpacity=0.2,\n    tooltip=\"Sticky tooltip (stays with mouse)\",\n    tooltip_options=dict(sticky=True),\n)\n\n# Add a polyline for Broadway\nbroadway_coords = [\n    [40.7614, -73.9776],\n    [40.7589, -73.9851],\n    [40.7565, -73.9926],\n    [40.7505, -74.0014],\n]\n\nshapes_map.add_polyline(broadway_coords, color=\"red\", weight=5)\n\nshapes_map\n</pre> # Create a map with shapes shapes_map = anymap.LeafletMap(center=[40.7128, -74.0060], zoom=11)  # New York  # Add a circle around Central Park shapes_map.add_circle(     [40.7829, -73.9654],  # Central Park     radius=1000,  # 1km radius     color=\"green\",     fillColor=\"lightgreen\",     fillOpacity=0.3,     tooltip=\"Central Park\ud83c\udf33Permanent tooltip\",     tooltip_options=dict(permanent=True, direction=\"top\"), )  # Add a polygon for Manhattan (simplified) manhattan_coords = [     [40.7831, -73.9712],     [40.7489, -73.9441],     [40.7061, -73.9969],     [40.7194, -74.0113],     [40.7831, -73.9712], ]  shapes_map.add_polygon(     manhattan_coords,     color=\"blue\",     fillColor=\"lightblue\",     fillOpacity=0.2,     tooltip=\"Sticky tooltip (stays with mouse)\",     tooltip_options=dict(sticky=True), )  # Add a polyline for Broadway broadway_coords = [     [40.7614, -73.9776],     [40.7589, -73.9851],     [40.7565, -73.9926],     [40.7505, -74.0014], ]  shapes_map.add_polyline(broadway_coords, color=\"red\", weight=5)  shapes_map In\u00a0[\u00a0]: Copied! <pre># Sample GeoJSON data\ngeojson_data = {\n    \"type\": \"FeatureCollection\",\n    \"features\": [\n        {\n            \"type\": \"Feature\",\n            \"geometry\": {\"type\": \"Point\", \"coordinates\": [-74.0060, 40.7128]},\n            \"properties\": {\"name\": \"New York City\", \"population\": 8175133},\n        },\n        {\n            \"type\": \"Feature\",\n            \"geometry\": {\"type\": \"Point\", \"coordinates\": [-87.6298, 41.8781]},\n            \"properties\": {\"name\": \"Chicago\", \"population\": 2693976},\n        },\n    ],\n}\n\n# Create map with GeoJSON data\ngeojson_map = anymap.LeafletMap(center=[40.0, -80.0], zoom=5)\n\ngeojson_map.add_geojson(\n    geojson_data, style={\"color\": \"purple\", \"weight\": 2, \"fillOpacity\": 0.7}\n)\n\ngeojson_map\n</pre> # Sample GeoJSON data geojson_data = {     \"type\": \"FeatureCollection\",     \"features\": [         {             \"type\": \"Feature\",             \"geometry\": {\"type\": \"Point\", \"coordinates\": [-74.0060, 40.7128]},             \"properties\": {\"name\": \"New York City\", \"population\": 8175133},         },         {             \"type\": \"Feature\",             \"geometry\": {\"type\": \"Point\", \"coordinates\": [-87.6298, 41.8781]},             \"properties\": {\"name\": \"Chicago\", \"population\": 2693976},         },     ], }  # Create map with GeoJSON data geojson_map = anymap.LeafletMap(center=[40.0, -80.0], zoom=5)  geojson_map.add_geojson(     geojson_data, style={\"color\": \"purple\", \"weight\": 2, \"fillOpacity\": 0.7} )  geojson_map In\u00a0[\u00a0]: Copied! <pre># Create a map for demonstrations\ncontrol_map = anymap.LeafletMap(center=[37.7749, -122.4194], zoom=10)  # San Francisco\n\ncontrol_map\n</pre> # Create a map for demonstrations control_map = anymap.LeafletMap(center=[37.7749, -122.4194], zoom=10)  # San Francisco  control_map In\u00a0[\u00a0]: Copied! <pre># Fly to a different location\ncontrol_map.fly_to(34.0522, -118.2437, 12)  # Los Angeles\n</pre> # Fly to a different location control_map.fly_to(34.0522, -118.2437, 12)  # Los Angeles In\u00a0[\u00a0]: Copied! <pre># Set center and zoom\ncontrol_map.set_center(25.7617, -80.1918)  # Miami\ncontrol_map.set_zoom(11)\n</pre> # Set center and zoom control_map.set_center(25.7617, -80.1918)  # Miami control_map.set_zoom(11) In\u00a0[\u00a0]: Copied! <pre># Fit bounds to a specific area\n# Southwest and Northeast corners of the bounding box\ncontrol_map.fit_bounds([[25.7617, -80.1918], [25.7907, -80.1310]])\n</pre> # Fit bounds to a specific area # Southwest and Northeast corners of the bounding box control_map.fit_bounds([[25.7617, -80.1918], [25.7907, -80.1310]]) In\u00a0[\u00a0]: Copied! <pre># Create a map with multiple tile layers\nmulti_layer_map = anymap.LeafletMap(center=[48.8566, 2.3522], zoom=12)  # Paris\n\n# Add a custom tile layer\nmulti_layer_map.add_tile_layer(\n    \"https://stamen-tiles-{s}.a.ssl.fastly.net/watercolor/{z}/{x}/{y}.jpg\",\n    attribution=\"Map tiles by Stamen Design, under CC BY 3.0. Data by OpenStreetMap, under ODbL.\",\n    layer_id=\"watercolor\",\n)\n\nmulti_layer_map\n</pre> # Create a map with multiple tile layers multi_layer_map = anymap.LeafletMap(center=[48.8566, 2.3522], zoom=12)  # Paris  # Add a custom tile layer multi_layer_map.add_tile_layer(     \"https://stamen-tiles-{s}.a.ssl.fastly.net/watercolor/{z}/{x}/{y}.jpg\",     attribution=\"Map tiles by Stamen Design, under CC BY 3.0. Data by OpenStreetMap, under ODbL.\",     layer_id=\"watercolor\", )  multi_layer_map In\u00a0[\u00a0]: Copied! <pre># Create a map for export\nexport_map = anymap.LeafletMap(\n    center=[35.6762, 139.6503], zoom=10, tile_layer=\"CartoDB.Positron\"  # Tokyo\n)\n\n# Add some markers\nexport_map.add_marker(\n    [35.6762, 139.6503], popup=\"&lt;b&gt;Tokyo&lt;/b&gt;&lt;br&gt;Capital of Japan\", tooltip=\"Tokyo\"\n)\n\nexport_map.add_circle(\n    [35.6762, 139.6503], radius=5000, color=\"red\", fillColor=\"pink\", fillOpacity=0.3\n)\n\n# Export to HTML\nhtml_content = export_map.to_html(\n    title=\"Tokyo Map - Leaflet Example\", width=\"100%\", height=\"600px\"\n)\n\n# Save to file\nwith open(\"tokyo_map.html\", \"w\") as f:\n    f.write(html_content)\n\nprint(\"Map exported to tokyo_map.html\")\nexport_map\n</pre> # Create a map for export export_map = anymap.LeafletMap(     center=[35.6762, 139.6503], zoom=10, tile_layer=\"CartoDB.Positron\"  # Tokyo )  # Add some markers export_map.add_marker(     [35.6762, 139.6503], popup=\"TokyoCapital of Japan\", tooltip=\"Tokyo\" )  export_map.add_circle(     [35.6762, 139.6503], radius=5000, color=\"red\", fillColor=\"pink\", fillOpacity=0.3 )  # Export to HTML html_content = export_map.to_html(     title=\"Tokyo Map - Leaflet Example\", width=\"100%\", height=\"600px\" )  # Save to file with open(\"tokyo_map.html\", \"w\") as f:     f.write(html_content)  print(\"Map exported to tokyo_map.html\") export_map In\u00a0[\u00a0]: Copied! <pre># Create a map for layer management\nlayer_map = anymap.LeafletMap(center=[52.5200, 13.4050], zoom=11)  # Berlin\n\n# Add several layers\nmarker_id = layer_map.add_marker(\n    [52.5200, 13.4050], popup=\"Berlin\", tooltip=\"German Capital\"\n)\n\ncircle_id = layer_map.add_circle(\n    [52.5200, 13.4050],\n    radius=3000,\n    color=\"blue\",\n    fillColor=\"lightblue\",\n    fillOpacity=0.2,\n)\n\nprint(f\"Added marker with ID: {marker_id}\")\nprint(f\"Added circle with ID: {circle_id}\")\n\nlayer_map\n</pre> # Create a map for layer management layer_map = anymap.LeafletMap(center=[52.5200, 13.4050], zoom=11)  # Berlin  # Add several layers marker_id = layer_map.add_marker(     [52.5200, 13.4050], popup=\"Berlin\", tooltip=\"German Capital\" )  circle_id = layer_map.add_circle(     [52.5200, 13.4050],     radius=3000,     color=\"blue\",     fillColor=\"lightblue\",     fillOpacity=0.2, )  print(f\"Added marker with ID: {marker_id}\") print(f\"Added circle with ID: {circle_id}\")  layer_map In\u00a0[\u00a0]: Copied! <pre># Get current layers\nlayers = layer_map.get_layers()\nprint(\"Current layers:\")\nfor layer_id, layer_config in layers.items():\n    print(f\"  {layer_id}: {layer_config['type']}\")\n</pre> # Get current layers layers = layer_map.get_layers() print(\"Current layers:\") for layer_id, layer_config in layers.items():     print(f\"  {layer_id}: {layer_config['type']}\") In\u00a0[\u00a0]: Copied! <pre># Remove a layer\nlayer_map.remove_layer(circle_id)\nprint(f\"Removed circle layer: {circle_id}\")\n</pre> # Remove a layer layer_map.remove_layer(circle_id) print(f\"Removed circle layer: {circle_id}\") In\u00a0[\u00a0]: Copied! <pre># Clear all layers\nlayer_map.clear_layers()\nprint(\"All layers cleared\")\n</pre> # Clear all layers layer_map.clear_layers() print(\"All layers cleared\")"},{"location":"examples/leaflet/leaflet_example/#leaflet-map-examples","title":"Leaflet Map Examples\u00b6","text":"<p>This notebook demonstrates how to use the LeafletMap widget from the anymap package.</p>"},{"location":"examples/leaflet/leaflet_example/#installation","title":"Installation\u00b6","text":"<p>First, make sure you have the anymap package installed:</p> <pre>pip install anymap\n</pre>"},{"location":"examples/leaflet/leaflet_example/#basic-leaflet-map-with-geotiff","title":"Basic Leaflet Map with GeoTIFF\u00b6","text":"<p>Create a basic Leaflet map with a GeoTIFF layer using the corrected implementation:</p>"},{"location":"examples/leaflet/leaflet_example/#basic-leaflet-map","title":"Basic Leaflet Map\u00b6","text":"<p>Create a basic Leaflet map with default settings:</p>"},{"location":"examples/leaflet/leaflet_example/#leaflet-map-options","title":"Leaflet Map Options\u00b6","text":"<p>Create a map with different leaflet map options (click here for a full list)</p>"},{"location":"examples/leaflet/leaflet_example/#different-tile-layers","title":"Different Tile Layers\u00b6","text":"<p>Leaflet supports various tile layer providers:</p>"},{"location":"examples/leaflet/leaflet_example/#adding-markers","title":"Adding Markers\u00b6","text":"<p>Add markers to your map with popups and tooltips:</p>"},{"location":"examples/leaflet/leaflet_example/#adding-shapes","title":"Adding Shapes\u00b6","text":"<p>Add various shapes like circles, polygons, and polylines:</p>"},{"location":"examples/leaflet/leaflet_example/#geojson-data","title":"GeoJSON Data\u00b6","text":"<p>Load and display GeoJSON data:</p>"},{"location":"examples/leaflet/leaflet_example/#map-controls-and-interactions","title":"Map Controls and Interactions\u00b6","text":"<p>Demonstrate various map control methods:</p>"},{"location":"examples/leaflet/leaflet_example/#adding-multiple-tile-layers","title":"Adding Multiple Tile Layers\u00b6","text":"<p>You can add multiple tile layers to the same map:</p>"},{"location":"examples/leaflet/leaflet_example/#exporting-to-html","title":"Exporting to HTML\u00b6","text":"<p>Export your map to a standalone HTML file:</p>"},{"location":"examples/leaflet/leaflet_example/#layer-management","title":"Layer Management\u00b6","text":"<p>Demonstrate layer management capabilities:</p>"},{"location":"examples/leaflet/leaflet_example/#conclusion","title":"Conclusion\u00b6","text":"<p>This notebook demonstrated the key features of the LeafletMap widget:</p> <ol> <li>Basic map creation with different tile layers</li> <li>Adding markers with popups and tooltips</li> <li>Drawing shapes (circles, polygons, polylines)</li> <li>Loading GeoJSON data</li> <li>Map controls (fly to, set center/zoom, fit bounds)</li> <li>Layer management (add, remove, clear)</li> <li>HTML export for sharing standalone maps</li> </ol> <p>The LeafletMap widget provides a lightweight, flexible mapping solution that integrates seamlessly with Jupyter notebooks and supports the full Leaflet ecosystem.</p>"},{"location":"examples/mapbox/mapbox_example/","title":"Mapbox example","text":"In\u00a0[\u00a0]: Copied! <pre># Import required modules\nfrom anymap import MapboxMap\nimport json\nimport os\n\n# Note: You need a Mapbox access token to use the Mapbox backend\n# Get a free token at https://account.mapbox.com/access-tokens/\n# Set it as an environment variable: export MAPBOX_TOKEN=\"your_token_here\"\n# Or pass it directly when creating the map: MapboxMap(access_token=\"your_token\")\n\nprint(\"AnyMap with Mapbox backend loaded successfully!\")\n</pre> # Import required modules from anymap import MapboxMap import json import os  # Note: You need a Mapbox access token to use the Mapbox backend # Get a free token at https://account.mapbox.com/access-tokens/ # Set it as an environment variable: export MAPBOX_TOKEN=\"your_token_here\" # Or pass it directly when creating the map: MapboxMap(access_token=\"your_token\")  print(\"AnyMap with Mapbox backend loaded successfully!\") In\u00a0[\u00a0]: Copied! <pre># Create a basic Mapbox map\n# NOTE: Replace \"your_token_here\" with your actual Mapbox access token\n# or set the MAPBOX_TOKEN environment variable\n\nm = MapboxMap(\n    center=[37.7749, -122.4194],  # San Francisco\n    zoom=12,\n    height=\"600px\",\n    style=\"mapbox://styles/mapbox/streets-v12\",\n    # access_token=\"your_token_here\"  # Replace with your actual token\n)\n\nprint(f\"Access token set: {bool(m.access_token)}\")\nprint(f\"Map style: {m.style}\")\n\nm\n</pre> # Create a basic Mapbox map # NOTE: Replace \"your_token_here\" with your actual Mapbox access token # or set the MAPBOX_TOKEN environment variable  m = MapboxMap(     center=[37.7749, -122.4194],  # San Francisco     zoom=12,     height=\"600px\",     style=\"mapbox://styles/mapbox/streets-v12\",     # access_token=\"your_token_here\"  # Replace with your actual token )  print(f\"Access token set: {bool(m.access_token)}\") print(f\"Map style: {m.style}\")  m In\u00a0[\u00a0]: Copied! <pre>m = MapboxMap(\n    center=[37.7749, -122.4194],  # San Francisco\n    zoom=12,\n    height=\"600px\",\n    style=\"mapbox://styles/mapbox/streets-v12\",\n    # access_token=\"your_token_here\"  # Replace with your actual token\n)\n\nm.add_basemap(\"Esri.WorldImagery\")\nm\n</pre> m = MapboxMap(     center=[37.7749, -122.4194],  # San Francisco     zoom=12,     height=\"600px\",     style=\"mapbox://styles/mapbox/streets-v12\",     # access_token=\"your_token_here\"  # Replace with your actual token )  m.add_basemap(\"Esri.WorldImagery\") m In\u00a0[\u00a0]: Copied! <pre># Change to satellite style\nm.set_style(\"mapbox://styles/mapbox/satellite-v9\")\nm\n</pre> # Change to satellite style m.set_style(\"mapbox://styles/mapbox/satellite-v9\") m In\u00a0[\u00a0]: Copied! <pre># Create a new map focused on a mountainous area\nm3d = MapboxMap(\n    center=[46.8182, 8.2275],  # Swiss Alps\n    zoom=12,\n    pitch=60,\n    bearing=45,\n    height=\"600px\",\n    style=\"mapbox://styles/mapbox/satellite-v9\",\n)\n\n# Add 3D terrain\nterrain_config = {\"source\": \"mapbox-dem\", \"exaggeration\": 1.5}\nm3d.set_terrain(terrain_config)\n\n# Add atmospheric fog for realism\nfog_config = {\n    \"color\": \"rgb(186, 210, 235)\",\n    \"high-color\": \"rgb(36, 92, 223)\",\n    \"horizon-blend\": 0.02,\n    \"space-color\": \"rgb(11, 11, 25)\",\n    \"star-intensity\": 0.6,\n}\nm3d.set_fog(fog_config)\n\nprint(\"3D terrain and fog added to the map\")\nm3d\n</pre> # Create a new map focused on a mountainous area m3d = MapboxMap(     center=[46.8182, 8.2275],  # Swiss Alps     zoom=12,     pitch=60,     bearing=45,     height=\"600px\",     style=\"mapbox://styles/mapbox/satellite-v9\", )  # Add 3D terrain terrain_config = {\"source\": \"mapbox-dem\", \"exaggeration\": 1.5} m3d.set_terrain(terrain_config)  # Add atmospheric fog for realism fog_config = {     \"color\": \"rgb(186, 210, 235)\",     \"high-color\": \"rgb(36, 92, 223)\",     \"horizon-blend\": 0.02,     \"space-color\": \"rgb(11, 11, 25)\",     \"star-intensity\": 0.6, } m3d.set_fog(fog_config)  print(\"3D terrain and fog added to the map\") m3d In\u00a0[\u00a0]: Copied! <pre># Add various controls to the map\nm3d.add_control(\"navigation\", \"top-left\")\nm3d.add_control(\"scale\", \"bottom-left\")\nm3d.add_control(\"fullscreen\", \"top-right\")\n\nprint(\"Navigation, scale, and fullscreen controls added\")\n</pre> # Add various controls to the map m3d.add_control(\"navigation\", \"top-left\") m3d.add_control(\"scale\", \"bottom-left\") m3d.add_control(\"fullscreen\", \"top-right\")  print(\"Navigation, scale, and fullscreen controls added\") In\u00a0[\u00a0]: Copied! <pre># Create a map focused on New York City\nnyc_map = MapboxMap(\n    center=[40.7589, -73.9851],  # Times Square\n    zoom=16,\n    pitch=60,\n    bearing=30,\n    height=\"600px\",\n    style=\"mapbox://styles/mapbox/streets-v12\",\n)\n\n# Add 3D buildings\nnyc_map.add_3d_buildings()\n\n# Add navigation control\nnyc_map.add_control(\"navigation\", \"top-left\")\n\nprint(\"3D buildings added to NYC map\")\nnyc_map\n</pre> # Create a map focused on New York City nyc_map = MapboxMap(     center=[40.7589, -73.9851],  # Times Square     zoom=16,     pitch=60,     bearing=30,     height=\"600px\",     style=\"mapbox://styles/mapbox/streets-v12\", )  # Add 3D buildings nyc_map.add_3d_buildings()  # Add navigation control nyc_map.add_control(\"navigation\", \"top-left\")  print(\"3D buildings added to NYC map\") nyc_map In\u00a0[\u00a0]: Copied! <pre># Sample data for NYC landmarks\nnyc_landmarks = {\n    \"type\": \"FeatureCollection\",\n    \"features\": [\n        {\n            \"type\": \"Feature\",\n            \"geometry\": {\"type\": \"Point\", \"coordinates\": [-74.0445, 40.6892]},\n            \"properties\": {\"name\": \"Statue of Liberty\", \"type\": \"monument\"},\n        },\n        {\n            \"type\": \"Feature\",\n            \"geometry\": {\"type\": \"Point\", \"coordinates\": [-74.0060, 40.7128]},\n            \"properties\": {\"name\": \"One World Trade Center\", \"type\": \"building\"},\n        },\n        {\n            \"type\": \"Feature\",\n            \"geometry\": {\"type\": \"Point\", \"coordinates\": [-73.9857, 40.7484]},\n            \"properties\": {\"name\": \"Central Park\", \"type\": \"park\"},\n        },\n        {\n            \"type\": \"Feature\",\n            \"geometry\": {\"type\": \"Point\", \"coordinates\": [-73.9442, 40.8176]},\n            \"properties\": {\"name\": \"Yankee Stadium\", \"type\": \"stadium\"},\n        },\n    ],\n}\n\n# Add the landmarks as a circle layer\nnyc_map.add_geojson_layer(\n    layer_id=\"landmarks\",\n    geojson_data=nyc_landmarks,\n    layer_type=\"circle\",\n    paint={\n        \"circle-radius\": 8,\n        \"circle-color\": \"#FF6B6B\",\n        \"circle-stroke-width\": 2,\n        \"circle-stroke-color\": \"#FFFFFF\",\n        \"circle-opacity\": 0.8,\n    },\n)\n\n# Add markers with popups\nnyc_map.add_marker(\n    40.6892,\n    -74.0445,\n    \"&lt;h3&gt;Statue of Liberty&lt;/h3&gt;&lt;p&gt;Symbol of freedom and democracy&lt;/p&gt;\",\n)\nnyc_map.add_marker(\n    40.7484, -73.9857, \"&lt;h3&gt;Central Park&lt;/h3&gt;&lt;p&gt;Manhattan's green oasis&lt;/p&gt;\"\n)\n\nprint(\"NYC landmarks added to the map\")\nprint(f\"Current layers: {list(nyc_map.get_layers().keys())}\")\n</pre> # Sample data for NYC landmarks nyc_landmarks = {     \"type\": \"FeatureCollection\",     \"features\": [         {             \"type\": \"Feature\",             \"geometry\": {\"type\": \"Point\", \"coordinates\": [-74.0445, 40.6892]},             \"properties\": {\"name\": \"Statue of Liberty\", \"type\": \"monument\"},         },         {             \"type\": \"Feature\",             \"geometry\": {\"type\": \"Point\", \"coordinates\": [-74.0060, 40.7128]},             \"properties\": {\"name\": \"One World Trade Center\", \"type\": \"building\"},         },         {             \"type\": \"Feature\",             \"geometry\": {\"type\": \"Point\", \"coordinates\": [-73.9857, 40.7484]},             \"properties\": {\"name\": \"Central Park\", \"type\": \"park\"},         },         {             \"type\": \"Feature\",             \"geometry\": {\"type\": \"Point\", \"coordinates\": [-73.9442, 40.8176]},             \"properties\": {\"name\": \"Yankee Stadium\", \"type\": \"stadium\"},         },     ], }  # Add the landmarks as a circle layer nyc_map.add_geojson_layer(     layer_id=\"landmarks\",     geojson_data=nyc_landmarks,     layer_type=\"circle\",     paint={         \"circle-radius\": 8,         \"circle-color\": \"#FF6B6B\",         \"circle-stroke-width\": 2,         \"circle-stroke-color\": \"#FFFFFF\",         \"circle-opacity\": 0.8,     }, )  # Add markers with popups nyc_map.add_marker(     40.6892,     -74.0445,     \"Statue of Liberty<p>Symbol of freedom and democracy</p>\", ) nyc_map.add_marker(     40.7484, -73.9857, \"Central Park<p>Manhattan's green oasis</p>\" )  print(\"NYC landmarks added to the map\") print(f\"Current layers: {list(nyc_map.get_layers().keys())}\") In\u00a0[\u00a0]: Copied! <pre># Display the NYC map again - should show all layers\nprint(\"Displaying NYC map again with all layers:\")\nprint(f\"Layers: {list(nyc_map.get_layers().keys())}\")\nprint(f\"Sources: {list(nyc_map.get_sources().keys())}\")\nnyc_map\n</pre> # Display the NYC map again - should show all layers print(\"Displaying NYC map again with all layers:\") print(f\"Layers: {list(nyc_map.get_layers().keys())}\") print(f\"Sources: {list(nyc_map.get_sources().keys())}\") nyc_map In\u00a0[\u00a0]: Copied! <pre># Store events for demonstration\nmap_events = []\n\n\ndef on_map_click(event):\n    lat, lng = event[\"lngLat\"]\n    map_events.append(f\"Clicked at: {lat:.4f}, {lng:.4f}\")\n    print(f\"Map clicked at: {lat:.4f}, {lng:.4f}\")\n\n\ndef on_map_move(event):\n    center = event.get(\"center\", [0, 0])\n    zoom = event.get(\"zoom\", 0)\n    print(f\"Map moved to: {center[0]:.4f}, {center[1]:.4f} at zoom {zoom:.2f}\")\n\n\n# Register event handlers\nnyc_map.on_map_event(\"click\", on_map_click)\nnyc_map.on_map_event(\"moveend\", on_map_move)\n\nprint(\"Event handlers registered. Try clicking and moving the map!\")\n</pre> # Store events for demonstration map_events = []   def on_map_click(event):     lat, lng = event[\"lngLat\"]     map_events.append(f\"Clicked at: {lat:.4f}, {lng:.4f}\")     print(f\"Map clicked at: {lat:.4f}, {lng:.4f}\")   def on_map_move(event):     center = event.get(\"center\", [0, 0])     zoom = event.get(\"zoom\", 0)     print(f\"Map moved to: {center[0]:.4f}, {center[1]:.4f} at zoom {zoom:.2f}\")   # Register event handlers nyc_map.on_map_event(\"click\", on_map_click) nyc_map.on_map_event(\"moveend\", on_map_move)  print(\"Event handlers registered. Try clicking and moving the map!\") In\u00a0[\u00a0]: Copied! <pre>from anymap import MapLibreMap\n\n# Create a MapLibre map for comparison\nmaplibre_map = MapLibreMap(\n    center=[37.7749, -122.4194],  # San Francisco\n    zoom=12,\n    height=\"400px\",\n    style=\"https://demotiles.maplibre.org/style.json\",\n)\n\n# Add some data to differentiate\nsf_data = {\n    \"type\": \"FeatureCollection\",\n    \"features\": [\n        {\n            \"type\": \"Feature\",\n            \"geometry\": {\"type\": \"Point\", \"coordinates\": [-122.4194, 37.7749]},\n            \"properties\": {\"name\": \"San Francisco City Hall\"},\n        }\n    ],\n}\n\nmaplibre_map.add_geojson_layer(\n    \"sf_poi\", sf_data, \"circle\", {\"circle-color\": \"#50C878\", \"circle-radius\": 10}\n)\n\nprint(\"MapLibre map (San Francisco):\")\nmaplibre_map\n</pre> from anymap import MapLibreMap  # Create a MapLibre map for comparison maplibre_map = MapLibreMap(     center=[37.7749, -122.4194],  # San Francisco     zoom=12,     height=\"400px\",     style=\"https://demotiles.maplibre.org/style.json\", )  # Add some data to differentiate sf_data = {     \"type\": \"FeatureCollection\",     \"features\": [         {             \"type\": \"Feature\",             \"geometry\": {\"type\": \"Point\", \"coordinates\": [-122.4194, 37.7749]},             \"properties\": {\"name\": \"San Francisco City Hall\"},         }     ], }  maplibre_map.add_geojson_layer(     \"sf_poi\", sf_data, \"circle\", {\"circle-color\": \"#50C878\", \"circle-radius\": 10} )  print(\"MapLibre map (San Francisco):\") maplibre_map In\u00a0[\u00a0]: Copied! <pre># Create a Mapbox map of the same location for comparison\nmapbox_sf = MapboxMap(\n    center=[37.7749, -122.4194],  # San Francisco\n    zoom=12,\n    height=\"400px\",\n    style=\"mapbox://styles/mapbox/streets-v12\",\n)\n\nmapbox_sf.add_geojson_layer(\n    \"sf_poi_mapbox\", sf_data, \"circle\", {\"circle-color\": \"#FF6B6B\", \"circle-radius\": 10}\n)\n\nprint(\"Mapbox map (San Francisco):\")\nmapbox_sf\n</pre> # Create a Mapbox map of the same location for comparison mapbox_sf = MapboxMap(     center=[37.7749, -122.4194],  # San Francisco     zoom=12,     height=\"400px\",     style=\"mapbox://styles/mapbox/streets-v12\", )  mapbox_sf.add_geojson_layer(     \"sf_poi_mapbox\", sf_data, \"circle\", {\"circle-color\": \"#FF6B6B\", \"circle-radius\": 10} )  print(\"Mapbox map (San Francisco):\") mapbox_sf In\u00a0[\u00a0]: Copied! <pre># Create a map of the Grand Canyon with enhanced terrain\ncanyon_map = MapboxMap(\n    center=[36.1069, -112.1129],  # Grand Canyon\n    zoom=13,\n    pitch=70,\n    bearing=150,\n    height=\"600px\",\n    style=\"mapbox://styles/mapbox/satellite-v9\",\n)\n\n# Add terrain with higher exaggeration for dramatic effect\ncanyon_terrain = {\"source\": \"mapbox-dem\", \"exaggeration\": 2.0}\ncanyon_map.set_terrain(canyon_terrain)\n\n# Add enhanced atmospheric fog\ncanyon_fog = {\n    \"color\": \"rgb(255, 255, 255)\",\n    \"high-color\": \"rgb(200, 200, 255)\",\n    \"horizon-blend\": 0.1,\n    \"space-color\": \"rgb(11, 11, 25)\",\n    \"star-intensity\": 0.0,\n}\ncanyon_map.set_fog(canyon_fog)\n\n# Add controls\ncanyon_map.add_control(\"navigation\", \"top-left\")\ncanyon_map.add_control(\"scale\", \"bottom-left\")\n\nprint(\"Grand Canyon with enhanced 3D terrain\")\ncanyon_map\n</pre> # Create a map of the Grand Canyon with enhanced terrain canyon_map = MapboxMap(     center=[36.1069, -112.1129],  # Grand Canyon     zoom=13,     pitch=70,     bearing=150,     height=\"600px\",     style=\"mapbox://styles/mapbox/satellite-v9\", )  # Add terrain with higher exaggeration for dramatic effect canyon_terrain = {\"source\": \"mapbox-dem\", \"exaggeration\": 2.0} canyon_map.set_terrain(canyon_terrain)  # Add enhanced atmospheric fog canyon_fog = {     \"color\": \"rgb(255, 255, 255)\",     \"high-color\": \"rgb(200, 200, 255)\",     \"horizon-blend\": 0.1,     \"space-color\": \"rgb(11, 11, 25)\",     \"star-intensity\": 0.0, } canyon_map.set_fog(canyon_fog)  # Add controls canyon_map.add_control(\"navigation\", \"top-left\") canyon_map.add_control(\"scale\", \"bottom-left\")  print(\"Grand Canyon with enhanced 3D terrain\") canyon_map In\u00a0[\u00a0]: Copied! <pre># Create a simple map for layer management demo\nlayer_demo = MapboxMap(center=[40.7128, -74.0060], zoom=10, height=\"400px\")  # NYC\n\n# Add multiple layers\ndemo_data = {\n    \"type\": \"FeatureCollection\",\n    \"features\": [\n        {\n            \"type\": \"Feature\",\n            \"geometry\": {\"type\": \"Point\", \"coordinates\": [-74.0060, 40.7128]},\n            \"properties\": {\"name\": \"Point 1\"},\n        }\n    ],\n}\n\nlayer_demo.add_geojson_layer(\"layer1\", demo_data, \"circle\", {\"circle-color\": \"red\"})\nlayer_demo.add_geojson_layer(\"layer2\", demo_data, \"circle\", {\"circle-color\": \"blue\"})\nlayer_demo.add_geojson_layer(\"layer3\", demo_data, \"circle\", {\"circle-color\": \"green\"})\n\nprint(f\"Layers before cleanup: {list(layer_demo.get_layers().keys())}\")\nlayer_demo\n</pre> # Create a simple map for layer management demo layer_demo = MapboxMap(center=[40.7128, -74.0060], zoom=10, height=\"400px\")  # NYC  # Add multiple layers demo_data = {     \"type\": \"FeatureCollection\",     \"features\": [         {             \"type\": \"Feature\",             \"geometry\": {\"type\": \"Point\", \"coordinates\": [-74.0060, 40.7128]},             \"properties\": {\"name\": \"Point 1\"},         }     ], }  layer_demo.add_geojson_layer(\"layer1\", demo_data, \"circle\", {\"circle-color\": \"red\"}) layer_demo.add_geojson_layer(\"layer2\", demo_data, \"circle\", {\"circle-color\": \"blue\"}) layer_demo.add_geojson_layer(\"layer3\", demo_data, \"circle\", {\"circle-color\": \"green\"})  print(f\"Layers before cleanup: {list(layer_demo.get_layers().keys())}\") layer_demo In\u00a0[\u00a0]: Copied! <pre># Clear some layers\nlayer_demo.remove_layer(\"layer2\")\nprint(f\"After removing layer2: {list(layer_demo.get_layers().keys())}\")\n\n# Clear all layers\nlayer_demo.clear_layers()\nprint(f\"After clearing all layers: {list(layer_demo.get_layers().keys())}\")\nprint(f\"Sources still exist: {list(layer_demo.get_sources().keys())}\")\n\n# Display the map without layers\nlayer_demo\n</pre> # Clear some layers layer_demo.remove_layer(\"layer2\") print(f\"After removing layer2: {list(layer_demo.get_layers().keys())}\")  # Clear all layers layer_demo.clear_layers() print(f\"After clearing all layers: {list(layer_demo.get_layers().keys())}\") print(f\"Sources still exist: {list(layer_demo.get_sources().keys())}\")  # Display the map without layers layer_demo"},{"location":"examples/mapbox/mapbox_example/#anymap-mapbox-gl-js-examples","title":"AnyMap Mapbox GL JS Examples\u00b6","text":"<p>This notebook demonstrates the Mapbox GL JS backend for anymap, showcasing advanced mapping features including 3D terrain, 3D buildings, custom controls, and atmospheric fog effects.</p>"},{"location":"examples/mapbox/mapbox_example/#basic-mapbox-map","title":"Basic Mapbox Map\u00b6","text":"<p>Let's start with a basic Mapbox map. The access token is automatically handled.</p>"},{"location":"examples/mapbox/mapbox_example/#mapbox-styles","title":"Mapbox Styles\u00b6","text":"<p>Mapbox offers various built-in styles. Let's try the satellite style.</p>"},{"location":"examples/mapbox/mapbox_example/#3d-terrain-and-buildings","title":"3D Terrain and Buildings\u00b6","text":"<p>One of Mapbox's powerful features is 3D terrain and building visualization.</p>"},{"location":"examples/mapbox/mapbox_example/#adding-controls","title":"Adding Controls\u00b6","text":"<p>Mapbox provides various interactive controls.</p>"},{"location":"examples/mapbox/mapbox_example/#urban-3d-buildings","title":"Urban 3D Buildings\u00b6","text":"<p>Let's create a map showcasing 3D buildings in a urban environment.</p>"},{"location":"examples/mapbox/mapbox_example/#adding-data-layers","title":"Adding Data Layers\u00b6","text":"<p>Let's add some GeoJSON data to visualize points of interest.</p>"},{"location":"examples/mapbox/mapbox_example/#multi-cell-rendering-test","title":"Multi-Cell Rendering Test\u00b6","text":"<p>Test that the same map instance renders correctly in multiple cells.</p>"},{"location":"examples/mapbox/mapbox_example/#event-handling","title":"Event Handling\u00b6","text":"<p>Set up event handlers to capture user interactions.</p>"},{"location":"examples/mapbox/mapbox_example/#comparison-with-maplibre","title":"Comparison with MapLibre\u00b6","text":"<p>Let's create a side-by-side comparison with MapLibre to show both backends work independently.</p>"},{"location":"examples/mapbox/mapbox_example/#advanced-mapbox-features","title":"Advanced Mapbox Features\u00b6","text":"<p>Let's showcase some advanced Mapbox-specific features like custom terrain sources.</p>"},{"location":"examples/mapbox/mapbox_example/#layer-management","title":"Layer Management\u00b6","text":"<p>Demonstrate layer management capabilities.</p>"},{"location":"examples/mapbox/mapbox_example/#summary","title":"Summary\u00b6","text":"<p>This notebook demonstrated the key features of AnyMap's Mapbox GL JS backend:</p> <p>\u2705 Mapbox Integration: Full integration with Mapbox GL JS v3.13.0 \u2705 Access Token Management: Automatic token handling with fallbacks \u2705 3D Terrain &amp; Buildings: Support for 3D terrain exaggeration and building visualization \u2705 Atmospheric Effects: Fog and lighting effects for realistic mapping \u2705 Interactive Controls: Navigation, scale, fullscreen, and geolocation controls \u2705 Multi-cell Rendering: Persistent layer state across Jupyter cells \u2705 Event Handling: Click and move event capture \u2705 Layer Management: Full CRUD operations for map layers and sources \u2705 Style Flexibility: Support for built-in Mapbox styles and custom styles \u2705 Independence: Works alongside MapLibre backend without conflicts</p> <p>The Mapbox backend provides access to Mapbox's premium features while maintaining the same simple API as the MapLibre backend.</p>"},{"location":"examples/maplibre/add_draw_data_example/","title":"Add draw data example","text":"In\u00a0[\u00a0]: Copied! <pre>from anymap import MapLibreMap\nimport json\n\nprint(\"AnyMap loaded successfully!\")\n</pre> from anymap import MapLibreMap import json  print(\"AnyMap loaded successfully!\") In\u00a0[\u00a0]: Copied! <pre># Create a map with draw control\nm = MapLibreMap(center=[-122.4194, 37.7749], zoom=13, height=\"600px\", style=\"liberty\")\nm.add_draw_control()\n\n# Start with initial data (this replaces any existing data)\ninitial_data = {\n    \"type\": \"FeatureCollection\",\n    \"features\": [\n        {\n            \"type\": \"Feature\",\n            \"geometry\": {\"type\": \"Point\", \"coordinates\": [-122.4194, 37.7749]},\n            \"properties\": {\"name\": \"Initial Point\", \"color\": \"red\"},\n        }\n    ],\n}\n\nm.load_draw_data(initial_data)\nprint(f\"\u2713 Loaded initial data: {len(m.get_draw_data()['features'])} features\")\n\nm\n</pre> # Create a map with draw control m = MapLibreMap(center=[-122.4194, 37.7749], zoom=13, height=\"600px\", style=\"liberty\") m.add_draw_control()  # Start with initial data (this replaces any existing data) initial_data = {     \"type\": \"FeatureCollection\",     \"features\": [         {             \"type\": \"Feature\",             \"geometry\": {\"type\": \"Point\", \"coordinates\": [-122.4194, 37.7749]},             \"properties\": {\"name\": \"Initial Point\", \"color\": \"red\"},         }     ], }  m.load_draw_data(initial_data) print(f\"\u2713 Loaded initial data: {len(m.get_draw_data()['features'])} features\")  m In\u00a0[\u00a0]: Copied! <pre># Add a single point feature (appends to existing data)\nnew_point = {\n    \"type\": \"Feature\",\n    \"geometry\": {\"type\": \"Point\", \"coordinates\": [-122.4150, 37.7700]},\n    \"properties\": {\"name\": \"Added Point\", \"color\": \"blue\"},\n}\n\nm.add_draw_data(new_point)\n</pre> # Add a single point feature (appends to existing data) new_point = {     \"type\": \"Feature\",     \"geometry\": {\"type\": \"Point\", \"coordinates\": [-122.4150, 37.7700]},     \"properties\": {\"name\": \"Added Point\", \"color\": \"blue\"}, }  m.add_draw_data(new_point) In\u00a0[\u00a0]: Copied! <pre>m.get_draw_data()\n</pre> m.get_draw_data() In\u00a0[\u00a0]: Copied! <pre># Add multiple features at once using a FeatureCollection\nmultiple_features = {\n    \"type\": \"FeatureCollection\",\n    \"features\": [\n        {\n            \"type\": \"Feature\",\n            \"geometry\": {\"type\": \"Point\", \"coordinates\": [-122.4100, 37.7750]},\n            \"properties\": {\"name\": \"Point 3\", \"color\": \"green\"},\n        },\n        {\n            \"type\": \"Feature\",\n            \"geometry\": {\n                \"type\": \"Polygon\",\n                \"coordinates\": [\n                    [\n                        [-122.4200, 37.7700],\n                        [-122.4180, 37.7700],\n                        [-122.4180, 37.7720],\n                        [-122.4200, 37.7720],\n                        [-122.4200, 37.7700],\n                    ]\n                ],\n            },\n            \"properties\": {\"name\": \"Sample Polygon\", \"color\": \"yellow\"},\n        },\n    ],\n}\n\nm.add_draw_data(multiple_features)\nprint(\n    f\"\u2713 Added multiple features. Total features: {len(m.get_draw_data()['features'])}\"\n)\n</pre> # Add multiple features at once using a FeatureCollection multiple_features = {     \"type\": \"FeatureCollection\",     \"features\": [         {             \"type\": \"Feature\",             \"geometry\": {\"type\": \"Point\", \"coordinates\": [-122.4100, 37.7750]},             \"properties\": {\"name\": \"Point 3\", \"color\": \"green\"},         },         {             \"type\": \"Feature\",             \"geometry\": {                 \"type\": \"Polygon\",                 \"coordinates\": [                     [                         [-122.4200, 37.7700],                         [-122.4180, 37.7700],                         [-122.4180, 37.7720],                         [-122.4200, 37.7720],                         [-122.4200, 37.7700],                     ]                 ],             },             \"properties\": {\"name\": \"Sample Polygon\", \"color\": \"yellow\"},         },     ], }  m.add_draw_data(multiple_features) print(     f\"\u2713 Added multiple features. Total features: {len(m.get_draw_data()['features'])}\" ) In\u00a0[\u00a0]: Copied! <pre># Add a line feature programmatically\nline_feature = {\n    \"type\": \"Feature\",\n    \"geometry\": {\n        \"type\": \"LineString\",\n        \"coordinates\": [\n            [-122.4180, 37.7720],\n            [-122.4160, 37.7740],\n            [-122.4140, 37.7730],\n        ],\n    },\n    \"properties\": {\"name\": \"Route Line\", \"color\": \"purple\"},\n}\n\nm.add_draw_data(line_feature)\nfinal_count = len(m.get_draw_data()[\"features\"])\nprint(f\"\u2713 Added line feature. Final total: {final_count} features\")\n\n# Display all features\nall_features = m.get_draw_data()[\"features\"]\nprint(\"\\nAll features on the map:\")\nfor i, feature in enumerate(all_features, 1):\n    geom_type = feature[\"geometry\"][\"type\"]\n    name = feature[\"properties\"].get(\"name\", f\"Feature {i}\")\n    print(f\"  {i}. {name} ({geom_type})\")\n</pre> # Add a line feature programmatically line_feature = {     \"type\": \"Feature\",     \"geometry\": {         \"type\": \"LineString\",         \"coordinates\": [             [-122.4180, 37.7720],             [-122.4160, 37.7740],             [-122.4140, 37.7730],         ],     },     \"properties\": {\"name\": \"Route Line\", \"color\": \"purple\"}, }  m.add_draw_data(line_feature) final_count = len(m.get_draw_data()[\"features\"]) print(f\"\u2713 Added line feature. Final total: {final_count} features\")  # Display all features all_features = m.get_draw_data()[\"features\"] print(\"\\nAll features on the map:\") for i, feature in enumerate(all_features, 1):     geom_type = feature[\"geometry\"][\"type\"]     name = feature[\"properties\"].get(\"name\", f\"Feature {i}\")     print(f\"  {i}. {name} ({geom_type})\") In\u00a0[\u00a0]: Copied! <pre># Create a new map to demonstrate the difference\nm2 = MapLibreMap(center=[-122.4194, 37.7749], zoom=13, height=\"400px\", style=\"light\")\nm2.add_draw_control()\n\n# Add some initial features\npoints = {\n    \"type\": \"FeatureCollection\",\n    \"features\": [\n        {\n            \"type\": \"Feature\",\n            \"geometry\": {\"type\": \"Point\", \"coordinates\": [-122.41, 37.77]},\n            \"properties\": {\"name\": \"A\"},\n        },\n        {\n            \"type\": \"Feature\",\n            \"geometry\": {\"type\": \"Point\", \"coordinates\": [-122.42, 37.77]},\n            \"properties\": {\"name\": \"B\"},\n        },\n    ],\n}\n\nm2.add_draw_data(points)\nprint(f\"After add_draw_data: {len(m2.get_draw_data()['features'])} features\")\n\n# Now use load_draw_data - this will REPLACE all existing features\nreplacement_data = {\n    \"type\": \"FeatureCollection\",\n    \"features\": [\n        {\n            \"type\": \"Feature\",\n            \"geometry\": {\"type\": \"Point\", \"coordinates\": [-122.43, 37.78]},\n            \"properties\": {\"name\": \"C\"},\n        }\n    ],\n}\n\nm2.load_draw_data(replacement_data)\nprint(\n    f\"After load_draw_data: {len(m2.get_draw_data()['features'])} features (replaced all!)\"\n)\n\nm2\n</pre> # Create a new map to demonstrate the difference m2 = MapLibreMap(center=[-122.4194, 37.7749], zoom=13, height=\"400px\", style=\"light\") m2.add_draw_control()  # Add some initial features points = {     \"type\": \"FeatureCollection\",     \"features\": [         {             \"type\": \"Feature\",             \"geometry\": {\"type\": \"Point\", \"coordinates\": [-122.41, 37.77]},             \"properties\": {\"name\": \"A\"},         },         {             \"type\": \"Feature\",             \"geometry\": {\"type\": \"Point\", \"coordinates\": [-122.42, 37.77]},             \"properties\": {\"name\": \"B\"},         },     ], }  m2.add_draw_data(points) print(f\"After add_draw_data: {len(m2.get_draw_data()['features'])} features\")  # Now use load_draw_data - this will REPLACE all existing features replacement_data = {     \"type\": \"FeatureCollection\",     \"features\": [         {             \"type\": \"Feature\",             \"geometry\": {\"type\": \"Point\", \"coordinates\": [-122.43, 37.78]},             \"properties\": {\"name\": \"C\"},         }     ], }  m2.load_draw_data(replacement_data) print(     f\"After load_draw_data: {len(m2.get_draw_data()['features'])} features (replaced all!)\" )  m2"},{"location":"examples/maplibre/add_draw_data_example/#add-draw-data-example","title":"Add Draw Data Example\u00b6","text":"<p>This notebook demonstrates the new <code>add_draw_data()</code> method in AnyMap, which allows you to append features to existing draw control data without clearing what's already there.</p>"},{"location":"examples/maplibre/add_draw_data_example/#difference-between-load_draw_data-and-add_draw_data","title":"Difference between <code>load_draw_data</code> and <code>add_draw_data</code>\u00b6","text":"<ul> <li><code>load_draw_data()</code>: Replaces ALL existing features with new data</li> <li><code>add_draw_data()</code>: Appends new features to existing data (NEW!)</li> </ul> <p>This makes <code>add_draw_data()</code> perfect for:</p> <ul> <li>Building up features programmatically</li> <li>Adding data from multiple sources</li> <li>Incrementally adding features without losing existing ones</li> </ul>"},{"location":"examples/maplibre/add_draw_data_example/#comparison-load_draw_data-vs-add_draw_data","title":"Comparison: <code>load_draw_data</code> vs <code>add_draw_data</code>\u00b6","text":"<p>Let's demonstrate the difference between the two methods:</p>"},{"location":"examples/maplibre/add_draw_data_example/#use-cases-for-add_draw_data","title":"Use Cases for <code>add_draw_data</code>\u00b6","text":"<p>The <code>add_draw_data</code> method is particularly useful for:</p> <ol> <li>Progressive Data Loading: Load data from multiple sources incrementally</li> <li>User Interaction: Add features based on user input or calculations</li> <li>Data Integration: Combine manual drawing with programmatic feature addition</li> <li>Incremental Visualization: Build up complex visualizations step by step</li> </ol>"},{"location":"examples/maplibre/add_draw_data_example/#method-signature","title":"Method Signature:\u00b6","text":"<pre>map.add_draw_data(geojson_data: Union[Dict[str, Any], str]) -&gt; None\n</pre> <p>Parameters:</p> <ul> <li><code>geojson_data</code>: Can be a single Feature, FeatureCollection, or JSON string</li> </ul> <p>Key Features:</p> <ul> <li>\u2705 Appends features without clearing existing ones</li> <li>\u2705 Accepts both single Features and FeatureCollections</li> <li>\u2705 Handles JSON strings automatically</li> <li>\u2705 Immediately syncs with JavaScript draw control</li> <li>\u2705 Maintains existing features on the map</li> </ul>"},{"location":"examples/maplibre/basic_usage/","title":"Basic usage","text":"In\u00a0[\u00a0]: Copied! <pre># Import the required modules\nfrom anymap import MapLibreMap\nimport json\n</pre> # Import the required modules from anymap import MapLibreMap import json In\u00a0[\u00a0]: Copied! <pre># Create a basic map\nm = MapLibreMap(\n    center=[37.7749, -122.4194],  # San Francisco coordinates [lat, lng]\n    zoom=12,\n    height=\"500px\",\n)\nm\n</pre> # Create a basic map m = MapLibreMap(     center=[37.7749, -122.4194],  # San Francisco coordinates [lat, lng]     zoom=12,     height=\"500px\", ) m In\u00a0[\u00a0]: Copied! <pre># Change the center and zoom\nm.set_center(40.7128, -74.0060)  # New York City\nm.set_zoom(10)\n</pre> # Change the center and zoom m.set_center(40.7128, -74.0060)  # New York City m.set_zoom(10) In\u00a0[\u00a0]: Copied! <pre># Use fly_to for smooth animation\nm.fly_to(51.5074, -0.1278, zoom=14)  # London\n</pre> # Use fly_to for smooth animation m.fly_to(51.5074, -0.1278, zoom=14)  # London In\u00a0[\u00a0]: Copied! <pre>m\n</pre> m In\u00a0[\u00a0]: Copied! <pre># Add a marker with popup\nm.add_marker(\n    lat=51.5074,\n    lng=-0.1278,\n    popup=\"&lt;h3&gt;London&lt;/h3&gt;&lt;p&gt;Capital of the United Kingdom&lt;/p&gt;\",\n)\n</pre> # Add a marker with popup m.add_marker(     lat=51.5074,     lng=-0.1278,     popup=\"London<p>Capital of the United Kingdom</p>\", ) In\u00a0[\u00a0]: Copied! <pre># Sample GeoJSON data\ngeojson_data = {\n    \"type\": \"FeatureCollection\",\n    \"features\": [\n        {\n            \"type\": \"Feature\",\n            \"geometry\": {\"type\": \"Point\", \"coordinates\": [-0.1278, 51.5074]},\n            \"properties\": {\"name\": \"London\", \"population\": 8900000},\n        },\n        {\n            \"type\": \"Feature\",\n            \"geometry\": {\"type\": \"Point\", \"coordinates\": [2.3522, 48.8566]},\n            \"properties\": {\"name\": \"Paris\", \"population\": 2141000},\n        },\n    ],\n}\n\n# Add GeoJSON layer\nm.add_geojson_layer(\n    layer_id=\"cities\",\n    geojson_data=geojson_data,\n    layer_type=\"circle\",\n    paint={\n        \"circle-radius\": 8,\n        \"circle-color\": \"#ff0000\",\n        \"circle-stroke-width\": 2,\n        \"circle-stroke-color\": \"#ffffff\",\n    },\n)\n</pre> # Sample GeoJSON data geojson_data = {     \"type\": \"FeatureCollection\",     \"features\": [         {             \"type\": \"Feature\",             \"geometry\": {\"type\": \"Point\", \"coordinates\": [-0.1278, 51.5074]},             \"properties\": {\"name\": \"London\", \"population\": 8900000},         },         {             \"type\": \"Feature\",             \"geometry\": {\"type\": \"Point\", \"coordinates\": [2.3522, 48.8566]},             \"properties\": {\"name\": \"Paris\", \"population\": 2141000},         },     ], }  # Add GeoJSON layer m.add_geojson_layer(     layer_id=\"cities\",     geojson_data=geojson_data,     layer_type=\"circle\",     paint={         \"circle-radius\": 8,         \"circle-color\": \"#ff0000\",         \"circle-stroke-width\": 2,         \"circle-stroke-color\": \"#ffffff\",     }, ) In\u00a0[\u00a0]: Copied! <pre># Define event handler\ndef on_map_click(event):\n    lat, lng = event[\"lngLat\"]\n    print(f\"Map clicked at: {lat:.4f}, {lng:.4f}\")\n\n\n# Register the event handler\nm.on_map_event(\"click\", on_map_click)\n</pre> # Define event handler def on_map_click(event):     lat, lng = event[\"lngLat\"]     print(f\"Map clicked at: {lat:.4f}, {lng:.4f}\")   # Register the event handler m.on_map_event(\"click\", on_map_click) In\u00a0[\u00a0]: Copied! <pre># Display the same map instance again\nm\n</pre> # Display the same map instance again m In\u00a0[\u00a0]: Copied! <pre># Create a new map instance\nm2 = MapLibreMap(\n    center=[35.6762, 139.6503],  # Tokyo\n    zoom=10,\n    height=\"600px\",\n    style=\"https://demotiles.maplibre.org/style.json\",\n)\nm2\n</pre> # Create a new map instance m2 = MapLibreMap(     center=[35.6762, 139.6503],  # Tokyo     zoom=10,     height=\"600px\",     style=\"https://demotiles.maplibre.org/style.json\", ) m2 In\u00a0[\u00a0]: Copied! <pre># Both maps should work independently\nm2.add_marker(35.6762, 139.6503, popup=\"Tokyo, Japan\")\n</pre> # Both maps should work independently m2.add_marker(35.6762, 139.6503, popup=\"Tokyo, Japan\") In\u00a0[\u00a0]: Copied! <pre># Change to a different style\nm2.set_style(\"https://demotiles.maplibre.org/style.json\")\n</pre> # Change to a different style m2.set_style(\"https://demotiles.maplibre.org/style.json\") In\u00a0[\u00a0]: Copied! <pre># Set bearing and pitch for 3D effect\nm2.set_bearing(45)\nm2.set_pitch(60)\n</pre> # Set bearing and pitch for 3D effect m2.set_bearing(45) m2.set_pitch(60) In\u00a0[\u00a0]: Copied! <pre># Reset to default view\nm2.set_bearing(0)\nm2.set_pitch(0)\n</pre> # Reset to default view m2.set_bearing(0) m2.set_pitch(0) In\u00a0[\u00a0]: Copied! <pre>\n</pre> In\u00a0[\u00a0]: Copied! <pre>\n</pre>"},{"location":"examples/maplibre/basic_usage/#anymap-basic-usage-examples","title":"AnyMap Basic Usage Examples\u00b6","text":"<p>This notebook demonstrates the basic usage of the AnyMap package for creating interactive maps with MapLibre GL JS.</p>"},{"location":"examples/maplibre/basic_usage/#creating-a-basic-map","title":"Creating a Basic Map\u00b6","text":"<p>Let's start by creating a simple map centered on San Francisco.</p>"},{"location":"examples/maplibre/basic_usage/#changing-map-properties","title":"Changing Map Properties\u00b6","text":"<p>You can dynamically change map properties after creation:</p>"},{"location":"examples/maplibre/basic_usage/#adding-markers","title":"Adding Markers\u00b6","text":"<p>You can add markers to the map with optional popups:</p>"},{"location":"examples/maplibre/basic_usage/#working-with-geojson-data","title":"Working with GeoJSON Data\u00b6","text":"<p>Let's add some GeoJSON data to the map:</p>"},{"location":"examples/maplibre/basic_usage/#event-handling","title":"Event Handling\u00b6","text":"<p>You can register event handlers for map interactions:</p>"},{"location":"examples/maplibre/basic_usage/#multi-cell-rendering-test","title":"Multi-cell Rendering Test\u00b6","text":"<p>Let's test that the same map can be displayed in multiple cells without issues:</p>"},{"location":"examples/maplibre/basic_usage/#changing-map-styles","title":"Changing Map Styles\u00b6","text":"<p>You can change the map style dynamically:</p>"},{"location":"examples/maplibre/basic_usage/#calling-javascript-methods","title":"Calling JavaScript Methods\u00b6","text":"<p>You can call any MapLibre GL JS methods directly:</p>"},{"location":"examples/maplibre/clicked_attribute_example/","title":"Clicked attribute example","text":"In\u00a0[\u00a0]: Copied! <pre>from anymap.maplibre import MapLibreMap\nimport ipywidgets as widgets\nfrom IPython.display import display\n</pre> from anymap.maplibre import MapLibreMap import ipywidgets as widgets from IPython.display import display In\u00a0[\u00a0]: Copied! <pre># Create a MapLibre map\nm = MapLibreMap(center=[-122.4194, 37.7749], zoom=10, style=\"streets\")  # San Francisco\n\nm\n</pre> # Create a MapLibre map m = MapLibreMap(center=[-122.4194, 37.7749], zoom=10, style=\"streets\")  # San Francisco  m In\u00a0[\u00a0]: Copied! <pre># Create a widget to display clicked coordinates\noutput = widgets.Output()\n\n\ndef on_map_clicked(change):\n    clicked_coords = change[\"new\"]\n    if clicked_coords:  # Check if not empty\n        with output:\n            output.clear_output()\n            print(f\"Map clicked at: {clicked_coords}\")\n            print(f\"Longitude: {clicked_coords.get('lng', 'N/A')}\")\n            print(f\"Latitude: {clicked_coords.get('lat', 'N/A')}\")\n\n\n# Observe changes to the clicked attribute\nm.observe(on_map_clicked, names=\"clicked\")\n\ndisplay(output)\n</pre> # Create a widget to display clicked coordinates output = widgets.Output()   def on_map_clicked(change):     clicked_coords = change[\"new\"]     if clicked_coords:  # Check if not empty         with output:             output.clear_output()             print(f\"Map clicked at: {clicked_coords}\")             print(f\"Longitude: {clicked_coords.get('lng', 'N/A')}\")             print(f\"Latitude: {clicked_coords.get('lat', 'N/A')}\")   # Observe changes to the clicked attribute m.observe(on_map_clicked, names=\"clicked\")  display(output) In\u00a0[\u00a0]: Copied! <pre># You can also access the clicked coordinates directly\nprint(\"Current clicked coordinates:\", m.clicked)\n\n# The clicked attribute returns a dict with 'lng' and 'lat' keys\n# Example: {'lng': -122.34567890, 'lat': 37.1234567890}\n</pre> # You can also access the clicked coordinates directly print(\"Current clicked coordinates:\", m.clicked)  # The clicked attribute returns a dict with 'lng' and 'lat' keys # Example: {'lng': -122.34567890, 'lat': 37.1234567890}"},{"location":"examples/maplibre/clicked_attribute_example/#maplibre-map-clicked-attribute-example","title":"MapLibre Map Clicked Attribute Example\u00b6","text":"<p>This example demonstrates how to use the <code>clicked</code> attribute of MapLibreMap to capture map click coordinates.</p>"},{"location":"examples/maplibre/clicked_attribute_example/#instructions","title":"Instructions\u00b6","text":"<ol> <li>Click anywhere on the map above</li> <li>The coordinates will be displayed in the output widget</li> <li>The <code>m.clicked</code> attribute will contain the latest click coordinates as a dictionary with <code>lng</code> and <code>lat</code> keys</li> <li>You can observe changes to the <code>clicked</code> attribute using <code>m.observe(callback, names='clicked')</code></li> </ol>"},{"location":"examples/maplibre/cog_metadata_example/","title":"Cog metadata example","text":"In\u00a0[\u00a0]: Copied! <pre>from anymap import MapLibreMap\nfrom anymap.utils import get_cog_metadata\n</pre> from anymap import MapLibreMap from anymap.utils import get_cog_metadata In\u00a0[\u00a0]: Copied! <pre># Sample COG URL from MapLibre documentation\ncog_url = \"https://maplibre.org/maplibre-gl-js/docs/assets/cog.tif\"\n\n# Get metadata with default CRS (EPSG:4326)\nmetadata = get_cog_metadata(cog_url)\n\nif metadata:\n    print(\"COG Metadata (bbox in EPSG:4326):\")\n    print(\"=\" * 50)\n    for key, value in metadata.items():\n        print(f\"{key:15}: {value}\")\n\n    print(\"\\n\" + \"=\" * 50)\n    print(\"Note: The bbox coordinates are in EPSG:4326 (WGS84)\")\n    print(f\"Native CRS: {metadata.get('crs')}\")\n    print(f\"Output CRS: {metadata.get('output_crs')}\")\nelse:\n    print(\"Failed to retrieve metadata. Make sure rasterio is installed:\")\n    print(\"pip install rasterio\")\n</pre> # Sample COG URL from MapLibre documentation cog_url = \"https://maplibre.org/maplibre-gl-js/docs/assets/cog.tif\"  # Get metadata with default CRS (EPSG:4326) metadata = get_cog_metadata(cog_url)  if metadata:     print(\"COG Metadata (bbox in EPSG:4326):\")     print(\"=\" * 50)     for key, value in metadata.items():         print(f\"{key:15}: {value}\")      print(\"\\n\" + \"=\" * 50)     print(\"Note: The bbox coordinates are in EPSG:4326 (WGS84)\")     print(f\"Native CRS: {metadata.get('crs')}\")     print(f\"Output CRS: {metadata.get('output_crs')}\") else:     print(\"Failed to retrieve metadata. Make sure rasterio is installed:\")     print(\"pip install rasterio\") In\u00a0[\u00a0]: Copied! <pre># Get metadata in native CRS (EPSG:3857 in this case)\nmetadata_native = get_cog_metadata(cog_url, crs=None)\n\nif metadata_native:\n    print(\"COG Metadata (bbox in native CRS):\")\n    print(\"=\" * 50)\n    bbox = metadata_native.get(\"bbox\")\n    if bbox:\n        print(f\"Bounding Box (native CRS):\")\n        print(f\"  West:  {bbox[0]:.2f}\")\n        print(f\"  South: {bbox[1]:.2f}\")\n        print(f\"  East:  {bbox[2]:.2f}\")\n        print(f\"  North: {bbox[3]:.2f}\")\n\n    print(f\"\\nNative CRS: {metadata_native.get('crs')}\")\n    print(f\"Output CRS: {metadata_native.get('output_crs')}\")\n    print(\n        f\"Dimensions: {metadata_native.get('width')} x {metadata_native.get('height')} pixels\"\n    )\n    print(f\"Bands: {metadata_native.get('count')}\")\n\nprint(\"\\n\" + \"=\" * 50)\nprint(\"COMPARISON:\")\nprint(\"=\" * 50)\nif metadata and metadata_native:\n    print(f\"EPSG:4326 bbox: {metadata.get('bbox')}\")\n    print(f\"Native bbox:    {metadata_native.get('bbox')}\")\n</pre> # Get metadata in native CRS (EPSG:3857 in this case) metadata_native = get_cog_metadata(cog_url, crs=None)  if metadata_native:     print(\"COG Metadata (bbox in native CRS):\")     print(\"=\" * 50)     bbox = metadata_native.get(\"bbox\")     if bbox:         print(f\"Bounding Box (native CRS):\")         print(f\"  West:  {bbox[0]:.2f}\")         print(f\"  South: {bbox[1]:.2f}\")         print(f\"  East:  {bbox[2]:.2f}\")         print(f\"  North: {bbox[3]:.2f}\")      print(f\"\\nNative CRS: {metadata_native.get('crs')}\")     print(f\"Output CRS: {metadata_native.get('output_crs')}\")     print(         f\"Dimensions: {metadata_native.get('width')} x {metadata_native.get('height')} pixels\"     )     print(f\"Bands: {metadata_native.get('count')}\")  print(\"\\n\" + \"=\" * 50) print(\"COMPARISON:\") print(\"=\" * 50) if metadata and metadata_native:     print(f\"EPSG:4326 bbox: {metadata.get('bbox')}\")     print(f\"Native bbox:    {metadata_native.get('bbox')}\") In\u00a0[\u00a0]: Copied! <pre># Create a map instance\nm = MapLibreMap()\n\n# Get metadata using the map instance method (defaults to EPSG:4326)\ncog_url = \"https://huggingface.co/datasets/giswqs/geospatial/resolve/main/naip_rgb_train_3857.tif\"\nmetadata = m.get_cog_metadata(cog_url)\n\nif metadata:\n    print(\"Using MapLibreMap instance method:\")\n    print(\"=\" * 50)\n    bbox = metadata.get(\"bbox\")\n    if bbox:\n        print(f\"Bounding Box (EPSG:4326):\")\n        print(f\"  West:  {bbox[0]:.6f}\u00b0\")\n        print(f\"  South: {bbox[1]:.6f}\u00b0\")\n        print(f\"  East:  {bbox[2]:.6f}\u00b0\")\n        print(f\"  North: {bbox[3]:.6f}\u00b0\")\n\n    print(f\"\\nDimensions: {metadata.get('width')} x {metadata.get('height')} pixels\")\n    print(f\"Bands: {metadata.get('count')}\")\n    print(f\"Native CRS: {metadata.get('crs')}\")\n    print(f\"Output CRS: {metadata.get('output_crs')}\")\n</pre> # Create a map instance m = MapLibreMap()  # Get metadata using the map instance method (defaults to EPSG:4326) cog_url = \"https://huggingface.co/datasets/giswqs/geospatial/resolve/main/naip_rgb_train_3857.tif\" metadata = m.get_cog_metadata(cog_url)  if metadata:     print(\"Using MapLibreMap instance method:\")     print(\"=\" * 50)     bbox = metadata.get(\"bbox\")     if bbox:         print(f\"Bounding Box (EPSG:4326):\")         print(f\"  West:  {bbox[0]:.6f}\u00b0\")         print(f\"  South: {bbox[1]:.6f}\u00b0\")         print(f\"  East:  {bbox[2]:.6f}\u00b0\")         print(f\"  North: {bbox[3]:.6f}\u00b0\")      print(f\"\\nDimensions: {metadata.get('width')} x {metadata.get('height')} pixels\")     print(f\"Bands: {metadata.get('count')}\")     print(f\"Native CRS: {metadata.get('crs')}\")     print(f\"Output CRS: {metadata.get('output_crs')}\") In\u00a0[\u00a0]: Copied! <pre>m\n</pre> m In\u00a0[\u00a0]: Copied! <pre>m.add_cog_layer(layer_id=\"cogLayer\", cog_url=cog_url, fit_bounds=True)\n</pre> m.add_cog_layer(layer_id=\"cogLayer\", cog_url=cog_url, fit_bounds=True)"},{"location":"examples/maplibre/cog_metadata_example/#cog-metadata-example","title":"COG Metadata Example\u00b6","text":"<p>This notebook demonstrates how to retrieve and use metadata from Cloud Optimized GeoTIFF (COG) files using the AnyMap package.</p>"},{"location":"examples/maplibre/cog_metadata_example/#overview","title":"Overview\u00b6","text":"<p>The <code>get_cog_metadata()</code> function retrieves metadata from COG files, including:</p> <ul> <li>Bounding box (bbox) - Returned in EPSG:4326 (WGS84) by default</li> <li>Width and height (in pixels)</li> <li>Coordinate reference system (CRS)</li> <li>Number of bands</li> <li>Data types</li> <li>NoData value</li> <li>Scale and offset values (if available)</li> </ul> <p>Important: By default, the bounding box coordinates are reprojected to EPSG:4326 (WGS84) for compatibility with MapLibre. You can get coordinates in the native CRS by passing <code>crs=None</code>.</p> <p>Note: This feature uses the <code>getCogMetadata</code> function from maplibre-cog-protocol, which is marked as [unstable]. Some metadata internals may change in future releases.</p>"},{"location":"examples/maplibre/cog_metadata_example/#example-1-get-cog-metadata-with-default-crs-epsg4326","title":"Example 1: Get COG Metadata with Default CRS (EPSG:4326)\u00b6","text":"<p>By default, the bounding box coordinates are reprojected to EPSG:4326 (WGS84) for easy use with MapLibre.</p>"},{"location":"examples/maplibre/cog_metadata_example/#example-2-get-cog-metadata-in-native-crs","title":"Example 2: Get COG Metadata in Native CRS\u00b6","text":"<p>You can also retrieve the metadata in the COG's native CRS by passing <code>crs=None</code>.</p>"},{"location":"examples/maplibre/cog_metadata_example/#example-3-using-map-instance-method","title":"Example 3: Using Map Instance Method\u00b6","text":"<p>You can also use the <code>get_cog_metadata()</code> method directly on a MapLibreMap instance.</p>"},{"location":"examples/maplibre/custom_draw_styles_example/","title":"Custom draw styles example","text":"In\u00a0[\u00a0]: Copied! <pre># Import required modules\nfrom anymap import MapLibreMap\nfrom anymap.draw_styles import create_draw_styles\nimport json\n\nprint(\"AnyMap with custom draw control styling!\")\n</pre> # Import required modules from anymap import MapLibreMap from anymap.draw_styles import create_draw_styles import json  print(\"AnyMap with custom draw control styling!\") In\u00a0[\u00a0]: Copied! <pre># Create a map with default draw control styles\nm1 = MapLibreMap(\n    center=[37.7749, -122.4194],  # San Francisco\n    zoom=13,\n    height=\"600px\",\n    style=\"streets\",\n)\n\n# Add draw control with default styling (left side)\nm1.add_draw_control(\n    position=\"top-left\",\n    controls={\"point\": True, \"line_string\": True, \"polygon\": True, \"trash\": True},\n)\n\nm1\n</pre> # Create a map with default draw control styles m1 = MapLibreMap(     center=[37.7749, -122.4194],  # San Francisco     zoom=13,     height=\"600px\",     style=\"streets\", )  # Add draw control with default styling (left side) m1.add_draw_control(     position=\"top-left\",     controls={\"point\": True, \"line_string\": True, \"polygon\": True, \"trash\": True}, )  m1 In\u00a0[\u00a0]: Copied! <pre># Create multiple maps with different themed styles\n\n# Map 1: Transportation theme (roads, stops, areas)\nm2 = MapLibreMap(\n    center=[37.7749, -122.4194], zoom=13, height=\"500px\", style=\"dark-matter\"\n)\n\ntransportation_styles = create_draw_styles(\n    point_color=\"#FFD700\",  # Golden yellow for stops/stations\n    line_color=\"#32CD32\",  # Lime green for routes\n    polygon_fill_color=\"#FF6347\",  # Tomato red for service areas\n    polygon_stroke_color=\"#FF6347\",\n    active_color=\"#00FFFF\",  # Cyan for selection\n    point_radius=4,\n    line_width=3,\n)\n\nm2.add_draw_control(\n    position=\"top-left\",\n    styles=transportation_styles,\n    controls={\"point\": True, \"line_string\": True, \"polygon\": True, \"trash\": True},\n)\n\nprint(\"\ud83d\ude8c Transportation Theme: Golden stops, green routes, red service areas\")\nm2\n</pre> # Create multiple maps with different themed styles  # Map 1: Transportation theme (roads, stops, areas) m2 = MapLibreMap(     center=[37.7749, -122.4194], zoom=13, height=\"500px\", style=\"dark-matter\" )  transportation_styles = create_draw_styles(     point_color=\"#FFD700\",  # Golden yellow for stops/stations     line_color=\"#32CD32\",  # Lime green for routes     polygon_fill_color=\"#FF6347\",  # Tomato red for service areas     polygon_stroke_color=\"#FF6347\",     active_color=\"#00FFFF\",  # Cyan for selection     point_radius=4,     line_width=3, )  m2.add_draw_control(     position=\"top-left\",     styles=transportation_styles,     controls={\"point\": True, \"line_string\": True, \"polygon\": True, \"trash\": True}, )  print(\"\ud83d\ude8c Transportation Theme: Golden stops, green routes, red service areas\") m2 In\u00a0[\u00a0]: Copied! <pre># Map 2: Environmental theme (sampling points, streams, protected areas)\nm3 = MapLibreMap(\n    center=[37.7749, -122.4194], zoom=13, height=\"500px\", style=\"satellite\"\n)\n\nenvironmental_styles = create_draw_styles(\n    point_color=\"#8B4513\",  # Brown for sampling points\n    line_color=\"#4169E1\",  # Royal blue for water features\n    polygon_fill_color=\"#228B22\",  # Forest green for protected areas\n    polygon_stroke_color=\"#006400\",  # Dark green border\n    active_color=\"#FF1493\",  # Deep pink for selection\n    point_radius=3,\n    line_width=2,\n    polygon_opacity=0.3,\n)\n\nm3.add_draw_control(\n    position=\"top-right\",\n    styles=environmental_styles,\n    controls={\"point\": True, \"line_string\": True, \"polygon\": True, \"trash\": True},\n)\n\nprint(\n    \"\ud83c\udf32 Environmental Theme: Brown sampling points, blue streams, green protected areas\"\n)\nm3\n</pre> # Map 2: Environmental theme (sampling points, streams, protected areas) m3 = MapLibreMap(     center=[37.7749, -122.4194], zoom=13, height=\"500px\", style=\"satellite\" )  environmental_styles = create_draw_styles(     point_color=\"#8B4513\",  # Brown for sampling points     line_color=\"#4169E1\",  # Royal blue for water features     polygon_fill_color=\"#228B22\",  # Forest green for protected areas     polygon_stroke_color=\"#006400\",  # Dark green border     active_color=\"#FF1493\",  # Deep pink for selection     point_radius=3,     line_width=2,     polygon_opacity=0.3, )  m3.add_draw_control(     position=\"top-right\",     styles=environmental_styles,     controls={\"point\": True, \"line_string\": True, \"polygon\": True, \"trash\": True}, )  print(     \"\ud83c\udf32 Environmental Theme: Brown sampling points, blue streams, green protected areas\" ) m3 In\u00a0[\u00a0]: Copied! <pre># Create high contrast styles\nm4 = MapLibreMap(\n    center=[37.7749, -122.4194],\n    zoom=13,\n    height=\"500px\",\n    style=\"positron\",  # Light background for contrast\n)\n\nhigh_contrast_styles = create_draw_styles(\n    point_color=\"#000000\",  # Black points\n    line_color=\"#000000\",  # Black lines\n    polygon_fill_color=\"#000000\",  # Black polygon fill\n    polygon_stroke_color=\"#000000\",  # Black polygon stroke\n    active_color=\"#FF0000\",  # Bright red for selection\n    point_radius=6,  # Larger for visibility\n    line_width=4,  # Thicker for visibility\n    polygon_opacity=0.4,  # More visible\n)\n\nm4.add_draw_control(\n    position=\"top-left\",\n    styles=high_contrast_styles,\n    controls={\"point\": True, \"line_string\": True, \"polygon\": True, \"trash\": True},\n)\n\nprint(\"\u267f High Contrast Theme: Bold black features with bright red selection\")\nm4\n</pre> # Create high contrast styles m4 = MapLibreMap(     center=[37.7749, -122.4194],     zoom=13,     height=\"500px\",     style=\"positron\",  # Light background for contrast )  high_contrast_styles = create_draw_styles(     point_color=\"#000000\",  # Black points     line_color=\"#000000\",  # Black lines     polygon_fill_color=\"#000000\",  # Black polygon fill     polygon_stroke_color=\"#000000\",  # Black polygon stroke     active_color=\"#FF0000\",  # Bright red for selection     point_radius=6,  # Larger for visibility     line_width=4,  # Thicker for visibility     polygon_opacity=0.4,  # More visible )  m4.add_draw_control(     position=\"top-left\",     styles=high_contrast_styles,     controls={\"point\": True, \"line_string\": True, \"polygon\": True, \"trash\": True}, )  print(\"\u267f High Contrast Theme: Bold black features with bright red selection\") m4 In\u00a0[\u00a0]: Copied! <pre># Create sample data for demonstration\nsample_data = {\n    \"type\": \"FeatureCollection\",\n    \"features\": [\n        {\n            \"type\": \"Feature\",\n            \"geometry\": {\"type\": \"Point\", \"coordinates\": [-122.4194, 37.7749]},\n            \"properties\": {\"name\": \"City Hall\", \"type\": \"landmark\"},\n        },\n        {\n            \"type\": \"Feature\",\n            \"geometry\": {\n                \"type\": \"LineString\",\n                \"coordinates\": [[-122.42, 37.77], [-122.41, 37.78], [-122.40, 37.77]],\n            },\n            \"properties\": {\"name\": \"Sample Route\", \"type\": \"route\"},\n        },\n        {\n            \"type\": \"Feature\",\n            \"geometry\": {\n                \"type\": \"Polygon\",\n                \"coordinates\": [\n                    [\n                        [-122.415, 37.775],\n                        [-122.405, 37.775],\n                        [-122.405, 37.765],\n                        [-122.415, 37.765],\n                        [-122.415, 37.775],\n                    ]\n                ],\n            },\n            \"properties\": {\"name\": \"Sample Area\", \"type\": \"zone\"},\n        },\n    ],\n}\n\n# Create map with custom styles\nm5 = MapLibreMap(center=[37.7749, -122.4194], zoom=14, height=\"600px\", style=\"voyager\")\n\n# Create purple theme for loaded data\npurple_styles = create_draw_styles(\n    point_color=\"#8A2BE2\",  # Blue violet\n    line_color=\"#9370DB\",  # Medium purple\n    polygon_fill_color=\"#DA70D6\",  # Orchid\n    polygon_stroke_color=\"#8A2BE2\",  # Blue violet\n    active_color=\"#FFD700\",  # Gold for selection\n    point_radius=4,\n    line_width=3,\n    polygon_opacity=0.25,\n)\n\nm5.add_draw_control(\n    position=\"top-left\",\n    styles=purple_styles,\n    controls={\"point\": True, \"line_string\": True, \"polygon\": True, \"trash\": True},\n)\n\n# Load the sample data - it will appear with purple styling\nm5.load_draw_data(sample_data)\n\nprint(\"\ud83d\udc9c Purple Theme with Pre-loaded Data\")\nprint(\"\u2022 Point: City Hall location\")\nprint(\"\u2022 Line: Sample route\")\nprint(\"\u2022 Polygon: Sample area\")\nprint(\"Try selecting and editing the features to see the gold selection color!\")\n\nm5\n</pre> # Create sample data for demonstration sample_data = {     \"type\": \"FeatureCollection\",     \"features\": [         {             \"type\": \"Feature\",             \"geometry\": {\"type\": \"Point\", \"coordinates\": [-122.4194, 37.7749]},             \"properties\": {\"name\": \"City Hall\", \"type\": \"landmark\"},         },         {             \"type\": \"Feature\",             \"geometry\": {                 \"type\": \"LineString\",                 \"coordinates\": [[-122.42, 37.77], [-122.41, 37.78], [-122.40, 37.77]],             },             \"properties\": {\"name\": \"Sample Route\", \"type\": \"route\"},         },         {             \"type\": \"Feature\",             \"geometry\": {                 \"type\": \"Polygon\",                 \"coordinates\": [                     [                         [-122.415, 37.775],                         [-122.405, 37.775],                         [-122.405, 37.765],                         [-122.415, 37.765],                         [-122.415, 37.775],                     ]                 ],             },             \"properties\": {\"name\": \"Sample Area\", \"type\": \"zone\"},         },     ], }  # Create map with custom styles m5 = MapLibreMap(center=[37.7749, -122.4194], zoom=14, height=\"600px\", style=\"voyager\")  # Create purple theme for loaded data purple_styles = create_draw_styles(     point_color=\"#8A2BE2\",  # Blue violet     line_color=\"#9370DB\",  # Medium purple     polygon_fill_color=\"#DA70D6\",  # Orchid     polygon_stroke_color=\"#8A2BE2\",  # Blue violet     active_color=\"#FFD700\",  # Gold for selection     point_radius=4,     line_width=3,     polygon_opacity=0.25, )  m5.add_draw_control(     position=\"top-left\",     styles=purple_styles,     controls={\"point\": True, \"line_string\": True, \"polygon\": True, \"trash\": True}, )  # Load the sample data - it will appear with purple styling m5.load_draw_data(sample_data)  print(\"\ud83d\udc9c Purple Theme with Pre-loaded Data\") print(\"\u2022 Point: City Hall location\") print(\"\u2022 Line: Sample route\") print(\"\u2022 Polygon: Sample area\") print(\"Try selecting and editing the features to see the gold selection color!\")  m5 In\u00a0[\u00a0]: Copied! <pre># Define completely custom style objects\nadvanced_custom_styles = [\n    # Custom point style with gradient effect (using multiple circles)\n    {\n        \"id\": \"custom-point-outer\",\n        \"type\": \"circle\",\n        \"filter\": [\n            \"all\",\n            [\"==\", \"active\", \"false\"],\n            [\"==\", \"$type\", \"Point\"],\n            [\"==\", \"meta\", \"feature\"],\n        ],\n        \"paint\": {\"circle-radius\": 8, \"circle-color\": \"#FF6B6B\", \"circle-opacity\": 0.6},\n    },\n    {\n        \"id\": \"custom-point-inner\",\n        \"type\": \"circle\",\n        \"filter\": [\n            \"all\",\n            [\"==\", \"active\", \"false\"],\n            [\"==\", \"$type\", \"Point\"],\n            [\"==\", \"meta\", \"feature\"],\n        ],\n        \"paint\": {\"circle-radius\": 4, \"circle-color\": \"#FF1744\", \"circle-opacity\": 1.0},\n    },\n    # Active point style\n    {\n        \"id\": \"custom-point-active\",\n        \"type\": \"circle\",\n        \"filter\": [\"all\", [\"==\", \"active\", \"true\"], [\"==\", \"$type\", \"Point\"]],\n        \"paint\": {\n            \"circle-radius\": 10,\n            \"circle-color\": \"#FFEB3B\",\n            \"circle-stroke-color\": \"#F57F17\",\n            \"circle-stroke-width\": 2,\n        },\n    },\n    # Custom line style with pattern\n    {\n        \"id\": \"custom-line-inactive\",\n        \"type\": \"line\",\n        \"filter\": [\"all\", [\"==\", \"active\", \"false\"], [\"==\", \"$type\", \"LineString\"]],\n        \"layout\": {\"line-cap\": \"round\", \"line-join\": \"round\"},\n        \"paint\": {\n            \"line-color\": \"#4CAF50\",\n            \"line-width\": 5,\n            \"line-dasharray\": [2, 1],  # Dashed pattern\n        },\n    },\n    # Active line style\n    {\n        \"id\": \"custom-line-active\",\n        \"type\": \"line\",\n        \"filter\": [\"all\", [\"==\", \"active\", \"true\"], [\"==\", \"$type\", \"LineString\"]],\n        \"layout\": {\"line-cap\": \"round\", \"line-join\": \"round\"},\n        \"paint\": {\"line-color\": \"#FFEB3B\", \"line-width\": 6, \"line-dasharray\": [1, 1]},\n    },\n    # Custom polygon fill\n    {\n        \"id\": \"custom-polygon-fill\",\n        \"type\": \"fill\",\n        \"filter\": [\"all\", [\"==\", \"active\", \"false\"], [\"==\", \"$type\", \"Polygon\"]],\n        \"paint\": {\"fill-color\": \"#2196F3\", \"fill-opacity\": 0.3},\n    },\n    # Custom polygon stroke\n    {\n        \"id\": \"custom-polygon-stroke\",\n        \"type\": \"line\",\n        \"filter\": [\"all\", [\"==\", \"active\", \"false\"], [\"==\", \"$type\", \"Polygon\"]],\n        \"layout\": {\"line-cap\": \"round\", \"line-join\": \"round\"},\n        \"paint\": {\"line-color\": \"#1976D2\", \"line-width\": 3},\n    },\n    # Active polygon styles\n    {\n        \"id\": \"custom-polygon-fill-active\",\n        \"type\": \"fill\",\n        \"filter\": [\"all\", [\"==\", \"active\", \"true\"], [\"==\", \"$type\", \"Polygon\"]],\n        \"paint\": {\"fill-color\": \"#FFEB3B\", \"fill-opacity\": 0.4},\n    },\n    {\n        \"id\": \"custom-polygon-stroke-active\",\n        \"type\": \"line\",\n        \"filter\": [\"all\", [\"==\", \"active\", \"true\"], [\"==\", \"$type\", \"Polygon\"]],\n        \"layout\": {\"line-cap\": \"round\", \"line-join\": \"round\"},\n        \"paint\": {\"line-color\": \"#F57F17\", \"line-width\": 4, \"line-dasharray\": [0.5, 1]},\n    },\n    # Vertex styles for editing\n    {\n        \"id\": \"custom-vertex-stroke\",\n        \"type\": \"circle\",\n        \"filter\": [\"all\", [\"==\", \"meta\", \"vertex\"], [\"==\", \"$type\", \"Point\"]],\n        \"paint\": {\n            \"circle-radius\": 6,\n            \"circle-color\": \"#FFFFFF\",\n            \"circle-stroke-color\": \"#333333\",\n            \"circle-stroke-width\": 2,\n        },\n    },\n    {\n        \"id\": \"custom-vertex\",\n        \"type\": \"circle\",\n        \"filter\": [\"all\", [\"==\", \"meta\", \"vertex\"], [\"==\", \"$type\", \"Point\"]],\n        \"paint\": {\"circle-radius\": 3, \"circle-color\": \"#FFEB3B\"},\n    },\n]\n\n# Create map with advanced custom styles\nm6 = MapLibreMap(\n    center=[37.7749, -122.4194], zoom=13, height=\"600px\", style=\"dark-matter\"\n)\n\nm6.add_draw_control(\n    position=\"top-left\",\n    styles=advanced_custom_styles,\n    controls={\"point\": True, \"line_string\": True, \"polygon\": True, \"trash\": True},\n)\n\nprint(\"\ud83d\udd25 Advanced Custom Styles\")\nprint(\"\u2022 Points: Gradient red circles with yellow selection\")\nprint(\"\u2022 Lines: Dashed green with yellow selection\")\nprint(\"\u2022 Polygons: Blue fill with custom stroke patterns\")\nprint(\"\u2022 Vertices: White circles with yellow centers\")\n\nm6\n</pre> # Define completely custom style objects advanced_custom_styles = [     # Custom point style with gradient effect (using multiple circles)     {         \"id\": \"custom-point-outer\",         \"type\": \"circle\",         \"filter\": [             \"all\",             [\"==\", \"active\", \"false\"],             [\"==\", \"$type\", \"Point\"],             [\"==\", \"meta\", \"feature\"],         ],         \"paint\": {\"circle-radius\": 8, \"circle-color\": \"#FF6B6B\", \"circle-opacity\": 0.6},     },     {         \"id\": \"custom-point-inner\",         \"type\": \"circle\",         \"filter\": [             \"all\",             [\"==\", \"active\", \"false\"],             [\"==\", \"$type\", \"Point\"],             [\"==\", \"meta\", \"feature\"],         ],         \"paint\": {\"circle-radius\": 4, \"circle-color\": \"#FF1744\", \"circle-opacity\": 1.0},     },     # Active point style     {         \"id\": \"custom-point-active\",         \"type\": \"circle\",         \"filter\": [\"all\", [\"==\", \"active\", \"true\"], [\"==\", \"$type\", \"Point\"]],         \"paint\": {             \"circle-radius\": 10,             \"circle-color\": \"#FFEB3B\",             \"circle-stroke-color\": \"#F57F17\",             \"circle-stroke-width\": 2,         },     },     # Custom line style with pattern     {         \"id\": \"custom-line-inactive\",         \"type\": \"line\",         \"filter\": [\"all\", [\"==\", \"active\", \"false\"], [\"==\", \"$type\", \"LineString\"]],         \"layout\": {\"line-cap\": \"round\", \"line-join\": \"round\"},         \"paint\": {             \"line-color\": \"#4CAF50\",             \"line-width\": 5,             \"line-dasharray\": [2, 1],  # Dashed pattern         },     },     # Active line style     {         \"id\": \"custom-line-active\",         \"type\": \"line\",         \"filter\": [\"all\", [\"==\", \"active\", \"true\"], [\"==\", \"$type\", \"LineString\"]],         \"layout\": {\"line-cap\": \"round\", \"line-join\": \"round\"},         \"paint\": {\"line-color\": \"#FFEB3B\", \"line-width\": 6, \"line-dasharray\": [1, 1]},     },     # Custom polygon fill     {         \"id\": \"custom-polygon-fill\",         \"type\": \"fill\",         \"filter\": [\"all\", [\"==\", \"active\", \"false\"], [\"==\", \"$type\", \"Polygon\"]],         \"paint\": {\"fill-color\": \"#2196F3\", \"fill-opacity\": 0.3},     },     # Custom polygon stroke     {         \"id\": \"custom-polygon-stroke\",         \"type\": \"line\",         \"filter\": [\"all\", [\"==\", \"active\", \"false\"], [\"==\", \"$type\", \"Polygon\"]],         \"layout\": {\"line-cap\": \"round\", \"line-join\": \"round\"},         \"paint\": {\"line-color\": \"#1976D2\", \"line-width\": 3},     },     # Active polygon styles     {         \"id\": \"custom-polygon-fill-active\",         \"type\": \"fill\",         \"filter\": [\"all\", [\"==\", \"active\", \"true\"], [\"==\", \"$type\", \"Polygon\"]],         \"paint\": {\"fill-color\": \"#FFEB3B\", \"fill-opacity\": 0.4},     },     {         \"id\": \"custom-polygon-stroke-active\",         \"type\": \"line\",         \"filter\": [\"all\", [\"==\", \"active\", \"true\"], [\"==\", \"$type\", \"Polygon\"]],         \"layout\": {\"line-cap\": \"round\", \"line-join\": \"round\"},         \"paint\": {\"line-color\": \"#F57F17\", \"line-width\": 4, \"line-dasharray\": [0.5, 1]},     },     # Vertex styles for editing     {         \"id\": \"custom-vertex-stroke\",         \"type\": \"circle\",         \"filter\": [\"all\", [\"==\", \"meta\", \"vertex\"], [\"==\", \"$type\", \"Point\"]],         \"paint\": {             \"circle-radius\": 6,             \"circle-color\": \"#FFFFFF\",             \"circle-stroke-color\": \"#333333\",             \"circle-stroke-width\": 2,         },     },     {         \"id\": \"custom-vertex\",         \"type\": \"circle\",         \"filter\": [\"all\", [\"==\", \"meta\", \"vertex\"], [\"==\", \"$type\", \"Point\"]],         \"paint\": {\"circle-radius\": 3, \"circle-color\": \"#FFEB3B\"},     }, ]  # Create map with advanced custom styles m6 = MapLibreMap(     center=[37.7749, -122.4194], zoom=13, height=\"600px\", style=\"dark-matter\" )  m6.add_draw_control(     position=\"top-left\",     styles=advanced_custom_styles,     controls={\"point\": True, \"line_string\": True, \"polygon\": True, \"trash\": True}, )  print(\"\ud83d\udd25 Advanced Custom Styles\") print(\"\u2022 Points: Gradient red circles with yellow selection\") print(\"\u2022 Lines: Dashed green with yellow selection\") print(\"\u2022 Polygons: Blue fill with custom stroke patterns\") print(\"\u2022 Vertices: White circles with yellow centers\")  m6 In\u00a0[\u00a0]: Copied! <pre># Test with the transportation themed map from earlier\n# Add different types of transportation data\n\ntransport_data = {\n    \"type\": \"FeatureCollection\",\n    \"features\": [\n        # Bus stops (points)\n        {\n            \"type\": \"Feature\",\n            \"geometry\": {\"type\": \"Point\", \"coordinates\": [-122.42, 37.775]},\n            \"properties\": {\"type\": \"bus_stop\", \"name\": \"Market St &amp; 5th St\"},\n        },\n        {\n            \"type\": \"Feature\",\n            \"geometry\": {\"type\": \"Point\", \"coordinates\": [-122.415, 37.78]},\n            \"properties\": {\"type\": \"bus_stop\", \"name\": \"Union Square\"},\n        },\n        # Bus route (line)\n        {\n            \"type\": \"Feature\",\n            \"geometry\": {\n                \"type\": \"LineString\",\n                \"coordinates\": [\n                    [-122.42, 37.775],\n                    [-122.415, 37.78],\n                    [-122.41, 37.782],\n                    [-122.405, 37.78],\n                ],\n            },\n            \"properties\": {\"type\": \"bus_route\", \"name\": \"Route 38\"},\n        },\n        # Service area (polygon)\n        {\n            \"type\": \"Feature\",\n            \"geometry\": {\n                \"type\": \"Polygon\",\n                \"coordinates\": [\n                    [\n                        [-122.425, 37.785],\n                        [-122.405, 37.785],\n                        [-122.405, 37.770],\n                        [-122.425, 37.770],\n                        [-122.425, 37.785],\n                    ]\n                ],\n            },\n            \"properties\": {\"type\": \"service_area\", \"name\": \"Downtown Coverage Zone\"},\n        },\n    ],\n}\n\n# Load the transportation data into our transportation-themed map\nm2.load_draw_data(transport_data)\nprint(\"\ud83d\ude8c Transportation data loaded with custom styling:\")\nprint(\"\u2022 Golden bus stops\")\nprint(\"\u2022 Green bus route\")\nprint(\"\u2022 Red service coverage area\")\nprint(\"Try selecting and editing the features!\")\n\nm2\n</pre> # Test with the transportation themed map from earlier # Add different types of transportation data  transport_data = {     \"type\": \"FeatureCollection\",     \"features\": [         # Bus stops (points)         {             \"type\": \"Feature\",             \"geometry\": {\"type\": \"Point\", \"coordinates\": [-122.42, 37.775]},             \"properties\": {\"type\": \"bus_stop\", \"name\": \"Market St &amp; 5th St\"},         },         {             \"type\": \"Feature\",             \"geometry\": {\"type\": \"Point\", \"coordinates\": [-122.415, 37.78]},             \"properties\": {\"type\": \"bus_stop\", \"name\": \"Union Square\"},         },         # Bus route (line)         {             \"type\": \"Feature\",             \"geometry\": {                 \"type\": \"LineString\",                 \"coordinates\": [                     [-122.42, 37.775],                     [-122.415, 37.78],                     [-122.41, 37.782],                     [-122.405, 37.78],                 ],             },             \"properties\": {\"type\": \"bus_route\", \"name\": \"Route 38\"},         },         # Service area (polygon)         {             \"type\": \"Feature\",             \"geometry\": {                 \"type\": \"Polygon\",                 \"coordinates\": [                     [                         [-122.425, 37.785],                         [-122.405, 37.785],                         [-122.405, 37.770],                         [-122.425, 37.770],                         [-122.425, 37.785],                     ]                 ],             },             \"properties\": {\"type\": \"service_area\", \"name\": \"Downtown Coverage Zone\"},         },     ], }  # Load the transportation data into our transportation-themed map m2.load_draw_data(transport_data) print(\"\ud83d\ude8c Transportation data loaded with custom styling:\") print(\"\u2022 Golden bus stops\") print(\"\u2022 Green bus route\") print(\"\u2022 Red service coverage area\") print(\"Try selecting and editing the features!\")  m2 In\u00a0[\u00a0]: Copied! <pre># Display current draw data\ncurrent_data = m2.get_draw_data()\nprint(f\"\\nLoaded {len(m2._draw_data.get('features', []))} features with custom styling\")\n</pre> # Display current draw data current_data = m2.get_draw_data() print(f\"\\nLoaded {len(m2._draw_data.get('features', []))} features with custom styling\")"},{"location":"examples/maplibre/custom_draw_styles_example/#custom-draw-control-styling","title":"Custom Draw Control Styling\u00b6","text":"<p>This notebook demonstrates how to customize the appearance of draw control features using custom paint parameters and styling.</p>"},{"location":"examples/maplibre/custom_draw_styles_example/#features-covered","title":"Features Covered\u00b6","text":"<ul> <li>Custom Colors: Set different colors for points, lines, and polygons</li> <li>Style Parameters: Customize stroke width, fill opacity, and point radius</li> <li>Multiple Draw Controls: Use different styles for different purposes</li> <li>Easy Styling: Use the built-in <code>create_draw_styles()</code> helper method</li> </ul>"},{"location":"examples/maplibre/custom_draw_styles_example/#example-1-default-vs-custom-styles-comparison","title":"Example 1: Default vs Custom Styles Comparison\u00b6","text":"<p>Let's start by comparing the default styles with custom ones.</p>"},{"location":"examples/maplibre/custom_draw_styles_example/#example-2-themed-styles-for-different-use-cases","title":"Example 2: Themed Styles for Different Use Cases\u00b6","text":"<p>Different color schemes for different purposes.</p>"},{"location":"examples/maplibre/custom_draw_styles_example/#example-3-high-contrast-styles-for-accessibility","title":"Example 3: High Contrast Styles for Accessibility\u00b6","text":"<p>Bold, high-contrast styles for better visibility.</p>"},{"location":"examples/maplibre/custom_draw_styles_example/#example-4-loading-data-with-different-styled-controls","title":"Example 4: Loading Data with Different Styled Controls\u00b6","text":"<p>Show how features loaded via <code>add_draw_data</code> appear with custom styling.</p>"},{"location":"examples/maplibre/custom_draw_styles_example/#example-5-advanced-custom-styles-with-raw-style-objects","title":"Example 5: Advanced Custom Styles with Raw Style Objects\u00b6","text":"<p>For advanced users who want complete control over styling.</p>"},{"location":"examples/maplibre/custom_draw_styles_example/#example-6-testing-custom-styles-with-different-data","title":"Example 6: Testing Custom Styles with Different Data\u00b6","text":"<p>Let's test how the custom styling works with different types of loaded data.</p>"},{"location":"examples/maplibre/deckgl_pointcloud_example/","title":"Deckgl pointcloud example","text":"In\u00a0[\u00a0]: Copied! <pre>from anymap.maplibre import MapLibreMap\n</pre> from anymap.maplibre import MapLibreMap In\u00a0[\u00a0]: Copied! <pre># Create a MapLibre map centered on San Francisco\nm = MapLibreMap(\n    center=[-122.4, 37.74],\n    zoom=11,\n    pitch=45,  # Tilt the map for better 3D view\n    bearing=0,\n    style=\"https://tiles.openfreemap.org/styles/bright\",\n)\n\n# Add PointCloudLayer with data from URL\nm.add_deckgl_layer(\n    \"pointcloud\",\n    \"PointCloudLayer\",\n    \"https://raw.githubusercontent.com/visgl/deck.gl-data/master/website/pointcloud.json\",\n    props={\n        \"getPosition\": \"position\",\n        \"getColor\": \"color\",\n        \"getNormal\": \"normal\",\n        \"pointSize\": 2,\n        \"coordinateOrigin\": [-122.4, 37.74],\n        \"coordinateSystem\": \"COORDINATE_SYSTEM.METER_OFFSETS\",\n        \"pickable\": True,\n        \"opacity\": 0.8,\n    },\n)\n\n# Add layer control to toggle visibility\n# m.add_layer_control()\nm.to_html(\"pointcloud_example.html\", title=\"Point Cloud Visualization\")\nm\n</pre> # Create a MapLibre map centered on San Francisco m = MapLibreMap(     center=[-122.4, 37.74],     zoom=11,     pitch=45,  # Tilt the map for better 3D view     bearing=0,     style=\"https://tiles.openfreemap.org/styles/bright\", )  # Add PointCloudLayer with data from URL m.add_deckgl_layer(     \"pointcloud\",     \"PointCloudLayer\",     \"https://raw.githubusercontent.com/visgl/deck.gl-data/master/website/pointcloud.json\",     props={         \"getPosition\": \"position\",         \"getColor\": \"color\",         \"getNormal\": \"normal\",         \"pointSize\": 2,         \"coordinateOrigin\": [-122.4, 37.74],         \"coordinateSystem\": \"COORDINATE_SYSTEM.METER_OFFSETS\",         \"pickable\": True,         \"opacity\": 0.8,     }, )  # Add layer control to toggle visibility # m.add_layer_control() m.to_html(\"pointcloud_example.html\", title=\"Point Cloud Visualization\") m In\u00a0[\u00a0]: Copied! <pre>import numpy as np\n\n# Generate a simple 3D point cloud - a spiral\nn_points = 1000\nt = np.linspace(0, 4 * np.pi, n_points)\n\n# Create spiral in meter offsets\nx = 100 * np.cos(t) * (1 + t / (4 * np.pi))\ny = 100 * np.sin(t) * (1 + t / (4 * np.pi))\nz = 5 * t\n\n# Color gradient from blue to red based on height\ncolors = np.zeros((n_points, 3))\ncolors[:, 0] = (t / t.max() * 255).astype(int)  # Red increases with height\ncolors[:, 2] = ((1 - t / t.max()) * 255).astype(int)  # Blue decreases with height\n\n# Create data array\npoint_data = [\n    {\n        \"position\": [float(x[i]), float(y[i]), float(z[i])],\n        \"color\": [int(colors[i, 0]), int(colors[i, 1]), int(colors[i, 2])],\n        \"normal\": [0, 0, 1],  # Simple upward normals\n    }\n    for i in range(n_points)\n]\n\n# Create map\nm2 = MapLibreMap(\n    center=[-122.4, 37.74],\n    zoom=13,\n    pitch=60,\n    bearing=30,\n    style=\"https://tiles.openfreemap.org/styles/dark\",  # Dark style for better contrast\n)\n\n# Add the spiral point cloud\nm2.add_deckgl_layer(\n    \"spiral\",\n    \"PointCloudLayer\",\n    point_data,\n    props={\n        \"getPosition\": \"position\",\n        \"getColor\": \"color\",\n        \"getNormal\": \"normal\",\n        \"pointSize\": 3,\n        \"coordinateOrigin\": [-122.4, 37.74],\n        \"coordinateSystem\": \"COORDINATE_SYSTEM.METER_OFFSETS\",\n        \"pickable\": True,\n        \"opacity\": 0.9,\n    },\n)\n\nm2.add_layer_control()\n\nm2\n</pre> import numpy as np  # Generate a simple 3D point cloud - a spiral n_points = 1000 t = np.linspace(0, 4 * np.pi, n_points)  # Create spiral in meter offsets x = 100 * np.cos(t) * (1 + t / (4 * np.pi)) y = 100 * np.sin(t) * (1 + t / (4 * np.pi)) z = 5 * t  # Color gradient from blue to red based on height colors = np.zeros((n_points, 3)) colors[:, 0] = (t / t.max() * 255).astype(int)  # Red increases with height colors[:, 2] = ((1 - t / t.max()) * 255).astype(int)  # Blue decreases with height  # Create data array point_data = [     {         \"position\": [float(x[i]), float(y[i]), float(z[i])],         \"color\": [int(colors[i, 0]), int(colors[i, 1]), int(colors[i, 2])],         \"normal\": [0, 0, 1],  # Simple upward normals     }     for i in range(n_points) ]  # Create map m2 = MapLibreMap(     center=[-122.4, 37.74],     zoom=13,     pitch=60,     bearing=30,     style=\"https://tiles.openfreemap.org/styles/dark\",  # Dark style for better contrast )  # Add the spiral point cloud m2.add_deckgl_layer(     \"spiral\",     \"PointCloudLayer\",     point_data,     props={         \"getPosition\": \"position\",         \"getColor\": \"color\",         \"getNormal\": \"normal\",         \"pointSize\": 3,         \"coordinateOrigin\": [-122.4, 37.74],         \"coordinateSystem\": \"COORDINATE_SYSTEM.METER_OFFSETS\",         \"pickable\": True,         \"opacity\": 0.9,     }, )  m2.add_layer_control()  m2 In\u00a0[\u00a0]: Copied! <pre># Generate a grid of points with varying heights\ngrid_size = 30\nspacing = 20  # meters between points\n\ngrid_data = []\nfor i in range(grid_size):\n    for j in range(grid_size):\n        x = (i - grid_size / 2) * spacing\n        y = (j - grid_size / 2) * spacing\n        # Create wave pattern for height\n        z = 30 * np.sin(i / 3) * np.cos(j / 3) + 50\n\n        # Color based on height\n        height_norm = (z + 20) / 90  # Normalize to 0-1\n        color = [\n            int(255 * height_norm),\n            int(100 + 155 * (1 - height_norm)),\n            int(255 * (1 - height_norm)),\n        ]\n\n        grid_data.append(\n            {\n                \"position\": [float(x), float(y), float(z)],\n                \"color\": color,\n                \"normal\": [0, 0, 1],\n            }\n        )\n\n# Create map with the grid\nm3 = MapLibreMap(\n    center=[-73.935242, 40.730610],  # New York\n    zoom=14,\n    pitch=70,\n    bearing=45,\n    style=\"https://tiles.openfreemap.org/styles/liberty\",\n)\n\nm3.add_deckgl_layer(\n    \"grid\",\n    \"PointCloudLayer\",\n    grid_data,\n    props={\n        \"getPosition\": \"position\",\n        \"getColor\": \"color\",\n        \"getNormal\": \"normal\",\n        \"pointSize\": 4,\n        \"coordinateOrigin\": [-73.935242, 40.730610],\n        \"coordinateSystem\": \"COORDINATE_SYSTEM.METER_OFFSETS\",\n        \"pickable\": True,\n        \"material\": {\n            \"ambient\": 0.5,\n            \"diffuse\": 0.8,\n            \"shininess\": 32,\n            \"specularColor\": [255, 255, 255],\n        },\n    },\n)\n\nm3.add_layer_control()\n\nm3\n</pre> # Generate a grid of points with varying heights grid_size = 30 spacing = 20  # meters between points  grid_data = [] for i in range(grid_size):     for j in range(grid_size):         x = (i - grid_size / 2) * spacing         y = (j - grid_size / 2) * spacing         # Create wave pattern for height         z = 30 * np.sin(i / 3) * np.cos(j / 3) + 50          # Color based on height         height_norm = (z + 20) / 90  # Normalize to 0-1         color = [             int(255 * height_norm),             int(100 + 155 * (1 - height_norm)),             int(255 * (1 - height_norm)),         ]          grid_data.append(             {                 \"position\": [float(x), float(y), float(z)],                 \"color\": color,                 \"normal\": [0, 0, 1],             }         )  # Create map with the grid m3 = MapLibreMap(     center=[-73.935242, 40.730610],  # New York     zoom=14,     pitch=70,     bearing=45,     style=\"https://tiles.openfreemap.org/styles/liberty\", )  m3.add_deckgl_layer(     \"grid\",     \"PointCloudLayer\",     grid_data,     props={         \"getPosition\": \"position\",         \"getColor\": \"color\",         \"getNormal\": \"normal\",         \"pointSize\": 4,         \"coordinateOrigin\": [-73.935242, 40.730610],         \"coordinateSystem\": \"COORDINATE_SYSTEM.METER_OFFSETS\",         \"pickable\": True,         \"material\": {             \"ambient\": 0.5,             \"diffuse\": 0.8,             \"shininess\": 32,             \"specularColor\": [255, 255, 255],         },     }, )  m3.add_layer_control()  m3 In\u00a0[\u00a0]: Copied! <pre># Create a map\nm4 = MapLibreMap(\n    center=[0, 0],\n    zoom=12,\n    pitch=55,\n    bearing=0,\n    style=\"https://tiles.openfreemap.org/styles/positron\",\n)\n\n# First point cloud - red sphere\nn_sphere = 500\nphi = np.random.uniform(0, 2 * np.pi, n_sphere)\ntheta = np.random.uniform(0, np.pi, n_sphere)\nradius = 200\n\nsphere_data = [\n    {\n        \"position\": [\n            float(radius * np.sin(theta[i]) * np.cos(phi[i]) - 300),\n            float(radius * np.sin(theta[i]) * np.sin(phi[i])),\n            float(radius * np.cos(theta[i]) + 100),\n        ],\n        \"color\": [255, 50, 50],\n        \"normal\": [\n            float(np.sin(theta[i]) * np.cos(phi[i])),\n            float(np.sin(theta[i]) * np.sin(phi[i])),\n            float(np.cos(theta[i])),\n        ],\n    }\n    for i in range(n_sphere)\n]\n\n# Second point cloud - blue sphere\nsphere_data2 = [\n    {\n        \"position\": [\n            float(radius * np.sin(theta[i]) * np.cos(phi[i]) + 300),\n            float(radius * np.sin(theta[i]) * np.sin(phi[i])),\n            float(radius * np.cos(theta[i]) + 100),\n        ],\n        \"color\": [50, 50, 255],\n        \"normal\": [\n            float(np.sin(theta[i]) * np.cos(phi[i])),\n            float(np.sin(theta[i]) * np.sin(phi[i])),\n            float(np.cos(theta[i])),\n        ],\n    }\n    for i in range(n_sphere)\n]\n\n# Add both layers\nm4.add_deckgl_layer(\n    \"red-sphere\",\n    \"PointCloudLayer\",\n    sphere_data,\n    props={\n        \"getPosition\": \"position\",\n        \"getColor\": \"color\",\n        \"getNormal\": \"normal\",\n        \"pointSize\": 3,\n        \"coordinateOrigin\": [0, 0],\n        \"coordinateSystem\": \"COORDINATE_SYSTEM.METER_OFFSETS\",\n        \"pickable\": True,\n        \"material\": {\"ambient\": 0.4, \"diffuse\": 0.8, \"shininess\": 32},\n    },\n)\n\nm4.add_deckgl_layer(\n    \"blue-sphere\",\n    \"PointCloudLayer\",\n    sphere_data2,\n    props={\n        \"getPosition\": \"position\",\n        \"getColor\": \"color\",\n        \"getNormal\": \"normal\",\n        \"pointSize\": 3,\n        \"coordinateOrigin\": [0, 0],\n        \"coordinateSystem\": \"COORDINATE_SYSTEM.METER_OFFSETS\",\n        \"pickable\": True,\n        \"material\": {\"ambient\": 0.4, \"diffuse\": 0.8, \"shininess\": 32},\n    },\n)\n\n# Add layer control to toggle individual layers\nm4.add_layer_control()\n\nm4\n</pre> # Create a map m4 = MapLibreMap(     center=[0, 0],     zoom=12,     pitch=55,     bearing=0,     style=\"https://tiles.openfreemap.org/styles/positron\", )  # First point cloud - red sphere n_sphere = 500 phi = np.random.uniform(0, 2 * np.pi, n_sphere) theta = np.random.uniform(0, np.pi, n_sphere) radius = 200  sphere_data = [     {         \"position\": [             float(radius * np.sin(theta[i]) * np.cos(phi[i]) - 300),             float(radius * np.sin(theta[i]) * np.sin(phi[i])),             float(radius * np.cos(theta[i]) + 100),         ],         \"color\": [255, 50, 50],         \"normal\": [             float(np.sin(theta[i]) * np.cos(phi[i])),             float(np.sin(theta[i]) * np.sin(phi[i])),             float(np.cos(theta[i])),         ],     }     for i in range(n_sphere) ]  # Second point cloud - blue sphere sphere_data2 = [     {         \"position\": [             float(radius * np.sin(theta[i]) * np.cos(phi[i]) + 300),             float(radius * np.sin(theta[i]) * np.sin(phi[i])),             float(radius * np.cos(theta[i]) + 100),         ],         \"color\": [50, 50, 255],         \"normal\": [             float(np.sin(theta[i]) * np.cos(phi[i])),             float(np.sin(theta[i]) * np.sin(phi[i])),             float(np.cos(theta[i])),         ],     }     for i in range(n_sphere) ]  # Add both layers m4.add_deckgl_layer(     \"red-sphere\",     \"PointCloudLayer\",     sphere_data,     props={         \"getPosition\": \"position\",         \"getColor\": \"color\",         \"getNormal\": \"normal\",         \"pointSize\": 3,         \"coordinateOrigin\": [0, 0],         \"coordinateSystem\": \"COORDINATE_SYSTEM.METER_OFFSETS\",         \"pickable\": True,         \"material\": {\"ambient\": 0.4, \"diffuse\": 0.8, \"shininess\": 32},     }, )  m4.add_deckgl_layer(     \"blue-sphere\",     \"PointCloudLayer\",     sphere_data2,     props={         \"getPosition\": \"position\",         \"getColor\": \"color\",         \"getNormal\": \"normal\",         \"pointSize\": 3,         \"coordinateOrigin\": [0, 0],         \"coordinateSystem\": \"COORDINATE_SYSTEM.METER_OFFSETS\",         \"pickable\": True,         \"material\": {\"ambient\": 0.4, \"diffuse\": 0.8, \"shininess\": 32},     }, )  # Add layer control to toggle individual layers m4.add_layer_control()  m4 In\u00a0[\u00a0]: Copied! <pre># Toggle visibility of the red sphere\nm4.set_deckgl_layer_visibility(\"red-sphere\", False)\n\n# Show it again\nm4.set_deckgl_layer_visibility(\"red-sphere\", True)\n\n# Get information about current DeckGL layers\nprint(\"Current DeckGL layers:\", list(m4.get_deckgl_layers().keys()))\n</pre> # Toggle visibility of the red sphere m4.set_deckgl_layer_visibility(\"red-sphere\", False)  # Show it again m4.set_deckgl_layer_visibility(\"red-sphere\", True)  # Get information about current DeckGL layers print(\"Current DeckGL layers:\", list(m4.get_deckgl_layers().keys())) In\u00a0[\u00a0]: Copied! <pre># Export the multi-sphere example\nm4.to_html(\"pointcloud_example.html\", title=\"Point Cloud Visualization\")\nprint(\"Map exported to pointcloud_example.html\")\n</pre> # Export the multi-sphere example m4.to_html(\"pointcloud_example.html\", title=\"Point Cloud Visualization\") print(\"Map exported to pointcloud_example.html\") In\u00a0[\u00a0]: Copied! <pre># Create a map for LAZ point cloud visualization\nm5 = MapLibreMap(\n    center=[-123.068674, 44.055334],  # Autzen Stadium area, Eugene, Oregon\n    zoom=16,\n    pitch=60,\n    bearing=0,\n    style=\"https://tiles.openfreemap.org/styles/liberty\",\n)\n\n# Add PointCloudLayer with LAZ data\n# The LAZ file will be loaded using @loaders.gl/las which DeckGL includes\nm5.add_deckgl_layer(\n    \"lidar-laz\",\n    \"PointCloudLayer\",\n    \"https://raw.githubusercontent.com/visgl/deck.gl-data/master/examples/point-cloud-laz/indoor.0.1.laz\",\n    props={\n        # For LAZ files loaded by loaders.gl, we don't specify accessors\n        # The loader automatically provides position and color data\n        \"getNormal\": [0, 0, 1],  # Default normal vector\n        \"pointSize\": 1,\n        \"sizeUnits\": \"pixels\",\n        # LAZ files use absolute coordinates, not offset coordinates\n        \"coordinateSystem\": \"COORDINATE_SYSTEM.LNGLAT\",\n        \"pickable\": True,\n        \"opacity\": 1.0,\n        # Material properties for better 3D appearance\n        \"material\": {\n            \"ambient\": 0.35,\n            \"diffuse\": 0.6,\n            \"shininess\": 32,\n            \"specularColor\": [60, 64, 70],\n        },\n    },\n)\n\nm5.add_layer_control()\nm5.to_html(\"lidar.html\")\n\nprint(\"LAZ file will be loaded automatically by DeckGL's loaders.gl\")\nprint(\"This may take a moment depending on file size and network speed\")\n\nm5\n</pre> # Create a map for LAZ point cloud visualization m5 = MapLibreMap(     center=[-123.068674, 44.055334],  # Autzen Stadium area, Eugene, Oregon     zoom=16,     pitch=60,     bearing=0,     style=\"https://tiles.openfreemap.org/styles/liberty\", )  # Add PointCloudLayer with LAZ data # The LAZ file will be loaded using @loaders.gl/las which DeckGL includes m5.add_deckgl_layer(     \"lidar-laz\",     \"PointCloudLayer\",     \"https://raw.githubusercontent.com/visgl/deck.gl-data/master/examples/point-cloud-laz/indoor.0.1.laz\",     props={         # For LAZ files loaded by loaders.gl, we don't specify accessors         # The loader automatically provides position and color data         \"getNormal\": [0, 0, 1],  # Default normal vector         \"pointSize\": 1,         \"sizeUnits\": \"pixels\",         # LAZ files use absolute coordinates, not offset coordinates         \"coordinateSystem\": \"COORDINATE_SYSTEM.LNGLAT\",         \"pickable\": True,         \"opacity\": 1.0,         # Material properties for better 3D appearance         \"material\": {             \"ambient\": 0.35,             \"diffuse\": 0.6,             \"shininess\": 32,             \"specularColor\": [60, 64, 70],         },     }, )  m5.add_layer_control() m5.to_html(\"lidar.html\")  print(\"LAZ file will be loaded automatically by DeckGL's loaders.gl\") print(\"This may take a moment depending on file size and network speed\")  m5"},{"location":"examples/maplibre/deckgl_pointcloud_example/#deckgl-point-cloud-layer-example","title":"DeckGL Point Cloud Layer Example\u00b6","text":"<p>This notebook demonstrates how to visualize 3D point cloud data using DeckGL's PointCloudLayer integrated with MapLibre in anymap.</p> <p>The PointCloudLayer is perfect for visualizing large sets of 3D points with color and normal information, such as LiDAR data, 3D scans, or any spatial point cloud dataset.</p>"},{"location":"examples/maplibre/deckgl_pointcloud_example/#installation","title":"Installation\u00b6","text":"<pre>pip install anymap\n</pre>"},{"location":"examples/maplibre/deckgl_pointcloud_example/#example-1-point-cloud-from-url","title":"Example 1: Point Cloud from URL\u00b6","text":"<p>This example loads a point cloud dataset from a remote URL. The dataset contains position, color, and normal information for each point.</p>"},{"location":"examples/maplibre/deckgl_pointcloud_example/#example-2-simple-point-cloud-with-custom-data","title":"Example 2: Simple Point Cloud with Custom Data\u00b6","text":"<p>Create a simple point cloud from scratch with custom data.</p>"},{"location":"examples/maplibre/deckgl_pointcloud_example/#example-3-point-cloud-grid","title":"Example 3: Point Cloud Grid\u00b6","text":"<p>Create a grid-based point cloud with varying heights.</p>"},{"location":"examples/maplibre/deckgl_pointcloud_example/#example-4-multiple-point-cloud-layers","title":"Example 4: Multiple Point Cloud Layers\u00b6","text":"<p>Demonstrate multiple point cloud layers on the same map with different colors and sizes.</p>"},{"location":"examples/maplibre/deckgl_pointcloud_example/#controlling-point-cloud-layers","title":"Controlling Point Cloud Layers\u00b6","text":"<p>You can control the visibility of point cloud layers programmatically:</p>"},{"location":"examples/maplibre/deckgl_pointcloud_example/#export-to-html","title":"Export to HTML\u00b6","text":"<p>You can export any map with point cloud layers to a standalone HTML file:</p>"},{"location":"examples/maplibre/deckgl_pointcloud_example/#key-parameters-for-pointcloudlayer","title":"Key Parameters for PointCloudLayer\u00b6","text":"<p>Basic Properties:</p> <ul> <li>data: Point cloud data as array of objects, GeoJSON, or URL to LAZ/other formats</li> <li>getPosition: Accessor for point positions (x, y, z) - not needed for LAZ files</li> <li>getColor: Accessor for point colors (RGB or RGBA) - not needed for LAZ files</li> <li>getNormal: Accessor for surface normals (for lighting) - can be constant for LAZ</li> </ul> <p>Rendering Properties:</p> <ul> <li>pointSize: Size of each point in pixels or meters</li> <li>sizeUnits: 'pixels' (default) or 'meters'</li> <li>opacity: Layer opacity (0-1)</li> <li>pickable: Whether points can be selected/clicked</li> </ul> <p>Coordinate Systems:</p> <ul> <li>LNGLAT: Geographic coordinates (longitude, latitude) - use for LAZ files</li> <li>METER_OFFSETS: Local meter offsets from origin - use for custom data</li> <li>coordinateOrigin: Origin point for METER_OFFSETS system</li> </ul> <p>Material Properties (for 3D lighting):</p> <ul> <li>ambient: Ambient light factor (0-1)</li> <li>diffuse: Diffuse light factor (0-1)</li> <li>shininess: Surface shininess (0-128)</li> <li>specularColor: Color of specular highlights [R, G, B]</li> </ul> <p>LAZ-Specific: When loading LAZ files, you typically only need:</p> <pre>props={\n    \"getNormal\": [0, 0, 1],\n    \"pointSize\": 1,\n    \"coordinateSystem\": \"COORDINATE_SYSTEM.LNGLAT\",\n    \"material\": {...}  # Optional\n}\n</pre> <p>For more details, see:</p> <ul> <li>DeckGL PointCloudLayer documentation</li> <li>Loaders.gl LAS/LAZ loader</li> </ul>"},{"location":"examples/maplibre/deckgl_pointcloud_example/#laz-format-notes","title":"LAZ Format Notes\u00b6","text":"<p>What is LAZ?</p> <ul> <li>LAZ is a compressed version of the LAS format (LASer)</li> <li>Commonly used for LiDAR point cloud data</li> <li>Can contain millions of points with position, color, intensity, and classification data</li> <li>Typical file sizes: 10-100MB compressed (100s of MB uncompressed)</li> </ul> <p>How DeckGL Handles LAZ:</p> <ul> <li>DeckGL uses <code>@loaders.gl/las</code> library (included in deck.gl distribution)</li> <li>The loader runs in a Web Worker for non-blocking loading</li> <li>Automatically extracts position, color, and other attributes</li> <li>Supports streaming for large files</li> <li>Important: anymap automatically enables <code>fp64</code> (64-bit float precision) for LAZ files to ensure proper 3D elevation rendering with geographic coordinates</li> </ul> <p>3D Elevation with LAZ Files:</p> <ul> <li>LAZ files contain [longitude, latitude, elevation] coordinates</li> <li>By default, deck.gl uses 32-bit floats which can cause precision issues</li> <li>This results in point clouds appearing flat (no vertical variation)</li> <li>anymap automatically fixes this by enabling <code>fp64: true</code> in the loader options</li> <li>This ensures Z-coordinates (elevation) are properly rendered in 3D space</li> </ul> <p>Performance Tips:</p> <ul> <li>LAZ files with millions of points may take 10-60 seconds to load</li> <li>Consider using <code>pointSize: 1</code> for dense datasets</li> <li>Adjust <code>opacity</code> if points overlap significantly</li> <li>Use <code>material</code> properties for better 3D visualization</li> </ul> <p>Common Issues:</p> <ul> <li>CORS errors: Ensure LAZ file is served with proper CORS headers</li> <li>File not loading: Check browser console for errors</li> <li>Slow loading: Large files may need time; check network tab in DevTools</li> <li>Memory issues: Very large files (&gt;200MB) may cause browser slowdown</li> <li>Flat appearance: Fixed automatically by anymap's fp64 precision mode</li> </ul>"},{"location":"examples/maplibre/deckgl_pointcloud_example/#using-local-laz-files","title":"Using Local LAZ Files\u00b6","text":"<p>If you have a local LAZ file (like the Autzen dataset), you can serve it and use it in your map. Here's how:</p> <ol> <li>Serve the file locally using Python's built-in HTTP server:</li> </ol> <pre># In the directory containing your LAZ file\npython -m http.server 8000\n</pre> <ol> <li>Reference the local file in your map:</li> </ol> <pre>m_local = MapLibreMap(center=[-123.075, 44.05], zoom=16, pitch=60)\nm_local.add_deckgl_layer(\n    \"local-lidar\",\n    \"PointCloudLayer\",\n    \"http://localhost:8000/autzen.laz\",  # Your local LAZ file\n    props={\n        \"getNormal\": [0, 0, 1],\n        \"pointSize\": 1,\n        \"coordinateSystem\": \"COORDINATE_SYSTEM.LNGLAT\",\n        \"pickable\": True,\n    }\n)\n</pre> <p>Alternative: Use publicly available LAZ datasets:</p> <ul> <li>USGS 3DEP LiDAR: https://www.usgs.gov/3d-elevation-program</li> <li>OpenTopography: https://opentopography.org/</li> <li>Various city open data portals often provide LiDAR in LAZ format</li> </ul>"},{"location":"examples/maplibre/deckgl_pointcloud_example/#example-5-lidar-point-cloud-from-laz-format","title":"Example 5: LiDAR Point Cloud from LAZ Format\u00b6","text":"<p>This example demonstrates loading LiDAR data from a LAZ (LASzip compressed) file. LAZ is a compressed format commonly used for LiDAR point cloud data.</p> <p>Note: For LAZ support in web browsers, DeckGL uses the <code>@loaders.gl/las</code> loader which is loaded automatically. The LAZ file should be accessible via URL.</p> <p>For this example, we'll use a publicly available LAZ dataset. You can also use local LAZ files by serving them with a local web server.</p>"},{"location":"examples/maplibre/draw_control_example/","title":"Draw control example","text":"In\u00a0[\u00a0]: Copied! <pre># Import required modules\nfrom anymap import MapLibreMap\nimport json\n\nprint(\"AnyMap loaded successfully!\")\nprint(\"Draw control support is built into the MapLibre implementation.\")\n</pre> # Import required modules from anymap import MapLibreMap import json  print(\"AnyMap loaded successfully!\") print(\"Draw control support is built into the MapLibre implementation.\") In\u00a0[\u00a0]: Copied! <pre># Create a map\nm = MapLibreMap(\n    center=[40.7749, -122.4194],  # San Francisco coordinates\n    zoom=12,\n    height=\"600px\",\n    style=\"positron\",\n)\n\n# Add draw control with default settings\nm.add_draw_control()\n\nprint(\"Draw control added with default settings\")\nprint(\"You can now draw points, lines, and polygons on the map!\")\nm\n</pre> # Create a map m = MapLibreMap(     center=[40.7749, -122.4194],  # San Francisco coordinates     zoom=12,     height=\"600px\",     style=\"positron\", )  # Add draw control with default settings m.add_draw_control()  print(\"Draw control added with default settings\") print(\"You can now draw points, lines, and polygons on the map!\") m <p>Instructions for the map above:</p> <ul> <li>Use the point tool (\ud83d\udccd) to add points</li> <li>Use the line tool (\ud83d\udccf) to draw lines</li> <li>Use the polygon tool (\ud83d\udd37) to draw polygons</li> <li>Use the trash tool (\ud83d\uddd1\ufe0f) to delete selected features</li> <li>Click and drag to select and move features</li> </ul> In\u00a0[\u00a0]: Copied! <pre># Create a new map for custom configuration\nm2 = MapLibreMap(\n    center=[40.7749, -122.4194], zoom=13, height=\"600px\", style=\"dark-matter\"\n)\n\n# Add draw control with custom configuration\nm2.add_draw_control(\n    position=\"top-right\",  # Position the control on the top-right\n    controls={\n        \"point\": True,  # Enable point drawing\n        \"line_string\": False,  # Disable line drawing\n        \"polygon\": True,  # Enable polygon drawing\n        \"trash\": True,  # Enable delete tool\n    },\n    default_mode=\"draw_polygon\",  # Start in polygon drawing mode\n    keybindings=True,  # Enable keyboard shortcuts\n    touch_enabled=True,  # Enable touch interactions\n)\n\nprint(\"Custom draw control added:\")\nprint(\"- Position: top-right\")\nprint(\"- Tools: points and polygons only\")\nprint(\"- Default mode: polygon drawing\")\nm2\n</pre> # Create a new map for custom configuration m2 = MapLibreMap(     center=[40.7749, -122.4194], zoom=13, height=\"600px\", style=\"dark-matter\" )  # Add draw control with custom configuration m2.add_draw_control(     position=\"top-right\",  # Position the control on the top-right     controls={         \"point\": True,  # Enable point drawing         \"line_string\": False,  # Disable line drawing         \"polygon\": True,  # Enable polygon drawing         \"trash\": True,  # Enable delete tool     },     default_mode=\"draw_polygon\",  # Start in polygon drawing mode     keybindings=True,  # Enable keyboard shortcuts     touch_enabled=True,  # Enable touch interactions )  print(\"Custom draw control added:\") print(\"- Position: top-right\") print(\"- Tools: points and polygons only\") print(\"- Default mode: polygon drawing\") m2 In\u00a0[\u00a0]: Copied! <pre># Create sample GeoJSON data\nsample_geojson = {\n    \"type\": \"FeatureCollection\",\n    \"features\": [\n        {\n            \"type\": \"Feature\",\n            \"geometry\": {\"type\": \"Point\", \"coordinates\": [-122.4194, 37.7749]},\n            \"properties\": {\"name\": \"San Francisco City Hall\", \"type\": \"landmark\"},\n        },\n        {\n            \"type\": \"Feature\",\n            \"geometry\": {\n                \"type\": \"Polygon\",\n                \"coordinates\": [\n                    [\n                        [-122.4200, 37.7700],\n                        [-122.4150, 37.7700],\n                        [-122.4150, 37.7750],\n                        [-122.4200, 37.7750],\n                        [-122.4200, 37.7700],\n                    ]\n                ],\n            },\n            \"properties\": {\"name\": \"Sample Area\", \"type\": \"area\"},\n        },\n        {\n            \"type\": \"Feature\",\n            \"geometry\": {\n                \"type\": \"LineString\",\n                \"coordinates\": [\n                    [-122.4180, 37.7720],\n                    [-122.4160, 37.7740],\n                    [-122.4140, 37.7730],\n                ],\n            },\n            \"properties\": {\"name\": \"Sample Route\", \"type\": \"route\"},\n        },\n    ],\n}\n\n# Create a new map\nm3 = MapLibreMap(center=[37.7749, -122.4194], zoom=14, height=\"600px\", style=\"voyager\")\n\n# Add draw control\nm3.add_draw_control(position=\"top-left\")\n\n# Load the sample GeoJSON data\nm3.load_draw_data(sample_geojson)\n\nprint(\"Loaded sample GeoJSON data:\")\nprint(\"- 1 Point (City Hall)\")\nprint(\"- 1 Polygon (Sample Area)\")\nprint(\"- 1 LineString (Sample Route)\")\nprint(\"\\nYou can now edit these existing features or draw new ones!\")\nm3\n</pre> # Create sample GeoJSON data sample_geojson = {     \"type\": \"FeatureCollection\",     \"features\": [         {             \"type\": \"Feature\",             \"geometry\": {\"type\": \"Point\", \"coordinates\": [-122.4194, 37.7749]},             \"properties\": {\"name\": \"San Francisco City Hall\", \"type\": \"landmark\"},         },         {             \"type\": \"Feature\",             \"geometry\": {                 \"type\": \"Polygon\",                 \"coordinates\": [                     [                         [-122.4200, 37.7700],                         [-122.4150, 37.7700],                         [-122.4150, 37.7750],                         [-122.4200, 37.7750],                         [-122.4200, 37.7700],                     ]                 ],             },             \"properties\": {\"name\": \"Sample Area\", \"type\": \"area\"},         },         {             \"type\": \"Feature\",             \"geometry\": {                 \"type\": \"LineString\",                 \"coordinates\": [                     [-122.4180, 37.7720],                     [-122.4160, 37.7740],                     [-122.4140, 37.7730],                 ],             },             \"properties\": {\"name\": \"Sample Route\", \"type\": \"route\"},         },     ], }  # Create a new map m3 = MapLibreMap(center=[37.7749, -122.4194], zoom=14, height=\"600px\", style=\"voyager\")  # Add draw control m3.add_draw_control(position=\"top-left\")  # Load the sample GeoJSON data m3.load_draw_data(sample_geojson)  print(\"Loaded sample GeoJSON data:\") print(\"- 1 Point (City Hall)\") print(\"- 1 Polygon (Sample Area)\") print(\"- 1 LineString (Sample Route)\") print(\"\\nYou can now edit these existing features or draw new ones!\") m3 In\u00a0[\u00a0]: Copied! <pre># Note: In a real Jupyter environment, you would draw some features on the map above\n# then run this cell to get the drawn data\n\n# Trigger retrieval of draw data\ndraw_data = m3.get_draw_data()\n\n# The actual data will be available in the _draw_data trait\nprint(\"Draw data retrieval triggered.\")\nprint(\"In a real environment, drawn features would be available in m3._draw_data\")\n\n# You can also access it directly (this will be empty until features are drawn)\ncurrent_draw_data = m3._draw_data\nprint(f\"Current draw data: {current_draw_data}\")\n</pre> # Note: In a real Jupyter environment, you would draw some features on the map above # then run this cell to get the drawn data  # Trigger retrieval of draw data draw_data = m3.get_draw_data()  # The actual data will be available in the _draw_data trait print(\"Draw data retrieval triggered.\") print(\"In a real environment, drawn features would be available in m3._draw_data\")  # You can also access it directly (this will be empty until features are drawn) current_draw_data = m3._draw_data print(f\"Current draw data: {current_draw_data}\") In\u00a0[\u00a0]: Copied! <pre># Set different drawing modes\nprint(\"Available drawing modes:\")\nprint(\"- simple_select: Select and edit features\")\nprint(\"- direct_select: Edit vertices of selected features\")\nprint(\"- draw_point: Draw points\")\nprint(\"- draw_line_string: Draw lines\")\nprint(\"- draw_polygon: Draw polygons\")\nprint(\"- static: Disable all interactions\")\n\n# Set the draw mode to polygon drawing\nm3.set_draw_mode(\"draw_polygon\")\nprint(\"\\n\u2713 Set mode to polygon drawing\")\n\n# You can change modes programmatically\nprint(\"\\nTry drawing a polygon, then run the next cell to switch to point mode\")\n</pre> # Set different drawing modes print(\"Available drawing modes:\") print(\"- simple_select: Select and edit features\") print(\"- direct_select: Edit vertices of selected features\") print(\"- draw_point: Draw points\") print(\"- draw_line_string: Draw lines\") print(\"- draw_polygon: Draw polygons\") print(\"- static: Disable all interactions\")  # Set the draw mode to polygon drawing m3.set_draw_mode(\"draw_polygon\") print(\"\\n\u2713 Set mode to polygon drawing\")  # You can change modes programmatically print(\"\\nTry drawing a polygon, then run the next cell to switch to point mode\") In\u00a0[\u00a0]: Copied! <pre># Switch to point drawing mode\nm3.set_draw_mode(\"draw_point\")\nprint(\"\u2713 Switched to point drawing mode\")\n</pre> # Switch to point drawing mode m3.set_draw_mode(\"draw_point\") print(\"\u2713 Switched to point drawing mode\") In\u00a0[\u00a0]: Copied! <pre># Create a map with some initial data for demonstration\nm4 = MapLibreMap(center=[37.7749, -122.4194], zoom=13, height=\"600px\", style=\"streets\")\n\n# Add draw control\nm4.add_draw_control()\n\n# Load some test data\ntest_data = {\n    \"type\": \"FeatureCollection\",\n    \"features\": [\n        {\n            \"type\": \"Feature\",\n            \"geometry\": {\"type\": \"Point\", \"coordinates\": [-122.4194, 37.7749]},\n            \"properties\": {\"name\": \"Point 1\"},\n        },\n        {\n            \"type\": \"Feature\",\n            \"geometry\": {\"type\": \"Point\", \"coordinates\": [-122.4150, 37.7700]},\n            \"properties\": {\"name\": \"Point 2\"},\n        },\n    ],\n}\n\nm4.load_draw_data(test_data)\nprint(\"Loaded test data with 2 points\")\nprint(\"Try drawing some additional features, then run the cell below to test deletion\")\nm4\n</pre> # Create a map with some initial data for demonstration m4 = MapLibreMap(center=[37.7749, -122.4194], zoom=13, height=\"600px\", style=\"streets\")  # Add draw control m4.add_draw_control()  # Load some test data test_data = {     \"type\": \"FeatureCollection\",     \"features\": [         {             \"type\": \"Feature\",             \"geometry\": {\"type\": \"Point\", \"coordinates\": [-122.4194, 37.7749]},             \"properties\": {\"name\": \"Point 1\"},         },         {             \"type\": \"Feature\",             \"geometry\": {\"type\": \"Point\", \"coordinates\": [-122.4150, 37.7700]},             \"properties\": {\"name\": \"Point 2\"},         },     ], }  m4.load_draw_data(test_data) print(\"Loaded test data with 2 points\") print(\"Try drawing some additional features, then run the cell below to test deletion\") m4 In\u00a0[\u00a0]: Copied! <pre># Clear all drawn features\nm4.clear_draw_data()\nprint(\"\u2713 Cleared all drawn features\")\n\n# Note: In a real scenario, you could also delete specific features by ID:\n# m4.delete_draw_features(['feature_id_1', 'feature_id_2'])\nprint(\"\\nTo delete specific features, you would use:\")\nprint(\"m4.delete_draw_features(['feature_id_1', 'feature_id_2'])\")\n</pre> # Clear all drawn features m4.clear_draw_data() print(\"\u2713 Cleared all drawn features\")  # Note: In a real scenario, you could also delete specific features by ID: # m4.delete_draw_features(['feature_id_1', 'feature_id_2']) print(\"\\nTo delete specific features, you would use:\") print(\"m4.delete_draw_features(['feature_id_1', 'feature_id_2'])\") In\u00a0[\u00a0]: Copied! <pre># Create a final map for HTML export\nexport_map = MapLibreMap(\n    center=[37.7749, -122.4194], zoom=12, height=\"600px\", style=\"satellite\"\n)\n\n# Add draw control\nexport_map.add_draw_control(\n    position=\"top-right\",\n    controls={\"point\": True, \"line_string\": True, \"polygon\": True, \"trash\": True},\n)\n\n# Load some sample data\nexport_map.load_draw_data(sample_geojson)\n\n# Export to HTML\nexport_map.to_html(\n    \"san_francisco_draw_map.html\", title=\"San Francisco Draw Control Demo\"\n)\n\nprint(\"Map exported to 'san_francisco_draw_map.html'\")\nprint(\n    \"The HTML file includes draw control functionality and can be opened in any browser\"\n)\nexport_map\n</pre> # Create a final map for HTML export export_map = MapLibreMap(     center=[37.7749, -122.4194], zoom=12, height=\"600px\", style=\"satellite\" )  # Add draw control export_map.add_draw_control(     position=\"top-right\",     controls={\"point\": True, \"line_string\": True, \"polygon\": True, \"trash\": True}, )  # Load some sample data export_map.load_draw_data(sample_geojson)  # Export to HTML export_map.to_html(     \"san_francisco_draw_map.html\", title=\"San Francisco Draw Control Demo\" )  print(\"Map exported to 'san_francisco_draw_map.html'\") print(     \"The HTML file includes draw control functionality and can be opened in any browser\" ) export_map"},{"location":"examples/maplibre/draw_control_example/#draw-control-support-in-anymap","title":"Draw Control Support in AnyMap\u00b6","text":"<p>This notebook demonstrates how to use the draw control functionality with the MapLibre implementation in AnyMap. The draw control allows users to interactively draw and edit geometries on the map.</p>"},{"location":"examples/maplibre/draw_control_example/#what-is-the-draw-control","title":"What is the Draw Control?\u00b6","text":"<p>The draw control is based on mapbox-gl-draw and provides:</p> <ul> <li>Interactive drawing of points, lines, and polygons</li> <li>Editing and deleting existing geometries</li> <li>Loading existing GeoJSON data</li> <li>Retrieving drawn features as GeoJSON</li> <li>Programmatic control over drawing modes</li> </ul>"},{"location":"examples/maplibre/draw_control_example/#features","title":"Features\u00b6","text":"<ul> <li>\u2705 Draw geometries: Points, lines, and polygons</li> <li>\u2705 Edit geometries: Modify existing shapes</li> <li>\u2705 Delete geometries: Remove unwanted features</li> <li>\u2705 Load data: Import existing GeoJSON</li> <li>\u2705 Export data: Get drawn features as GeoJSON</li> <li>\u2705 Mode control: Switch between different drawing modes</li> <li>\u2705 Event handling: React to drawing events</li> </ul>"},{"location":"examples/maplibre/draw_control_example/#example-1-basic-draw-control","title":"Example 1: Basic Draw Control\u00b6","text":"<p>Let's start with a simple example of adding a draw control to the map.</p>"},{"location":"examples/maplibre/draw_control_example/#example-2-custom-draw-control-configuration","title":"Example 2: Custom Draw Control Configuration\u00b6","text":"<p>You can customize which drawing tools are available and where the control is positioned.</p>"},{"location":"examples/maplibre/draw_control_example/#example-3-loading-existing-geojson-data","title":"Example 3: Loading Existing GeoJSON Data\u00b6","text":"<p>You can load existing GeoJSON data into the draw control for editing.</p>"},{"location":"examples/maplibre/draw_control_example/#example-4-retrieving-draw-data","title":"Example 4: Retrieving Draw Data\u00b6","text":"<p>You can retrieve the currently drawn features as GeoJSON.</p>"},{"location":"examples/maplibre/draw_control_example/#example-5-draw-control-mode-management","title":"Example 5: Draw Control Mode Management\u00b6","text":"<p>You can programmatically control the drawing mode.</p>"},{"location":"examples/maplibre/draw_control_example/#example-6-clearing-and-deleting-features","title":"Example 6: Clearing and Deleting Features\u00b6","text":"<p>You can clear all drawn features or delete specific ones.</p>"},{"location":"examples/maplibre/draw_control_example/#example-7-export-map-with-draw-control-to-html","title":"Example 7: Export Map with Draw Control to HTML\u00b6","text":"<p>Maps with draw controls can be exported to standalone HTML files.</p>"},{"location":"examples/maplibre/draw_control_example/#summary","title":"Summary\u00b6","text":"<p>This notebook demonstrated the draw control functionality in AnyMap:</p>"},{"location":"examples/maplibre/draw_control_example/#key-features-covered","title":"\u2705 Key Features Covered:\u00b6","text":"<ol> <li>Basic Draw Control: Simple addition of draw tools to the map</li> <li>Custom Configuration: Customizing available tools, position, and behavior</li> <li>Loading Data: Importing existing GeoJSON data for editing</li> <li>Retrieving Data: Getting drawn features as GeoJSON</li> <li>Mode Management: Programmatically controlling drawing modes</li> <li>Data Management: Clearing and deleting features</li> <li>HTML Export: Exporting maps with draw controls to HTML</li> </ol>"},{"location":"examples/maplibre/draw_control_example/#method-signatures","title":"\ud83d\udd27 Method Signatures:\u00b6","text":"<pre># Add draw control\nmap.add_draw_control(\n    position: str = \"top-left\",\n    controls: Optional[Dict[str, bool]] = None,\n    default_mode: str = \"simple_select\",\n    keybindings: bool = True,\n    touch_enabled: bool = True\n)\n\n# Load GeoJSON data\nmap.load_draw_data(geojson_data: Union[Dict, str])\n\n# Get drawn data\nmap.get_draw_data() -&gt; Dict\n\n# Clear all features\nmap.clear_draw_data()\n\n# Delete specific features\nmap.delete_draw_features(feature_ids: List[str])\n\n# Set drawing mode\nmap.set_draw_mode(mode: str)\n</pre>"},{"location":"examples/maplibre/draw_control_example/#drawing-modes","title":"\ud83c\udfa8 Drawing Modes:\u00b6","text":"<ul> <li>simple_select: Select and move features</li> <li>direct_select: Edit feature vertices</li> <li>draw_point: Draw points</li> <li>draw_line_string: Draw lines</li> <li>draw_polygon: Draw polygons</li> <li>static: Disable all interactions</li> </ul>"},{"location":"examples/maplibre/draw_control_example/#use-cases","title":"\ud83c\udfaf Use Cases:\u00b6","text":"<ul> <li>Annotation: Mark important locations or areas</li> <li>Planning: Draw routes, boundaries, or zones</li> <li>Data Collection: Gather spatial information interactively</li> <li>Editing: Modify existing spatial data</li> <li>Measurement: Create geometries for area/distance calculations</li> </ul> <p>The draw control integration provides a powerful way to create interactive mapping applications with drawing and editing capabilities!</p>"},{"location":"examples/maplibre/geocoder_example/","title":"Geocoder example","text":"In\u00a0[\u00a0]: Copied! <pre>from anymap import MapLibreMap\n</pre> from anymap import MapLibreMap In\u00a0[\u00a0]: Copied! <pre># Create a MapLibre map\nm = MapLibreMap(\n    center=[-87.61694, 41.86625], zoom=10, style=\"positron\", height=\"600px\"  # Chicago\n)\n\n# Add a collapsed geocoder control (default behavior)\nm.add_geocoder_control(position=\"top-left\", collapsed=True)\n\nm\n</pre> # Create a MapLibre map m = MapLibreMap(     center=[-87.61694, 41.86625], zoom=10, style=\"positron\", height=\"600px\"  # Chicago )  # Add a collapsed geocoder control (default behavior) m.add_geocoder_control(position=\"top-left\", collapsed=True)  m In\u00a0[\u00a0]: Copied! <pre># Create a map with expanded geocoder\nm_expanded = MapLibreMap(\n    center=[2.3522, 48.8566], zoom=11, style=\"positron\", height=\"600px\"  # Paris\n)\n\n# Add an expanded geocoder control\nm_expanded.add_geocoder_control(position=\"top-left\", collapsed=False)\n\nm_expanded\n</pre> # Create a map with expanded geocoder m_expanded = MapLibreMap(     center=[2.3522, 48.8566], zoom=11, style=\"positron\", height=\"600px\"  # Paris )  # Add an expanded geocoder control m_expanded.add_geocoder_control(position=\"top-left\", collapsed=False)  m_expanded In\u00a0[\u00a0]: Copied! <pre># Create a map with custom geocoder settings\nm2 = MapLibreMap(center=[0, 0], zoom=2, style=\"dark-matter\", height=\"600px\")\n\n# Add geocoder with custom API configuration\ncustom_api_config = {\n    \"forwardGeocode\": True,\n    \"reverseGeocode\": False,\n    \"placeholder\": \"Search for cities, countries...\",\n    \"limit\": 10,\n    \"api_url\": \"https://nominatim.openstreetmap.org/search\",\n}\n\nm2.add_geocoder_control(position=\"top-right\", api_config=custom_api_config)\n\nm2\n</pre> # Create a map with custom geocoder settings m2 = MapLibreMap(center=[0, 0], zoom=2, style=\"dark-matter\", height=\"600px\")  # Add geocoder with custom API configuration custom_api_config = {     \"forwardGeocode\": True,     \"reverseGeocode\": False,     \"placeholder\": \"Search for cities, countries...\",     \"limit\": 10,     \"api_url\": \"https://nominatim.openstreetmap.org/search\", }  m2.add_geocoder_control(position=\"top-right\", api_config=custom_api_config)  m2 In\u00a0[\u00a0]: Copied! <pre># Export the map with geocoder to HTML\nm.to_html(\"geocoder_map.html\")\nprint(\"Map with geocoder control exported to geocoder_map.html\")\n</pre> # Export the map with geocoder to HTML m.to_html(\"geocoder_map.html\") print(\"Map with geocoder control exported to geocoder_map.html\") In\u00a0[\u00a0]: Copied! <pre># Create a comprehensive map with multiple controls\nm3 = MapLibreMap(\n    center=[-74.0059, 40.7128],  # New York City\n    zoom=12,\n    style=\"liberty\",\n    height=\"600px\",\n)\n\n# Add various controls\nm3.add_geocoder_control(position=\"top-left\")\nm3.add_control(\"navigation\", \"top-right\")\nm3.add_control(\"fullscreen\", \"top-right\")\nm3.add_control(\"scale\", \"bottom-left\")\nm3.add_layer_control(position=\"top-right\")\n\n# Add a basemap for more visual context\nm3.add_basemap(\"OpenStreetMap.Mapnik\")\n\nm3\n</pre> # Create a comprehensive map with multiple controls m3 = MapLibreMap(     center=[-74.0059, 40.7128],  # New York City     zoom=12,     style=\"liberty\",     height=\"600px\", )  # Add various controls m3.add_geocoder_control(position=\"top-left\") m3.add_control(\"navigation\", \"top-right\") m3.add_control(\"fullscreen\", \"top-right\") m3.add_control(\"scale\", \"bottom-left\") m3.add_layer_control(position=\"top-right\")  # Add a basemap for more visual context m3.add_basemap(\"OpenStreetMap.Mapnik\")  m3"},{"location":"examples/maplibre/geocoder_example/#maplibre-geocoder-control-example","title":"MapLibre Geocoder Control Example\u00b6","text":"<p>This notebook demonstrates how to use the geocoder control with MapLibre GL JS maps in AnyMap.</p>"},{"location":"examples/maplibre/geocoder_example/#basic-geocoder-control-collapsed-mode","title":"Basic Geocoder Control (Collapsed Mode)\u00b6","text":"<p>Create a map with a collapsed geocoder control that shows only a search icon initially. Click the icon to expand the search input:</p>"},{"location":"examples/maplibre/geocoder_example/#custom-geocoder-configuration","title":"Custom Geocoder Configuration\u00b6","text":"<p>You can customize the geocoder with different settings:</p>"},{"location":"examples/maplibre/geocoder_example/#expanded-geocoder-control","title":"Expanded Geocoder Control\u00b6","text":"<p>You can also create a geocoder that shows the input box immediately without requiring a click:</p>"},{"location":"examples/maplibre/geocoder_example/#export-to-html","title":"Export to HTML\u00b6","text":"<p>The geocoder control is also preserved when exporting to HTML:</p>"},{"location":"examples/maplibre/geocoder_example/#combining-with-other-controls","title":"Combining with Other Controls\u00b6","text":"<p>The geocoder control works well with other map controls:</p>"},{"location":"examples/maplibre/geogrid_example/","title":"Geogrid example","text":"In\u00a0[\u00a0]: Copied! <pre>from anymap import MapLibreMap\n</pre> from anymap import MapLibreMap In\u00a0[\u00a0]: Copied! <pre># Create a MapLibre map\nm = MapLibreMap(\n    center=[0, 20], zoom=2, style=\"positron\", height=\"600px\"  # Centered on Africa\n)\n\n# Add a basic GeoGrid\nm.add_geogrid_control()\n\nm\n</pre> # Create a MapLibre map m = MapLibreMap(     center=[0, 20], zoom=2, style=\"positron\", height=\"600px\"  # Centered on Africa )  # Add a basic GeoGrid m.add_geogrid_control()  m In\u00a0[\u00a0]: Copied! <pre># Create a map with custom grid styling\nm2 = MapLibreMap(\n    center=[-95, 40], zoom=3, style=\"dark-matter\", height=\"600px\"  # Centered on USA\n)\n\n# Add GeoGrid with custom line and label styling\nm2.add_geogrid_control(\n    grid_style={\n        \"line-color\": \"#00ffff\",  # Cyan grid lines\n        \"line-width\": 2,\n        \"line-dasharray\": [2, 2],  # Dashed lines\n    },\n    label_style={\n        \"color\": \"#00ffff\",  # Cyan labels\n        \"fontSize\": \"14px\",\n        \"textShadow\": \"2px 2px 4px rgba(0, 0, 0, 0.8)\",\n    },\n)\n\nm2\n</pre> # Create a map with custom grid styling m2 = MapLibreMap(     center=[-95, 40], zoom=3, style=\"dark-matter\", height=\"600px\"  # Centered on USA )  # Add GeoGrid with custom line and label styling m2.add_geogrid_control(     grid_style={         \"line-color\": \"#00ffff\",  # Cyan grid lines         \"line-width\": 2,         \"line-dasharray\": [2, 2],  # Dashed lines     },     label_style={         \"color\": \"#00ffff\",  # Cyan labels         \"fontSize\": \"14px\",         \"textShadow\": \"2px 2px 4px rgba(0, 0, 0, 0.8)\",     }, )  m2 In\u00a0[\u00a0]: Copied! <pre># Create a map with zoom-dependent grid visibility\nm3 = MapLibreMap(\n    center=[10, 50], zoom=4, style=\"liberty\", height=\"600px\"  # Centered on Europe\n)\n\n# Add GeoGrid that's only visible between zoom levels 2 and 8\nm3.add_geogrid_control(\n    zoom_level_range=[2, 8],\n    grid_style={\"line-color\": \"#ff6b6b\", \"line-width\": 1.5},\n    label_style={\"color\": \"#ff6b6b\", \"fontSize\": \"12px\"},\n)\n\nm3\n</pre> # Create a map with zoom-dependent grid visibility m3 = MapLibreMap(     center=[10, 50], zoom=4, style=\"liberty\", height=\"600px\"  # Centered on Europe )  # Add GeoGrid that's only visible between zoom levels 2 and 8 m3.add_geogrid_control(     zoom_level_range=[2, 8],     grid_style={\"line-color\": \"#ff6b6b\", \"line-width\": 1.5},     label_style={\"color\": \"#ff6b6b\", \"fontSize\": \"12px\"}, )  m3 In\u00a0[\u00a0]: Copied! <pre># Create a map with a GeoJSON layer\nm4 = MapLibreMap(\n    center=[139.7, 35.7], zoom=5, style=\"positron\", height=\"600px\"  # Centered on Tokyo\n)\n\n# Add a GeoJSON layer\ngeojson_data = {\n    \"type\": \"Feature\",\n    \"geometry\": {\"type\": \"Point\", \"coordinates\": [139.6917, 35.6895]},\n    \"properties\": {\"name\": \"Tokyo\"},\n}\n\nm4.add_geojson_layer(\n    layer_id=\"tokyo-marker\",\n    geojson_data=geojson_data,\n    layer_type=\"circle\",\n    paint={\"circle-radius\": 10, \"circle-color\": \"#FF0000\"},\n)\n\n# Add grid below the marker layer\n# Note: You may need to check available layer IDs in your style\nm4.add_geogrid_control(grid_style={\"line-color\": \"#888888\", \"line-width\": 1})\n\nm4\n</pre> # Create a map with a GeoJSON layer m4 = MapLibreMap(     center=[139.7, 35.7], zoom=5, style=\"positron\", height=\"600px\"  # Centered on Tokyo )  # Add a GeoJSON layer geojson_data = {     \"type\": \"Feature\",     \"geometry\": {\"type\": \"Point\", \"coordinates\": [139.6917, 35.6895]},     \"properties\": {\"name\": \"Tokyo\"}, }  m4.add_geojson_layer(     layer_id=\"tokyo-marker\",     geojson_data=geojson_data,     layer_type=\"circle\",     paint={\"circle-radius\": 10, \"circle-color\": \"#FF0000\"}, )  # Add grid below the marker layer # Note: You may need to check available layer IDs in your style m4.add_geogrid_control(grid_style={\"line-color\": \"#888888\", \"line-width\": 1})  m4 In\u00a0[\u00a0]: Copied! <pre># Remove the GeoGrid from the first map\nm.remove_geogrid_control()\n\nprint(\"GeoGrid removed from the first map\")\n</pre> # Remove the GeoGrid from the first map m.remove_geogrid_control()  print(\"GeoGrid removed from the first map\") In\u00a0[\u00a0]: Copied! <pre># Create a comprehensive map with multiple controls\nm5 = MapLibreMap(\n    center=[15, 0], zoom=2.5, style=\"dark-matter\", height=\"600px\"  # Centered on Africa\n)\n\n# Add various controls\nm5.add_control(\"navigation\", \"top-right\")\nm5.add_control(\"fullscreen\", \"top-right\")\nm5.add_control(\"scale\", \"bottom-left\")\n\n# Add GeoGrid with custom styling\nm5.add_geogrid_control(\n    grid_style={\"line-color\": \"#4ecdc4\", \"line-width\": 1.5, \"line-opacity\": 0.6},\n    label_style={\n        \"color\": \"#4ecdc4\",\n        \"fontSize\": \"13px\",\n        \"textShadow\": \"1px 1px 3px rgba(0, 0, 0, 0.9)\",\n    },\n)\n\nm5\n</pre> # Create a comprehensive map with multiple controls m5 = MapLibreMap(     center=[15, 0], zoom=2.5, style=\"dark-matter\", height=\"600px\"  # Centered on Africa )  # Add various controls m5.add_control(\"navigation\", \"top-right\") m5.add_control(\"fullscreen\", \"top-right\") m5.add_control(\"scale\", \"bottom-left\")  # Add GeoGrid with custom styling m5.add_geogrid_control(     grid_style={\"line-color\": \"#4ecdc4\", \"line-width\": 1.5, \"line-opacity\": 0.6},     label_style={         \"color\": \"#4ecdc4\",         \"fontSize\": \"13px\",         \"textShadow\": \"1px 1px 3px rgba(0, 0, 0, 0.9)\",     }, )  m5 In\u00a0[\u00a0]: Copied! <pre># Export the map with GeoGrid to HTML\nm5.to_html(\"geogrid_map.html\")\nprint(\"Map with GeoGrid control exported to geogrid_map.html\")\n</pre> # Export the map with GeoGrid to HTML m5.to_html(\"geogrid_map.html\") print(\"Map with GeoGrid control exported to geogrid_map.html\") In\u00a0[\u00a0]: Copied! <pre># Create a map with globe projection\nm6 = MapLibreMap(center=[0, 20], zoom=1.5, style=\"positron\", height=\"600px\")\n\n# Set globe projection\nm6.set_projection({\"type\": \"globe\"})\n\n# Add GeoGrid that works with globe projection\nm6.add_geogrid_control(\n    grid_style={\"line-color\": \"#1a73e8\", \"line-width\": 2},\n    label_style={\"color\": \"#1a73e8\", \"fontSize\": \"14px\", \"fontWeight\": \"bold\"},\n)\n\nm6\n</pre> # Create a map with globe projection m6 = MapLibreMap(center=[0, 20], zoom=1.5, style=\"positron\", height=\"600px\")  # Set globe projection m6.set_projection({\"type\": \"globe\"})  # Add GeoGrid that works with globe projection m6.add_geogrid_control(     grid_style={\"line-color\": \"#1a73e8\", \"line-width\": 2},     label_style={\"color\": \"#1a73e8\", \"fontSize\": \"14px\", \"fontWeight\": \"bold\"}, )  m6"},{"location":"examples/maplibre/geogrid_example/#geogrid-example","title":"GeoGrid Example\u00b6","text":"<p>This notebook demonstrates how to use the GeoGrid plugin with MapLibre GL JS maps in AnyMap. GeoGrid adds a customizable geographic grid (graticule) with labeled coordinates to your maps.</p>"},{"location":"examples/maplibre/geogrid_example/#basic-geogrid","title":"Basic GeoGrid\u00b6","text":"<p>Create a map with a basic geographic grid overlay showing latitude and longitude lines:</p>"},{"location":"examples/maplibre/geogrid_example/#customized-grid-style","title":"Customized Grid Style\u00b6","text":"<p>You can customize the appearance of the grid lines and labels with different colors, widths, and styles:</p>"},{"location":"examples/maplibre/geogrid_example/#grid-with-zoom-level-range","title":"Grid with Zoom Level Range\u00b6","text":"<p>Control the visibility of the grid at different zoom levels. This is useful to show the grid only at specific zoom ranges:</p>"},{"location":"examples/maplibre/geogrid_example/#grid-below-specific-layer","title":"Grid Below Specific Layer\u00b6","text":"<p>You can position the grid below a specific layer to control the rendering order:</p>"},{"location":"examples/maplibre/geogrid_example/#removing-the-grid","title":"Removing the Grid\u00b6","text":"<p>You can remove the grid control when it's no longer needed:</p>"},{"location":"examples/maplibre/geogrid_example/#combining-with-other-controls","title":"Combining with Other Controls\u00b6","text":"<p>The GeoGrid control works well with other map controls:</p>"},{"location":"examples/maplibre/geogrid_example/#export-to-html","title":"Export to HTML\u00b6","text":"<p>The GeoGrid control is preserved when exporting to HTML:</p>"},{"location":"examples/maplibre/geogrid_example/#globe-projection-support","title":"Globe Projection Support\u00b6","text":"<p>GeoGrid also works with globe projection (MapLibre GL 5.x feature):</p>"},{"location":"examples/maplibre/infobox_example/","title":"Infobox example","text":"In\u00a0[\u00a0]: Copied! <pre>from anymap import MapLibreMap\n</pre> from anymap import MapLibreMap In\u00a0[\u00a0]: Copied! <pre># Create a MapLibre map and add world cities from the provided dataset\nimport json, urllib.request\n\nm = MapLibreMap(center=[0, 20], zoom=2.5, style=\"liberty\", height=\"600px\")\n\nwith urllib.request.urlopen(\n    \"https://github.com/opengeos/datasets/releases/download/world/world_cities.geojson\"\n) as resp:\n    world_cities = json.load(resp)\n\nm.add_geojson_layer(\n    layer_id=\"world-cities\",\n    geojson_data=world_cities,\n    layer_type=\"circle\",\n    paint={\n        \"circle-radius\": 3,\n        \"circle-color\": \"#e11d48\",\n        \"circle-opacity\": 0.7,\n        \"circle-stroke-width\": 0.5,\n        \"circle-stroke-color\": \"#ffffff\",\n    },\n)\n\nm\n</pre> # Create a MapLibre map and add world cities from the provided dataset import json, urllib.request  m = MapLibreMap(center=[0, 20], zoom=2.5, style=\"liberty\", height=\"600px\")  with urllib.request.urlopen(     \"https://github.com/opengeos/datasets/releases/download/world/world_cities.geojson\" ) as resp:     world_cities = json.load(resp)  m.add_geojson_layer(     layer_id=\"world-cities\",     geojson_data=world_cities,     layer_type=\"circle\",     paint={         \"circle-radius\": 3,         \"circle-color\": \"#e11d48\",         \"circle-opacity\": 0.7,         \"circle-stroke-width\": 0.5,         \"circle-stroke-color\": \"#ffffff\",     }, )  m In\u00a0[\u00a0]: Copied! <pre># Show feature attributes when hovering/clicking on cities\nm.add_infobox_control(\n    position=\"bottom-right\",\n    layer_id=\"world-cities\",\n    formatter=\"&lt;div style='margin: 8px; font-size: 14px;'&gt;&lt;b&gt;{{name}}&lt;/b&gt;&lt;br/&gt;Population: {{population}}&lt;/div&gt;\",\n    collapsed=False,\n)\n# m\n</pre> # Show feature attributes when hovering/clicking on cities m.add_infobox_control(     position=\"bottom-right\",     layer_id=\"world-cities\",     formatter=\"{{name}}Population: {{population}}\",     collapsed=False, ) # m In\u00a0[\u00a0]: Copied! <pre># Display a population legend for the dataset\nm.add_gradientbox_control(\n    position=\"top-left\",\n    layer_id=\"world-cities\",\n    weight_property=\"population\",\n    min_value=0,\n    max_value=40000000,\n    colors=[\"#ffffcc\", \"#a1dab4\", \"#41b6c4\", \"#225ea8\", \"#ffffff\"],\n    collapsed=True,\n)\n# m\n</pre> # Display a population legend for the dataset m.add_gradientbox_control(     position=\"top-left\",     layer_id=\"world-cities\",     weight_property=\"population\",     min_value=0,     max_value=40000000,     colors=[\"#ffffcc\", \"#a1dab4\", \"#41b6c4\", \"#225ea8\", \"#ffffff\"],     collapsed=True, ) # m In\u00a0[\u00a0]: Copied! <pre>\n</pre>"},{"location":"examples/maplibre/infobox_example/#infobox-and-gradientbox-controls-example","title":"InfoBox and GradientBox Controls Example\u00b6","text":"<p>This notebook demonstrates how to use the <code>mapbox-gl-infobox</code> plugin with AnyMap's MapLibre maps. It shows both the InfoBox (feature attributes) and GradientBox (value legend) controls.</p>"},{"location":"examples/maplibre/infobox_example/#create-a-map-and-add-a-demo-layer","title":"Create a map and add a demo layer\u00b6","text":""},{"location":"examples/maplibre/infobox_example/#add-infobox-control","title":"Add InfoBox control\u00b6","text":""},{"location":"examples/maplibre/infobox_example/#add-gradientbox-control","title":"Add GradientBox control\u00b6","text":""},{"location":"examples/maplibre/layer_control_example/","title":"Layer control example","text":"In\u00a0[\u00a0]: Copied! <pre>from anymap.maplibre import MapLibreMap\n</pre> from anymap.maplibre import MapLibreMap In\u00a0[\u00a0]: Copied! <pre># Create map with default style\nm = MapLibreMap(center=[-122.4307025, 37.780538], zoom=12, style=\"dark-matter\")\n\n# Add layer control - should show immediately with Background\nm.add_layer_control(position=\"top-right\", collapsed=True)\n\nm\n</pre> # Create map with default style m = MapLibreMap(center=[-122.4307025, 37.780538], zoom=12, style=\"dark-matter\")  # Add layer control - should show immediately with Background m.add_layer_control(position=\"top-right\", collapsed=True)  m In\u00a0[\u00a0]: Copied! <pre># Add a test point layer - should appear in layer control automatically\npoint_data = {\n    \"type\": \"FeatureCollection\",\n    \"features\": [\n        {\n            \"type\": \"Feature\",\n            \"geometry\": {\"type\": \"Point\", \"coordinates\": [-122.4194, 37.7749]},\n            \"properties\": {\"name\": \"San Francisco\"},\n        },\n        {\n            \"type\": \"Feature\",\n            \"geometry\": {\"type\": \"Point\", \"coordinates\": [-122.4294, 37.7849]},\n            \"properties\": {\"name\": \"Point 2\"},\n        },\n    ],\n}\n\nlayer_config = {\n    \"id\": \"test-points\",\n    \"type\": \"circle\",\n    \"source\": {\"type\": \"geojson\", \"data\": point_data},\n    \"paint\": {\n        \"circle-radius\": 8,\n        \"circle-color\": \"#FF0000\",\n        \"circle-stroke-color\": \"#FFFFFF\",\n        \"circle-stroke-width\": 2,\n    },\n}\n\nm.add_layer(\"test-points\", layer_config)\n\nprint(\n    \"Added test-points layer. Check the layer control - it should now show both 'Background' and 'test-points'.\"\n)\n</pre> # Add a test point layer - should appear in layer control automatically point_data = {     \"type\": \"FeatureCollection\",     \"features\": [         {             \"type\": \"Feature\",             \"geometry\": {\"type\": \"Point\", \"coordinates\": [-122.4194, 37.7749]},             \"properties\": {\"name\": \"San Francisco\"},         },         {             \"type\": \"Feature\",             \"geometry\": {\"type\": \"Point\", \"coordinates\": [-122.4294, 37.7849]},             \"properties\": {\"name\": \"Point 2\"},         },     ], }  layer_config = {     \"id\": \"test-points\",     \"type\": \"circle\",     \"source\": {\"type\": \"geojson\", \"data\": point_data},     \"paint\": {         \"circle-radius\": 8,         \"circle-color\": \"#FF0000\",         \"circle-stroke-color\": \"#FFFFFF\",         \"circle-stroke-width\": 2,     }, }  m.add_layer(\"test-points\", layer_config)  print(     \"Added test-points layer. Check the layer control - it should now show both 'Background' and 'test-points'.\" ) In\u00a0[\u00a0]: Copied! <pre># Add a polygon layer\npolygon_data = {\n    \"type\": \"FeatureCollection\",\n    \"features\": [\n        {\n            \"type\": \"Feature\",\n            \"geometry\": {\n                \"type\": \"Polygon\",\n                \"coordinates\": [\n                    [\n                        [-122.43, 37.77],\n                        [-122.43, 37.78],\n                        [-122.42, 37.78],\n                        [-122.42, 37.77],\n                        [-122.43, 37.77],\n                    ]\n                ],\n            },\n            \"properties\": {\"name\": \"Test Area\"},\n        }\n    ],\n}\n\npolygon_layer_config = {\n    \"id\": \"test-polygon\",\n    \"type\": \"fill\",\n    \"source\": {\"type\": \"geojson\", \"data\": polygon_data},\n    \"paint\": {\"fill-color\": \"#00FF00\", \"fill-opacity\": 0.5},\n}\n\nm.add_layer(\"test-polygon\", polygon_layer_config)\n\n# Add a line layer\nline_data = {\n    \"type\": \"FeatureCollection\",\n    \"features\": [\n        {\n            \"type\": \"Feature\",\n            \"geometry\": {\n                \"type\": \"LineString\",\n                \"coordinates\": [[-122.45, 37.77], [-122.44, 37.78], [-122.43, 37.79]],\n            },\n            \"properties\": {\"name\": \"Test Route\"},\n        }\n    ],\n}\n\nline_layer_config = {\n    \"id\": \"test-line\",\n    \"type\": \"line\",\n    \"source\": {\"type\": \"geojson\", \"data\": line_data},\n    \"paint\": {\"line-color\": \"#0000FF\", \"line-width\": 3},\n}\n\nm.add_layer(\"test-line\", line_layer_config)\n\nprint(\n    \"Added test-polygon and test-line layers. Layer control should now show all 4 items:\"\n)\nprint(\"- Background\")\nprint(\"- test-points\")\nprint(\"- test-polygon\")\nprint(\"- test-line\")\n</pre> # Add a polygon layer polygon_data = {     \"type\": \"FeatureCollection\",     \"features\": [         {             \"type\": \"Feature\",             \"geometry\": {                 \"type\": \"Polygon\",                 \"coordinates\": [                     [                         [-122.43, 37.77],                         [-122.43, 37.78],                         [-122.42, 37.78],                         [-122.42, 37.77],                         [-122.43, 37.77],                     ]                 ],             },             \"properties\": {\"name\": \"Test Area\"},         }     ], }  polygon_layer_config = {     \"id\": \"test-polygon\",     \"type\": \"fill\",     \"source\": {\"type\": \"geojson\", \"data\": polygon_data},     \"paint\": {\"fill-color\": \"#00FF00\", \"fill-opacity\": 0.5}, }  m.add_layer(\"test-polygon\", polygon_layer_config)  # Add a line layer line_data = {     \"type\": \"FeatureCollection\",     \"features\": [         {             \"type\": \"Feature\",             \"geometry\": {                 \"type\": \"LineString\",                 \"coordinates\": [[-122.45, 37.77], [-122.44, 37.78], [-122.43, 37.79]],             },             \"properties\": {\"name\": \"Test Route\"},         }     ], }  line_layer_config = {     \"id\": \"test-line\",     \"type\": \"line\",     \"source\": {\"type\": \"geojson\", \"data\": line_data},     \"paint\": {\"line-color\": \"#0000FF\", \"line-width\": 3}, }  m.add_layer(\"test-line\", line_layer_config)  print(     \"Added test-polygon and test-line layers. Layer control should now show all 4 items:\" ) print(\"- Background\") print(\"- test-points\") print(\"- test-polygon\") print(\"- test-line\") In\u00a0[\u00a0]: Copied! <pre>html = m.to_html(\"layer_control.html\", title=\"MapLibre Layer Control\", height=\"800px\")\n</pre> html = m.to_html(\"layer_control.html\", title=\"MapLibre Layer Control\", height=\"800px\") In\u00a0[\u00a0]: Copied! <pre># Test visibility changes - the checkboxes should update automatically\nprint(\"Testing visibility changes...\")\nm.set_visibility(\"test-points\", False)\nprint(\"- Set test-points visibility to False (checkbox should be unchecked)\")\n\nm.set_visibility(\"test-polygon\", False)\nprint(\"- Set test-polygon visibility to False (checkbox should be unchecked)\")\n\n# Test opacity changes - the sliders should update automatically\nprint(\"\\nTesting opacity changes...\")\nm.set_opacity(\"test-line\", 0.3)\nprint(\"- Set test-line opacity to 0.3 (slider should move to 30%)\")\n\nm.set_opacity(\"test-polygon\", 0.8)\nprint(\"- Set test-polygon opacity to 0.8 (slider should move to 80%)\")\n\nprint(\"\\nCheck the layer control - all changes should be reflected in the UI!\")\n</pre> # Test visibility changes - the checkboxes should update automatically print(\"Testing visibility changes...\") m.set_visibility(\"test-points\", False) print(\"- Set test-points visibility to False (checkbox should be unchecked)\")  m.set_visibility(\"test-polygon\", False) print(\"- Set test-polygon visibility to False (checkbox should be unchecked)\")  # Test opacity changes - the sliders should update automatically print(\"\\nTesting opacity changes...\") m.set_opacity(\"test-line\", 0.3) print(\"- Set test-line opacity to 0.3 (slider should move to 30%)\")  m.set_opacity(\"test-polygon\", 0.8) print(\"- Set test-polygon opacity to 0.8 (slider should move to 80%)\")  print(\"\\nCheck the layer control - all changes should be reflected in the UI!\") In\u00a0[\u00a0]: Copied! <pre># Restore visibility\nm.set_visibility(\"test-points\", True)\nm.set_visibility(\"test-polygon\", True)\nm.set_opacity(\"test-line\", 1.0)\nm.set_opacity(\"test-polygon\", 0.5)\n\nprint(\"Restored all layer visibility and opacity.\")\nprint(\"\\nTry using the layer control UI:\")\nprint(\"- Toggle the 'Background' checkbox to hide/show all background layers\")\nprint(\"- Adjust the 'Background' opacity slider to change map transparency\")\nprint(\"- Toggle individual layer checkboxes to show/hide specific layers\")\nprint(\"- Adjust individual layer opacity sliders for fine control\")\nprint(\"\\nAll changes should work in both directions (UI \u2192 Python and Python \u2192 UI)!\")\n</pre> # Restore visibility m.set_visibility(\"test-points\", True) m.set_visibility(\"test-polygon\", True) m.set_opacity(\"test-line\", 1.0) m.set_opacity(\"test-polygon\", 0.5)  print(\"Restored all layer visibility and opacity.\") print(\"\\nTry using the layer control UI:\") print(\"- Toggle the 'Background' checkbox to hide/show all background layers\") print(\"- Adjust the 'Background' opacity slider to change map transparency\") print(\"- Toggle individual layer checkboxes to show/hide specific layers\") print(\"- Adjust individual layer opacity sliders for fine control\") print(\"\\nAll changes should work in both directions (UI \u2192 Python and Python \u2192 UI)!\") In\u00a0[\u00a0]: Copied! <pre># Add a second layer control with only specific layers\nm.add_layer_control(\n    position=\"top-left\",\n    collapsed=True,\n    layers=[\"test-points\", \"test-line\"],  # Only show these layers\n)\n\nprint(\"Added second layer control on top-left with filtered layers.\")\nprint(\"The left control should only show test-points and test-line.\")\nprint(\"The right control should show all layers including Background.\")\n</pre> # Add a second layer control with only specific layers m.add_layer_control(     position=\"top-left\",     collapsed=True,     layers=[\"test-points\", \"test-line\"],  # Only show these layers )  print(\"Added second layer control on top-left with filtered layers.\") print(\"The left control should only show test-points and test-line.\") print(\"The right control should show all layers including Background.\") In\u00a0[\u00a0]: Copied! <pre># Export to HTML with improved styling that matches the notebook appearance\nhtml = m.to_html(\"layer_control.html\", title=\"Layer Control Test\")\n\nprint(\"\u2713 Map exported to HTML with enhanced layer control styling!\")\nprint(\"\\\\nThe exported HTML now features:\")\nprint(\"- Professional SVG layers icon (3 stacked rectangles)\")\nprint(\"- Gray gradient opacity sliders matching notebook appearance\")\nprint(\"- Consistent typography and spacing\")\nprint(\"- Proper hover effects and visual feedback\")\nprint(\"- Clean scrollbar styling\")\nprint(\"- All interactive functionality preserved\")\nprint(\"\\\\nThe layer control appearance now matches the Jupyter notebook exactly!\")\nprint(\"\\\\nOpen layer_control.html in a browser to see the improved styling!\")\n</pre> # Export to HTML with improved styling that matches the notebook appearance html = m.to_html(\"layer_control.html\", title=\"Layer Control Test\")  print(\"\u2713 Map exported to HTML with enhanced layer control styling!\") print(\"\\\\nThe exported HTML now features:\") print(\"- Professional SVG layers icon (3 stacked rectangles)\") print(\"- Gray gradient opacity sliders matching notebook appearance\") print(\"- Consistent typography and spacing\") print(\"- Proper hover effects and visual feedback\") print(\"- Clean scrollbar styling\") print(\"- All interactive functionality preserved\") print(\"\\\\nThe layer control appearance now matches the Jupyter notebook exactly!\") print(\"\\\\nOpen layer_control.html in a browser to see the improved styling!\")"},{"location":"examples/maplibre/layer_control_example/#maplibrelayer-control","title":"MapLibreLayer Control\u00b6","text":"<p>This notebook demonstrates the fixed layer control implementation that:</p> <ul> <li>Shows immediately after map initialization</li> <li>Groups background layers as \"Background Map\"</li> <li>Dynamically updates when new layers are added</li> <li>Properly syncs with programmatic changes</li> </ul>"},{"location":"examples/maplibre/layer_control_example/#1-create-map-with-immediate-layer-control","title":"1. Create Map with Immediate Layer Control\u00b6","text":"<p>The layer control now shows up immediately after map initialization, displaying the \"Background Map\" control even when no user layers are present.</p>"},{"location":"examples/maplibre/layer_control_example/#2-dynamic-layer-addition","title":"2. Dynamic Layer Addition\u00b6","text":"<p>New layers are now automatically detected and added to the layer control panel.</p>"},{"location":"examples/maplibre/layer_control_example/#3-add-multiple-layers","title":"3. Add Multiple Layers\u00b6","text":"<p>All new layers are automatically added to the control panel.</p>"},{"location":"examples/maplibre/layer_control_example/#4-test-programmatic-changes","title":"4. Test Programmatic Changes\u00b6","text":"<p>The layer control now properly syncs with programmatic visibility and opacity changes.</p>"},{"location":"examples/maplibre/layer_control_example/#5-restore-visibility-and-test-background-control","title":"5. Restore Visibility and Test Background Control\u00b6","text":"<p>Test that the background control properly affects all map style layers.</p>"},{"location":"examples/maplibre/layer_control_example/#6-test-multiple-layer-controls","title":"6. Test Multiple Layer Controls\u00b6","text":"<p>You can add multiple layer controls in different positions with different layer filters.</p>"},{"location":"examples/maplibre/layer_control_example/#summary","title":"Summary\u00b6","text":"<p>The layer control implementation now provides:</p>"},{"location":"examples/maplibre/layer_control_example/#features","title":"Features:\u00b6","text":"<ul> <li>Collapsible Panel: Click the icon to expand/collapse the layer list</li> <li>Visibility Control: Checkboxes to toggle layer visibility</li> <li>Opacity Control: Sliders to adjust layer transparency</li> <li>Layer Filtering: Optional parameter to show only specific layers</li> <li>Multiple Controls: Add controls in different positions with different layer sets</li> <li>Bidirectional Sync: Changes work both ways (UI \u2194 Python)</li> </ul>"},{"location":"examples/maplibre/layer_control_example/#background-layer-handling","title":"Background Layer Handling:\u00b6","text":"<ul> <li>All map style layers (landcover, parks, roads, etc.) are grouped under \"Background Map\"</li> <li>User-added layers appear as individual controls</li> <li>Background control affects all style layers simultaneously</li> <li>Individual layer controls only affect their specific layer</li> </ul>"},{"location":"examples/maplibre/map_click_polygon_intersection/","title":"Map click polygon intersection","text":"In\u00a0[\u00a0]: Copied! <pre>import json\nimport geopandas as gpd\nfrom shapely.geometry import Point\nfrom anymap.maplibre import MapLibreMap\nimport ipywidgets as widgets\nfrom IPython.display import display\n</pre> import json import geopandas as gpd from shapely.geometry import Point from anymap.maplibre import MapLibreMap import ipywidgets as widgets from IPython.display import display In\u00a0[\u00a0]: Copied! <pre># Load buildings data\nurl = \"https://github.com/opengeos/datasets/releases/download/places/las_vegas_buildings.geojson\"\nbuildings_gdf = gpd.read_file(url)\n\nprint(f\"Loaded {len(buildings_gdf)} building polygons\")\nprint(f\"Buildings CRS: {buildings_gdf.crs}\")\nprint(f\"Buildings bounds: {buildings_gdf.total_bounds}\")\n\n# Display first few buildings\nbuildings_gdf.head()\n</pre> # Load buildings data url = \"https://github.com/opengeos/datasets/releases/download/places/las_vegas_buildings.geojson\" buildings_gdf = gpd.read_file(url)  print(f\"Loaded {len(buildings_gdf)} building polygons\") print(f\"Buildings CRS: {buildings_gdf.crs}\") print(f\"Buildings bounds: {buildings_gdf.total_bounds}\")  # Display first few buildings buildings_gdf.head() In\u00a0[\u00a0]: Copied! <pre>geojson = buildings_gdf.__geo_interface__\n</pre> geojson = buildings_gdf.__geo_interface__ In\u00a0[\u00a0]: Copied! <pre>point_gdf = buildings_gdf.copy()\npoint_gdf[\"geometry\"] = point_gdf.to_crs(\"EPSG:3857\").centroid.to_crs(\"EPSG:4326\")\n</pre> point_gdf = buildings_gdf.copy() point_gdf[\"geometry\"] = point_gdf.to_crs(\"EPSG:3857\").centroid.to_crs(\"EPSG:4326\") In\u00a0[\u00a0]: Copied! <pre>point_gdf.head()\n</pre> point_gdf.head() In\u00a0[\u00a0]: Copied! <pre>point_geojson = point_gdf.__geo_interface__\n</pre> point_geojson = point_gdf.__geo_interface__ In\u00a0[\u00a0]: Copied! <pre>m = MapLibreMap(\n    style=\"liberty\", center=[-115.20350534, 36.1209240], zoom=16, add_sidebar=True\n)\nm.add_basemap(\"Esri.WorldImagery\")\nm.add_geojson_layer(\n    \"building_point\",\n    point_geojson,\n    layer_type=\"circle\",\n    paint={\"circle-color\": \"#0000ff\", \"circle-radius\": 5},\n)\nm.add_draw_control()\nm\n</pre> m = MapLibreMap(     style=\"liberty\", center=[-115.20350534, 36.1209240], zoom=16, add_sidebar=True ) m.add_basemap(\"Esri.WorldImagery\") m.add_geojson_layer(     \"building_point\",     point_geojson,     layer_type=\"circle\",     paint={\"circle-color\": \"#0000ff\", \"circle-radius\": 5}, ) m.add_draw_control() m In\u00a0[\u00a0]: Copied! <pre># Create output widget to show messages\noutput = widgets.Output()\n</pre> # Create output widget to show messages output = widgets.Output() In\u00a0[\u00a0]: Copied! <pre>def on_map_clicked(change):\n    \"\"\"Handle map click events.\"\"\"\n    clicked_coords = change[\"new\"]\n\n    with output:\n        output.clear_output()\n\n        if not clicked_coords:\n            return\n\n        lng = clicked_coords.get(\"lng\")\n        lat = clicked_coords.get(\"lat\")\n\n        print(f\"Map clicked at: {lng:.6f}, {lat:.6f}\")\n\n        # Create point from click coordinates\n        click_point = Point(lng, lat)\n\n        # First check if there's already a polygon in draw data that intersects this point\n        existing_draw_data = m.get_draw_data()\n        existing_features = existing_draw_data.get(\"features\", [])\n\n        # Check if click point intersects any existing drawn features\n        for feature in existing_features:\n            try:\n                from shapely.geometry import shape\n\n                existing_geom = shape(feature[\"geometry\"])\n                if existing_geom.intersects(click_point):\n                    print(\n                        f\"\u26a0\ufe0f  Click point already intersects an existing drawn feature\"\n                    )\n                    print(\n                        f\"    Feature: {feature.get('properties', {}).get('name', 'Unnamed')}\"\n                    )\n                    print(f\"    Skipping search for new buildings\")\n                    return\n            except Exception as e:\n                # Skip if there's an issue with the geometry\n                continue\n\n        # Find intersecting building in the buildings dataset\n        building = find_intersecting_building(clicked_coords)\n\n        if building is not None:\n            print(f\"\u2705 Found intersecting building!\")\n            print(f\"   Building ID: {building['id']}\")\n            print(f\"   Place ID: {building['height']}\")\n\n            # Convert building geometry to GeoJSON\n            building_geojson = {\n                \"type\": \"Feature\",\n                \"geometry\": building.geometry.__geo_interface__,\n                \"properties\": {\n                    \"buildingId\": str(building[\"id\"]),\n                    \"height\": str(building[\"height\"]),\n                    \"clicked_at\": f\"{lng:.6f}, {lat:.6f}\",\n                },\n            }\n\n            # Add building to draw control\n            m.add_draw_data(building_geojson)\n            print(f\"\ud83d\udccd Added building to draw control\")\n\n        else:\n            print(f\"\u274c No building found at this location\")\n\n\n# Observe changes to the clicked attribute\nm.observe(on_map_clicked, names=\"clicked\")\n\ndisplay(output)\n</pre> def on_map_clicked(change):     \"\"\"Handle map click events.\"\"\"     clicked_coords = change[\"new\"]      with output:         output.clear_output()          if not clicked_coords:             return          lng = clicked_coords.get(\"lng\")         lat = clicked_coords.get(\"lat\")          print(f\"Map clicked at: {lng:.6f}, {lat:.6f}\")          # Create point from click coordinates         click_point = Point(lng, lat)          # First check if there's already a polygon in draw data that intersects this point         existing_draw_data = m.get_draw_data()         existing_features = existing_draw_data.get(\"features\", [])          # Check if click point intersects any existing drawn features         for feature in existing_features:             try:                 from shapely.geometry import shape                  existing_geom = shape(feature[\"geometry\"])                 if existing_geom.intersects(click_point):                     print(                         f\"\u26a0\ufe0f  Click point already intersects an existing drawn feature\"                     )                     print(                         f\"    Feature: {feature.get('properties', {}).get('name', 'Unnamed')}\"                     )                     print(f\"    Skipping search for new buildings\")                     return             except Exception as e:                 # Skip if there's an issue with the geometry                 continue          # Find intersecting building in the buildings dataset         building = find_intersecting_building(clicked_coords)          if building is not None:             print(f\"\u2705 Found intersecting building!\")             print(f\"   Building ID: {building['id']}\")             print(f\"   Place ID: {building['height']}\")              # Convert building geometry to GeoJSON             building_geojson = {                 \"type\": \"Feature\",                 \"geometry\": building.geometry.__geo_interface__,                 \"properties\": {                     \"buildingId\": str(building[\"id\"]),                     \"height\": str(building[\"height\"]),                     \"clicked_at\": f\"{lng:.6f}, {lat:.6f}\",                 },             }              # Add building to draw control             m.add_draw_data(building_geojson)             print(f\"\ud83d\udccd Added building to draw control\")          else:             print(f\"\u274c No building found at this location\")   # Observe changes to the clicked attribute m.observe(on_map_clicked, names=\"clicked\")  display(output) In\u00a0[\u00a0]: Copied! <pre>def find_intersecting_building(click_coords):\n    \"\"\"Find building polygon that intersects with click point.\"\"\"\n    if not click_coords:\n        return None\n\n    lng = click_coords.get(\"lng\")\n    lat = click_coords.get(\"lat\")\n\n    if lng is None or lat is None:\n        return None\n\n    # Create point from click coordinates\n    click_point = Point(lng, lat)\n\n    # Find intersecting buildings\n    intersecting = buildings_gdf[buildings_gdf.geometry.intersects(click_point)]\n\n    if len(intersecting) &gt; 0:\n        # Return the first intersecting building\n        return intersecting.iloc[0]\n\n    return None\n</pre> def find_intersecting_building(click_coords):     \"\"\"Find building polygon that intersects with click point.\"\"\"     if not click_coords:         return None      lng = click_coords.get(\"lng\")     lat = click_coords.get(\"lat\")      if lng is None or lat is None:         return None      # Create point from click coordinates     click_point = Point(lng, lat)      # Find intersecting buildings     intersecting = buildings_gdf[buildings_gdf.geometry.intersects(click_point)]      if len(intersecting) &gt; 0:         # Return the first intersecting building         return intersecting.iloc[0]      return None In\u00a0[\u00a0]: Copied! <pre>\n</pre>"},{"location":"examples/maplibre/map_click_polygon_intersection/#map-click-polygon-intersection-example","title":"Map Click Polygon Intersection Example\u00b6","text":"<p>This notebook demonstrates how to:</p> <ol> <li>Observe map clicks using the <code>clicked</code> attribute</li> <li>Find intersecting polygons from a GeoJSON file</li> <li>Load the intersecting polygon into the draw control</li> </ol> <p>When you click on the map, it will check if the click point intersects any building polygons from <code>buildings.geojson</code> and automatically add the intersecting building to the draw control.</p>"},{"location":"examples/maplibre/map_click_polygon_intersection/#load-building-data","title":"Load Building Data\u00b6","text":"<p>First, let's load the buildings.geojson file which contains building polygons from the Washington state area.</p>"},{"location":"examples/maplibre/map_click_polygon_intersection/#create-interactive-map","title":"Create Interactive Map\u00b6","text":"<p>Create a map centered in the Washington state area where the buildings are located, and add a draw control.</p>"},{"location":"examples/maplibre/map_comparison/","title":"Map comparison","text":"In\u00a0[\u00a0]: Copied! <pre>import anymap\n</pre> import anymap In\u00a0[\u00a0]: Copied! <pre># Basic MapLibre comparison with different styles\ncompare = anymap.MapCompare(\n    left_map={\n        \"center\": [37.7749, -122.4194],  # San Francisco\n        \"zoom\": 12,\n        \"style\": \"https://demotiles.maplibre.org/style.json\",\n    },\n    right_map={\n        \"center\": [37.7749, -122.4194],\n        \"zoom\": 12,\n        \"style\": \"https://tiles.stadiamaps.com/styles/alidade_smooth.json\",\n    },\n    backend=\"maplibre\",\n    orientation=\"vertical\",\n    mousemove=False,\n    height=\"600px\",\n)\n\ncompare\n</pre> # Basic MapLibre comparison with different styles compare = anymap.MapCompare(     left_map={         \"center\": [37.7749, -122.4194],  # San Francisco         \"zoom\": 12,         \"style\": \"https://demotiles.maplibre.org/style.json\",     },     right_map={         \"center\": [37.7749, -122.4194],         \"zoom\": 12,         \"style\": \"https://tiles.stadiamaps.com/styles/alidade_smooth.json\",     },     backend=\"maplibre\",     orientation=\"vertical\",     mousemove=False,     height=\"600px\", )  compare In\u00a0[\u00a0]: Copied! <pre># Move slider to 25% position (more of the left map visible)\ncompare.set_slider_position(0.25)\n</pre> # Move slider to 25% position (more of the left map visible) compare.set_slider_position(0.25) In\u00a0[\u00a0]: Copied! <pre># Move slider to 75% position (more of the right map visible)\ncompare.set_slider_position(0.75)\n</pre> # Move slider to 75% position (more of the right map visible) compare.set_slider_position(0.75) In\u00a0[\u00a0]: Copied! <pre># Center the slider\"\ncompare.set_slider_position(0.5)\n</pre> # Center the slider\" compare.set_slider_position(0.5) In\u00a0[\u00a0]: Copied! <pre># Switch to horizontal orientation (top/bottom comparison)\ncompare.set_orientation(\"horizontal\")\n</pre> # Switch to horizontal orientation (top/bottom comparison) compare.set_orientation(\"horizontal\") In\u00a0[\u00a0]: Copied! <pre># Switch back to vertical orientation (left/right comparison)\ncompare.set_orientation(\"vertical\")\n</pre> # Switch back to vertical orientation (left/right comparison) compare.set_orientation(\"vertical\") In\u00a0[\u00a0]: Copied! <pre># Disable mouse move (slider must be dragged)\ncompare.enable_mousemove(False)\n</pre> # Disable mouse move (slider must be dragged) compare.enable_mousemove(False) In\u00a0[\u00a0]: Copied! <pre># Re-enable mouse move\ncompare.enable_mousemove(True)\n</pre> # Re-enable mouse move compare.enable_mousemove(True) In\u00a0[\u00a0]: Copied! <pre># Update the left map to a different style\ncompare.update_left_map({\"style\": \"https://tiles.stadiamaps.com/styles/outdoors.json\"})\n</pre> # Update the left map to a different style compare.update_left_map({\"style\": \"https://tiles.stadiamaps.com/styles/outdoors.json\"}) In\u00a0[\u00a0]: Copied! <pre># Update the right map to a satellite style\ncompare.update_right_map(\n    {\"style\": \"https://tiles.stadiamaps.com/styles/alidade_satellite.json\"}\n)\n</pre> # Update the right map to a satellite style compare.update_right_map(     {\"style\": \"https://tiles.stadiamaps.com/styles/alidade_satellite.json\"} ) In\u00a0[\u00a0]: Copied! <pre># Fly to New York City\ncompare.fly_to(40.7128, -74.0060, zoom=13)\n</pre> # Fly to New York City compare.fly_to(40.7128, -74.0060, zoom=13) In\u00a0[\u00a0]: Copied! <pre># Fly to London\ncompare.fly_to(51.5074, -0.1278, zoom=12)\n</pre> # Fly to London compare.fly_to(51.5074, -0.1278, zoom=12) In\u00a0[\u00a0]: Copied! <pre># Disable center synchronization but keep zoom sync\ncompare.set_sync_options(center=False, zoom=True, bearing=True, pitch=True)\n</pre> # Disable center synchronization but keep zoom sync compare.set_sync_options(center=False, zoom=True, bearing=True, pitch=True) In\u00a0[\u00a0]: Copied! <pre># Re-enable all synchronization\ncompare.set_sync_options(center=True, zoom=True, bearing=True, pitch=True)\n</pre> # Re-enable all synchronization compare.set_sync_options(center=True, zoom=True, bearing=True, pitch=True) In\u00a0[\u00a0]: Copied! <pre># Uncomment and set your Mapbox access token\n# import os\n# os.environ['MAPBOX_ACCESS_TOKEN'] = 'your_mapbox_token_here'\n\n# mapbox_compare = anymap.MapCompare(\n#     left_map={\n#         \"center\": [37.7749, -122.4194],\n#         \"zoom\": 12,\n#         \"style\": \"mapbox://styles/mapbox/streets-v12\"\n#     },\n#     right_map={\n#         \"center\": [37.7749, -122.4194],\n#         \"zoom\": 12,\n#         \"style\": \"mapbox://styles/mapbox/satellite-v9\"\n#     },\n#     backend=\"mapbox\",\n#     orientation=\"vertical\",\n#     mousemove=True,\n#     height=\"500px\"\n# )\n\n# mapbox_compare\n</pre> # Uncomment and set your Mapbox access token # import os # os.environ['MAPBOX_ACCESS_TOKEN'] = 'your_mapbox_token_here'  # mapbox_compare = anymap.MapCompare( #     left_map={ #         \"center\": [37.7749, -122.4194], #         \"zoom\": 12, #         \"style\": \"mapbox://styles/mapbox/streets-v12\" #     }, #     right_map={ #         \"center\": [37.7749, -122.4194], #         \"zoom\": 12, #         \"style\": \"mapbox://styles/mapbox/satellite-v9\" #     }, #     backend=\"mapbox\", #     orientation=\"vertical\", #     mousemove=True, #     height=\"500px\" # )  # mapbox_compare In\u00a0[\u00a0]: Copied! <pre># Define an event handler\ndef on_slide_end(event):\n    print(f\"Slider moved to position: {event.get('position', 'unknown')}\")\n\n\n# Register the event handler\ncompare.on_event(\"slideend\", on_slide_end)\n</pre> # Define an event handler def on_slide_end(event):     print(f\"Slider moved to position: {event.get('position', 'unknown')}\")   # Register the event handler compare.on_event(\"slideend\", on_slide_end) In\u00a0[\u00a0]: Copied! <pre># Second comparison with different settings\ncompare2 = anymap.MapCompare(\n    left_map={\n        \"center\": [51.5074, -0.1278],  # London\n        \"zoom\": 10,\n        \"style\": \"https://demotiles.maplibre.org/style.json\",\n    },\n    right_map={\n        \"center\": [51.5074, -0.1278],\n        \"zoom\": 10,\n        \"style\": \"https://tiles.stadiamaps.com/styles/alidade_smooth_dark.json\",\n    },\n    backend=\"maplibre\",\n    orientation=\"horizontal\",\n    mousemove=False,\n    height=\"400px\",\n)\n\ncompare2\n</pre> # Second comparison with different settings compare2 = anymap.MapCompare(     left_map={         \"center\": [51.5074, -0.1278],  # London         \"zoom\": 10,         \"style\": \"https://demotiles.maplibre.org/style.json\",     },     right_map={         \"center\": [51.5074, -0.1278],         \"zoom\": 10,         \"style\": \"https://tiles.stadiamaps.com/styles/alidade_smooth_dark.json\",     },     backend=\"maplibre\",     orientation=\"horizontal\",     mousemove=False,     height=\"400px\", )  compare2 In\u00a0[\u00a0]: Copied! <pre># You can also get the HTML content without saving to file\nhtml_content = compare.to_html(title=\"My Map Comparison\")\nprint(\"HTML content generated (first 500 characters):\")\nprint(html_content[:500] + \"...\")\n</pre> # You can also get the HTML content without saving to file html_content = compare.to_html(title=\"My Map Comparison\") print(\"HTML content generated (first 500 characters):\") print(html_content[:500] + \"...\") In\u00a0[\u00a0]: Copied! <pre># Export to HTML file\nhtml_content = compare.to_html(\n    filename=\"map_comparison.html\", title=\"San Francisco Map Style Comparison\"\n)\n\nprint(\"Map comparison exported to map_comparison.html\")\nprint(f\"HTML file size: {len(html_content)} characters\")\n</pre> # Export to HTML file html_content = compare.to_html(     filename=\"map_comparison.html\", title=\"San Francisco Map Style Comparison\" )  print(\"Map comparison exported to map_comparison.html\") print(f\"HTML file size: {len(html_content)} characters\")"},{"location":"examples/maplibre/map_comparison/#map-comparison-example","title":"Map Comparison Example\u00b6","text":"<p>This notebook demonstrates the map comparison functionality in anymap using the MapCompare widget. You can compare two maps side-by-side with different styles, data layers, or temporal states.</p>"},{"location":"examples/maplibre/map_comparison/#features","title":"Features\u00b6","text":"<ul> <li>Side-by-side map comparison with swipe control</li> <li>Support for both MapLibre and Mapbox backends</li> <li>Configurable orientation (vertical/horizontal)</li> <li>Map synchronization options</li> <li>Interactive slider control</li> </ul>"},{"location":"examples/maplibre/map_comparison/#basic-maplibre-comparison","title":"Basic MapLibre Comparison\u00b6","text":"<p>Let's start with a basic comparison of two different MapLibre styles.</p>"},{"location":"examples/maplibre/map_comparison/#controlling-the-slider-position","title":"Controlling the Slider Position\u00b6","text":"<p>You can programmatically control the slider position.</p>"},{"location":"examples/maplibre/map_comparison/#changing-orientation","title":"Changing Orientation\u00b6","text":"<p>You can switch between vertical and horizontal orientations.</p>"},{"location":"examples/maplibre/map_comparison/#enablingdisabling-mouse-move","title":"Enabling/Disabling Mouse Move\u00b6","text":"<p>You can control whether the slider follows mouse movement or requires dragging.</p>"},{"location":"examples/maplibre/map_comparison/#updating-map-styles","title":"Updating Map Styles\u00b6","text":"<p>You can dynamically update the styles of either map.</p>"},{"location":"examples/maplibre/map_comparison/#flying-to-different-locations","title":"Flying to Different Locations\u00b6","text":"<p>You can fly both maps to a new location simultaneously.</p>"},{"location":"examples/maplibre/map_comparison/#synchronization-options","title":"Synchronization Options\u00b6","text":"<p>You can control which aspects of the maps are synchronized.</p>"},{"location":"examples/maplibre/map_comparison/#mapbox-comparison-requires-access-token","title":"Mapbox Comparison (requires access token)\u00b6","text":"<p>If you have a Mapbox access token, you can use Mapbox styles for comparison.</p>"},{"location":"examples/maplibre/map_comparison/#event-handling","title":"Event Handling\u00b6","text":"<p>You can listen to events from the comparison widget.</p>"},{"location":"examples/maplibre/map_comparison/#conclusion","title":"Conclusion\u00b6","text":"<p>The MapCompare widget provides a powerful way to compare different map styles, data layers, or temporal states side-by-side. Key features include:</p> <ol> <li>Interactive Swipe Control: Easily compare maps by dragging the slider or moving the mouse</li> <li>Multiple Backends: Support for both MapLibre and Mapbox</li> <li>Flexible Orientation: Choose between vertical and horizontal comparisons</li> <li>Synchronization Options: Control which map properties are synchronized</li> <li>Dynamic Updates: Change styles and settings programmatically</li> <li>Multiple Widgets: Create multiple comparisons in the same notebook</li> <li>HTML Export: Export comparisons to standalone HTML files</li> </ol> <p>This makes it ideal for:</p> <ul> <li>Comparing different map styles</li> <li>Before/after visualizations</li> <li>Temporal data comparisons</li> <li>A/B testing of map designs</li> <li>Educational demonstrations</li> <li>Sharing interactive comparisons as HTML files</li> </ul>"},{"location":"examples/maplibre/map_comparison/#html-export","title":"HTML Export\u00b6","text":"<p>You can export any comparison widget to a standalone HTML file.</p>"},{"location":"examples/maplibre/map_comparison/#conclusion","title":"Conclusion\u00b6","text":"<p>The MapCompare widget provides a powerful way to compare different map styles, data layers, or temporal states side-by-side. Key features include:</p> <ol> <li>Interactive Swipe Control: Easily compare maps by dragging the slider or moving the mouse</li> <li>Multiple Backends: Support for both MapLibre and Mapbox</li> <li>Flexible Orientation: Choose between vertical and horizontal comparisons</li> <li>Synchronization Options: Control which map properties are synchronized</li> <li>Dynamic Updates: Change styles and settings programmatically</li> <li>Multiple Widgets: Create multiple comparisons in the same notebook</li> </ol> <p>This makes it ideal for:</p> <ul> <li>Comparing different map styles</li> <li>Before/after visualizations</li> <li>Temporal data comparisons</li> <li>A/B testing of map designs</li> <li>Educational demonstrations</li> </ul>"},{"location":"examples/maplibre/maplibre_add_raster/","title":"Maplibre add raster","text":"In\u00a0[\u00a0]: Copied! <pre>import anymap\n</pre> import anymap In\u00a0[\u00a0]: Copied! <pre>url = \"https://github.com/opengeos/datasets/releases/download/raster/landsat.tif\"\nfilepath = \"landsat.tif\"\nanymap.download_file(url, filepath)\n</pre> url = \"https://github.com/opengeos/datasets/releases/download/raster/landsat.tif\" filepath = \"landsat.tif\" anymap.download_file(url, filepath) In\u00a0[\u00a0]: Copied! <pre>m = anymap.Map()\nm = anymap.Map(style=\"liberty\")\nm.add_raster(filepath, indexes=[3, 2, 1], vmin=0, vmax=100, name=\"Landsat-321\")\nm.add_raster(filepath, indexes=[4, 3, 2], vmin=0, vmax=100, name=\"Landsat-432\")\nm\n</pre> m = anymap.Map() m = anymap.Map(style=\"liberty\") m.add_raster(filepath, indexes=[3, 2, 1], vmin=0, vmax=100, name=\"Landsat-321\") m.add_raster(filepath, indexes=[4, 3, 2], vmin=0, vmax=100, name=\"Landsat-432\") m"},{"location":"examples/maplibre/maplibre_add_vector/","title":"Maplibre add vector","text":"In\u00a0[\u00a0]: Copied! <pre>import anymap\n</pre> import anymap In\u00a0[\u00a0]: Copied! <pre>m = anymap.Map()\nm.add_basemap(\"Esri.WorldImagery\")\nfilepath = \"https://huggingface.co/datasets/giswqs/geospatial/resolve/main/naip_train_buildings.geojson\"\nm.add_vector(filepath, opacity=0.5)\nm\n</pre> m = anymap.Map() m.add_basemap(\"Esri.WorldImagery\") filepath = \"https://huggingface.co/datasets/giswqs/geospatial/resolve/main/naip_train_buildings.geojson\" m.add_vector(filepath, opacity=0.5) m"},{"location":"examples/maplibre/maplibre_example/","title":"Maplibre example","text":"In\u00a0[\u00a0]: Copied! <pre>from anymap import MapLibreMap\n</pre> from anymap import MapLibreMap In\u00a0[\u00a0]: Copied! <pre># Create the main test map\nm = MapLibreMap(\n    center=[-100, 40],\n    zoom=3.5,\n    height=\"600px\",\n    width=\"100%\",\n)\nm\n</pre> # Create the main test map m = MapLibreMap(     center=[-100, 40],     zoom=3.5,     height=\"600px\",     width=\"100%\", ) m In\u00a0[\u00a0]: Copied! <pre>m = MapLibreMap(\n    center=[-122.4194, 37.7749],\n    zoom=12,\n    height=\"600px\",\n    width=\"100%\",\n    projection=\"globe\",\n    add_sidebar=True,  # San Francisco\n)\nm.add_basemap(\"Esri.WorldImagery\")\nm\n</pre> m = MapLibreMap(     center=[-122.4194, 37.7749],     zoom=12,     height=\"600px\",     width=\"100%\",     projection=\"globe\",     add_sidebar=True,  # San Francisco ) m.add_basemap(\"Esri.WorldImagery\") m In\u00a0[\u00a0]: Copied! <pre>m.set_opacity(\"Esri.WorldImagery\", 0.5)\n</pre> m.set_opacity(\"Esri.WorldImagery\", 0.5) In\u00a0[\u00a0]: Copied! <pre>m.set_visibility(\"Esri.WorldImagery\", False)\n</pre> m.set_visibility(\"Esri.WorldImagery\", False) In\u00a0[\u00a0]: Copied! <pre>url = \"https://mt1.google.com/vt/lyrs=s&amp;x={x}&amp;y={y}&amp;z={z}\"\n</pre> url = \"https://mt1.google.com/vt/lyrs=s&amp;x={x}&amp;y={y}&amp;z={z}\" In\u00a0[\u00a0]: Copied! <pre>m.add_tile_layer(\"Satellite\", source_url=url, attribution=\"Google\")\n</pre> m.add_tile_layer(\"Satellite\", source_url=url, attribution=\"Google\") In\u00a0[\u00a0]: Copied! <pre># Display the same map instance again - should render without issues\nprint(\"Displaying the SAME map instance in a second cell...\")\nm\n</pre> # Display the same map instance again - should render without issues print(\"Displaying the SAME map instance in a second cell...\") m In\u00a0[\u00a0]: Copied! <pre># Add a GeoJSON layer with points of interest in San Francisco\nsf_poi = {\n    \"type\": \"FeatureCollection\",\n    \"features\": [\n        {\n            \"type\": \"Feature\",\n            \"geometry\": {\"type\": \"Point\", \"coordinates\": [-122.4194, 37.7749]},\n            \"properties\": {\"name\": \"San Francisco City Hall\", \"type\": \"government\"},\n        },\n        {\n            \"type\": \"Feature\",\n            \"geometry\": {\"type\": \"Point\", \"coordinates\": [-122.4183, 37.7793]},\n            \"properties\": {\"name\": \"Golden Gate Park\", \"type\": \"park\"},\n        },\n        {\n            \"type\": \"Feature\",\n            \"geometry\": {\"type\": \"Point\", \"coordinates\": [-122.3959, 37.7937]},\n            \"properties\": {\"name\": \"Fisherman's Wharf\", \"type\": \"attraction\"},\n        },\n    ],\n}\n\n# Add the layer\nm.add_geojson_layer(\n    layer_id=\"sf_poi\",\n    geojson_data=sf_poi,\n    layer_type=\"circle\",\n    paint={\n        \"circle-radius\": 8,\n        \"circle-color\": \"#ff6b6b\",\n        \"circle-stroke-width\": 2,\n        \"circle-stroke-color\": \"#ffffff\",\n    },\n)\n\n# Add markers\nm.add_marker(-122.4194, 37.7749, popup=\"&lt;b&gt;City Hall&lt;/b&gt;&lt;br&gt;Government building\")\nm.add_marker(-122.4183, 37.7793, popup=\"&lt;b&gt;Golden Gate Park&lt;/b&gt;&lt;br&gt;Beautiful park\")\n\nprint(\"Added GeoJSON layer and markers. Current layers:\", list(m.get_layers().keys()))\n</pre> # Add a GeoJSON layer with points of interest in San Francisco sf_poi = {     \"type\": \"FeatureCollection\",     \"features\": [         {             \"type\": \"Feature\",             \"geometry\": {\"type\": \"Point\", \"coordinates\": [-122.4194, 37.7749]},             \"properties\": {\"name\": \"San Francisco City Hall\", \"type\": \"government\"},         },         {             \"type\": \"Feature\",             \"geometry\": {\"type\": \"Point\", \"coordinates\": [-122.4183, 37.7793]},             \"properties\": {\"name\": \"Golden Gate Park\", \"type\": \"park\"},         },         {             \"type\": \"Feature\",             \"geometry\": {\"type\": \"Point\", \"coordinates\": [-122.3959, 37.7937]},             \"properties\": {\"name\": \"Fisherman's Wharf\", \"type\": \"attraction\"},         },     ], }  # Add the layer m.add_geojson_layer(     layer_id=\"sf_poi\",     geojson_data=sf_poi,     layer_type=\"circle\",     paint={         \"circle-radius\": 8,         \"circle-color\": \"#ff6b6b\",         \"circle-stroke-width\": 2,         \"circle-stroke-color\": \"#ffffff\",     }, )  # Add markers m.add_marker(-122.4194, 37.7749, popup=\"City HallGovernment building\") m.add_marker(-122.4183, 37.7793, popup=\"Golden Gate ParkBeautiful park\")  print(\"Added GeoJSON layer and markers. Current layers:\", list(m.get_layers().keys())) In\u00a0[\u00a0]: Copied! <pre># Render the map again - layers should persist\nprint(\"Rendering map with layers in a new cell...\")\nprint(\"Layers should be visible:\", list(m.get_layers().keys()))\nprint(\"Sources should include:\", list(m.get_sources().keys()))\nm\n</pre> # Render the map again - layers should persist print(\"Rendering map with layers in a new cell...\") print(\"Layers should be visible:\", list(m.get_layers().keys())) print(\"Sources should include:\", list(m.get_sources().keys())) m In\u00a0[\u00a0]: Copied! <pre>m\n</pre> m In\u00a0[\u00a0]: Copied! <pre># Modify map properties\nm.fly_to(-122.2712, 37.8044, zoom=15)  # Fly to Berkeley\nm.set_bearing(45)  # Rotate the map\nm.set_pitch(45)  # Tilt the map\n\nprint(\"Modified map view - flying to Berkeley with rotation and tilt\")\n</pre> # Modify map properties m.fly_to(-122.2712, 37.8044, zoom=15)  # Fly to Berkeley m.set_bearing(45)  # Rotate the map m.set_pitch(45)  # Tilt the map  print(\"Modified map view - flying to Berkeley with rotation and tilt\") In\u00a0[\u00a0]: Copied! <pre># Add more layers to test different layer types\nberkeley_area = {\n    \"type\": \"FeatureCollection\",\n    \"features\": [\n        {\n            \"type\": \"Feature\",\n            \"geometry\": {\n                \"type\": \"Polygon\",\n                \"coordinates\": [\n                    [\n                        [-122.2850, 37.8000],\n                        [-122.2700, 37.8000],\n                        [-122.2700, 37.8100],\n                        [-122.2850, 37.8100],\n                        [-122.2850, 37.8000],\n                    ]\n                ],\n            },\n            \"properties\": {\"name\": \"Berkeley Area\"},\n        }\n    ],\n}\n\n# Add polygon layer\nm.add_geojson_layer(\n    layer_id=\"berkeley_area\",\n    geojson_data=berkeley_area,\n    layer_type=\"fill\",\n    paint={\"fill-color\": \"#4a90e2\", \"fill-opacity\": 0.3},\n)\n\nprint(\"Added Berkeley area polygon layer\")\n</pre> # Add more layers to test different layer types berkeley_area = {     \"type\": \"FeatureCollection\",     \"features\": [         {             \"type\": \"Feature\",             \"geometry\": {                 \"type\": \"Polygon\",                 \"coordinates\": [                     [                         [-122.2850, 37.8000],                         [-122.2700, 37.8000],                         [-122.2700, 37.8100],                         [-122.2850, 37.8100],                         [-122.2850, 37.8000],                     ]                 ],             },             \"properties\": {\"name\": \"Berkeley Area\"},         }     ], }  # Add polygon layer m.add_geojson_layer(     layer_id=\"berkeley_area\",     geojson_data=berkeley_area,     layer_type=\"fill\",     paint={\"fill-color\": \"#4a90e2\", \"fill-opacity\": 0.3}, )  print(\"Added Berkeley area polygon layer\") In\u00a0[\u00a0]: Copied! <pre>m\n</pre> m In\u00a0[\u00a0]: Copied! <pre># Display map again with all modifications\nprint(\"Displaying map with all modifications and layers:\")\nprint(\"Current layers:\", list(m.get_layers().keys()))\nm\n</pre> # Display map again with all modifications print(\"Displaying map with all modifications and layers:\") print(\"Current layers:\", list(m.get_layers().keys())) m In\u00a0[\u00a0]: Copied! <pre># Create a second independent map\nm2 = MapLibreMap(center=[-74.0060, 40.7128], zoom=12, height=\"600px\")  # New York City\n\n# Add different data to the second map\nnyc_poi = {\n    \"type\": \"FeatureCollection\",\n    \"features\": [\n        {\n            \"type\": \"Feature\",\n            \"geometry\": {\"type\": \"Point\", \"coordinates\": [-74.0060, 40.7128]},\n            \"properties\": {\"name\": \"Times Square\", \"type\": \"attraction\"},\n        },\n        {\n            \"type\": \"Feature\",\n            \"geometry\": {\"type\": \"Point\", \"coordinates\": [-73.9857, 40.7484]},\n            \"properties\": {\"name\": \"Central Park\", \"type\": \"park\"},\n        },\n    ],\n}\n\nm2.add_geojson_layer(\n    layer_id=\"nyc_poi\",\n    geojson_data=nyc_poi,\n    layer_type=\"circle\",\n    paint={\n        \"circle-radius\": 10,\n        \"circle-color\": \"#50C878\",\n        \"circle-stroke-width\": 2,\n        \"circle-stroke-color\": \"#ffffff\",\n    },\n)\n\nprint(\"Created second map (NYC) with different layers\")\nprint(\"Map 1 layers:\", list(m.get_layers().keys()))\nprint(\"Map 2 layers:\", list(m2.get_layers().keys()))\nm2\n</pre> # Create a second independent map m2 = MapLibreMap(center=[-74.0060, 40.7128], zoom=12, height=\"600px\")  # New York City  # Add different data to the second map nyc_poi = {     \"type\": \"FeatureCollection\",     \"features\": [         {             \"type\": \"Feature\",             \"geometry\": {\"type\": \"Point\", \"coordinates\": [-74.0060, 40.7128]},             \"properties\": {\"name\": \"Times Square\", \"type\": \"attraction\"},         },         {             \"type\": \"Feature\",             \"geometry\": {\"type\": \"Point\", \"coordinates\": [-73.9857, 40.7484]},             \"properties\": {\"name\": \"Central Park\", \"type\": \"park\"},         },     ], }  m2.add_geojson_layer(     layer_id=\"nyc_poi\",     geojson_data=nyc_poi,     layer_type=\"circle\",     paint={         \"circle-radius\": 10,         \"circle-color\": \"#50C878\",         \"circle-stroke-width\": 2,         \"circle-stroke-color\": \"#ffffff\",     }, )  print(\"Created second map (NYC) with different layers\") print(\"Map 1 layers:\", list(m.get_layers().keys())) print(\"Map 2 layers:\", list(m2.get_layers().keys())) m2 In\u00a0[\u00a0]: Copied! <pre># Display both maps side by side to verify independence\nprint(\"Original map (San Francisco/Berkeley area):\")\nprint(\"Layers:\", list(m.get_layers().keys()))\nm\n</pre> # Display both maps side by side to verify independence print(\"Original map (San Francisco/Berkeley area):\") print(\"Layers:\", list(m.get_layers().keys())) m In\u00a0[\u00a0]: Copied! <pre># Second map again\nprint(\"Second map (New York City):\")\nprint(\"Layers:\", list(m2.get_layers().keys()))\nm2\n</pre> # Second map again print(\"Second map (New York City):\") print(\"Layers:\", list(m2.get_layers().keys())) m2 In\u00a0[\u00a0]: Copied! <pre># Set up event handlers\nclick_events = []\nmove_events = []\n\n\ndef on_map_click(event):\n    lat, lng = event[\"lngLat\"]\n    click_events.append(f\"Clicked at: {lat:.4f}, {lng:.4f}\")\n    print(f\"Map clicked at: {lat:.4f}, {lng:.4f}\")\n\n\ndef on_map_move(event):\n    center = event.get(\"center\", [0, 0])\n    zoom = event.get(\"zoom\", 0)\n    move_events.append(f\"Moved to: {center[0]:.4f}, {center[1]:.4f} at zoom {zoom:.2f}\")\n    print(f\"Map moved to: {center[0]:.4f}, {center[1]:.4f} at zoom {zoom:.2f}\")\n\n\n# Register event handlers\nm.on_map_event(\"click\", on_map_click)\nm.on_map_event(\"moveend\", on_map_move)\n\nprint(\"Event handlers registered. Click and move the map to test!\")\nprint(\"Events will be captured and displayed here.\")\n</pre> # Set up event handlers click_events = [] move_events = []   def on_map_click(event):     lat, lng = event[\"lngLat\"]     click_events.append(f\"Clicked at: {lat:.4f}, {lng:.4f}\")     print(f\"Map clicked at: {lat:.4f}, {lng:.4f}\")   def on_map_move(event):     center = event.get(\"center\", [0, 0])     zoom = event.get(\"zoom\", 0)     move_events.append(f\"Moved to: {center[0]:.4f}, {center[1]:.4f} at zoom {zoom:.2f}\")     print(f\"Map moved to: {center[0]:.4f}, {center[1]:.4f} at zoom {zoom:.2f}\")   # Register event handlers m.on_map_event(\"click\", on_map_click) m.on_map_event(\"moveend\", on_map_move)  print(\"Event handlers registered. Click and move the map to test!\") print(\"Events will be captured and displayed here.\") In\u00a0[\u00a0]: Copied! <pre># Display the map with event handlers\nprint(\"Interactive map with event handlers - try clicking and panning!\")\nm\n</pre> # Display the map with event handlers print(\"Interactive map with event handlers - try clicking and panning!\") m In\u00a0[\u00a0]: Copied! <pre># Check collected events\nprint(\"Recent click events:\")\nfor event in click_events[-5:]:  # Show last 5\n    print(f\"  {event}\")\n\nprint(\"\\nRecent move events:\")\nfor event in move_events[-5:]:  # Show last 5\n    print(f\"  {event}\")\n\nprint(f\"\\nTotal click events: {len(click_events)}\")\nprint(f\"Total move events: {len(move_events)}\")\n</pre> # Check collected events print(\"Recent click events:\") for event in click_events[-5:]:  # Show last 5     print(f\"  {event}\")  print(\"\\nRecent move events:\") for event in move_events[-5:]:  # Show last 5     print(f\"  {event}\")  print(f\"\\nTotal click events: {len(click_events)}\") print(f\"Total move events: {len(move_events)}\") In\u00a0[\u00a0]: Copied! <pre># Test layer management methods\nprint(\"Current layers before cleanup:\", list(m.get_layers().keys()))\nprint(\"Current sources before cleanup:\", list(m.get_sources().keys()))\n\n# Create a new map for testing layer management\nm3 = MapLibreMap(center=[-0.1278, 51.5074], zoom=12, height=\"600px\")  # London\n\n# Add multiple test layers\ntest_data = {\n    \"type\": \"FeatureCollection\",\n    \"features\": [\n        {\n            \"type\": \"Feature\",\n            \"geometry\": {\"type\": \"Point\", \"coordinates\": [-0.1278, 51.5074]},\n            \"properties\": {\"name\": \"Big Ben\"},\n        }\n    ],\n}\n\nm3.add_geojson_layer(\"test1\", test_data, \"circle\", {\"circle-color\": \"red\"})\nm3.add_geojson_layer(\"test2\", test_data, \"circle\", {\"circle-color\": \"blue\"})\nm3.add_geojson_layer(\"test3\", test_data, \"circle\", {\"circle-color\": \"green\"})\n\nprint(\"\\nLayers after adding test layers:\", list(m3.get_layers().keys()))\nm3\n</pre> # Test layer management methods print(\"Current layers before cleanup:\", list(m.get_layers().keys())) print(\"Current sources before cleanup:\", list(m.get_sources().keys()))  # Create a new map for testing layer management m3 = MapLibreMap(center=[-0.1278, 51.5074], zoom=12, height=\"600px\")  # London  # Add multiple test layers test_data = {     \"type\": \"FeatureCollection\",     \"features\": [         {             \"type\": \"Feature\",             \"geometry\": {\"type\": \"Point\", \"coordinates\": [-0.1278, 51.5074]},             \"properties\": {\"name\": \"Big Ben\"},         }     ], }  m3.add_geojson_layer(\"test1\", test_data, \"circle\", {\"circle-color\": \"red\"}) m3.add_geojson_layer(\"test2\", test_data, \"circle\", {\"circle-color\": \"blue\"}) m3.add_geojson_layer(\"test3\", test_data, \"circle\", {\"circle-color\": \"green\"})  print(\"\\nLayers after adding test layers:\", list(m3.get_layers().keys())) m3 In\u00a0[\u00a0]: Copied! <pre># Test clearing layers\nprint(\"Before clearing - Layers:\", list(m3.get_layers().keys()))\nm3.clear_layers()\nprint(\"After clearing layers - Layers:\", list(m3.get_layers().keys()))\nprint(\"Sources still exist:\", list(m3.get_sources().keys()))\n\n# Display map after clearing layers\nm3\n</pre> # Test clearing layers print(\"Before clearing - Layers:\", list(m3.get_layers().keys())) m3.clear_layers() print(\"After clearing layers - Layers:\", list(m3.get_layers().keys())) print(\"Sources still exist:\", list(m3.get_sources().keys()))  # Display map after clearing layers m3 In\u00a0[\u00a0]: Copied! <pre># Final test - render all three maps in sequence\nprint(\"=== FINAL MULTI-CELL TEST ===\")\nprint(\"\\n1. Original map (San Francisco area):\")\nprint(\"   Layers:\", list(m.get_layers().keys()))\nprint(\"   Center:\", m.center, \"Zoom:\", m.zoom)\nm\n</pre> # Final test - render all three maps in sequence print(\"=== FINAL MULTI-CELL TEST ===\") print(\"\\n1. Original map (San Francisco area):\") print(\"   Layers:\", list(m.get_layers().keys())) print(\"   Center:\", m.center, \"Zoom:\", m.zoom) m In\u00a0[\u00a0]: Copied! <pre>print(\"2. Second map (New York City):\")\nprint(\"   Layers:\", list(m2.get_layers().keys()))\nprint(\"   Center:\", m2.center, \"Zoom:\", m2.zoom)\nm2\n</pre> print(\"2. Second map (New York City):\") print(\"   Layers:\", list(m2.get_layers().keys())) print(\"   Center:\", m2.center, \"Zoom:\", m2.zoom) m2 In\u00a0[\u00a0]: Copied! <pre>print(\"3. Third map (London - after layer clearing):\")\nprint(\"   Layers:\", list(m3.get_layers().keys()))\nprint(\"   Center:\", m3.center, \"Zoom:\", m3.zoom)\nm3\n</pre> print(\"3. Third map (London - after layer clearing):\") print(\"   Layers:\", list(m3.get_layers().keys())) print(\"   Center:\", m3.center, \"Zoom:\", m3.zoom) m3 In\u00a0[\u00a0]: Copied! <pre># Match the exact parameters from cog.html\nm = MapLibreMap(\n    center=[11.39831, 47.26244],  # [lng, lat] format\n    zoom=14,\n)\n\n# Add COG layer with exact same parameters as cog.html\nm.add_cog_layer(\n    layer_id=\"cogLayer\",\n    cog_url=\"https://maplibre.org/maplibre-gl-js/docs/assets/cog.tif\",\n)\n\n# Export to HTML\nm.to_html(\"COG.html\", title=\"Add a COG raster source\")\nm\n</pre> # Match the exact parameters from cog.html m = MapLibreMap(     center=[11.39831, 47.26244],  # [lng, lat] format     zoom=14, )  # Add COG layer with exact same parameters as cog.html m.add_cog_layer(     layer_id=\"cogLayer\",     cog_url=\"https://maplibre.org/maplibre-gl-js/docs/assets/cog.tif\", )  # Export to HTML m.to_html(\"COG.html\", title=\"Add a COG raster source\") m"},{"location":"examples/maplibre/maplibre_example/#anymap-multi-cell-rendering-test","title":"AnyMap Multi-Cell Rendering Test\u00b6","text":"<p>This notebook thoroughly tests the anymap package's ability to render interactive maps across multiple cells without issues. It also tests layer persistence, bidirectional communication, and various MapLibre features.</p>"},{"location":"examples/maplibre/maplibre_example/#test-1-basic-map-creation-and-multi-cell-rendering","title":"Test 1: Basic Map Creation and Multi-Cell Rendering\u00b6","text":"<p>Let's create a map and test that it renders correctly across multiple cells.</p>"},{"location":"examples/maplibre/maplibre_example/#test-2-layer-persistence","title":"Test 2: Layer Persistence\u00b6","text":"<p>Now let's add some layers and verify they persist when the map is rendered in multiple cells.</p>"},{"location":"examples/maplibre/maplibre_example/#test-3-dynamic-map-modifications","title":"Test 3: Dynamic Map Modifications\u00b6","text":"<p>Test that modifications to the map work correctly across cells.</p>"},{"location":"examples/maplibre/maplibre_example/#test-4-multiple-independent-map-instances","title":"Test 4: Multiple Independent Map Instances\u00b6","text":"<p>Test creating multiple independent map instances that work independently.</p>"},{"location":"examples/maplibre/maplibre_example/#test-5-event-handling-and-bidirectional-communication","title":"Test 5: Event Handling and Bidirectional Communication\u00b6","text":"<p>Test the event handling system and bidirectional communication.</p>"},{"location":"examples/maplibre/maplibre_example/#test-6-layer-management-methods","title":"Test 6: Layer Management Methods\u00b6","text":"<p>Test the enhanced layer management functionality.</p>"},{"location":"examples/maplibre/maplibre_example/#test-7-final-multi-cell-persistence-test","title":"Test 7: Final Multi-Cell Persistence Test\u00b6","text":"<p>Let's do a final comprehensive test to ensure everything works across cells.</p>"},{"location":"examples/maplibre/maplibre_example/#test-8-add-cog","title":"Test 8: Add COG\u00b6","text":""},{"location":"examples/maplibre/maplibre_example/#test-summary","title":"Test Summary\u00b6","text":"<p>If all the above tests worked correctly, you should observe:</p> <ol> <li>\u2705 Multi-cell rendering: The same map instance renders correctly in multiple cells</li> <li>\u2705 Layer persistence: Layers added to a map persist when the map is rendered in different cells</li> <li>\u2705 Independent instances: Multiple map instances work independently without interfering with each other</li> <li>\u2705 Dynamic modifications: Map property changes (zoom, center, bearing, pitch) work correctly</li> <li>\u2705 Event handling: Click and move events are captured and handled properly</li> <li>\u2705 Layer management: Adding, removing, and clearing layers works as expected</li> <li>\u2705 State synchronization: The JavaScript frontend and Python backend maintain synchronized state</li> </ol>"},{"location":"examples/maplibre/maplibre_example/#compatibility-notes","title":"Compatibility Notes\u00b6","text":"<p>This implementation should work in:</p> <ul> <li>JupyterLab (Classic and modern)</li> <li>Jupyter Notebook (Classic)</li> <li>VS Code with Jupyter extension</li> <li>Google Colab</li> <li>Other Jupyter-compatible environments</li> </ul> <p>The anywidget framework ensures broad compatibility across different Jupyter environments.</p>"},{"location":"examples/maplibre/maplibre_export_map/","title":"Maplibre export map","text":"In\u00a0[\u00a0]: Copied! <pre>from anymap.maplibre import MapLibreMap\n\nm = MapLibreMap()\nm.add_basemap(\"Esri.WorldImagery\")\nm.add_flatgeobuf_layer(\n    \"https://flatgeobuf.org/test/data/UScounties.fgb\",\n    layer_id=\"counties\",\n    layer_type=\"fill\",\n    paint={\n        \"fill-color\": \"#f97316\",\n        \"fill-outline-color\": \"#ffffff\",\n        \"fill-opacity\": 0.7,\n    },\n)\nm.add_export_control(printable_area=True)\nm\n</pre> from anymap.maplibre import MapLibreMap  m = MapLibreMap() m.add_basemap(\"Esri.WorldImagery\") m.add_flatgeobuf_layer(     \"https://flatgeobuf.org/test/data/UScounties.fgb\",     layer_id=\"counties\",     layer_type=\"fill\",     paint={         \"fill-color\": \"#f97316\",         \"fill-outline-color\": \"#ffffff\",         \"fill-opacity\": 0.7,     }, ) m.add_export_control(printable_area=True) m"},{"location":"examples/maplibre/maplibre_export_map/#export-maplibre-maps","title":"Export MapLibre Maps\u00b6","text":""},{"location":"examples/maplibre/maplibre_flatgeobuf/","title":"Maplibre flatgeobuf","text":"In\u00a0[\u00a0]: Copied! <pre>from anymap.maplibre import MapLibreMap\n\nm = MapLibreMap()\nm.add_basemap(\"Esri.WorldImagery\")\nm.add_flatgeobuf_layer(\n    \"https://flatgeobuf.org/test/data/UScounties.fgb\",\n    layer_id=\"counties\",\n    layer_type=\"fill\",\n    paint={\n        \"fill-color\": \"#f97316\",\n        \"fill-outline-color\": \"#ffffff\",\n        \"fill-opacity\": 0.7,\n    },\n)\n\nm.enable_feature_popup(\n    \"counties\",\n    # fields=[\"NAME\", \"STATEFP\", \"ALAND\"],\n    # aliases={\"NAME\": \"County\", \"STATEFP\": \"State\", \"ALAND\": \"Area (m\u00b2)\"},\n    # title_field=\"NAME\",\n    max_properties=10,\n)\nm\n</pre> from anymap.maplibre import MapLibreMap  m = MapLibreMap() m.add_basemap(\"Esri.WorldImagery\") m.add_flatgeobuf_layer(     \"https://flatgeobuf.org/test/data/UScounties.fgb\",     layer_id=\"counties\",     layer_type=\"fill\",     paint={         \"fill-color\": \"#f97316\",         \"fill-outline-color\": \"#ffffff\",         \"fill-opacity\": 0.7,     }, )  m.enable_feature_popup(     \"counties\",     # fields=[\"NAME\", \"STATEFP\", \"ALAND\"],     # aliases={\"NAME\": \"County\", \"STATEFP\": \"State\", \"ALAND\": \"Area (m\u00b2)\"},     # title_field=\"NAME\",     max_properties=10, ) m In\u00a0[\u00a0]: Copied! <pre>m.disable_feature_popup(layer_id=\"counties\")\n</pre> m.disable_feature_popup(layer_id=\"counties\")"},{"location":"examples/maplibre/maplibre_flatgeobuf/#add-flatgeobuf-layers","title":"Add FlatGeobuf layers\u00b6","text":""},{"location":"examples/maplibre/maplibre_geocoder_example/","title":"Maplibre geocoder example","text":"In\u00a0[\u00a0]: Copied! <pre>import os\nfrom anymap import MapLibreMap\n</pre> import os from anymap import MapLibreMap In\u00a0[\u00a0]: Copied! <pre>maptiler_api_key = os.environ.get(\"MAPTILER_KEY\")\n</pre> maptiler_api_key = os.environ.get(\"MAPTILER_KEY\") In\u00a0[\u00a0]: Copied! <pre># Create a map centered on San Francisco\nm = MapLibreMap(center=[-122.4194, 37.7749], zoom=12, style=\"positron\", height=\"600px\")\n\n# Add MapLibre GL Geocoder with Maptiler API\nm.add_maplibre_geocoder(\n    position=\"top-left\",\n    api_key=maptiler_api_key,\n    maplibre_api=\"maptiler\",\n    placeholder=\"Search for places...\",\n    marker=True,\n    show_result_markers=True,\n    collapsed=True,\n)\n\nm\n</pre> # Create a map centered on San Francisco m = MapLibreMap(center=[-122.4194, 37.7749], zoom=12, style=\"positron\", height=\"600px\")  # Add MapLibre GL Geocoder with Maptiler API m.add_maplibre_geocoder(     position=\"top-left\",     api_key=maptiler_api_key,     maplibre_api=\"maptiler\",     placeholder=\"Search for places...\",     marker=True,     show_result_markers=True,     collapsed=True, )  m In\u00a0[\u00a0]: Copied! <pre># Create a map centered on New York City\nm2 = MapLibreMap(\n    center=[-74.0060, 40.7128], zoom=11, style=\"dark-matter\", height=\"600px\"\n)\n\nmapbox_api_key = os.environ[\"MAPBOX_TOKEN\"]\n# Add MapLibre GL Geocoder with Mapbox API\nm2.add_maplibre_geocoder(\n    position=\"top-left\",\n    api_key=mapbox_api_key,\n    maplibre_api=\"mapbox\",\n    placeholder=\"Find a location...\",\n    language=\"en\",\n    marker=True,\n    collapsed=True,\n)\n\nm2\n</pre> # Create a map centered on New York City m2 = MapLibreMap(     center=[-74.0060, 40.7128], zoom=11, style=\"dark-matter\", height=\"600px\" )  mapbox_api_key = os.environ[\"MAPBOX_TOKEN\"] # Add MapLibre GL Geocoder with Mapbox API m2.add_maplibre_geocoder(     position=\"top-left\",     api_key=mapbox_api_key,     maplibre_api=\"mapbox\",     placeholder=\"Find a location...\",     language=\"en\",     marker=True,     collapsed=True, )  m2 In\u00a0[\u00a0]: Copied! <pre># Create a map focused on the United States\nm3 = MapLibreMap(center=[-98.5795, 39.8283], zoom=4, style=\"liberty\", height=\"600px\")\n\n# Add geocoder with country filter and specific place types\nm3.add_maplibre_geocoder(\n    position=\"top-left\",\n    api_key=maptiler_api_key,\n    maplibre_api=\"maptiler\",\n    placeholder=\"Search US cities...\",\n    country=\"us\",  # Limit to United States\n    types=\"place,locality\",  # Only show cities and localities\n    limit=10,\n    marker=True,\n)\n\nm3\n</pre> # Create a map focused on the United States m3 = MapLibreMap(center=[-98.5795, 39.8283], zoom=4, style=\"liberty\", height=\"600px\")  # Add geocoder with country filter and specific place types m3.add_maplibre_geocoder(     position=\"top-left\",     api_key=maptiler_api_key,     maplibre_api=\"maptiler\",     placeholder=\"Search US cities...\",     country=\"us\",  # Limit to United States     types=\"place,locality\",  # Only show cities and localities     limit=10,     marker=True, )  m3 In\u00a0[\u00a0]: Copied! <pre># Create a map centered on London\nm4 = MapLibreMap(center=[-0.1276, 51.5074], zoom=11, style=\"positron\", height=\"600px\")\n\n# Add geocoder with proximity bias towards London\nm4.add_maplibre_geocoder(\n    position=\"top-left\",\n    api_key=maptiler_api_key,\n    maplibre_api=\"maptiler\",\n    placeholder=\"Search near London...\",\n    proximity=[-0.1276, 51.5074],  # [lng, lat] for London\n    marker=True,\n    language=\"en\",\n)\n\nm4\n</pre> # Create a map centered on London m4 = MapLibreMap(center=[-0.1276, 51.5074], zoom=11, style=\"positron\", height=\"600px\")  # Add geocoder with proximity bias towards London m4.add_maplibre_geocoder(     position=\"top-left\",     api_key=maptiler_api_key,     maplibre_api=\"maptiler\",     placeholder=\"Search near London...\",     proximity=[-0.1276, 51.5074],  # [lng, lat] for London     marker=True,     language=\"en\", )  m4 In\u00a0[\u00a0]: Copied! <pre># Create a map of California\nm5 = MapLibreMap(center=[-119.4179, 36.7783], zoom=6, style=\"positron\", height=\"600px\")\n\n# Add geocoder with bounding box for California\n# Bounding box: [minLng, minLat, maxLng, maxLat]\nm5.add_maplibre_geocoder(\n    position=\"top-left\",\n    api_key=maptiler_api_key,\n    maplibre_api=\"maptiler\",\n    placeholder=\"Search in California...\",\n    bbox=[-124.48, 32.53, -114.13, 42.01],  # California bounds\n    marker=True,\n)\n\nm5\n</pre> # Create a map of California m5 = MapLibreMap(center=[-119.4179, 36.7783], zoom=6, style=\"positron\", height=\"600px\")  # Add geocoder with bounding box for California # Bounding box: [minLng, minLat, maxLng, maxLat] m5.add_maplibre_geocoder(     position=\"top-left\",     api_key=maptiler_api_key,     maplibre_api=\"maptiler\",     placeholder=\"Search in California...\",     bbox=[-124.48, 32.53, -114.13, 42.01],  # California bounds     marker=True, )  m5 In\u00a0[\u00a0]: Copied! <pre># Create a map\nm6 = MapLibreMap(center=[2.3522, 48.8566], zoom=12, style=\"dark-matter\", height=\"600px\")\n\n# Add geocoder with custom behavior settings\nm6.add_maplibre_geocoder(\n    position=\"top-right\",\n    api_key=maptiler_api_key,\n    maplibre_api=\"maptiler\",\n    placeholder=\"Search for places in French...\",\n    language=\"fr\",  # French language results\n    collapsed=True,  # Start collapsed (icon only)\n    clear_on_blur=True,  # Clear search when input loses focus\n    clear_and_blur_on_esc=True,  # Clear and unfocus on ESC key\n    min_length=3,  # Minimum 3 characters to trigger search\n    limit=8,  # Show up to 8 results\n    marker=True,\n    show_result_markers=False,  # Don't show markers for all results\n    enable_event_logging=True,  # Enable console logging\n)\n\nm6\n</pre> # Create a map m6 = MapLibreMap(center=[2.3522, 48.8566], zoom=12, style=\"dark-matter\", height=\"600px\")  # Add geocoder with custom behavior settings m6.add_maplibre_geocoder(     position=\"top-right\",     api_key=maptiler_api_key,     maplibre_api=\"maptiler\",     placeholder=\"Search for places in French...\",     language=\"fr\",  # French language results     collapsed=True,  # Start collapsed (icon only)     clear_on_blur=True,  # Clear search when input loses focus     clear_and_blur_on_esc=True,  # Clear and unfocus on ESC key     min_length=3,  # Minimum 3 characters to trigger search     limit=8,  # Show up to 8 results     marker=True,     show_result_markers=False,  # Don't show markers for all results     enable_event_logging=True,  # Enable console logging )  m6 In\u00a0[\u00a0]: Copied! <pre># Create a comprehensive map with multiple controls\nm7 = MapLibreMap(\n    center=[-87.6298, 41.8781], zoom=11, style=\"liberty\", height=\"600px\"  # Chicago\n)\n\n# Add MapLibre GL Geocoder\nm7.add_maplibre_geocoder(\n    position=\"top-left\",\n    api_key=maptiler_api_key,\n    maplibre_api=\"maptiler\",\n    placeholder=\"Search Chicago...\",\n    proximity=[-87.6298, 41.8781],\n    country=\"us\",\n)\n\n# Add other controls\nm7.add_control(\"navigation\", \"top-right\")\nm7.add_control(\"fullscreen\", \"top-right\")\nm7.add_control(\"scale\", \"bottom-left\")\n\nm7\n</pre> # Create a comprehensive map with multiple controls m7 = MapLibreMap(     center=[-87.6298, 41.8781], zoom=11, style=\"liberty\", height=\"600px\"  # Chicago )  # Add MapLibre GL Geocoder m7.add_maplibre_geocoder(     position=\"top-left\",     api_key=maptiler_api_key,     maplibre_api=\"maptiler\",     placeholder=\"Search Chicago...\",     proximity=[-87.6298, 41.8781],     country=\"us\", )  # Add other controls m7.add_control(\"navigation\", \"top-right\") m7.add_control(\"fullscreen\", \"top-right\") m7.add_control(\"scale\", \"bottom-left\")  m7 In\u00a0[\u00a0]: Copied! <pre># Export the map with geocoder to HTML\nm.to_html(\"maplibre_geocoder_map.html\")\nprint(\"Map with MapLibre GL Geocoder exported to maplibre_geocoder_map.html\")\n</pre> # Export the map with geocoder to HTML m.to_html(\"maplibre_geocoder_map.html\") print(\"Map with MapLibre GL Geocoder exported to maplibre_geocoder_map.html\")"},{"location":"examples/maplibre/maplibre_geocoder_example/#maplibre-gl-geocoder-example","title":"MapLibre GL Geocoder Example\u00b6","text":"<p>This notebook demonstrates how to use the MapLibre GL Geocoder plugin with AnyMap. The MapLibre GL Geocoder is a powerful search control that supports various geocoding services including Maptiler and Mapbox.</p> <p>For more information, see the MapLibre GL Geocoder GitHub repository.</p>"},{"location":"examples/maplibre/maplibre_geocoder_example/#basic-usage-with-maptiler","title":"Basic Usage with Maptiler\u00b6","text":"<p>The MapLibre GL Geocoder requires an API key from a geocoding service. This example uses Maptiler's geocoding API.</p> <p>Note: You'll need to replace <code>'YOUR_MAPTILER_API_KEY'</code> with your actual API key. Get one free at https://www.maptiler.com/.</p>"},{"location":"examples/maplibre/maplibre_geocoder_example/#using-mapbox-geocoding-api","title":"Using Mapbox Geocoding API\u00b6","text":"<p>You can also use Mapbox's geocoding service. You'll need a Mapbox access token from https://www.mapbox.com/.</p>"},{"location":"examples/maplibre/maplibre_geocoder_example/#advanced-configuration-country-and-type-filtering","title":"Advanced Configuration: Country and Type Filtering\u00b6","text":"<p>You can filter geocoding results by country and place types:</p>"},{"location":"examples/maplibre/maplibre_geocoder_example/#using-proximity-bias","title":"Using Proximity Bias\u00b6","text":"<p>Bias search results towards a specific location using the <code>proximity</code> parameter:</p>"},{"location":"examples/maplibre/maplibre_geocoder_example/#using-bounding-box-filter","title":"Using Bounding Box Filter\u00b6","text":"<p>Limit search results to a specific bounding box:</p>"},{"location":"examples/maplibre/maplibre_geocoder_example/#customizing-geocoder-behavior","title":"Customizing Geocoder Behavior\u00b6","text":"<p>Control various aspects of the geocoder's behavior:</p>"},{"location":"examples/maplibre/maplibre_geocoder_example/#combining-with-other-controls","title":"Combining with Other Controls\u00b6","text":"<p>The MapLibre GL Geocoder works seamlessly with other map controls:</p>"},{"location":"examples/maplibre/maplibre_geocoder_example/#export-to-html","title":"Export to HTML\u00b6","text":"<p>Maps with the MapLibre GL Geocoder can be exported to standalone HTML files:</p>"},{"location":"examples/maplibre/maplibre_geocoder_example/#api-key-notes","title":"API Key Notes\u00b6","text":""},{"location":"examples/maplibre/maplibre_geocoder_example/#maptiler","title":"Maptiler\u00b6","text":"<ul> <li>Sign up at https://www.maptiler.com/</li> <li>Free tier includes 100,000 geocoding requests per month</li> <li>Use <code>maplibre_api=\"maptiler\"</code></li> </ul>"},{"location":"examples/maplibre/maplibre_geocoder_example/#mapbox","title":"Mapbox\u00b6","text":"<ul> <li>Sign up at https://www.mapbox.com/</li> <li>Free tier includes 100,000 geocoding requests per month</li> <li>Use <code>maplibre_api=\"mapbox\"</code></li> </ul>"},{"location":"examples/maplibre/maplibre_geocoder_example/#supported-parameters","title":"Supported Parameters\u00b6","text":"<ul> <li><code>position</code>: Control position on the map</li> <li><code>api_key</code>: API key for the geocoding service</li> <li><code>maplibre_api</code>: Geocoding API to use ('maptiler' or 'mapbox')</li> <li><code>language</code>: Language code for results (e.g., 'en', 'es', 'fr')</li> <li><code>placeholder</code>: Placeholder text in the search input</li> <li><code>proximity</code>: [lng, lat] to bias results towards a location</li> <li><code>bbox</code>: [minLng, minLat, maxLng, maxLat] to limit results to a bounding box</li> <li><code>country</code>: Country code(s) to filter results (e.g., 'us' or 'us,ca')</li> <li><code>types</code>: Comma-separated place types to filter results</li> <li><code>limit</code>: Maximum number of results to return</li> <li><code>marker</code>: Whether to add a marker at the geocoded location</li> <li><code>show_result_markers</code>: Whether to show markers for all search results</li> <li><code>collapsed</code>: Whether the control starts collapsed (icon only)</li> <li><code>clear_on_blur</code>: Clear input when it loses focus</li> <li><code>clear_and_blur_on_esc</code>: Clear input and remove focus on ESC key</li> <li><code>enable_event_logging</code>: Enable console logging of geocoder events</li> <li><code>min_length</code>: Minimum characters to trigger search</li> </ul>"},{"location":"examples/maplibre/maplibre_geoman/","title":"Maplibre geoman","text":"In\u00a0[\u00a0]: Copied! <pre>from anymap.maplibre import MapLibreMap\n\nm = MapLibreMap()\nm.add_basemap(\"Esri.WorldImagery\")\nm.add_geoman_control()\nm\n</pre> from anymap.maplibre import MapLibreMap  m = MapLibreMap() m.add_basemap(\"Esri.WorldImagery\") m.add_geoman_control() m In\u00a0[\u00a0]: Copied! <pre>m.expand_geoman_control()\n</pre> m.expand_geoman_control() In\u00a0[\u00a0]: Copied! <pre>m.collapse_geoman_control()\n</pre> m.collapse_geoman_control() In\u00a0[\u00a0]: Copied! <pre>m.get_geoman_data()\n</pre> m.get_geoman_data() In\u00a0[\u00a0]: Copied! <pre>m.clear_geoman_data()\n</pre> m.clear_geoman_data() In\u00a0[\u00a0]: Copied! <pre>m.set_geoman_data(\n    {\n        \"type\": \"FeatureCollection\",\n        \"features\": [\n            {\n                \"type\": \"Feature\",\n                \"properties\": {\"__gm_id\": \"feature-1\", \"__gm_shape\": \"marker\"},\n                \"geometry\": {\n                    \"type\": \"Point\",\n                    \"coordinates\": [-94.21874999999979, 42.31453821054666],\n                },\n                \"id\": \"feature-1\",\n            },\n            {\n                \"type\": \"Feature\",\n                \"properties\": {\"__gm_id\": \"feature-4\", \"__gm_shape\": \"rectangle\"},\n                \"geometry\": {\n                    \"type\": \"Polygon\",\n                    \"coordinates\": [\n                        [\n                            [-100.89843749999969, 29.559900578322555],\n                            [-100.89843749999969, 39.11796883981944],\n                            [-83.67187500000044, 39.11796883981944],\n                            [-83.67187500000044, 29.559900578322555],\n                            [-100.89843749999969, 29.559900578322555],\n                        ]\n                    ],\n                },\n                \"id\": \"feature-4\",\n            },\n        ],\n    }\n)\n</pre> m.set_geoman_data(     {         \"type\": \"FeatureCollection\",         \"features\": [             {                 \"type\": \"Feature\",                 \"properties\": {\"__gm_id\": \"feature-1\", \"__gm_shape\": \"marker\"},                 \"geometry\": {                     \"type\": \"Point\",                     \"coordinates\": [-94.21874999999979, 42.31453821054666],                 },                 \"id\": \"feature-1\",             },             {                 \"type\": \"Feature\",                 \"properties\": {\"__gm_id\": \"feature-4\", \"__gm_shape\": \"rectangle\"},                 \"geometry\": {                     \"type\": \"Polygon\",                     \"coordinates\": [                         [                             [-100.89843749999969, 29.559900578322555],                             [-100.89843749999969, 39.11796883981944],                             [-83.67187500000044, 39.11796883981944],                             [-83.67187500000044, 29.559900578322555],                             [-100.89843749999969, 29.559900578322555],                         ]                     ],                 },                 \"id\": \"feature-4\",             },         ],     } ) In\u00a0[\u00a0]: Copied! <pre>m.set_geoman_data({\"type\": \"FeatureCollection\", \"features\": []})\n</pre> m.set_geoman_data({\"type\": \"FeatureCollection\", \"features\": []}) <p>Clear all drawn features from the map:</p> In\u00a0[\u00a0]: Copied! <pre>m2 = MapLibreMap()\nm2.add_basemap(\"Esri.WorldImagery\")\nm2.add_geoman_control(\n    position=\"top-left\",\n    controls={\"helper\": {\"snapping\": {\"active\": False}}},\n)\nm2\n</pre> m2 = MapLibreMap() m2.add_basemap(\"Esri.WorldImagery\") m2.add_geoman_control(     position=\"top-left\",     controls={\"helper\": {\"snapping\": {\"active\": False}}}, ) m2 In\u00a0[\u00a0]: Copied! <pre># Collapse the control\nm.collapse_geoman_control()\n</pre> # Collapse the control m.collapse_geoman_control() In\u00a0[\u00a0]: Copied! <pre># Expand the control\nm.expand_geoman_control()\n</pre> # Expand the control m.expand_geoman_control() In\u00a0[\u00a0]: Copied! <pre># Toggle between collapsed and expanded states\nm.toggle_geoman_control()\n</pre> # Toggle between collapsed and expanded states m.toggle_geoman_control()"},{"location":"examples/maplibre/maplibre_geoman/#add-geoman-draw-control","title":"Add Geoman Draw Control\u00b6","text":"<p>The Geoman draw control allows you to draw and edit geometries on the map. By default, snapping is enabled to help you create precise geometries by snapping to existing features.</p>"},{"location":"examples/maplibre/maplibre_geoman/#managing-drawn-features","title":"Managing Drawn Features\u00b6","text":"<p>You can retrieve the drawn features as GeoJSON:</p>"},{"location":"examples/maplibre/maplibre_geoman/#custom-configuration","title":"Custom Configuration\u00b6","text":"<p>You can customize the Geoman control with various options. For example, you can disable snapping if needed:</p>"},{"location":"examples/maplibre/maplibre_geoman/#collapse-and-expand-control","title":"Collapse and Expand Control\u00b6","text":"<p>You can programmatically collapse and expand the Geoman control toolbar:</p>"},{"location":"examples/maplibre/maplibre_legend_example/","title":"Maplibre legend example","text":"In\u00a0[\u00a0]: Copied! <pre>from anymap import MapLibreMap\n\n# Center on San Francisco\nm = MapLibreMap(center=[-122.4194, 37.7749], zoom=12, style=\"liberty\", height=\"600px\")\n\n# Simple GeoJSON layer with paint and metadata for legend\ngeojson = {\n    \"type\": \"FeatureCollection\",\n    \"features\": [\n        {\n            \"type\": \"Feature\",\n            \"properties\": {\"density\": 120},\n            \"geometry\": {\"type\": \"Point\", \"coordinates\": [-122.4194, 37.7749]},\n        },\n        {\n            \"type\": \"Feature\",\n            \"properties\": {\"density\": 240},\n            \"geometry\": {\"type\": \"Point\", \"coordinates\": [-122.4094, 37.7849]},\n        },\n        {\n            \"type\": \"Feature\",\n            \"properties\": {\"density\": 320},\n            \"geometry\": {\"type\": \"Point\", \"coordinates\": [-122.4294, 37.7649]},\n        },\n    ],\n}\n\nlayer_id = \"density_points\"\npaint = {\n    \"circle-radius\": [\n        \"interpolate\",\n        [\"linear\"],\n        [\"to-number\", [\"get\", \"density\"]],\n        100,\n        6,\n        200,\n        10,\n        300,\n        14,\n    ],\n    \"circle-color\": [\n        \"interpolate\",\n        [\"linear\"],\n        [\"to-number\", [\"get\", \"density\"]],\n        100,\n        \"#fca107\",\n        200,\n        \"#7f3121\",\n        300,\n        \"#1a1a1a\",\n    ],\n}\n\n# Add as a GeoJSON layer and set metadata into the style so legend can read it\nm.add_geojson_layer(layer_id, geojson, layer_type=\"circle\", paint=paint)\n# Attach metadata via internal layer dict and JS will sync; also helpful for legend plugins\nlayer = m.layer_dict[layer_id][\"layer\"]\nlayer.setdefault(\"metadata\", {})\nlayer[\"metadata\"].update(\n    {\n        \"name\": \"Population Density\",\n        \"unit\": \"people/km\u00b2\",\n        \"labels\": {\"100\": \"Low\", \"200\": \"Medium\", \"300\": \"High\"},\n    }\n)\n# Update internal sync\nm._layer_dict = dict(m.layer_dict)\n\n# Add legend control\nm.add_legend_control(\n    position=\"bottom-left\",\n    show_default=True,\n    show_checkbox=True,\n    max_height=500,\n    toggle_icon=\"\u2637\",\n)\n\nm\n</pre> from anymap import MapLibreMap  # Center on San Francisco m = MapLibreMap(center=[-122.4194, 37.7749], zoom=12, style=\"liberty\", height=\"600px\")  # Simple GeoJSON layer with paint and metadata for legend geojson = {     \"type\": \"FeatureCollection\",     \"features\": [         {             \"type\": \"Feature\",             \"properties\": {\"density\": 120},             \"geometry\": {\"type\": \"Point\", \"coordinates\": [-122.4194, 37.7749]},         },         {             \"type\": \"Feature\",             \"properties\": {\"density\": 240},             \"geometry\": {\"type\": \"Point\", \"coordinates\": [-122.4094, 37.7849]},         },         {             \"type\": \"Feature\",             \"properties\": {\"density\": 320},             \"geometry\": {\"type\": \"Point\", \"coordinates\": [-122.4294, 37.7649]},         },     ], }  layer_id = \"density_points\" paint = {     \"circle-radius\": [         \"interpolate\",         [\"linear\"],         [\"to-number\", [\"get\", \"density\"]],         100,         6,         200,         10,         300,         14,     ],     \"circle-color\": [         \"interpolate\",         [\"linear\"],         [\"to-number\", [\"get\", \"density\"]],         100,         \"#fca107\",         200,         \"#7f3121\",         300,         \"#1a1a1a\",     ], }  # Add as a GeoJSON layer and set metadata into the style so legend can read it m.add_geojson_layer(layer_id, geojson, layer_type=\"circle\", paint=paint) # Attach metadata via internal layer dict and JS will sync; also helpful for legend plugins layer = m.layer_dict[layer_id][\"layer\"] layer.setdefault(\"metadata\", {}) layer[\"metadata\"].update(     {         \"name\": \"Population Density\",         \"unit\": \"people/km\u00b2\",         \"labels\": {\"100\": \"Low\", \"200\": \"Medium\", \"300\": \"High\"},     } ) # Update internal sync m._layer_dict = dict(m.layer_dict)  # Add legend control m.add_legend_control(     position=\"bottom-left\",     show_default=True,     show_checkbox=True,     max_height=500,     toggle_icon=\"\u2637\", )  m In\u00a0[\u00a0]: Copied! <pre>\n</pre>"},{"location":"examples/maplibre/maplibre_legend_example/#maplibre-legend-control-example","title":"MapLibre Legend Control Example\u00b6","text":"<p>This notebook demonstrates the <code>mapbox-gl-legend</code> plugin integrated in AnyMap.</p> <p>It adds a legend based on layer styles/metadata. Ensure layers have helpful <code>metadata</code> like <code>name</code>, <code>unit</code>, or <code>labels</code> for best results.</p>"},{"location":"examples/maplibre/maplibre_measures/","title":"Maplibre measures","text":"In\u00a0[\u00a0]: Copied! <pre>from anymap import MapLibreMap\n</pre> from anymap import MapLibreMap In\u00a0[\u00a0]: Copied! <pre># Create a MapLibre map\nm = MapLibreMap(\n    center=[-87.61694, 41.86625], zoom=10, style=\"positron\", height=\"600px\"  # Chicago\n)\n\n# Add a measures control with metric units (default)\nm.add_measures_control(position=\"top-left\", units=\"metric\")\n\nm\n</pre> # Create a MapLibre map m = MapLibreMap(     center=[-87.61694, 41.86625], zoom=10, style=\"positron\", height=\"600px\"  # Chicago )  # Add a measures control with metric units (default) m.add_measures_control(position=\"top-left\", units=\"metric\")  m In\u00a0[\u00a0]: Copied! <pre># Create a map with imperial units\nm_imperial = MapLibreMap(\n    center=[-118.2437, 34.0522],  # Los Angeles\n    zoom=11,\n    style=\"positron\",\n    height=\"600px\",\n)\n\n# Add measures control with imperial units\nm_imperial.add_measures_control(position=\"top-left\", units=\"imperial\")\n\nm_imperial\n</pre> # Create a map with imperial units m_imperial = MapLibreMap(     center=[-118.2437, 34.0522],  # Los Angeles     zoom=11,     style=\"positron\",     height=\"600px\", )  # Add measures control with imperial units m_imperial.add_measures_control(position=\"top-left\", units=\"imperial\")  m_imperial In\u00a0[\u00a0]: Copied! <pre># Create a map with custom button titles\nm_custom = MapLibreMap(\n    center=[2.3522, 48.8566], zoom=12, style=\"liberty\", height=\"600px\"  # Paris\n)\n\n# Add measures control with custom titles\nm_custom.add_measures_control(\n    position=\"top-right\",\n    units=\"metric\",\n    area_button_title=\"Measure Area\",\n    length_button_title=\"Measure Distance\",\n    clear_button_title=\"Clear All Measurements\",\n)\n\nm_custom\n</pre> # Create a map with custom button titles m_custom = MapLibreMap(     center=[2.3522, 48.8566], zoom=12, style=\"liberty\", height=\"600px\"  # Paris )  # Add measures control with custom titles m_custom.add_measures_control(     position=\"top-right\",     units=\"metric\",     area_button_title=\"Measure Area\",     length_button_title=\"Measure Distance\",     clear_button_title=\"Clear All Measurements\", )  m_custom In\u00a0[\u00a0]: Copied! <pre># Create a map with custom styling\nm_styled = MapLibreMap(\n    center=[-0.1276, 51.5074], zoom=11, style=\"dark-matter\", height=\"600px\"  # London\n)\n\n# Add measures control with custom styling\nm_styled.add_measures_control(\n    position=\"top-left\",\n    units=\"metric\",\n    options={\n        # Customize text appearance\n        \"textColor\": \"#FFFF00\",\n        \"textHaloColor\": \"#000000\",\n        # Customize line measurements\n        \"lineColor\": \"#FF0000\",\n        \"lineWidth\": 3,\n        # Customize area measurements\n        \"fillColor\": \"#0000FF\",\n        \"fillOpacity\": 0.3,\n        # Customize midpoint markers\n        \"midPointColor\": \"#FF00FF\",\n        \"midPointRadius\": 4,\n    },\n)\n\nm_styled\n</pre> # Create a map with custom styling m_styled = MapLibreMap(     center=[-0.1276, 51.5074], zoom=11, style=\"dark-matter\", height=\"600px\"  # London )  # Add measures control with custom styling m_styled.add_measures_control(     position=\"top-left\",     units=\"metric\",     options={         # Customize text appearance         \"textColor\": \"#FFFF00\",         \"textHaloColor\": \"#000000\",         # Customize line measurements         \"lineColor\": \"#FF0000\",         \"lineWidth\": 3,         # Customize area measurements         \"fillColor\": \"#0000FF\",         \"fillOpacity\": 0.3,         # Customize midpoint markers         \"midPointColor\": \"#FF00FF\",         \"midPointRadius\": 4,     }, )  m_styled In\u00a0[\u00a0]: Copied! <pre># Create a map with satellite imagery\nm_satellite = MapLibreMap(\n    center=[-74.0059, 40.7128], zoom=13, height=\"600px\"  # New York City\n)\n\n# Add satellite basemap\nm_satellite.add_basemap(\"Esri.WorldImagery\")\n\n# Add measures control\nm_satellite.add_measures_control(position=\"top-left\", units=\"imperial\")\n\n# Add navigation control for easier zooming\nm_satellite.add_control(\"navigation\", \"top-right\")\n\nm_satellite\n</pre> # Create a map with satellite imagery m_satellite = MapLibreMap(     center=[-74.0059, 40.7128], zoom=13, height=\"600px\"  # New York City )  # Add satellite basemap m_satellite.add_basemap(\"Esri.WorldImagery\")  # Add measures control m_satellite.add_measures_control(position=\"top-left\", units=\"imperial\")  # Add navigation control for easier zooming m_satellite.add_control(\"navigation\", \"top-right\")  m_satellite In\u00a0[\u00a0]: Copied! <pre># Export the map with measures control to HTML\nm.to_html(\"measures_map.html\")\nprint(\"Map with measures control exported to measures_map.html\")\n</pre> # Export the map with measures control to HTML m.to_html(\"measures_map.html\") print(\"Map with measures control exported to measures_map.html\") In\u00a0[\u00a0]: Copied! <pre># Create a comprehensive map with multiple controls\nm_comprehensive = MapLibreMap(\n    center=[139.6917, 35.6895], zoom=10, style=\"positron\", height=\"600px\"  # Tokyo\n)\n\n# Add various controls\nm_comprehensive.add_measures_control(position=\"top-left\", units=\"metric\")\nm_comprehensive.add_control(\"navigation\", \"top-right\")\nm_comprehensive.add_control(\"fullscreen\", \"top-right\")\nm_comprehensive.add_control(\"scale\", \"bottom-left\")\n\n# Add a basemap\nm_comprehensive.add_basemap(\"OpenStreetMap.Mapnik\")\n\nm_comprehensive\n</pre> # Create a comprehensive map with multiple controls m_comprehensive = MapLibreMap(     center=[139.6917, 35.6895], zoom=10, style=\"positron\", height=\"600px\"  # Tokyo )  # Add various controls m_comprehensive.add_measures_control(position=\"top-left\", units=\"metric\") m_comprehensive.add_control(\"navigation\", \"top-right\") m_comprehensive.add_control(\"fullscreen\", \"top-right\") m_comprehensive.add_control(\"scale\", \"bottom-left\")  # Add a basemap m_comprehensive.add_basemap(\"OpenStreetMap.Mapnik\")  m_comprehensive In\u00a0[\u00a0]: Copied! <pre># Create a map and add measures control\nm_removable = MapLibreMap(\n    center=[13.4050, 52.5200], zoom=11, style=\"positron\", height=\"600px\"  # Berlin\n)\n\nm_removable.add_measures_control(position=\"top-left\")\n\n# Uncomment the line below to remove the measures control\n# m_removable.remove_measures_control(position=\"top-left\")\n\nm_removable\n</pre> # Create a map and add measures control m_removable = MapLibreMap(     center=[13.4050, 52.5200], zoom=11, style=\"positron\", height=\"600px\"  # Berlin )  m_removable.add_measures_control(position=\"top-left\")  # Uncomment the line below to remove the measures control # m_removable.remove_measures_control(position=\"top-left\")  m_removable"},{"location":"examples/maplibre/maplibre_measures/#maplibre-measures-control-example","title":"MapLibre Measures Control Example\u00b6","text":"<p>This notebook demonstrates how to use the measures control with MapLibre GL JS maps in AnyMap. The measures control allows users to measure distances along lines and calculate areas within polygons.</p>"},{"location":"examples/maplibre/maplibre_measures/#basic-measures-control-metric-units","title":"Basic Measures Control (Metric Units)\u00b6","text":"<p>Create a map with a measures control using metric units (default). Click the line icon to measure distances, or the polygon icon to measure areas:</p>"},{"location":"examples/maplibre/maplibre_measures/#imperial-units","title":"Imperial Units\u00b6","text":"<p>You can also use imperial units (miles, feet) for measurements:</p>"},{"location":"examples/maplibre/maplibre_measures/#custom-button-titles","title":"Custom Button Titles\u00b6","text":"<p>You can customize the button titles for different measurement tools:</p>"},{"location":"examples/maplibre/maplibre_measures/#custom-styling-options","title":"Custom Styling Options\u00b6","text":"<p>You can customize the appearance of measurement lines and polygons:</p>"},{"location":"examples/maplibre/maplibre_measures/#combining-with-imagery","title":"Combining with Imagery\u00b6","text":"<p>The measures control works great with satellite imagery for real-world measurements:</p>"},{"location":"examples/maplibre/maplibre_measures/#export-to-html","title":"Export to HTML\u00b6","text":"<p>The measures control is preserved when exporting to HTML:</p>"},{"location":"examples/maplibre/maplibre_measures/#multiple-controls-example","title":"Multiple Controls Example\u00b6","text":"<p>The measures control works well with other map controls and features:</p>"},{"location":"examples/maplibre/maplibre_measures/#remove-measures-control","title":"Remove Measures Control\u00b6","text":"<p>You can also remove the measures control when it's no longer needed:</p>"},{"location":"examples/maplibre/maplibre_three_plugin_example/","title":"Maplibre three plugin example","text":"In\u00a0[\u00a0]: Copied! <pre>from anymap import MapLibreMap\n</pre> from anymap import MapLibreMap In\u00a0[\u00a0]: Copied! <pre># Create a map centered on Canberra, Australia with pitch for 3D viewing\nm = MapLibreMap(\n    center=[149.1300, -35.2809],  # Canberra\n    zoom=16,\n    pitch=60,  # Tilt the map for better 3D viewing\n    bearing=0,\n    height=\"600px\",\n)\n\n# Initialize the Three.js scene\nm.init_three_scene()\n\n# Add lighting to the scene\nm.add_three_light(light_type=\"ambient\", intensity=0.5)\nm.add_three_light(light_type=\"directional\", intensity=0.8, position=[1, 1, 1])\n\nm\n</pre> # Create a map centered on Canberra, Australia with pitch for 3D viewing m = MapLibreMap(     center=[149.1300, -35.2809],  # Canberra     zoom=16,     pitch=60,  # Tilt the map for better 3D viewing     bearing=0,     height=\"600px\", )  # Initialize the Three.js scene m.init_three_scene()  # Add lighting to the scene m.add_three_light(light_type=\"ambient\", intensity=0.5) m.add_three_light(light_type=\"directional\", intensity=0.8, position=[1, 1, 1])  m In\u00a0[\u00a0]: Copied! <pre># Add a 3D model\n# Using a sample GLTF model - you can replace this with any GLTF/GLB URL\nm.add_three_model(\n    model_id=\"sample_building\",\n    url=\"https://raw.githubusercontent.com/KhronosGroup/glTF-Sample-Models/master/2.0/Box/glTF/Box.gltf\",\n    coordinates=[149.1300, -35.2809],  # [longitude, latitude]\n    scale=50,  # Scale the model to make it visible\n    rotation=[0, 0, 0],  # Optional rotation in radians [x, y, z]\n)\n</pre> # Add a 3D model # Using a sample GLTF model - you can replace this with any GLTF/GLB URL m.add_three_model(     model_id=\"sample_building\",     url=\"https://raw.githubusercontent.com/KhronosGroup/glTF-Sample-Models/master/2.0/Box/glTF/Box.gltf\",     coordinates=[149.1300, -35.2809],  # [longitude, latitude]     scale=50,  # Scale the model to make it visible     rotation=[0, 0, 0],  # Optional rotation in radians [x, y, z] ) In\u00a0[\u00a0]: Copied! <pre># Create another map with sun lighting\nm2 = MapLibreMap(\n    center=[148.9819, -35.3981],  # Different location in Canberra\n    zoom=18,\n    pitch=60,\n    bearing=45,\n    height=\"600px\",\n)\n\n# Initialize Three.js scene\nm2.init_three_scene()\n\n# Add sun and ambient light\nm2.add_three_light(light_type=\"sun\")\nm2.add_three_light(light_type=\"ambient\", intensity=0.3)\n\n# Add a 3D model\nm2.add_three_model(\n    model_id=\"model_with_sun\",\n    url=\"https://raw.githubusercontent.com/KhronosGroup/glTF-Sample-Models/master/2.0/Duck/glTF/Duck.gltf\",\n    coordinates=[148.9819, -35.3981],\n    scale=100,\n    rotation=[0, 0, 0],\n)\n\nm2\n</pre> # Create another map with sun lighting m2 = MapLibreMap(     center=[148.9819, -35.3981],  # Different location in Canberra     zoom=18,     pitch=60,     bearing=45,     height=\"600px\", )  # Initialize Three.js scene m2.init_three_scene()  # Add sun and ambient light m2.add_three_light(light_type=\"sun\") m2.add_three_light(light_type=\"ambient\", intensity=0.3)  # Add a 3D model m2.add_three_model(     model_id=\"model_with_sun\",     url=\"https://raw.githubusercontent.com/KhronosGroup/glTF-Sample-Models/master/2.0/Duck/glTF/Duck.gltf\",     coordinates=[148.9819, -35.3981],     scale=100,     rotation=[0, 0, 0], )  m2 In\u00a0[\u00a0]: Copied! <pre># Create a map with multiple models\nm3 = MapLibreMap(\n    center=[-74.0060, 40.7128],  # New York City\n    zoom=16,\n    pitch=60,\n    bearing=30,\n    height=\"600px\",\n)\n\n# Initialize Three.js scene\nm3.init_three_scene()\n\n# Add multiple lights for better illumination\nm3.add_three_light(light_type=\"ambient\", intensity=0.4)\nm3.add_three_light(light_type=\"directional\", intensity=0.6, position=[1, 1, 1])\nm3.add_three_light(light_type=\"directional\", intensity=0.4, position=[-1, -1, 1])\n\n# Add multiple 3D models at different locations\nm3.add_three_model(\n    model_id=\"model_1\",\n    url=\"https://raw.githubusercontent.com/KhronosGroup/glTF-Sample-Models/master/2.0/Box/glTF/Box.gltf\",\n    coordinates=[-74.0060, 40.7128],\n    scale=30,\n)\n\nm3.add_three_model(\n    model_id=\"model_2\",\n    url=\"https://raw.githubusercontent.com/KhronosGroup/glTF-Sample-Models/master/2.0/Box/glTF/Box.gltf\",\n    coordinates=[-74.0050, 40.7128],\n    scale=40,\n)\n\nm3.add_three_model(\n    model_id=\"model_3\",\n    url=\"https://raw.githubusercontent.com/KhronosGroup/glTF-Sample-Models/master/2.0/Box/glTF/Box.gltf\",\n    coordinates=[-74.0060, 40.7138],\n    scale=50,\n)\n\nm3\n</pre> # Create a map with multiple models m3 = MapLibreMap(     center=[-74.0060, 40.7128],  # New York City     zoom=16,     pitch=60,     bearing=30,     height=\"600px\", )  # Initialize Three.js scene m3.init_three_scene()  # Add multiple lights for better illumination m3.add_three_light(light_type=\"ambient\", intensity=0.4) m3.add_three_light(light_type=\"directional\", intensity=0.6, position=[1, 1, 1]) m3.add_three_light(light_type=\"directional\", intensity=0.4, position=[-1, -1, 1])  # Add multiple 3D models at different locations m3.add_three_model(     model_id=\"model_1\",     url=\"https://raw.githubusercontent.com/KhronosGroup/glTF-Sample-Models/master/2.0/Box/glTF/Box.gltf\",     coordinates=[-74.0060, 40.7128],     scale=30, )  m3.add_three_model(     model_id=\"model_2\",     url=\"https://raw.githubusercontent.com/KhronosGroup/glTF-Sample-Models/master/2.0/Box/glTF/Box.gltf\",     coordinates=[-74.0050, 40.7128],     scale=40, )  m3.add_three_model(     model_id=\"model_3\",     url=\"https://raw.githubusercontent.com/KhronosGroup/glTF-Sample-Models/master/2.0/Box/glTF/Box.gltf\",     coordinates=[-74.0060, 40.7138],     scale=50, )  m3 In\u00a0[\u00a0]: Copied! <pre># Update the scale and rotation of model_1\nimport math\n\nm3.update_three_model(\n    model_id=\"model_1\",\n    scale=60,  # Make it larger\n    rotation=[0, math.pi / 4, 0],  # Rotate 45 degrees around Y axis\n)\n</pre> # Update the scale and rotation of model_1 import math  m3.update_three_model(     model_id=\"model_1\",     scale=60,  # Make it larger     rotation=[0, math.pi / 4, 0],  # Rotate 45 degrees around Y axis ) In\u00a0[\u00a0]: Copied! <pre># Remove model_2\nm3.remove_three_model(\"model_2\")\n</pre> # Remove model_2 m3.remove_three_model(\"model_2\") In\u00a0[\u00a0]: Copied! <pre># Create a map with custom styling\nm4 = MapLibreMap(\n    center=[-122.4194, 37.7749],  # San Francisco\n    zoom=17,\n    pitch=70,\n    bearing=60,\n    height=\"700px\",\n    style=\"3d-satellite\",  # Use satellite style for better 3D context\n)\n\n# Initialize Three.js scene\nm4.init_three_scene()\n\n# Create a dramatic lighting setup\nm4.add_three_light(light_type=\"ambient\", intensity=0.3, color=0x404040)\nm4.add_three_light(\n    light_type=\"directional\", intensity=1.0, position=[2, 3, 1], color=0xFFFFFF\n)\nm4.add_three_light(\n    light_type=\"directional\", intensity=0.5, position=[-1, -2, 1], color=0x8080FF\n)\n\n# Add a 3D model\nm4.add_three_model(\n    model_id=\"sf_model\",\n    url=\"https://raw.githubusercontent.com/KhronosGroup/glTF-Sample-Models/master/2.0/Duck/glTF/Duck.gltf\",\n    coordinates=[-122.4194, 37.7749],\n    scale=200,\n    rotation=[0, 0, 0],\n)\n\nm4\n</pre> # Create a map with custom styling m4 = MapLibreMap(     center=[-122.4194, 37.7749],  # San Francisco     zoom=17,     pitch=70,     bearing=60,     height=\"700px\",     style=\"3d-satellite\",  # Use satellite style for better 3D context )  # Initialize Three.js scene m4.init_three_scene()  # Create a dramatic lighting setup m4.add_three_light(light_type=\"ambient\", intensity=0.3, color=0x404040) m4.add_three_light(     light_type=\"directional\", intensity=1.0, position=[2, 3, 1], color=0xFFFFFF ) m4.add_three_light(     light_type=\"directional\", intensity=0.5, position=[-1, -2, 1], color=0x8080FF )  # Add a 3D model m4.add_three_model(     model_id=\"sf_model\",     url=\"https://raw.githubusercontent.com/KhronosGroup/glTF-Sample-Models/master/2.0/Duck/glTF/Duck.gltf\",     coordinates=[-122.4194, 37.7749],     scale=200,     rotation=[0, 0, 0], )  m4 In\u00a0[\u00a0]: Copied! <pre>from anymap import MapLibreMap\n\nm_tiles = MapLibreMap(\n    center=[-75.628, 40.028],\n    zoom=13,\n    pitch=60,\n    style=\"dark-matter\",\n    height=\"600px\",\n)\nm_tiles.init_three_scene()\nm_tiles.add_three_light(light_id=\"tiles-ambient\", light_type=\"ambient\", intensity=0.6)\nm_tiles.add_three_light(\n    light_id=\"tiles-directional\",\n    light_type=\"directional\",\n    intensity=0.85,\n    position=[150, 300, 400],\n)\nm_tiles.add_three_tileset(\n    \"discrete_lod\",\n    url=\"https://raw.githubusercontent.com/CesiumGS/3d-tiles-samples/refs/heads/main/1.0/TilesetWithDiscreteLOD/tileset.json\",\n    use_fade=True,\n    height_offset=0,\n    fly_to=True,\n)\nm_tiles\n</pre> from anymap import MapLibreMap  m_tiles = MapLibreMap(     center=[-75.628, 40.028],     zoom=13,     pitch=60,     style=\"dark-matter\",     height=\"600px\", ) m_tiles.init_three_scene() m_tiles.add_three_light(light_id=\"tiles-ambient\", light_type=\"ambient\", intensity=0.6) m_tiles.add_three_light(     light_id=\"tiles-directional\",     light_type=\"directional\",     intensity=0.85,     position=[150, 300, 400], ) m_tiles.add_three_tileset(     \"discrete_lod\",     url=\"https://raw.githubusercontent.com/CesiumGS/3d-tiles-samples/refs/heads/main/1.0/TilesetWithDiscreteLOD/tileset.json\",     use_fade=True,     height_offset=0,     fly_to=True, ) m_tiles In\u00a0[\u00a0]: Copied! <pre>import os\nfrom anymap import MapLibreMap\n\ntoken = os.environ.get(\"CESIUM_TOKEN\")\nif not token:\n    print(\"Set CESIUM_ION_TOKEN to stream the Cesium Ion gaussian tileset.\")\nelse:\n    m_gaussian = MapLibreMap(\n        center=[-74.0445, 40.6892],\n        zoom=16,\n        pitch=60,\n        style=\"dark-matter\",\n        height=\"600px\",\n    )\n    m_gaussian.init_three_scene()\n    m_gaussian.add_three_light(\n        light_id=\"gs-ambient\", light_type=\"ambient\", intensity=0.5\n    )\n    m_gaussian.add_three_light(\n        light_id=\"gs-sun\",\n        light_type=\"sun\",\n        sun_options={\"castShadow\": False},\n    )\n    m_gaussian.add_three_tileset(\n        \"cesium_gaussian\",\n        asset_id=3667783,\n        ion_token=token,\n        use_update=True,\n        fly_to=True,\n    )\n</pre> import os from anymap import MapLibreMap  token = os.environ.get(\"CESIUM_TOKEN\") if not token:     print(\"Set CESIUM_ION_TOKEN to stream the Cesium Ion gaussian tileset.\") else:     m_gaussian = MapLibreMap(         center=[-74.0445, 40.6892],         zoom=16,         pitch=60,         style=\"dark-matter\",         height=\"600px\",     )     m_gaussian.init_three_scene()     m_gaussian.add_three_light(         light_id=\"gs-ambient\", light_type=\"ambient\", intensity=0.5     )     m_gaussian.add_three_light(         light_id=\"gs-sun\",         light_type=\"sun\",         sun_options={\"castShadow\": False},     )     m_gaussian.add_three_tileset(         \"cesium_gaussian\",         asset_id=3667783,         ion_token=token,         use_update=True,         fly_to=True,     ) In\u00a0[\u00a0]: Copied! <pre>m_gaussian\n</pre> m_gaussian"},{"location":"examples/maplibre/maplibre_three_plugin_example/#maplibre-threejs-plugin-example","title":"MapLibre Three.js Plugin Example\u00b6","text":"<p>This notebook demonstrates how to use the MapLibre Three.js plugin to add 3D models to your map using Three.js and GLTF models.</p> <p>The <code>maplibre-three-plugin</code> connects MapLibre GL JS with Three.js, enabling developers to implement 3D rendering and animation on maps.</p>"},{"location":"examples/maplibre/maplibre_three_plugin_example/#basic-3d-model-example","title":"Basic 3D Model Example\u00b6","text":"<p>First, let's create a map with a tilted view (pitch) which is better for viewing 3D models.</p>"},{"location":"examples/maplibre/maplibre_three_plugin_example/#adding-a-3d-gltf-model","title":"Adding a 3D GLTF Model\u00b6","text":"<p>Now let's add a 3D model to the map. We'll use a publicly available GLTF model.</p>"},{"location":"examples/maplibre/maplibre_three_plugin_example/#using-the-sun-light","title":"Using the Sun Light\u00b6","text":"<p>The maplibre-three-plugin includes a Sun object for realistic lighting based on time of day.</p>"},{"location":"examples/maplibre/maplibre_three_plugin_example/#multiple-3d-models","title":"Multiple 3D Models\u00b6","text":"<p>You can add multiple 3D models to the same map.</p>"},{"location":"examples/maplibre/maplibre_three_plugin_example/#updating-3d-models","title":"Updating 3D Models\u00b6","text":"<p>You can update the properties of existing 3D models.</p>"},{"location":"examples/maplibre/maplibre_three_plugin_example/#removing-3d-models","title":"Removing 3D Models\u00b6","text":"<p>You can remove models from the scene.</p>"},{"location":"examples/maplibre/maplibre_three_plugin_example/#advanced-example-with-custom-lighting","title":"Advanced Example with Custom Lighting\u00b6","text":"<p>Create a more complex scene with custom lighting and styled models.</p>"},{"location":"examples/maplibre/maplibre_three_plugin_example/#notes","title":"Notes\u00b6","text":"<ul> <li>The Three.js scene must be initialized with <code>init_three_scene()</code> before adding models or lights</li> <li>GLTF/GLB model files must be accessible via HTTP/HTTPS URLs</li> <li>Scale values may need adjustment depending on the model's original size and units</li> <li>Rotations are specified in radians (use <code>math.pi</code> for conversions)</li> <li>The map's pitch (tilt) should typically be set to a non-zero value (30-70 degrees) for better 3D visualization</li> <li>Lighting is essential for seeing 3D models properly - always add at least ambient light</li> </ul>"},{"location":"examples/maplibre/maplibre_three_plugin_example/#available-light-types","title":"Available Light Types\u00b6","text":"<ol> <li>ambient: Provides uniform lighting from all directions</li> <li>directional: Simulates sunlight with parallel rays from a specific direction</li> <li>sun: Special sun object that simulates realistic sun lighting</li> </ol>"},{"location":"examples/maplibre/maplibre_three_plugin_example/#resources","title":"Resources\u00b6","text":"<ul> <li>maplibre-three-plugin on GitHub</li> <li>Three.js Documentation</li> <li>GLTF Sample Models</li> </ul>"},{"location":"examples/maplibre/maplibre_three_plugin_example/#3d-tiles-tilesrenderer","title":"3D Tiles (TilesRenderer)\u00b6","text":"<p>Stream 3D Tiles content into the MapLibre scene. This sample uses the open <code>TilesetWithDiscreteLOD</code> dataset from the Cesium 3D Tiles samples repository: https://github.com/CesiumGS/3d-tiles-samples</p>"},{"location":"examples/maplibre/maplibre_three_plugin_example/#3d-tiles-cesium-ion-gaussian-splatting","title":"3D Tiles (Cesium Ion Gaussian Splatting)\u00b6","text":"<p>Gaussian splatting assets hosted on Cesium Ion require an access token. Set the <code>CESIUM_ION_TOKEN</code> environment variable before running the cell below. (Experimental support \u2014 gaussian tiles may require additional extensions.)</p>"},{"location":"examples/maplibre/pmtiles_example/","title":"Pmtiles example","text":"In\u00a0[\u00a0]: Copied! <pre># Import required modules\nfrom anymap import MapLibreMap\nimport json\n\nprint(\"AnyMap loaded successfully!\")\nprint(\"PMTiles support is built into the MapLibre implementation.\")\n</pre> # Import required modules from anymap import MapLibreMap import json  print(\"AnyMap loaded successfully!\") print(\"PMTiles support is built into the MapLibre implementation.\") In\u00a0[\u00a0]: Copied! <pre># Create a map centered on Florence, Italy\nm = MapLibreMap(\n    center=[11.25, 43.77],  # Florence coordinates [lng, lat]\n    zoom=12,\n    height=\"600px\",\n    width=\"100%\",\n)\n\n# Add PMTiles data - this will use default styling\npmtiles_url = \"https://pmtiles.io/protomaps(vector)ODbL_firenze.pmtiles\"\nm.add_pmtiles(pmtiles_url)\n\nprint(f\"Added PMTiles data from: {pmtiles_url}\")\nprint(\"Default layers created: landuse, roads, buildings, water\")\nm\n</pre> # Create a map centered on Florence, Italy m = MapLibreMap(     center=[11.25, 43.77],  # Florence coordinates [lng, lat]     zoom=12,     height=\"600px\",     width=\"100%\", )  # Add PMTiles data - this will use default styling pmtiles_url = \"https://pmtiles.io/protomaps(vector)ODbL_firenze.pmtiles\" m.add_pmtiles(pmtiles_url)  print(f\"Added PMTiles data from: {pmtiles_url}\") print(\"Default layers created: landuse, roads, buildings, water\") m In\u00a0[\u00a0]: Copied! <pre># Create a new map for custom styling\nm2 = MapLibreMap(\n    center=[43.77, 11.25],\n    zoom=13,\n    height=\"600px\",\n    style=\"positron\",  # Use a light base style\n)\n\n# Define custom layers with specific styling\ncustom_layers = [\n    {\n        \"id\": \"florence_buildings\",\n        \"source\": \"florence_pmtiles_source\",\n        \"source-layer\": \"landuse\",  # Using landuse layer from the PMTiles\n        \"type\": \"fill\",\n        \"paint\": {\"fill-color\": \"#8B4513\", \"fill-opacity\": 0.6},  # Brown color\n    },\n    {\n        \"id\": \"florence_roads\",\n        \"source\": \"florence_pmtiles_source\",\n        \"source-layer\": \"roads\",\n        \"type\": \"line\",\n        \"paint\": {\n            \"line-color\": \"#FF6B35\",  # Orange color\n            \"line-width\": [\"interpolate\", [\"linear\"], [\"zoom\"], 10, 1, 15, 3],\n        },\n    },\n    {\n        \"id\": \"florence_mask\",\n        \"source\": \"florence_pmtiles_source\",\n        \"source-layer\": \"mask\",\n        \"type\": \"fill\",\n        \"paint\": {\"fill-color\": \"rgba(255, 255, 255, 0.1)\"},\n    },\n]\n\n# Add PMTiles with custom styling\nm2.add_pmtiles(\n    pmtiles_url, layer_id=\"florence_pmtiles\", layers=custom_layers, opacity=0.8\n)\n\nprint(\"Added PMTiles with custom layer styling\")\nprint(\"Custom layers:\", [layer[\"id\"] for layer in custom_layers])\nm2\n</pre> # Create a new map for custom styling m2 = MapLibreMap(     center=[43.77, 11.25],     zoom=13,     height=\"600px\",     style=\"positron\",  # Use a light base style )  # Define custom layers with specific styling custom_layers = [     {         \"id\": \"florence_buildings\",         \"source\": \"florence_pmtiles_source\",         \"source-layer\": \"landuse\",  # Using landuse layer from the PMTiles         \"type\": \"fill\",         \"paint\": {\"fill-color\": \"#8B4513\", \"fill-opacity\": 0.6},  # Brown color     },     {         \"id\": \"florence_roads\",         \"source\": \"florence_pmtiles_source\",         \"source-layer\": \"roads\",         \"type\": \"line\",         \"paint\": {             \"line-color\": \"#FF6B35\",  # Orange color             \"line-width\": [\"interpolate\", [\"linear\"], [\"zoom\"], 10, 1, 15, 3],         },     },     {         \"id\": \"florence_mask\",         \"source\": \"florence_pmtiles_source\",         \"source-layer\": \"mask\",         \"type\": \"fill\",         \"paint\": {\"fill-color\": \"rgba(255, 255, 255, 0.1)\"},     }, ]  # Add PMTiles with custom styling m2.add_pmtiles(     pmtiles_url, layer_id=\"florence_pmtiles\", layers=custom_layers, opacity=0.8 )  print(\"Added PMTiles with custom layer styling\") print(\"Custom layers:\", [layer[\"id\"] for layer in custom_layers]) m2 In\u00a0[\u00a0]: Copied! <pre># Create a map for multiple PMTiles demonstration\nm3 = MapLibreMap(center=[43.77, 11.25], zoom=11, height=\"600px\", style=\"dark-matter\")\n\n# Add the first PMTiles source with roads emphasized\nroads_layers = [\n    {\n        \"id\": \"main_roads\",\n        \"source\": \"pmtiles_roads_source\",\n        \"source-layer\": \"roads\",\n        \"type\": \"line\",\n        \"paint\": {\n            \"line-color\": \"#FFD700\",  # Gold color\n            \"line-width\": 2,\n            \"line-opacity\": 0.8,\n        },\n    }\n]\n\nm3.add_pmtiles(pmtiles_url, layer_id=\"pmtiles_roads\", layers=roads_layers)\n\n# Add the same PMTiles source again with different styling for buildings\nbuilding_layers = [\n    {\n        \"id\": \"landuse_areas\",\n        \"source\": \"pmtiles_buildings_source\",\n        \"source-layer\": \"landuse\",\n        \"type\": \"fill\",\n        \"paint\": {\"fill-color\": \"#32CD32\", \"fill-opacity\": 0.4},  # Lime green\n    }\n]\n\nm3.add_pmtiles(pmtiles_url, layer_id=\"pmtiles_buildings\", layers=building_layers)\n\nprint(\"Added multiple PMTiles layers with different styling\")\nprint(\"Gold roads and green landuse areas should be visible\")\nm3\n</pre> # Create a map for multiple PMTiles demonstration m3 = MapLibreMap(center=[43.77, 11.25], zoom=11, height=\"600px\", style=\"dark-matter\")  # Add the first PMTiles source with roads emphasized roads_layers = [     {         \"id\": \"main_roads\",         \"source\": \"pmtiles_roads_source\",         \"source-layer\": \"roads\",         \"type\": \"line\",         \"paint\": {             \"line-color\": \"#FFD700\",  # Gold color             \"line-width\": 2,             \"line-opacity\": 0.8,         },     } ]  m3.add_pmtiles(pmtiles_url, layer_id=\"pmtiles_roads\", layers=roads_layers)  # Add the same PMTiles source again with different styling for buildings building_layers = [     {         \"id\": \"landuse_areas\",         \"source\": \"pmtiles_buildings_source\",         \"source-layer\": \"landuse\",         \"type\": \"fill\",         \"paint\": {\"fill-color\": \"#32CD32\", \"fill-opacity\": 0.4},  # Lime green     } ]  m3.add_pmtiles(pmtiles_url, layer_id=\"pmtiles_buildings\", layers=building_layers)  print(\"Added multiple PMTiles layers with different styling\") print(\"Gold roads and green landuse areas should be visible\") m3 In\u00a0[\u00a0]: Copied! <pre># Check current layers\nprint(\"Current layers in the map:\")\nfor layer_id in m3.layer_dict.keys():\n    layer_info = m3.layer_dict[layer_id]\n    print(\n        f\"  - {layer_id}: visible={layer_info['visible']}, opacity={layer_info['opacity']}\"\n    )\n</pre> # Check current layers print(\"Current layers in the map:\") for layer_id in m3.layer_dict.keys():     layer_info = m3.layer_dict[layer_id]     print(         f\"  - {layer_id}: visible={layer_info['visible']}, opacity={layer_info['opacity']}\"     ) In\u00a0[\u00a0]: Copied! <pre># Adjust layer properties\nm3.set_opacity(\"main_roads\", 0.5)\nm3.set_visibility(\"landuse_areas\", False)\n\nprint(\"Modified layer properties:\")\nprint(\"- Reduced road opacity to 0.5\")\nprint(\"- Hidden landuse areas\")\nm3\n</pre> # Adjust layer properties m3.set_opacity(\"main_roads\", 0.5) m3.set_visibility(\"landuse_areas\", False)  print(\"Modified layer properties:\") print(\"- Reduced road opacity to 0.5\") print(\"- Hidden landuse areas\") m3 In\u00a0[\u00a0]: Copied! <pre># Show landuse areas again\nm3.set_visibility(\"landuse_areas\", True)\nprint(\"Landuse areas are now visible again\")\nm3\n</pre> # Show landuse areas again m3.set_visibility(\"landuse_areas\", True) print(\"Landuse areas are now visible again\") m3 In\u00a0[\u00a0]: Copied! <pre># Create a final map for HTML export\nexport_map = MapLibreMap(\n    center=[43.77, 11.25], zoom=13, height=\"600px\", style=\"voyager\"\n)\n\n# Add PMTiles with default styling\nexport_map.add_pmtiles(pmtiles_url, layer_id=\"florence_export\")\n\n# Export to HTML\nexport_map.to_html(\"florence_pmtiles_map.html\", title=\"Florence PMTiles Demo\")\n\nprint(\"Map exported to 'florence_pmtiles_map.html'\")\nprint(\"The HTML file includes PMTiles support and can be opened in any browser\")\nexport_map\n</pre> # Create a final map for HTML export export_map = MapLibreMap(     center=[43.77, 11.25], zoom=13, height=\"600px\", style=\"voyager\" )  # Add PMTiles with default styling export_map.add_pmtiles(pmtiles_url, layer_id=\"florence_export\")  # Export to HTML export_map.to_html(\"florence_pmtiles_map.html\", title=\"Florence PMTiles Demo\")  print(\"Map exported to 'florence_pmtiles_map.html'\") print(\"The HTML file includes PMTiles support and can be opened in any browser\") export_map In\u00a0[\u00a0]: Copied! <pre># Create an advanced styled map\nadvanced_map = MapLibreMap(\n    center=[43.77, 11.25], zoom=14, height=\"600px\", style=\"positron\"\n)\n\n# Advanced layer configuration with expressions and filters\nadvanced_layers = [\n    {\n        \"id\": \"florence_roads_by_type\",\n        \"source\": \"florence_advanced_source\",\n        \"source-layer\": \"roads\",\n        \"type\": \"line\",\n        \"paint\": {\n            \"line-color\": [\n                \"case\",\n                [\"has\", \"highway\"],\n                \"#FF0000\",  # Red for highways\n                \"#666666\",  # Gray for other roads\n            ],\n            \"line-width\": [\"interpolate\", [\"linear\"], [\"zoom\"], 10, 1, 16, 4],\n            \"line-opacity\": 0.8,\n        },\n    },\n    {\n        \"id\": \"florence_landuse_styled\",\n        \"source\": \"florence_advanced_source\",\n        \"source-layer\": \"landuse\",\n        \"type\": \"fill\",\n        \"paint\": {\n            \"fill-color\": [\n                \"interpolate\",\n                [\"linear\"],\n                [\"zoom\"],\n                10,\n                \"rgba(139, 69, 19, 0.3)\",\n                15,\n                \"rgba(139, 69, 19, 0.6)\",\n            ],\n            \"fill-outline-color\": \"rgba(139, 69, 19, 0.8)\",\n        },\n    },\n]\n\nadvanced_map.add_pmtiles(\n    pmtiles_url, layer_id=\"florence_advanced\", layers=advanced_layers\n)\n\nprint(\"Created advanced PMTiles map with:\")\nprint(\"- Color-coded roads (red for highways, gray for others)\")\nprint(\"- Zoom-dependent styling\")\nprint(\"- Outlined landuse areas\")\nadvanced_map\n</pre> # Create an advanced styled map advanced_map = MapLibreMap(     center=[43.77, 11.25], zoom=14, height=\"600px\", style=\"positron\" )  # Advanced layer configuration with expressions and filters advanced_layers = [     {         \"id\": \"florence_roads_by_type\",         \"source\": \"florence_advanced_source\",         \"source-layer\": \"roads\",         \"type\": \"line\",         \"paint\": {             \"line-color\": [                 \"case\",                 [\"has\", \"highway\"],                 \"#FF0000\",  # Red for highways                 \"#666666\",  # Gray for other roads             ],             \"line-width\": [\"interpolate\", [\"linear\"], [\"zoom\"], 10, 1, 16, 4],             \"line-opacity\": 0.8,         },     },     {         \"id\": \"florence_landuse_styled\",         \"source\": \"florence_advanced_source\",         \"source-layer\": \"landuse\",         \"type\": \"fill\",         \"paint\": {             \"fill-color\": [                 \"interpolate\",                 [\"linear\"],                 [\"zoom\"],                 10,                 \"rgba(139, 69, 19, 0.3)\",                 15,                 \"rgba(139, 69, 19, 0.6)\",             ],             \"fill-outline-color\": \"rgba(139, 69, 19, 0.8)\",         },     }, ]  advanced_map.add_pmtiles(     pmtiles_url, layer_id=\"florence_advanced\", layers=advanced_layers )  print(\"Created advanced PMTiles map with:\") print(\"- Color-coded roads (red for highways, gray for others)\") print(\"- Zoom-dependent styling\") print(\"- Outlined landuse areas\") advanced_map"},{"location":"examples/maplibre/pmtiles_example/#pmtiles-support-in-anymap","title":"PMTiles Support in AnyMap\u00b6","text":"<p>This notebook demonstrates how to use PMTiles (Protomaps Tiles) with the MapLibre implementation in AnyMap. PMTiles is a single-file archive format for tiled data that enables efficient serving of vector tiles without a tile server.</p>"},{"location":"examples/maplibre/pmtiles_example/#what-is-pmtiles","title":"What is PMTiles?\u00b6","text":"<p>PMTiles is a cloud-optimized format for storing map tiles in a single file. It allows you to:</p> <ul> <li>Serve vector tiles directly from cloud storage (S3, CDN, etc.)</li> <li>Eliminate the need for a tile server</li> <li>Reduce costs and complexity for map deployments</li> <li>Enable offline mapping applications</li> </ul> <p>Learn more at protomaps.com</p>"},{"location":"examples/maplibre/pmtiles_example/#example-1-basic-pmtiles-usage","title":"Example 1: Basic PMTiles Usage\u00b6","text":"<p>Let's start with a simple example using a PMTiles file from the Protomaps demo. This contains vector data for Florence, Italy.</p>"},{"location":"examples/maplibre/pmtiles_example/#example-2-custom-layer-styling","title":"Example 2: Custom Layer Styling\u00b6","text":"<p>PMTiles often contain multiple data layers. You can customize how these layers are styled by providing your own layer configurations.</p>"},{"location":"examples/maplibre/pmtiles_example/#example-3-multiple-pmtiles-sources","title":"Example 3: Multiple PMTiles Sources\u00b6","text":"<p>You can add multiple PMTiles sources to the same map, each with different styling and data.</p>"},{"location":"examples/maplibre/pmtiles_example/#example-4-layer-management-with-pmtiles","title":"Example 4: Layer Management with PMTiles\u00b6","text":"<p>PMTiles layers can be managed like any other layers in AnyMap - you can adjust opacity, visibility, and remove them.</p>"},{"location":"examples/maplibre/pmtiles_example/#example-5-export-pmtiles-map-to-html","title":"Example 5: Export PMTiles Map to HTML\u00b6","text":"<p>Maps with PMTiles can be exported to standalone HTML files for sharing or deployment.</p>"},{"location":"examples/maplibre/pmtiles_example/#example-6-advanced-pmtiles-configuration","title":"Example 6: Advanced PMTiles Configuration\u00b6","text":"<p>For more advanced use cases, you can create complex layer configurations that take advantage of PMTiles data structure.</p>"},{"location":"examples/maplibre/pmtiles_example/#summary","title":"Summary\u00b6","text":"<p>This notebook demonstrated the PMTiles functionality in AnyMap:</p>"},{"location":"examples/maplibre/pmtiles_example/#key-features-covered","title":"\u2705 Key Features Covered:\u00b6","text":"<ol> <li>Basic PMTiles Usage: Simple addition of PMTiles data with default styling</li> <li>Custom Layer Styling: Creating custom layer configurations for specific visual effects</li> <li>Multiple PMTiles Sources: Adding multiple PMTiles sources to the same map</li> <li>Layer Management: Controlling opacity, visibility, and other layer properties</li> <li>HTML Export: Exporting PMTiles maps to standalone HTML files</li> <li>Advanced Configuration: Using MapLibre expressions for complex styling</li> </ol>"},{"location":"examples/maplibre/pmtiles_example/#method-signature","title":"\ud83d\udd27 Method Signature:\u00b6","text":"<pre>map.add_pmtiles(\n    pmtiles_url: str,                    # URL to the PMTiles file\n    layer_id: Optional[str] = None,      # Custom layer ID (auto-generated if None)\n    layers: Optional[List[Dict]] = None, # Custom layer configurations\n    opacity: Optional[float] = 1.0,      # Layer opacity (0.0 - 1.0)\n    visible: Optional[bool] = True,      # Initial visibility\n    before_id: Optional[str] = None      # Insert before this layer\n)\n</pre>"},{"location":"examples/maplibre/pmtiles_example/#pmtiles-benefits","title":"\ud83c\udf10 PMTiles Benefits:\u00b6","text":"<ul> <li>No tile server required: Serve directly from cloud storage</li> <li>Cost effective: Reduce infrastructure costs</li> <li>Fast loading: Optimized for web delivery</li> <li>Offline capable: Works without internet connectivity</li> <li>Single file format: Easy to manage and deploy</li> </ul>"},{"location":"examples/maplibre/pmtiles_example/#resources","title":"\ud83d\udcda Resources:\u00b6","text":"<ul> <li>PMTiles Specification</li> <li>Protomaps.com</li> <li>MapLibre GL JS Documentation</li> </ul> <p>PMTiles integration makes it easy to serve vector map data efficiently without complex server infrastructure!</p>"},{"location":"examples/maplibre/save_draw_data_example/","title":"Save draw data example","text":"In\u00a0[\u00a0]: Copied! <pre>from anymap.maplibre import MapLibreMap\nimport tempfile\nimport os\n\n# Create a map centered on New York City\nm = MapLibreMap(center=[-74.0, 40.7], zoom=10)\nm.add_basemap(\"OpenStreetMap.Mapnik\")\n\n# Add a draw control so users can draw features\nm.add_draw_control(\n    position=\"top-left\",\n    controls={\"point\": True, \"line_string\": True, \"polygon\": True, \"trash\": True},\n)\n\nm\n</pre> from anymap.maplibre import MapLibreMap import tempfile import os  # Create a map centered on New York City m = MapLibreMap(center=[-74.0, 40.7], zoom=10) m.add_basemap(\"OpenStreetMap.Mapnik\")  # Add a draw control so users can draw features m.add_draw_control(     position=\"top-left\",     controls={\"point\": True, \"line_string\": True, \"polygon\": True, \"trash\": True}, )  m In\u00a0[\u00a0]: Copied! <pre># Add some sample drawn features\nsample_features = {\n    \"type\": \"FeatureCollection\",\n    \"features\": [\n        {\n            \"type\": \"Feature\",\n            \"properties\": {\"name\": \"Central Park\", \"type\": \"park\"},\n            \"geometry\": {\"type\": \"Point\", \"coordinates\": [-73.9665, 40.7812]},\n        },\n        {\n            \"type\": \"Feature\",\n            \"properties\": {\"name\": \"Brooklyn Bridge\", \"type\": \"landmark\"},\n            \"geometry\": {\"type\": \"Point\", \"coordinates\": [-73.9969, 40.7061]},\n        },\n        {\n            \"type\": \"Feature\",\n            \"properties\": {\"name\": \"Manhattan Area\", \"type\": \"area\"},\n            \"geometry\": {\n                \"type\": \"Polygon\",\n                \"coordinates\": [\n                    [\n                        [-74.02, 40.70],\n                        [-73.93, 40.70],\n                        [-73.93, 40.80],\n                        [-74.02, 40.80],\n                        [-74.02, 40.70],\n                    ]\n                ],\n            },\n        },\n    ],\n}\n\n# Load the sample data into the draw control\nm.load_draw_data(sample_features)\n\nprint(f\"Loaded {len(m.get_draw_data()['features'])} features\")\n</pre> # Add some sample drawn features sample_features = {     \"type\": \"FeatureCollection\",     \"features\": [         {             \"type\": \"Feature\",             \"properties\": {\"name\": \"Central Park\", \"type\": \"park\"},             \"geometry\": {\"type\": \"Point\", \"coordinates\": [-73.9665, 40.7812]},         },         {             \"type\": \"Feature\",             \"properties\": {\"name\": \"Brooklyn Bridge\", \"type\": \"landmark\"},             \"geometry\": {\"type\": \"Point\", \"coordinates\": [-73.9969, 40.7061]},         },         {             \"type\": \"Feature\",             \"properties\": {\"name\": \"Manhattan Area\", \"type\": \"area\"},             \"geometry\": {                 \"type\": \"Polygon\",                 \"coordinates\": [                     [                         [-74.02, 40.70],                         [-73.93, 40.70],                         [-73.93, 40.80],                         [-74.02, 40.80],                         [-74.02, 40.70],                     ]                 ],             },         },     ], }  # Load the sample data into the draw control m.load_draw_data(sample_features)  print(f\"Loaded {len(m.get_draw_data()['features'])} features\") In\u00a0[\u00a0]: Copied! <pre># Save to GeoJSON format\ngeojson_path = \"/tmp/drawn_features.geojson\"\nm.save_draw_data(geojson_path)\n\nprint(f\"\u2713 Saved to GeoJSON: {geojson_path}\")\nprint(f\"File size: {os.path.getsize(geojson_path)} bytes\")\n</pre> # Save to GeoJSON format geojson_path = \"/tmp/drawn_features.geojson\" m.save_draw_data(geojson_path)  print(f\"\u2713 Saved to GeoJSON: {geojson_path}\") print(f\"File size: {os.path.getsize(geojson_path)} bytes\") In\u00a0[\u00a0]: Copied! <pre># Save to GeoPackage format\ngpkg_path = \"/tmp/drawn_features.gpkg\"\nm.save_draw_data(gpkg_path)\n\nprint(f\"\u2713 Saved to GeoPackage: {gpkg_path}\")\nprint(f\"File size: {os.path.getsize(gpkg_path)} bytes\")\n</pre> # Save to GeoPackage format gpkg_path = \"/tmp/drawn_features.gpkg\" m.save_draw_data(gpkg_path)  print(f\"\u2713 Saved to GeoPackage: {gpkg_path}\") print(f\"File size: {os.path.getsize(gpkg_path)} bytes\") In\u00a0[\u00a0]: Copied! <pre># Create a new map with only point features\nm_points = MapLibreMap(center=[-74.0, 40.7], zoom=10)\nm_points.add_basemap(\"OpenStreetMap.Mapnik\")\nm_points.add_draw_control()\n\n# Add only point features\npoint_features = {\n    \"type\": \"FeatureCollection\",\n    \"features\": [\n        {\n            \"type\": \"Feature\",\n            \"properties\": {\"name\": \"Central Park\", \"type\": \"park\"},\n            \"geometry\": {\"type\": \"Point\", \"coordinates\": [-73.9665, 40.7812]},\n        },\n        {\n            \"type\": \"Feature\",\n            \"properties\": {\"name\": \"Brooklyn Bridge\", \"type\": \"landmark\"},\n            \"geometry\": {\"type\": \"Point\", \"coordinates\": [-73.9969, 40.7061]},\n        },\n    ],\n}\n\nm_points.load_draw_data(point_features)\n\n# Now save to shapefile\nshp_path = \"/tmp/drawn_points.shp\"\nm_points.save_draw_data(shp_path)\n\nprint(f\"\u2713 Saved points to Shapefile: {shp_path}\")\nprint(\n    f\"Files created: {[f for f in os.listdir('/tmp') if f.startswith('drawn_points.')]}\"\n)\n\nm_points\n</pre> # Create a new map with only point features m_points = MapLibreMap(center=[-74.0, 40.7], zoom=10) m_points.add_basemap(\"OpenStreetMap.Mapnik\") m_points.add_draw_control()  # Add only point features point_features = {     \"type\": \"FeatureCollection\",     \"features\": [         {             \"type\": \"Feature\",             \"properties\": {\"name\": \"Central Park\", \"type\": \"park\"},             \"geometry\": {\"type\": \"Point\", \"coordinates\": [-73.9665, 40.7812]},         },         {             \"type\": \"Feature\",             \"properties\": {\"name\": \"Brooklyn Bridge\", \"type\": \"landmark\"},             \"geometry\": {\"type\": \"Point\", \"coordinates\": [-73.9969, 40.7061]},         },     ], }  m_points.load_draw_data(point_features)  # Now save to shapefile shp_path = \"/tmp/drawn_points.shp\" m_points.save_draw_data(shp_path)  print(f\"\u2713 Saved points to Shapefile: {shp_path}\") print(     f\"Files created: {[f for f in os.listdir('/tmp') if f.startswith('drawn_points.')]}\" )  m_points In\u00a0[\u00a0]: Copied! <pre># Try to save mixed geometry types to shapefile\ntry:\n    m.save_draw_data(\"/tmp/mixed_geometries.shp\")\nexcept ValueError as e:\n    print(f\"Expected error: {e}\")\n</pre> # Try to save mixed geometry types to shapefile try:     m.save_draw_data(\"/tmp/mixed_geometries.shp\") except ValueError as e:     print(f\"Expected error: {e}\") In\u00a0[\u00a0]: Copied! <pre># Create a map with no drawn features\nempty_map = MapLibreMap(center=[0, 0], zoom=2)\n\ntry:\n    empty_map.save_draw_data(\"/tmp/empty.geojson\")\nexcept ValueError as e:\n    print(f\"Expected error: {e}\")\n</pre> # Create a map with no drawn features empty_map = MapLibreMap(center=[0, 0], zoom=2)  try:     empty_map.save_draw_data(\"/tmp/empty.geojson\") except ValueError as e:     print(f\"Expected error: {e}\") In\u00a0[\u00a0]: Copied! <pre>import json\n\n# Create a new map and load the saved GeoJSON data\nm_new = MapLibreMap(center=[-74.0, 40.7], zoom=10)\nm_new.add_basemap(\"OpenStreetMap.Mapnik\")\nm_new.add_draw_control()\n\n# Load the saved data\nwith open(geojson_path, \"r\") as f:\n    saved_data = json.load(f)\n\nm_new.load_draw_data(saved_data)\nprint(f\"Loaded {len(m_new.get_draw_data()['features'])} features from saved file\")\n\nm_new\n</pre> import json  # Create a new map and load the saved GeoJSON data m_new = MapLibreMap(center=[-74.0, 40.7], zoom=10) m_new.add_basemap(\"OpenStreetMap.Mapnik\") m_new.add_draw_control()  # Load the saved data with open(geojson_path, \"r\") as f:     saved_data = json.load(f)  m_new.load_draw_data(saved_data) print(f\"Loaded {len(m_new.get_draw_data()['features'])} features from saved file\")  m_new In\u00a0[\u00a0]: Copied! <pre>import geopandas as gpd\n\n# Read the saved GeoJSON with GeoPandas\ngdf = gpd.read_file(geojson_path)\n\nprint(\"GeoPandas DataFrame:\")\nprint(gdf)\nprint(f\"\\nCRS: {gdf.crs}\")\nprint(f\"Geometry types: {gdf.geometry.geom_type.unique()}\")\n</pre> import geopandas as gpd  # Read the saved GeoJSON with GeoPandas gdf = gpd.read_file(geojson_path)  print(\"GeoPandas DataFrame:\") print(gdf) print(f\"\\nCRS: {gdf.crs}\") print(f\"Geometry types: {gdf.geometry.geom_type.unique()}\") In\u00a0[\u00a0]: Copied! <pre># Clean up temporary files\nimport glob\n\nfor pattern in [\"/tmp/drawn_features.*\", \"/tmp/drawn_points.*\"]:\n    for file in glob.glob(pattern):\n        try:\n            os.remove(file)\n            print(f\"Removed {file}\")\n        except:\n            pass\n</pre> # Clean up temporary files import glob  for pattern in [\"/tmp/drawn_features.*\", \"/tmp/drawn_points.*\"]:     for file in glob.glob(pattern):         try:             os.remove(file)             print(f\"Removed {file}\")         except:             pass"},{"location":"examples/maplibre/save_draw_data_example/#save-draw-data-example","title":"Save Draw Data Example\u00b6","text":"<p>This notebook demonstrates the new <code>save_draw_data()</code> method in AnyMap, which allows you to save drawn features to various file formats supported by GeoPandas.</p>"},{"location":"examples/maplibre/save_draw_data_example/#installation-requirements","title":"Installation Requirements\u00b6","text":"<p>The <code>save_draw_data</code> method requires GeoPandas to be installed:</p> <pre>pip install geopandas\n</pre>"},{"location":"examples/maplibre/save_draw_data_example/#basic-usage","title":"Basic Usage\u00b6","text":"<p>First, let's create a map and add a draw control:</p>"},{"location":"examples/maplibre/save_draw_data_example/#adding-sample-data","title":"Adding Sample Data\u00b6","text":"<p>Let's add some sample features for demonstration:</p>"},{"location":"examples/maplibre/save_draw_data_example/#saving-to-different-formats","title":"Saving to Different Formats\u00b6","text":"<p>Now let's demonstrate saving the drawn data to various formats:</p>"},{"location":"examples/maplibre/save_draw_data_example/#save-to-geojson","title":"Save to GeoJSON\u00b6","text":"<p>GeoJSON is the most common format for web mapping and supports all geometry types:</p>"},{"location":"examples/maplibre/save_draw_data_example/#save-to-geopackage","title":"Save to GeoPackage\u00b6","text":"<p>GeoPackage is a modern, standards-based format that supports mixed geometry types:</p>"},{"location":"examples/maplibre/save_draw_data_example/#save-to-shapefile-points-only","title":"Save to Shapefile (Points Only)\u00b6","text":"<p>Shapefiles require all features to have the same geometry type. Let's create a map with only points:</p>"},{"location":"examples/maplibre/save_draw_data_example/#error-handling","title":"Error Handling\u00b6","text":"<p>The <code>save_draw_data</code> method provides helpful error messages for common issues:</p>"},{"location":"examples/maplibre/save_draw_data_example/#mixed-geometry-types-in-shapefile","title":"Mixed Geometry Types in Shapefile\u00b6","text":"<p>Let's see what happens when we try to save mixed geometry types to a shapefile:</p>"},{"location":"examples/maplibre/save_draw_data_example/#no-features-to-save","title":"No Features to Save\u00b6","text":"<p>Let's see what happens when there are no drawn features:</p>"},{"location":"examples/maplibre/save_draw_data_example/#loading-saved-data","title":"Loading Saved Data\u00b6","text":"<p>You can load the saved data back into a map or use it with other geospatial tools:</p>"},{"location":"examples/maplibre/save_draw_data_example/#working-with-geopandas","title":"Working with GeoPandas\u00b6","text":"<p>Since the save method uses GeoPandas, you can also work directly with the data:</p>"},{"location":"examples/maplibre/save_draw_data_example/#supported-formats","title":"Supported Formats\u00b6","text":"<p>The <code>save_draw_data</code> method supports all formats that GeoPandas can write to, including:</p> <ul> <li>GeoJSON (<code>.geojson</code>) - Best for web applications, supports all geometry types</li> <li>GeoPackage (<code>.gpkg</code>) - Modern SQLite-based format, supports all geometry types</li> <li>Shapefile (<code>.shp</code>) - Traditional GIS format, requires same geometry type for all features</li> <li>KML (<code>.kml</code>) - Google Earth format</li> <li>GML (<code>.gml</code>) - OGC Geography Markup Language</li> <li>CSV (<code>.csv</code>) - Only for point data without geometry</li> </ul> <p>You can also specify the driver explicitly:</p> <pre>m.save_draw_data(\"output.gpkg\", driver=\"GPKG\")\nm.save_draw_data(\"output.shp\", driver=\"ESRI Shapefile\")\n</pre>"},{"location":"examples/maplibre/save_draw_data_example/#cleanup","title":"Cleanup\u00b6","text":"<p>Clean up the temporary files:</p>"},{"location":"examples/maplibre/save_draw_data_example/#summary","title":"Summary\u00b6","text":"<p>The <code>save_draw_data()</code> method provides a simple way to export drawn features from AnyMap to various geospatial file formats:</p> <ol> <li>Easy to use: Just call <code>map.save_draw_data(\"filename.geojson\")</code></li> <li>Multiple formats: Supports all GeoPandas-compatible formats</li> <li>Error handling: Provides helpful error messages for common issues</li> <li>Format detection: Automatically detects format from file extension</li> <li>CRS handling: Automatically sets EPSG:4326 if no CRS is present</li> </ol> <p>This makes it easy to integrate drawn features with other geospatial workflows and tools!</p>"},{"location":"examples/maplibre/streetview_example/","title":"Streetview example","text":"In\u00a0[\u00a0]: Copied! <pre>from anymap import MapLibreMap\nimport os\n</pre> from anymap import MapLibreMap import os In\u00a0[\u00a0]: Copied! <pre># Create a map centered in New York City\nm = MapLibreMap(\n    center=[-74.0066, 40.7135],  # New York City coordinates\n    zoom=15,\n    height=\"600px\",\n    width=\"100%\",\n)\n\n# Add a basemap for better context\nm.add_basemap(\"OpenStreetMap.Mapnik\")\n\n# Add the Google Street View control\n# The API key will be automatically retrieved from the GOOGLE_MAPS_API_KEY environment variable\ntry:\n    m.add_google_streetview(position=\"top-left\")\n    print(\"\u2705 Street View control added successfully!\")\n    print(\"\ud83d\udccd How to use:\")\n    print(\"   1. Look for the Street View button on the map (person/peg man icon)\")\n    print(\"   2. Click and drag the pegman to show Street View coverage (blue areas)\")\n    print(\"   3. Drop the pegman on blue coverage areas to open Street View\")\n    print(\"   4. The plugin now properly initializes when the map loads\")\nexcept ValueError as e:\n    print(f\"\u274c Error: {e}\")\n    print(\"\ud83d\udca1 Please set your GOOGLE_MAPS_API_KEY environment variable\")\n\nm\n</pre> # Create a map centered in New York City m = MapLibreMap(     center=[-74.0066, 40.7135],  # New York City coordinates     zoom=15,     height=\"600px\",     width=\"100%\", )  # Add a basemap for better context m.add_basemap(\"OpenStreetMap.Mapnik\")  # Add the Google Street View control # The API key will be automatically retrieved from the GOOGLE_MAPS_API_KEY environment variable try:     m.add_google_streetview(position=\"top-left\")     print(\"\u2705 Street View control added successfully!\")     print(\"\ud83d\udccd How to use:\")     print(\"   1. Look for the Street View button on the map (person/peg man icon)\")     print(\"   2. Click and drag the pegman to show Street View coverage (blue areas)\")     print(\"   3. Drop the pegman on blue coverage areas to open Street View\")     print(\"   4. The plugin now properly initializes when the map loads\") except ValueError as e:     print(f\"\u274c Error: {e}\")     print(\"\ud83d\udca1 Please set your GOOGLE_MAPS_API_KEY environment variable\")  m"},{"location":"examples/maplibre/streetview_example/#google-street-view-example","title":"Google Street View Example\u00b6","text":"<p>This notebook demonstrates how to use the Google Street View feature in anymap's MapLibre implementation. The Street View control allows users to view street-level imagery at clicked locations on the map.</p>"},{"location":"examples/maplibre/streetview_example/#setup","title":"Setup\u00b6","text":"<p>Before using the Google Street View functionality, you need to have a Google Maps API key. You can:</p> <ol> <li>Set it as an environment variable: <code>GOOGLE_MAPS_API_KEY</code></li> <li>Pass it directly to the <code>add_google_streetview()</code> method</li> <li>In Google Colab, add it to your userdata with key <code>GOOGLE_MAPS_API_KEY</code></li> </ol> <p>Note: Make sure your Google Maps API key has the Street View Static API enabled.</p>"},{"location":"examples/maplibre/streetview_example/#basic-street-view-setup","title":"Basic Street View Setup\u00b6","text":"<p>Create a map centered in New York City and add the Google Street View control.</p>"},{"location":"examples/maplibre/temporal_control_example/","title":"Temporal control example","text":"In\u00a0[\u00a0]: Copied! <pre>from anymap import MapLibreMap\n</pre> from anymap import MapLibreMap In\u00a0[\u00a0]: Copied! <pre># Create sample GeoJSON data for different time periods\n# Simulating city population growth over three years\n\ndata_2020 = {\n    \"type\": \"FeatureCollection\",\n    \"features\": [\n        {\n            \"type\": \"Feature\",\n            \"geometry\": {\"type\": \"Point\", \"coordinates\": [-122.4194, 37.7749]},\n            \"properties\": {\"name\": \"San Francisco\", \"population\": 870000, \"year\": 2020},\n        },\n        {\n            \"type\": \"Feature\",\n            \"geometry\": {\"type\": \"Point\", \"coordinates\": [-118.2437, 34.0522]},\n            \"properties\": {\"name\": \"Los Angeles\", \"population\": 3900000, \"year\": 2020},\n        },\n        {\n            \"type\": \"Feature\",\n            \"geometry\": {\"type\": \"Point\", \"coordinates\": [-122.3321, 47.6062]},\n            \"properties\": {\"name\": \"Seattle\", \"population\": 750000, \"year\": 2020},\n        },\n    ],\n}\n\ndata_2021 = {\n    \"type\": \"FeatureCollection\",\n    \"features\": [\n        {\n            \"type\": \"Feature\",\n            \"geometry\": {\"type\": \"Point\", \"coordinates\": [-122.4194, 37.7749]},\n            \"properties\": {\"name\": \"San Francisco\", \"population\": 875000, \"year\": 2021},\n        },\n        {\n            \"type\": \"Feature\",\n            \"geometry\": {\"type\": \"Point\", \"coordinates\": [-118.2437, 34.0522]},\n            \"properties\": {\"name\": \"Los Angeles\", \"population\": 3950000, \"year\": 2021},\n        },\n        {\n            \"type\": \"Feature\",\n            \"geometry\": {\"type\": \"Point\", \"coordinates\": [-122.3321, 47.6062]},\n            \"properties\": {\"name\": \"Seattle\", \"population\": 760000, \"year\": 2021},\n        },\n    ],\n}\n\ndata_2022 = {\n    \"type\": \"FeatureCollection\",\n    \"features\": [\n        {\n            \"type\": \"Feature\",\n            \"geometry\": {\"type\": \"Point\", \"coordinates\": [-122.4194, 37.7749]},\n            \"properties\": {\"name\": \"San Francisco\", \"population\": 880000, \"year\": 2022},\n        },\n        {\n            \"type\": \"Feature\",\n            \"geometry\": {\"type\": \"Point\", \"coordinates\": [-118.2437, 34.0522]},\n            \"properties\": {\"name\": \"Los Angeles\", \"population\": 4000000, \"year\": 2022},\n        },\n        {\n            \"type\": \"Feature\",\n            \"geometry\": {\"type\": \"Point\", \"coordinates\": [-122.3321, 47.6062]},\n            \"properties\": {\"name\": \"Seattle\", \"population\": 770000, \"year\": 2022},\n        },\n    ],\n}\n</pre> # Create sample GeoJSON data for different time periods # Simulating city population growth over three years  data_2020 = {     \"type\": \"FeatureCollection\",     \"features\": [         {             \"type\": \"Feature\",             \"geometry\": {\"type\": \"Point\", \"coordinates\": [-122.4194, 37.7749]},             \"properties\": {\"name\": \"San Francisco\", \"population\": 870000, \"year\": 2020},         },         {             \"type\": \"Feature\",             \"geometry\": {\"type\": \"Point\", \"coordinates\": [-118.2437, 34.0522]},             \"properties\": {\"name\": \"Los Angeles\", \"population\": 3900000, \"year\": 2020},         },         {             \"type\": \"Feature\",             \"geometry\": {\"type\": \"Point\", \"coordinates\": [-122.3321, 47.6062]},             \"properties\": {\"name\": \"Seattle\", \"population\": 750000, \"year\": 2020},         },     ], }  data_2021 = {     \"type\": \"FeatureCollection\",     \"features\": [         {             \"type\": \"Feature\",             \"geometry\": {\"type\": \"Point\", \"coordinates\": [-122.4194, 37.7749]},             \"properties\": {\"name\": \"San Francisco\", \"population\": 875000, \"year\": 2021},         },         {             \"type\": \"Feature\",             \"geometry\": {\"type\": \"Point\", \"coordinates\": [-118.2437, 34.0522]},             \"properties\": {\"name\": \"Los Angeles\", \"population\": 3950000, \"year\": 2021},         },         {             \"type\": \"Feature\",             \"geometry\": {\"type\": \"Point\", \"coordinates\": [-122.3321, 47.6062]},             \"properties\": {\"name\": \"Seattle\", \"population\": 760000, \"year\": 2021},         },     ], }  data_2022 = {     \"type\": \"FeatureCollection\",     \"features\": [         {             \"type\": \"Feature\",             \"geometry\": {\"type\": \"Point\", \"coordinates\": [-122.4194, 37.7749]},             \"properties\": {\"name\": \"San Francisco\", \"population\": 880000, \"year\": 2022},         },         {             \"type\": \"Feature\",             \"geometry\": {\"type\": \"Point\", \"coordinates\": [-118.2437, 34.0522]},             \"properties\": {\"name\": \"Los Angeles\", \"population\": 4000000, \"year\": 2022},         },         {             \"type\": \"Feature\",             \"geometry\": {\"type\": \"Point\", \"coordinates\": [-122.3321, 47.6062]},             \"properties\": {\"name\": \"Seattle\", \"population\": 770000, \"year\": 2022},         },     ], } In\u00a0[\u00a0]: Copied! <pre># Create a MapLibre map centered on the US West Coast\nm = MapLibreMap(center=[-120.5, 40.0], zoom=5, style=\"positron\", height=\"600px\")\n\n# Add layers for each time period\n# Note: Initially all layers will be visible, but the temporal control will manage visibility\nm.add_geojson_layer(\n    \"cities-2020\",\n    data_2020,\n    \"circle\",\n    paint={\n        \"circle-radius\": [\n            \"interpolate\",\n            [\"linear\"],\n            [\"get\", \"population\"],\n            0,\n            5,\n            5000000,\n            30,\n        ],\n        \"circle-color\": \"#FF6B6B\",\n        \"circle-opacity\": 0.7,\n        \"circle-stroke-width\": 2,\n        \"circle-stroke-color\": \"#FFFFFF\",\n    },\n)\n\nm.add_geojson_layer(\n    \"cities-2021\",\n    data_2021,\n    \"circle\",\n    paint={\n        \"circle-radius\": [\n            \"interpolate\",\n            [\"linear\"],\n            [\"get\", \"population\"],\n            0,\n            5,\n            5000000,\n            30,\n        ],\n        \"circle-color\": \"#4ECDC4\",\n        \"circle-opacity\": 0.7,\n        \"circle-stroke-width\": 2,\n        \"circle-stroke-color\": \"#FFFFFF\",\n    },\n)\n\nm.add_geojson_layer(\n    \"cities-2022\",\n    data_2022,\n    \"circle\",\n    paint={\n        \"circle-radius\": [\n            \"interpolate\",\n            [\"linear\"],\n            [\"get\", \"population\"],\n            0,\n            5,\n            5000000,\n            30,\n        ],\n        \"circle-color\": \"#95E1D3\",\n        \"circle-opacity\": 0.7,\n        \"circle-stroke-width\": 2,\n        \"circle-stroke-color\": \"#FFFFFF\",\n    },\n)\n\n# Configure temporal frames\nframes = [\n    {\"title\": \"2020\", \"layers\": [\"cities-2020\"]},\n    {\"title\": \"2021\", \"layers\": [\"cities-2021\"]},\n    {\"title\": \"2022\", \"layers\": [\"cities-2022\"]},\n]\n\n# Add temporal control with 2-second intervals\nm.add_temporal_control(\n    frames=frames, position=\"top-right\", interval=2000  # 2 seconds per frame\n)\n\nm\n</pre> # Create a MapLibre map centered on the US West Coast m = MapLibreMap(center=[-120.5, 40.0], zoom=5, style=\"positron\", height=\"600px\")  # Add layers for each time period # Note: Initially all layers will be visible, but the temporal control will manage visibility m.add_geojson_layer(     \"cities-2020\",     data_2020,     \"circle\",     paint={         \"circle-radius\": [             \"interpolate\",             [\"linear\"],             [\"get\", \"population\"],             0,             5,             5000000,             30,         ],         \"circle-color\": \"#FF6B6B\",         \"circle-opacity\": 0.7,         \"circle-stroke-width\": 2,         \"circle-stroke-color\": \"#FFFFFF\",     }, )  m.add_geojson_layer(     \"cities-2021\",     data_2021,     \"circle\",     paint={         \"circle-radius\": [             \"interpolate\",             [\"linear\"],             [\"get\", \"population\"],             0,             5,             5000000,             30,         ],         \"circle-color\": \"#4ECDC4\",         \"circle-opacity\": 0.7,         \"circle-stroke-width\": 2,         \"circle-stroke-color\": \"#FFFFFF\",     }, )  m.add_geojson_layer(     \"cities-2022\",     data_2022,     \"circle\",     paint={         \"circle-radius\": [             \"interpolate\",             [\"linear\"],             [\"get\", \"population\"],             0,             5,             5000000,             30,         ],         \"circle-color\": \"#95E1D3\",         \"circle-opacity\": 0.7,         \"circle-stroke-width\": 2,         \"circle-stroke-color\": \"#FFFFFF\",     }, )  # Configure temporal frames frames = [     {\"title\": \"2020\", \"layers\": [\"cities-2020\"]},     {\"title\": \"2021\", \"layers\": [\"cities-2021\"]},     {\"title\": \"2022\", \"layers\": [\"cities-2022\"]}, ]  # Add temporal control with 2-second intervals m.add_temporal_control(     frames=frames, position=\"top-right\", interval=2000  # 2 seconds per frame )  m In\u00a0[\u00a0]: Copied! <pre># Create sample polygon data representing city boundaries at different times\nboundary_2020 = {\n    \"type\": \"FeatureCollection\",\n    \"features\": [\n        {\n            \"type\": \"Feature\",\n            \"geometry\": {\n                \"type\": \"Polygon\",\n                \"coordinates\": [\n                    [\n                        [-122.52, 37.70],\n                        [-122.32, 37.70],\n                        [-122.32, 37.82],\n                        [-122.52, 37.82],\n                        [-122.52, 37.70],\n                    ]\n                ],\n            },\n            \"properties\": {\"name\": \"SF Metro\", \"year\": 2020},\n        }\n    ],\n}\n\nboundary_2022 = {\n    \"type\": \"FeatureCollection\",\n    \"features\": [\n        {\n            \"type\": \"Feature\",\n            \"geometry\": {\n                \"type\": \"Polygon\",\n                \"coordinates\": [\n                    [\n                        [-122.58, 37.65],\n                        [-122.26, 37.65],\n                        [-122.26, 37.85],\n                        [-122.58, 37.85],\n                        [-122.58, 37.65],\n                    ]\n                ],\n            },\n            \"properties\": {\"name\": \"SF Metro\", \"year\": 2022},\n        }\n    ],\n}\n</pre> # Create sample polygon data representing city boundaries at different times boundary_2020 = {     \"type\": \"FeatureCollection\",     \"features\": [         {             \"type\": \"Feature\",             \"geometry\": {                 \"type\": \"Polygon\",                 \"coordinates\": [                     [                         [-122.52, 37.70],                         [-122.32, 37.70],                         [-122.32, 37.82],                         [-122.52, 37.82],                         [-122.52, 37.70],                     ]                 ],             },             \"properties\": {\"name\": \"SF Metro\", \"year\": 2020},         }     ], }  boundary_2022 = {     \"type\": \"FeatureCollection\",     \"features\": [         {             \"type\": \"Feature\",             \"geometry\": {                 \"type\": \"Polygon\",                 \"coordinates\": [                     [                         [-122.58, 37.65],                         [-122.26, 37.65],                         [-122.26, 37.85],                         [-122.58, 37.85],                         [-122.58, 37.65],                     ]                 ],             },             \"properties\": {\"name\": \"SF Metro\", \"year\": 2022},         }     ], } In\u00a0[\u00a0]: Copied! <pre># Create a new map\nm2 = MapLibreMap(center=[-122.42, 37.76], zoom=9, style=\"dark-matter\", height=\"600px\")\n\n# Add boundary layers\nm2.add_geojson_layer(\n    \"boundary-2020\",\n    boundary_2020,\n    \"fill\",\n    paint={\"fill-color\": \"#FF6B6B\", \"fill-opacity\": 0.3},\n)\n\nm2.add_geojson_layer(\n    \"boundary-outline-2020\",\n    boundary_2020,\n    \"line\",\n    paint={\"line-color\": \"#FF6B6B\", \"line-width\": 3},\n)\n\nm2.add_geojson_layer(\n    \"boundary-2022\",\n    boundary_2022,\n    \"fill\",\n    paint={\"fill-color\": \"#95E1D3\", \"fill-opacity\": 0.3},\n)\n\nm2.add_geojson_layer(\n    \"boundary-outline-2022\",\n    boundary_2022,\n    \"line\",\n    paint={\"line-color\": \"#95E1D3\", \"line-width\": 3},\n)\n\n# Configure frames with multiple layers per frame\nframes_multi = [\n    {\"title\": \"2020 Boundary\", \"layers\": [\"boundary-2020\", \"boundary-outline-2020\"]},\n    {\n        \"title\": \"2022 Boundary (Expanded)\",\n        \"layers\": [\"boundary-2022\", \"boundary-outline-2022\"],\n    },\n]\n\n# Add temporal control with slower interval for detailed viewing\nm2.add_temporal_control(\n    frames=frames_multi, position=\"top-left\", interval=3000  # 3 seconds per frame\n)\n\nm2\n</pre> # Create a new map m2 = MapLibreMap(center=[-122.42, 37.76], zoom=9, style=\"dark-matter\", height=\"600px\")  # Add boundary layers m2.add_geojson_layer(     \"boundary-2020\",     boundary_2020,     \"fill\",     paint={\"fill-color\": \"#FF6B6B\", \"fill-opacity\": 0.3}, )  m2.add_geojson_layer(     \"boundary-outline-2020\",     boundary_2020,     \"line\",     paint={\"line-color\": \"#FF6B6B\", \"line-width\": 3}, )  m2.add_geojson_layer(     \"boundary-2022\",     boundary_2022,     \"fill\",     paint={\"fill-color\": \"#95E1D3\", \"fill-opacity\": 0.3}, )  m2.add_geojson_layer(     \"boundary-outline-2022\",     boundary_2022,     \"line\",     paint={\"line-color\": \"#95E1D3\", \"line-width\": 3}, )  # Configure frames with multiple layers per frame frames_multi = [     {\"title\": \"2020 Boundary\", \"layers\": [\"boundary-2020\", \"boundary-outline-2020\"]},     {         \"title\": \"2022 Boundary (Expanded)\",         \"layers\": [\"boundary-2022\", \"boundary-outline-2022\"],     }, ]  # Add temporal control with slower interval for detailed viewing m2.add_temporal_control(     frames=frames_multi, position=\"top-left\", interval=3000  # 3 seconds per frame )  m2 In\u00a0[\u00a0]: Copied! <pre># Create sample weather data for different months\nimport random\n\n\ndef create_weather_data(month, base_temp):\n    \"\"\"Generate random weather data for demonstration\"\"\"\n    cities = [\n        {\"name\": \"New York\", \"coords\": [-74.0060, 40.7128]},\n        {\"name\": \"Chicago\", \"coords\": [-87.6298, 41.8781]},\n        {\"name\": \"Los Angeles\", \"coords\": [-118.2437, 34.0522]},\n        {\"name\": \"Miami\", \"coords\": [-80.1918, 25.7617]},\n        {\"name\": \"Seattle\", \"coords\": [-122.3321, 47.6062]},\n    ]\n\n    features = []\n    for city in cities:\n        temp_variation = random.uniform(-10, 10)\n        features.append(\n            {\n                \"type\": \"Feature\",\n                \"geometry\": {\"type\": \"Point\", \"coordinates\": city[\"coords\"]},\n                \"properties\": {\n                    \"name\": city[\"name\"],\n                    \"temperature\": round(base_temp + temp_variation, 1),\n                    \"month\": month,\n                },\n            }\n        )\n\n    return {\"type\": \"FeatureCollection\", \"features\": features}\n\n\n# Generate data for 6 months (winter to summer)\nmonths = [\n    {\"name\": \"January\", \"temp\": 32},\n    {\"name\": \"February\", \"temp\": 38},\n    {\"name\": \"March\", \"temp\": 48},\n    {\"name\": \"April\", \"temp\": 58},\n    {\"name\": \"May\", \"temp\": 68},\n    {\"name\": \"June\", \"temp\": 78},\n]\n\nweather_data = {\n    month[\"name\"]: create_weather_data(month[\"name\"], month[\"temp\"]) for month in months\n}\n</pre> # Create sample weather data for different months import random   def create_weather_data(month, base_temp):     \"\"\"Generate random weather data for demonstration\"\"\"     cities = [         {\"name\": \"New York\", \"coords\": [-74.0060, 40.7128]},         {\"name\": \"Chicago\", \"coords\": [-87.6298, 41.8781]},         {\"name\": \"Los Angeles\", \"coords\": [-118.2437, 34.0522]},         {\"name\": \"Miami\", \"coords\": [-80.1918, 25.7617]},         {\"name\": \"Seattle\", \"coords\": [-122.3321, 47.6062]},     ]      features = []     for city in cities:         temp_variation = random.uniform(-10, 10)         features.append(             {                 \"type\": \"Feature\",                 \"geometry\": {\"type\": \"Point\", \"coordinates\": city[\"coords\"]},                 \"properties\": {                     \"name\": city[\"name\"],                     \"temperature\": round(base_temp + temp_variation, 1),                     \"month\": month,                 },             }         )      return {\"type\": \"FeatureCollection\", \"features\": features}   # Generate data for 6 months (winter to summer) months = [     {\"name\": \"January\", \"temp\": 32},     {\"name\": \"February\", \"temp\": 38},     {\"name\": \"March\", \"temp\": 48},     {\"name\": \"April\", \"temp\": 58},     {\"name\": \"May\", \"temp\": 68},     {\"name\": \"June\", \"temp\": 78}, ]  weather_data = {     month[\"name\"]: create_weather_data(month[\"name\"], month[\"temp\"]) for month in months } In\u00a0[\u00a0]: Copied! <pre># Create map for weather animation\nm3 = MapLibreMap(center=[-95, 38], zoom=3.5, style=\"liberty\", height=\"600px\")\n\n# Add layers for each month with temperature-based colors\nweather_frames = []\nfor month_data in months:\n    month_name = month_data[\"name\"]\n    layer_id = f\"weather-{month_name.lower()}\"\n\n    m3.add_geojson_layer(\n        layer_id,\n        weather_data[month_name],\n        \"circle\",\n        paint={\n            \"circle-radius\": 15,\n            \"circle-color\": [\n                \"interpolate\",\n                [\"linear\"],\n                [\"get\", \"temperature\"],\n                20,\n                \"#0000FF\",  # Blue for cold\n                50,\n                \"#00FF00\",  # Green for mild\n                80,\n                \"#FF0000\",  # Red for hot\n            ],\n            \"circle-opacity\": 0.8,\n            \"circle-stroke-width\": 2,\n            \"circle-stroke-color\": \"#FFFFFF\",\n        },\n    )\n\n    weather_frames.append({\"title\": month_name, \"layers\": [layer_id]})\n\n# Add temporal control with fast animation\nm3.add_temporal_control(\n    frames=weather_frames,\n    position=\"bottom-right\",\n    interval=1500,  # 1.5 seconds per frame\n)\n\nm3\n</pre> # Create map for weather animation m3 = MapLibreMap(center=[-95, 38], zoom=3.5, style=\"liberty\", height=\"600px\")  # Add layers for each month with temperature-based colors weather_frames = [] for month_data in months:     month_name = month_data[\"name\"]     layer_id = f\"weather-{month_name.lower()}\"      m3.add_geojson_layer(         layer_id,         weather_data[month_name],         \"circle\",         paint={             \"circle-radius\": 15,             \"circle-color\": [                 \"interpolate\",                 [\"linear\"],                 [\"get\", \"temperature\"],                 20,                 \"#0000FF\",  # Blue for cold                 50,                 \"#00FF00\",  # Green for mild                 80,                 \"#FF0000\",  # Red for hot             ],             \"circle-opacity\": 0.8,             \"circle-stroke-width\": 2,             \"circle-stroke-color\": \"#FFFFFF\",         },     )      weather_frames.append({\"title\": month_name, \"layers\": [layer_id]})  # Add temporal control with fast animation m3.add_temporal_control(     frames=weather_frames,     position=\"bottom-right\",     interval=1500,  # 1.5 seconds per frame )  m3 In\u00a0[\u00a0]: Copied! <pre># Create a map with performance mode enabled\nm4 = MapLibreMap(center=[-120.5, 40.0], zoom=5, style=\"positron\", height=\"600px\")\n\n# Reuse the data from the first example\nm4.add_geojson_layer(\n    \"cities-2020\",\n    data_2020,\n    \"circle\",\n    paint={\"circle-radius\": 10, \"circle-color\": \"#FF6B6B\"},\n)\nm4.add_geojson_layer(\n    \"cities-2021\",\n    data_2021,\n    \"circle\",\n    paint={\"circle-radius\": 10, \"circle-color\": \"#4ECDC4\"},\n)\nm4.add_geojson_layer(\n    \"cities-2022\",\n    data_2022,\n    \"circle\",\n    paint={\"circle-radius\": 10, \"circle-color\": \"#95E1D3\"},\n)\n\nframes_perf = [\n    {\"title\": \"2020\", \"layers\": [\"cities-2020\"]},\n    {\"title\": \"2021\", \"layers\": [\"cities-2021\"]},\n    {\"title\": \"2022\", \"layers\": [\"cities-2022\"]},\n]\n\n# Add temporal control with performance mode enabled\nm4.add_temporal_control(\n    frames=frames_perf,\n    position=\"top-right\",\n    interval=2000,\n    performance=True,  # Enable performance mode\n)\n\nm4\n</pre> # Create a map with performance mode enabled m4 = MapLibreMap(center=[-120.5, 40.0], zoom=5, style=\"positron\", height=\"600px\")  # Reuse the data from the first example m4.add_geojson_layer(     \"cities-2020\",     data_2020,     \"circle\",     paint={\"circle-radius\": 10, \"circle-color\": \"#FF6B6B\"}, ) m4.add_geojson_layer(     \"cities-2021\",     data_2021,     \"circle\",     paint={\"circle-radius\": 10, \"circle-color\": \"#4ECDC4\"}, ) m4.add_geojson_layer(     \"cities-2022\",     data_2022,     \"circle\",     paint={\"circle-radius\": 10, \"circle-color\": \"#95E1D3\"}, )  frames_perf = [     {\"title\": \"2020\", \"layers\": [\"cities-2020\"]},     {\"title\": \"2021\", \"layers\": [\"cities-2021\"]},     {\"title\": \"2022\", \"layers\": [\"cities-2022\"]}, ]  # Add temporal control with performance mode enabled m4.add_temporal_control(     frames=frames_perf,     position=\"top-right\",     interval=2000,     performance=True,  # Enable performance mode )  m4 In\u00a0[\u00a0]: Copied! <pre># Export the first map with temporal control to HTML\nm.to_html(\"temporal_animation.html\")\nprint(\"Map with temporal control exported to temporal_animation.html\")\n</pre> # Export the first map with temporal control to HTML m.to_html(\"temporal_animation.html\") print(\"Map with temporal control exported to temporal_animation.html\")"},{"location":"examples/maplibre/temporal_control_example/#maplibre-temporal-control-example","title":"MapLibre Temporal Control Example\u00b6","text":"<p>This notebook demonstrates how to use the temporal control plugin with MapLibre GL JS maps in AnyMap. The temporal control enables animation of map layers across time, allowing you to visualize changes over time with playback controls.</p>"},{"location":"examples/maplibre/temporal_control_example/#basic-temporal-animation-with-point-data","title":"Basic Temporal Animation with Point Data\u00b6","text":"<p>This example shows how to animate point data across different time periods. We'll create three layers representing data from different years and use the temporal control to animate between them.</p>"},{"location":"examples/maplibre/temporal_control_example/#temporal-animation-with-multiple-layer-types","title":"Temporal Animation with Multiple Layer Types\u00b6","text":"<p>This example demonstrates animating multiple types of layers (points and polygons) together to show different aspects of temporal data.</p>"},{"location":"examples/maplibre/temporal_control_example/#monthly-weather-animation","title":"Monthly Weather Animation\u00b6","text":"<p>This example shows a more complex temporal animation with monthly data, simulating temperature changes across different locations.</p>"},{"location":"examples/maplibre/temporal_control_example/#performance-mode","title":"Performance Mode\u00b6","text":"<p>For slower systems or when animating many layers, you can enable performance mode which optimizes the rendering.</p>"},{"location":"examples/maplibre/temporal_control_example/#export-to-html","title":"Export to HTML\u00b6","text":"<p>The temporal control is preserved when exporting to HTML, allowing you to share interactive temporal animations.</p>"},{"location":"examples/maplibre/temporal_control_example/#notes","title":"Notes\u00b6","text":"<ul> <li>The temporal control automatically manages layer visibility, showing only the layers specified in the current frame</li> <li>You can have multiple layers per frame to show related data together</li> <li>The control includes play/pause buttons, frame navigation, and loop toggle</li> <li>The <code>interval</code> parameter controls how long each frame is displayed during playback</li> <li>Performance mode can help with smoother animations when dealing with complex layers</li> </ul>"},{"location":"examples/maplibre/terrain_example/","title":"Terrain example","text":"In\u00a0[\u00a0]: Copied! <pre>from anymap import MapLibreMap\n</pre> from anymap import MapLibreMap In\u00a0[\u00a0]: Copied! <pre># Create a map centered on the Swiss Alps\nm = MapLibreMap(\n    center=[8.2275, 46.8182],  # Swiss Alps\n    zoom=12,\n    pitch=60,  # Tilt the map to show 3D effect\n    bearing=20,  # Rotate the map slightly\n    height=\"600px\",\n    width=\"100%\",\n)\n\n# Add a satellite basemap for better terrain visualization\nm.add_basemap(\"Esri.WorldImagery\")\n\n# Enable terrain with default settings\nm.set_terrain(exaggeration=5)\n\nm\n</pre> # Create a map centered on the Swiss Alps m = MapLibreMap(     center=[8.2275, 46.8182],  # Swiss Alps     zoom=12,     pitch=60,  # Tilt the map to show 3D effect     bearing=20,  # Rotate the map slightly     height=\"600px\",     width=\"100%\", )  # Add a satellite basemap for better terrain visualization m.add_basemap(\"Esri.WorldImagery\")  # Enable terrain with default settings m.set_terrain(exaggeration=5)  m In\u00a0[\u00a0]: Copied! <pre># Create a map of the Grand Canyon with enhanced terrain\nm2 = MapLibreMap(\n    center=[-112.1401, 36.0544],  # Grand Canyon\n    zoom=13,\n    pitch=70,\n    bearing=0,\n    height=\"600px\",\n    width=\"100%\",\n)\n\n# Add satellite imagery\nm2.add_basemap(\"Esri.WorldImagery\")\n\n# Enable terrain with increased exaggeration\nm2.set_terrain(exaggeration=1.5)\n\nm2\n</pre> # Create a map of the Grand Canyon with enhanced terrain m2 = MapLibreMap(     center=[-112.1401, 36.0544],  # Grand Canyon     zoom=13,     pitch=70,     bearing=0,     height=\"600px\",     width=\"100%\", )  # Add satellite imagery m2.add_basemap(\"Esri.WorldImagery\")  # Enable terrain with increased exaggeration m2.set_terrain(exaggeration=1.5)  m2 In\u00a0[\u00a0]: Copied! <pre># Create a map of Mount Fuji with custom terrain source\nm3 = MapLibreMap(\n    center=[138.7274, 35.3606],  # Mount Fuji\n    zoom=11,\n    pitch=50,\n    bearing=45,\n    height=\"600px\",\n    width=\"100%\",\n)\n\n# Add OpenStreetMap basemap\nm3.add_basemap(\"OpenStreetMap.Mapnik\")\n\n# Enable terrain with custom source and source ID\nm3.set_terrain(\n    source=\"https://elevation-tiles-prod.s3.amazonaws.com/terrarium/{z}/{x}/{y}.png\",\n    exaggeration=1.2,\n    source_id=\"custom-terrain\",\n)\n\nm3\n</pre> # Create a map of Mount Fuji with custom terrain source m3 = MapLibreMap(     center=[138.7274, 35.3606],  # Mount Fuji     zoom=11,     pitch=50,     bearing=45,     height=\"600px\",     width=\"100%\", )  # Add OpenStreetMap basemap m3.add_basemap(\"OpenStreetMap.Mapnik\")  # Enable terrain with custom source and source ID m3.set_terrain(     source=\"https://elevation-tiles-prod.s3.amazonaws.com/terrarium/{z}/{x}/{y}.png\",     exaggeration=1.2,     source_id=\"custom-terrain\", )  m3 In\u00a0[\u00a0]: Copied! <pre># Create a map of the Appalachian Mountains with subtle terrain\nm4 = MapLibreMap(\n    center=[-82.5515, 35.5951],  # Great Smoky Mountains\n    zoom=11,\n    pitch=45,\n    bearing=0,\n    height=\"600px\",\n    width=\"100%\",\n)\n\n# Add OpenStreetMap basemap\nm4.add_basemap(\"OpenStreetMap.Mapnik\")\n\n# Enable terrain with minimal exaggeration\nm4.set_terrain(exaggeration=0.5)\n\nm4\n</pre> # Create a map of the Appalachian Mountains with subtle terrain m4 = MapLibreMap(     center=[-82.5515, 35.5951],  # Great Smoky Mountains     zoom=11,     pitch=45,     bearing=0,     height=\"600px\",     width=\"100%\", )  # Add OpenStreetMap basemap m4.add_basemap(\"OpenStreetMap.Mapnik\")  # Enable terrain with minimal exaggeration m4.set_terrain(exaggeration=0.5)  m4 In\u00a0[\u00a0]: Copied! <pre># Check the terrain configuration\nprint(\"Terrain configuration:\")\nprint(f\"  Source: {m4._terrain['source'] if m4._terrain else 'None'}\")\nprint(f\"  Exaggeration: {m4._terrain['exaggeration'] if m4._terrain else 'None'}\")\n\n# Check the terrain source configuration\nprint(\"\\nTerrain source configuration:\")\nterrain_source = m4._sources.get(\"terrain-dem\")\nif terrain_source:\n    print(f\"  Type: {terrain_source['type']}\")\n    print(f\"  Encoding: {terrain_source['encoding']}\")\n    print(f\"  Tile Size: {terrain_source['tileSize']}\")\n    print(f\"  Tiles: {terrain_source['tiles']}\")\nelse:\n    print(\"  No terrain source found\")\n</pre> # Check the terrain configuration print(\"Terrain configuration:\") print(f\"  Source: {m4._terrain['source'] if m4._terrain else 'None'}\") print(f\"  Exaggeration: {m4._terrain['exaggeration'] if m4._terrain else 'None'}\")  # Check the terrain source configuration print(\"\\nTerrain source configuration:\") terrain_source = m4._sources.get(\"terrain-dem\") if terrain_source:     print(f\"  Type: {terrain_source['type']}\")     print(f\"  Encoding: {terrain_source['encoding']}\")     print(f\"  Tile Size: {terrain_source['tileSize']}\")     print(f\"  Tiles: {terrain_source['tiles']}\") else:     print(\"  No terrain source found\") In\u00a0[\u00a0]: Copied! <pre># Export the Grand Canyon terrain map to HTML\nm2.to_html(\"terrain_grand_canyon.html\", title=\"Grand Canyon Terrain Visualization\")\nprint(\"Map exported to terrain_grand_canyon.html\")\n</pre> # Export the Grand Canyon terrain map to HTML m2.to_html(\"terrain_grand_canyon.html\", title=\"Grand Canyon Terrain Visualization\") print(\"Map exported to terrain_grand_canyon.html\")"},{"location":"examples/maplibre/terrain_example/#maplibre-terrain-visualization-example","title":"MapLibre Terrain Visualization Example\u00b6","text":"<p>This notebook demonstrates how to use the <code>set_terrain</code> method to add 3D terrain visualization to MapLibre GL JS maps. The terrain visualization uses elevation data from AWS terrain tiles to create a 3D effect.</p>"},{"location":"examples/maplibre/terrain_example/#basic-terrain-example","title":"Basic Terrain Example\u00b6","text":"<p>Let's create a map with terrain visualization enabled using the default terrain source (AWS elevation tiles).</p>"},{"location":"examples/maplibre/terrain_example/#terrain-with-custom-exaggeration","title":"Terrain with Custom Exaggeration\u00b6","text":"<p>You can adjust the terrain exaggeration to make the 3D effect more or less pronounced.</p>"},{"location":"examples/maplibre/terrain_example/#terrain-with-custom-source","title":"Terrain with Custom Source\u00b6","text":"<p>You can also use a custom terrain source if you have your own elevation data tiles.</p>"},{"location":"examples/maplibre/terrain_example/#terrain-with-minimal-exaggeration","title":"Terrain with Minimal Exaggeration\u00b6","text":"<p>For subtle terrain effects, you can use minimal exaggeration.</p>"},{"location":"examples/maplibre/terrain_example/#terrain-settings-information","title":"Terrain Settings Information\u00b6","text":"<p>Let's examine the terrain configuration stored in the map.</p>"},{"location":"examples/maplibre/terrain_example/#export-to-html","title":"Export to HTML\u00b6","text":"<p>You can export a terrain-enabled map to HTML for sharing.</p>"},{"location":"examples/maplibre/terrain_example/#summary","title":"Summary\u00b6","text":"<p>The <code>set_terrain</code> method provides a simple way to add 3D terrain visualization to MapLibre GL JS maps:</p> <ul> <li>Default usage: <code>m.set_terrain()</code> uses AWS elevation tiles with 1.0 exaggeration</li> <li>Custom exaggeration: <code>m.set_terrain(exaggeration=1.5)</code> for more pronounced terrain</li> <li>Custom source: <code>m.set_terrain(source=\"your-terrain-url\")</code> for custom elevation data</li> <li>Custom source ID: <code>m.set_terrain(source_id=\"custom-id\")</code> for custom source identification</li> </ul> <p>Tips for best results:</p> <ul> <li>Use <code>pitch</code> values between 30-70 degrees to show the 3D effect</li> <li>Combine with satellite imagery basemaps for realistic terrain visualization</li> <li>Adjust <code>exaggeration</code> based on the terrain type (higher for dramatic landscapes, lower for subtle hills)</li> <li>Use appropriate zoom levels (typically 10-15) for terrain visualization</li> </ul>"},{"location":"examples/maplibre/to_html/","title":"To html","text":"In\u00a0[\u00a0]: Copied! <pre>import anymap\nimport json\n</pre> import anymap import json In\u00a0[\u00a0]: Copied! <pre># Create a MapLibre map\nm = anymap.MapLibreMap(\n    center=[37.7749, -122.4194],  # San Francisco\n    zoom=12,\n    style=\"https://demotiles.maplibre.org/style.json\",\n)\n\n# Add a GeoJSON layer with some sample data\nsample_geojson = {\n    \"type\": \"FeatureCollection\",\n    \"features\": [\n        {\n            \"type\": \"Feature\",\n            \"geometry\": {\"type\": \"Point\", \"coordinates\": [-122.4194, 37.7749]},\n            \"properties\": {\n                \"name\": \"San Francisco\",\n                \"description\": \"The beautiful city by the bay\",\n            },\n        },\n        {\n            \"type\": \"Feature\",\n            \"geometry\": {\"type\": \"Point\", \"coordinates\": [-122.4594, 37.7849]},\n            \"properties\": {\n                \"name\": \"Golden Gate Park\",\n                \"description\": \"Large urban park\",\n            },\n        },\n    ],\n}\n\n# Add the GeoJSON layer\nm.add_geojson_layer(\n    layer_id=\"sample_points\",\n    geojson_data=sample_geojson,\n    layer_type=\"circle\",\n    paint={\n        \"circle-radius\": 10,\n        \"circle-color\": \"#ff6b6b\",\n        \"circle-stroke-color\": \"#ffffff\",\n        \"circle-stroke-width\": 2,\n    },\n)\n\n# Add a raster layer (OpenStreetMap tiles)\nm.add_tile_layer(\n    layer_id=\"osm_overlay\",\n    source_url=\"https://tile.openstreetmap.org/{z}/{x}/{y}.png\",\n    paint={\"raster-opacity\": 0.3},\n)\n\n# Display the map\nm\n</pre> # Create a MapLibre map m = anymap.MapLibreMap(     center=[37.7749, -122.4194],  # San Francisco     zoom=12,     style=\"https://demotiles.maplibre.org/style.json\", )  # Add a GeoJSON layer with some sample data sample_geojson = {     \"type\": \"FeatureCollection\",     \"features\": [         {             \"type\": \"Feature\",             \"geometry\": {\"type\": \"Point\", \"coordinates\": [-122.4194, 37.7749]},             \"properties\": {                 \"name\": \"San Francisco\",                 \"description\": \"The beautiful city by the bay\",             },         },         {             \"type\": \"Feature\",             \"geometry\": {\"type\": \"Point\", \"coordinates\": [-122.4594, 37.7849]},             \"properties\": {                 \"name\": \"Golden Gate Park\",                 \"description\": \"Large urban park\",             },         },     ], }  # Add the GeoJSON layer m.add_geojson_layer(     layer_id=\"sample_points\",     geojson_data=sample_geojson,     layer_type=\"circle\",     paint={         \"circle-radius\": 10,         \"circle-color\": \"#ff6b6b\",         \"circle-stroke-color\": \"#ffffff\",         \"circle-stroke-width\": 2,     }, )  # Add a raster layer (OpenStreetMap tiles) m.add_tile_layer(     layer_id=\"osm_overlay\",     source_url=\"https://tile.openstreetmap.org/{z}/{x}/{y}.png\",     paint={\"raster-opacity\": 0.3}, )  # Display the map m In\u00a0[\u00a0]: Copied! <pre># Export to HTML file\nhtml_content = m.to_html(\n    filename=\"maplibre_export.html\",\n    title=\"San Francisco Map - MapLibre Export\",\n    width=\"100%\",\n    height=\"700px\",\n)\n\nprint(\"\u2705 Map exported to 'maplibre_export.html'\")\nprint(f\"\ud83d\udcc4 HTML file size: {len(html_content)} characters\")\nprint(\"\ud83c\udf10 You can now open the HTML file in any web browser!\")\n</pre> # Export to HTML file html_content = m.to_html(     filename=\"maplibre_export.html\",     title=\"San Francisco Map - MapLibre Export\",     width=\"100%\",     height=\"700px\", )  print(\"\u2705 Map exported to 'maplibre_export.html'\") print(f\"\ud83d\udcc4 HTML file size: {len(html_content)} characters\") print(\"\ud83c\udf10 You can now open the HTML file in any web browser!\") In\u00a0[\u00a0]: Copied! <pre># Show the first 1000 characters of the HTML\nprint(\"HTML Preview (first 1000 characters):\")\nprint(\"=\" * 50)\nprint(html_content[:1000] + \"...\")\nprint(\"=\" * 50)\n\n# Check what layers are included\nprint(\"\\n\ud83d\uddfa\ufe0f  Layers included in export:\")\nif \"sample_points\" in html_content:\n    print(\"  \u2713 Sample points layer\")\nif \"osm_overlay\" in html_content:\n    print(\"  \u2713 OpenStreetMap overlay layer\")\n\nprint(\"\\n\ud83d\udccd Map configuration:\")\nprint(f\"  \u2022 Center: {m.center}\")\nprint(f\"  \u2022 Zoom: {m.zoom}\")\nprint(f\"  \u2022 Style: {m.style}\")\n</pre> # Show the first 1000 characters of the HTML print(\"HTML Preview (first 1000 characters):\") print(\"=\" * 50) print(html_content[:1000] + \"...\") print(\"=\" * 50)  # Check what layers are included print(\"\\n\ud83d\uddfa\ufe0f  Layers included in export:\") if \"sample_points\" in html_content:     print(\"  \u2713 Sample points layer\") if \"osm_overlay\" in html_content:     print(\"  \u2713 OpenStreetMap overlay layer\")  print(\"\\n\ud83d\udccd Map configuration:\") print(f\"  \u2022 Center: {m.center}\") print(f\"  \u2022 Zoom: {m.zoom}\") print(f\"  \u2022 Style: {m.style}\") In\u00a0[\u00a0]: Copied! <pre># Create a Mapbox map (you'll need to set your access token)\n# You can set the token via environment variable MAPBOX_ACCESS_TOKEN\n# or pass it directly as access_token parameter\n\nm_mapbox = anymap.MapboxMap(\n    center=[40.7128, -74.0060],  # New York\n    zoom=13,\n    style=\"mapbox://styles/mapbox/streets-v12\",\n    # access_token=\"your_mapbox_token_here\"  # Uncomment and add your token\n)\n\n# Add some NYC landmarks\nnyc_landmarks = {\n    \"type\": \"FeatureCollection\",\n    \"features\": [\n        {\n            \"type\": \"Feature\",\n            \"geometry\": {\"type\": \"Point\", \"coordinates\": [-74.0445, 40.6892]},\n            \"properties\": {\"name\": \"Statue of Liberty\"},\n        },\n        {\n            \"type\": \"Feature\",\n            \"geometry\": {\"type\": \"Point\", \"coordinates\": [-73.9857, 40.7484]},\n            \"properties\": {\"name\": \"Empire State Building\"},\n        },\n        {\n            \"type\": \"Feature\",\n            \"geometry\": {\"type\": \"Point\", \"coordinates\": [-73.9781, 40.7549]},\n            \"properties\": {\"name\": \"Times Square\"},\n        },\n    ],\n}\n\nm_mapbox.add_geojson_layer(\n    layer_id=\"nyc_landmarks\",\n    geojson_data=nyc_landmarks,\n    layer_type=\"circle\",\n    paint={\n        \"circle-radius\": 8,\n        \"circle-color\": \"#4264fb\",\n        \"circle-stroke-color\": \"#ffffff\",\n        \"circle-stroke-width\": 2,\n    },\n)\n\n# Display the map\nm_mapbox\n</pre> # Create a Mapbox map (you'll need to set your access token) # You can set the token via environment variable MAPBOX_ACCESS_TOKEN # or pass it directly as access_token parameter  m_mapbox = anymap.MapboxMap(     center=[40.7128, -74.0060],  # New York     zoom=13,     style=\"mapbox://styles/mapbox/streets-v12\",     # access_token=\"your_mapbox_token_here\"  # Uncomment and add your token )  # Add some NYC landmarks nyc_landmarks = {     \"type\": \"FeatureCollection\",     \"features\": [         {             \"type\": \"Feature\",             \"geometry\": {\"type\": \"Point\", \"coordinates\": [-74.0445, 40.6892]},             \"properties\": {\"name\": \"Statue of Liberty\"},         },         {             \"type\": \"Feature\",             \"geometry\": {\"type\": \"Point\", \"coordinates\": [-73.9857, 40.7484]},             \"properties\": {\"name\": \"Empire State Building\"},         },         {             \"type\": \"Feature\",             \"geometry\": {\"type\": \"Point\", \"coordinates\": [-73.9781, 40.7549]},             \"properties\": {\"name\": \"Times Square\"},         },     ], }  m_mapbox.add_geojson_layer(     layer_id=\"nyc_landmarks\",     geojson_data=nyc_landmarks,     layer_type=\"circle\",     paint={         \"circle-radius\": 8,         \"circle-color\": \"#4264fb\",         \"circle-stroke-color\": \"#ffffff\",         \"circle-stroke-width\": 2,     }, )  # Display the map m_mapbox In\u00a0[\u00a0]: Copied! <pre># Export Mapbox map to HTML\nmapbox_html = m_mapbox.to_html(\n    filename=\"mapbox_export.html\",\n    title=\"New York Landmarks - Mapbox Export\",\n    width=\"100%\",\n    height=\"600px\",\n)\n\nprint(\"\u2705 Mapbox map exported to 'mapbox_export.html'\")\nprint(f\"\ud83d\udcc4 HTML file size: {len(mapbox_html)} characters\")\n\n# Check if access token warning is present\nif \"access-token-warning\" in mapbox_html:\n    print(\"\u26a0\ufe0f  Warning: No Mapbox access token detected in export\")\n    print(\"   The exported map will need a valid Mapbox token to work properly\")\nelse:\n    print(\"\u2705 Access token included in export\")\n</pre> # Export Mapbox map to HTML mapbox_html = m_mapbox.to_html(     filename=\"mapbox_export.html\",     title=\"New York Landmarks - Mapbox Export\",     width=\"100%\",     height=\"600px\", )  print(\"\u2705 Mapbox map exported to 'mapbox_export.html'\") print(f\"\ud83d\udcc4 HTML file size: {len(mapbox_html)} characters\")  # Check if access token warning is present if \"access-token-warning\" in mapbox_html:     print(\"\u26a0\ufe0f  Warning: No Mapbox access token detected in export\")     print(\"   The exported map will need a valid Mapbox token to work properly\") else:     print(\"\u2705 Access token included in export\") In\u00a0[\u00a0]: Copied! <pre># Create a more complex map with multiple layer types\ncomplex_map = anymap.MapLibreMap(\n    center=[51.505, -0.09],  # London\n    zoom=10,\n    bearing=45,  # Rotate the map\n    pitch=30,  # Add some tilt\n)\n\n# Add a polygon layer (rough outline of central London)\nlondon_boundary = {\n    \"type\": \"FeatureCollection\",\n    \"features\": [\n        {\n            \"type\": \"Feature\",\n            \"geometry\": {\n                \"type\": \"Polygon\",\n                \"coordinates\": [\n                    [\n                        [-0.2, 51.45],\n                        [0.1, 51.45],\n                        [0.1, 51.55],\n                        [-0.2, 51.55],\n                        [-0.2, 51.45],\n                    ]\n                ],\n            },\n            \"properties\": {\"name\": \"Central London Area\"},\n        }\n    ],\n}\n\ncomplex_map.add_geojson_layer(\n    layer_id=\"london_area\",\n    geojson_data=london_boundary,\n    layer_type=\"fill\",\n    paint={\"fill-color\": \"#088\", \"fill-opacity\": 0.3},\n)\n\n# Export with custom styling\ncustom_html = complex_map.to_html(\n    filename=\"london_custom_export.html\",\n    title=\"London Map with Custom Styling\",\n    width=\"1200px\",\n    height=\"800px\",\n)\n\nprint(\"\u2705 Complex map exported to 'london_custom_export.html'\")\nprint(f\"\ud83d\udcd0 Map properties preserved:\")\nprint(f\"   \u2022 Bearing: {complex_map.bearing}\u00b0\")\nprint(f\"   \u2022 Pitch: {complex_map.pitch}\u00b0\")\nprint(f\"   \u2022 Layers: {list(complex_map.get_layers().keys())}\")\nprint(f\"   \u2022 Sources: {list(complex_map.get_sources().keys())}\")\n</pre> # Create a more complex map with multiple layer types complex_map = anymap.MapLibreMap(     center=[51.505, -0.09],  # London     zoom=10,     bearing=45,  # Rotate the map     pitch=30,  # Add some tilt )  # Add a polygon layer (rough outline of central London) london_boundary = {     \"type\": \"FeatureCollection\",     \"features\": [         {             \"type\": \"Feature\",             \"geometry\": {                 \"type\": \"Polygon\",                 \"coordinates\": [                     [                         [-0.2, 51.45],                         [0.1, 51.45],                         [0.1, 51.55],                         [-0.2, 51.55],                         [-0.2, 51.45],                     ]                 ],             },             \"properties\": {\"name\": \"Central London Area\"},         }     ], }  complex_map.add_geojson_layer(     layer_id=\"london_area\",     geojson_data=london_boundary,     layer_type=\"fill\",     paint={\"fill-color\": \"#088\", \"fill-opacity\": 0.3}, )  # Export with custom styling custom_html = complex_map.to_html(     filename=\"london_custom_export.html\",     title=\"London Map with Custom Styling\",     width=\"1200px\",     height=\"800px\", )  print(\"\u2705 Complex map exported to 'london_custom_export.html'\") print(f\"\ud83d\udcd0 Map properties preserved:\") print(f\"   \u2022 Bearing: {complex_map.bearing}\u00b0\") print(f\"   \u2022 Pitch: {complex_map.pitch}\u00b0\") print(f\"   \u2022 Layers: {list(complex_map.get_layers().keys())}\") print(f\"   \u2022 Sources: {list(complex_map.get_sources().keys())}\") In\u00a0[\u00a0]: Copied! <pre># Generate HTML without saving to file\nhtml_string = m.to_html(title=\"String Export Example\")\n\nprint(f\"\ud83d\udcdd Generated HTML string of {len(html_string)} characters\")\nprint(\"\\n\ud83d\udd0d HTML validation checks:\")\nprint(f\"  \u2713 Contains DOCTYPE: {'&lt;!DOCTYPE html&gt;' in html_string}\")\nprint(f\"  \u2713 Contains MapLibre: {'maplibre-gl' in html_string}\")\nprint(f\"  \u2713 Contains map container: {'id=\"map\"' in html_string}\")\nprint(f\"  \u2713 Contains map state: {'mapState' in html_string}\")\nprint(f\"  \u2713 Contains layers: {'sample_points' in html_string}\")\n\n# You could save this string manually if needed\n# with open(\"manual_export.html\", \"w\") as f:\n#     f.write(html_string)\n</pre> # Generate HTML without saving to file html_string = m.to_html(title=\"String Export Example\")  print(f\"\ud83d\udcdd Generated HTML string of {len(html_string)} characters\") print(\"\\n\ud83d\udd0d HTML validation checks:\") print(f\"  \u2713 Contains DOCTYPE: {' ' in html_string}\") print(f\"  \u2713 Contains MapLibre: {'maplibre-gl' in html_string}\") print(f\"  \u2713 Contains map container: {'id=\"map\"' in html_string}\") print(f\"  \u2713 Contains map state: {'mapState' in html_string}\") print(f\"  \u2713 Contains layers: {'sample_points' in html_string}\")  # You could save this string manually if needed # with open(\"manual_export.html\", \"w\") as f: #     f.write(html_string)"},{"location":"examples/maplibre/to_html/#html-export-example","title":"HTML Export Example\u00b6","text":"<p>This notebook demonstrates how to export anymap maps to standalone HTML files using the <code>to_html()</code> method.</p> <p>The exported HTML files are self-contained and can be opened in any web browser while maintaining all map layers and interactivity.</p>"},{"location":"examples/maplibre/to_html/#maplibre-export-example","title":"MapLibre Export Example\u00b6","text":"<p>Create a MapLibre map with various layer types and export it to HTML.</p>"},{"location":"examples/maplibre/to_html/#export-maplibre-map-to-html","title":"Export MapLibre Map to HTML\u00b6","text":"<p>Now let's export this map to a standalone HTML file:</p>"},{"location":"examples/maplibre/to_html/#preview-the-html-content","title":"Preview the HTML Content\u00b6","text":"<p>Let's take a look at the generated HTML structure:</p>"},{"location":"examples/maplibre/to_html/#mapbox-export-example","title":"Mapbox Export Example\u00b6","text":"<p>Now let's create a Mapbox map and export it to HTML. Note that you'll need a Mapbox access token for this to work properly.</p>"},{"location":"examples/maplibre/to_html/#advanced-export-options","title":"Advanced Export Options\u00b6","text":"<p>The <code>to_html()</code> method supports various customization options:</p>"},{"location":"examples/maplibre/to_html/#return-html-as-string-no-file","title":"Return HTML as String (No File)\u00b6","text":"<p>You can also get the HTML content as a string without saving to a file:</p>"},{"location":"examples/maplibre/to_html/#summary","title":"Summary\u00b6","text":"<p>The <code>to_html()</code> method provides a convenient way to export anymap maps to standalone HTML files:</p>"},{"location":"examples/maplibre/to_html/#features","title":"\u2728 Features:\u00b6","text":"<ul> <li>Self-contained: No dependencies on Jupyter or Python runtime</li> <li>Layer persistence: All layers and sources are preserved</li> <li>Interactive: Full map interactivity (pan, zoom, layer visibility)</li> <li>Customizable: Control title, dimensions, and styling</li> <li>Cross-platform: Works in any modern web browser</li> </ul>"},{"location":"examples/maplibre/to_html/#use-cases","title":"\ud83c\udfaf Use Cases:\u00b6","text":"<ul> <li>Share maps with non-technical users</li> <li>Embed maps in websites or presentations</li> <li>Create standalone map applications</li> <li>Archive map states for later viewing</li> <li>Generate reports with interactive maps</li> </ul>"},{"location":"examples/maplibre/to_html/#generated-files","title":"\ud83d\udcc2 Generated Files:\u00b6","text":"<p>After running this notebook, you should have these exported HTML files:</p> <ul> <li><code>maplibre_export.html</code> - San Francisco map with points and raster overlay</li> <li><code>mapbox_export.html</code> - New York landmarks map</li> <li><code>london_custom_export.html</code> - London map with custom styling and polygon layer</li> </ul> <p>Open any of these files in your web browser to see the interactive maps!</p>"},{"location":"examples/openlayers/openlayers_example/","title":"Openlayers example","text":"In\u00a0[\u00a0]: Copied! <pre>import anymap\nimport json\n</pre> import anymap import json In\u00a0[\u00a0]: Copied! <pre># Create a basic OpenLayers map\nol_map = anymap.OpenLayersMap(\n    center=[-0.09, 51.505],  # [longitude, latitude] - London coordinates\n    zoom=10,\n    width=\"100%\",\n    height=\"400px\",\n)\n\nol_map\n</pre> # Create a basic OpenLayers map ol_map = anymap.OpenLayersMap(     center=[-0.09, 51.505],  # [longitude, latitude] - London coordinates     zoom=10,     width=\"100%\",     height=\"400px\", )  ol_map In\u00a0[\u00a0]: Copied! <pre># OpenStreetMap (default)\nosm_map = anymap.OpenLayersMap(\n    center=[-74.0060, 40.7128],  # [longitude, latitude] - New York\n    zoom=10,\n    tile_layer=\"OSM\",\n)\n\nosm_map\n</pre> # OpenStreetMap (default) osm_map = anymap.OpenLayersMap(     center=[-74.0060, 40.7128],  # [longitude, latitude] - New York     zoom=10,     tile_layer=\"OSM\", )  osm_map In\u00a0[\u00a0]: Copied! <pre># CartoDB Positron (light theme)\npositron_map = anymap.OpenLayersMap(\n    center=[-74.0060, 40.7128], zoom=10, tile_layer=\"CartoDB.Positron\"\n)\n\npositron_map\n</pre> # CartoDB Positron (light theme) positron_map = anymap.OpenLayersMap(     center=[-74.0060, 40.7128], zoom=10, tile_layer=\"CartoDB.Positron\" )  positron_map In\u00a0[\u00a0]: Copied! <pre># CartoDB Dark Matter (dark theme)\ndark_map = anymap.OpenLayersMap(\n    center=[-74.0060, 40.7128], zoom=10, tile_layer=\"CartoDB.DarkMatter\"\n)\n\ndark_map\n</pre> # CartoDB Dark Matter (dark theme) dark_map = anymap.OpenLayersMap(     center=[-74.0060, 40.7128], zoom=10, tile_layer=\"CartoDB.DarkMatter\" )  dark_map In\u00a0[\u00a0]: Copied! <pre># Create a map with markers\nmarker_map = anymap.OpenLayersMap(\n    center=[-0.1278, 51.5074], zoom=12  # [longitude, latitude] - London\n)\n\n# Add markers for famous London landmarks\nmarker_map.add_marker(\n    [-0.1278, 51.5074],\n    popup=\"&lt;b&gt;London&lt;/b&gt;&lt;br&gt;Capital of the United Kingdom\",\n    tooltip=\"London City Center\",\n)\n\nmarker_map.add_marker(\n    [-0.1246, 51.5007], popup=\"&lt;b&gt;Big Ben&lt;/b&gt;&lt;br&gt;Famous clock tower\", tooltip=\"Big Ben\"\n)\n\nmarker_map.add_marker(\n    [-0.1195, 51.5033],\n    popup=\"&lt;b&gt;London Eye&lt;/b&gt;&lt;br&gt;Giant Ferris wheel\",\n    tooltip=\"London Eye\",\n)\n\nmarker_map\n</pre> # Create a map with markers marker_map = anymap.OpenLayersMap(     center=[-0.1278, 51.5074], zoom=12  # [longitude, latitude] - London )  # Add markers for famous London landmarks marker_map.add_marker(     [-0.1278, 51.5074],     popup=\"LondonCapital of the United Kingdom\",     tooltip=\"London City Center\", )  marker_map.add_marker(     [-0.1246, 51.5007], popup=\"Big BenFamous clock tower\", tooltip=\"Big Ben\" )  marker_map.add_marker(     [-0.1195, 51.5033],     popup=\"London EyeGiant Ferris wheel\",     tooltip=\"London Eye\", )  marker_map In\u00a0[\u00a0]: Copied! <pre># Create a map with shapes\nshapes_map = anymap.OpenLayersMap(\n    center=[-74.0060, 40.7128], zoom=11  # [longitude, latitude] - New York\n)\n\n# Add a circle around Central Park\nshapes_map.add_circle(\n    [-73.9654, 40.7829],  # [longitude, latitude] - Central Park\n    radius=1000,  # 1km radius\n    color=\"green\",\n    fillColor=\"lightgreen\",\n    fillOpacity=0.3,\n)\n\n# Add a polygon for Manhattan (simplified)\nmanhattan_coords = [\n    [\n        [-73.9712, 40.7831],\n        [-73.9441, 40.7489],\n        [-73.9969, 40.7061],\n        [-74.0113, 40.7194],\n        [-73.9712, 40.7831],\n    ]\n]\n\nshapes_map.add_polygon(\n    manhattan_coords, color=\"blue\", fillColor=\"lightblue\", fillOpacity=0.2\n)\n\n# Add a line string for Broadway\nbroadway_coords = [\n    [-73.9776, 40.7614],\n    [-73.9851, 40.7589],\n    [-73.9926, 40.7565],\n    [-74.0014, 40.7505],\n]\n\nshapes_map.add_linestring(broadway_coords, color=\"red\", strokeWidth=5)\n\nshapes_map\n</pre> # Create a map with shapes shapes_map = anymap.OpenLayersMap(     center=[-74.0060, 40.7128], zoom=11  # [longitude, latitude] - New York )  # Add a circle around Central Park shapes_map.add_circle(     [-73.9654, 40.7829],  # [longitude, latitude] - Central Park     radius=1000,  # 1km radius     color=\"green\",     fillColor=\"lightgreen\",     fillOpacity=0.3, )  # Add a polygon for Manhattan (simplified) manhattan_coords = [     [         [-73.9712, 40.7831],         [-73.9441, 40.7489],         [-73.9969, 40.7061],         [-74.0113, 40.7194],         [-73.9712, 40.7831],     ] ]  shapes_map.add_polygon(     manhattan_coords, color=\"blue\", fillColor=\"lightblue\", fillOpacity=0.2 )  # Add a line string for Broadway broadway_coords = [     [-73.9776, 40.7614],     [-73.9851, 40.7589],     [-73.9926, 40.7565],     [-74.0014, 40.7505], ]  shapes_map.add_linestring(broadway_coords, color=\"red\", strokeWidth=5)  shapes_map In\u00a0[\u00a0]: Copied! <pre># Sample GeoJSON data\ngeojson_data = {\n    \"type\": \"FeatureCollection\",\n    \"features\": [\n        {\n            \"type\": \"Feature\",\n            \"geometry\": {\"type\": \"Point\", \"coordinates\": [-74.0060, 40.7128]},\n            \"properties\": {\"name\": \"New York City\", \"population\": 8175133},\n        },\n        {\n            \"type\": \"Feature\",\n            \"geometry\": {\"type\": \"Point\", \"coordinates\": [-87.6298, 41.8781]},\n            \"properties\": {\"name\": \"Chicago\", \"population\": 2693976},\n        },\n    ],\n}\n\n# Create map with GeoJSON data\ngeojson_map = anymap.OpenLayersMap(center=[-80.0, 40.0], zoom=5)\n\ngeojson_map.add_geojson(\n    geojson_data,\n    style={\"fill\": {\"color\": \"purple\"}, \"stroke\": {\"color\": \"purple\", \"width\": 2}},\n)\n\ngeojson_map\n</pre> # Sample GeoJSON data geojson_data = {     \"type\": \"FeatureCollection\",     \"features\": [         {             \"type\": \"Feature\",             \"geometry\": {\"type\": \"Point\", \"coordinates\": [-74.0060, 40.7128]},             \"properties\": {\"name\": \"New York City\", \"population\": 8175133},         },         {             \"type\": \"Feature\",             \"geometry\": {\"type\": \"Point\", \"coordinates\": [-87.6298, 41.8781]},             \"properties\": {\"name\": \"Chicago\", \"population\": 2693976},         },     ], }  # Create map with GeoJSON data geojson_map = anymap.OpenLayersMap(center=[-80.0, 40.0], zoom=5)  geojson_map.add_geojson(     geojson_data,     style={\"fill\": {\"color\": \"purple\"}, \"stroke\": {\"color\": \"purple\", \"width\": 2}}, )  geojson_map In\u00a0[\u00a0]: Copied! <pre># Create a map for demonstrations\ncontrol_map = anymap.OpenLayersMap(\n    center=[-122.4194, 37.7749], zoom=10  # [longitude, latitude] - San Francisco\n)\n\ncontrol_map\n</pre> # Create a map for demonstrations control_map = anymap.OpenLayersMap(     center=[-122.4194, 37.7749], zoom=10  # [longitude, latitude] - San Francisco )  control_map In\u00a0[\u00a0]: Copied! <pre># Fly to a different location\ncontrol_map.fly_to(-118.2437, 34.0522, 12)  # Los Angeles\n</pre> # Fly to a different location control_map.fly_to(-118.2437, 34.0522, 12)  # Los Angeles In\u00a0[\u00a0]: Copied! <pre># Set center and zoom\ncontrol_map.set_center(-80.1918, 25.7617)  # Miami\ncontrol_map.set_zoom(11)\n</pre> # Set center and zoom control_map.set_center(-80.1918, 25.7617)  # Miami control_map.set_zoom(11) In\u00a0[\u00a0]: Copied! <pre># Fit extent to a specific area\n# [minX, minY, maxX, maxY] in map projection coordinates\ncontrol_map.fit_extent([-80.3, 25.7, -80.1, 25.9])\n</pre> # Fit extent to a specific area # [minX, minY, maxX, maxY] in map projection coordinates control_map.fit_extent([-80.3, 25.7, -80.1, 25.9]) In\u00a0[\u00a0]: Copied! <pre># Create a map with vector layers\nvector_map = anymap.OpenLayersMap(\n    center=[2.3522, 48.8566], zoom=12  # [longitude, latitude] - Paris\n)\n\n# Define features\nfeatures = [\n    {\n        \"geometry\": {\"type\": \"Point\", \"coordinates\": [2.3522, 48.8566]},\n        \"properties\": {\"name\": \"Paris\", \"type\": \"city\"},\n    },\n    {\n        \"geometry\": {\"type\": \"Point\", \"coordinates\": [2.2945, 48.8584]},\n        \"properties\": {\"name\": \"Eiffel Tower\", \"type\": \"landmark\"},\n    },\n]\n\nvector_map.add_vector_layer(\n    features,\n    style={\n        \"image\": {\n            \"circle\": {\n                \"radius\": 8,\n                \"fill\": {\"color\": \"red\"},\n                \"stroke\": {\"color\": \"white\", \"width\": 2},\n            }\n        }\n    },\n)\n\nvector_map\n</pre> # Create a map with vector layers vector_map = anymap.OpenLayersMap(     center=[2.3522, 48.8566], zoom=12  # [longitude, latitude] - Paris )  # Define features features = [     {         \"geometry\": {\"type\": \"Point\", \"coordinates\": [2.3522, 48.8566]},         \"properties\": {\"name\": \"Paris\", \"type\": \"city\"},     },     {         \"geometry\": {\"type\": \"Point\", \"coordinates\": [2.2945, 48.8584]},         \"properties\": {\"name\": \"Eiffel Tower\", \"type\": \"landmark\"},     }, ]  vector_map.add_vector_layer(     features,     style={         \"image\": {             \"circle\": {                 \"radius\": 8,                 \"fill\": {\"color\": \"red\"},                 \"stroke\": {\"color\": \"white\", \"width\": 2},             }         }     }, )  vector_map In\u00a0[\u00a0]: Copied! <pre># Create a map with multiple tile layers\nmulti_layer_map = anymap.OpenLayersMap(\n    center=[2.3522, 48.8566], zoom=12  # [longitude, latitude] - Paris\n)\n\n# Add a custom tile layer\nmulti_layer_map.add_tile_layer(\n    \"https://stamen-tiles-{a-c}.a.ssl.fastly.net/watercolor/{z}/{x}/{y}.jpg\",\n    attribution=\"Map tiles by Stamen Design, under CC BY 3.0. Data by OpenStreetMap, under ODbL.\",\n    layer_id=\"watercolor\",\n)\n\nmulti_layer_map\n</pre> # Create a map with multiple tile layers multi_layer_map = anymap.OpenLayersMap(     center=[2.3522, 48.8566], zoom=12  # [longitude, latitude] - Paris )  # Add a custom tile layer multi_layer_map.add_tile_layer(     \"https://stamen-tiles-{a-c}.a.ssl.fastly.net/watercolor/{z}/{x}/{y}.jpg\",     attribution=\"Map tiles by Stamen Design, under CC BY 3.0. Data by OpenStreetMap, under ODbL.\",     layer_id=\"watercolor\", )  multi_layer_map In\u00a0[\u00a0]: Copied! <pre># Create a map with a different projection\nprojection_map = anymap.OpenLayersMap(\n    center=[0, 0],  # [longitude, latitude]\n    zoom=2,\n    projection=\"EPSG:4326\",  # WGS84 geographic projection\n)\n\nprojection_map\n</pre> # Create a map with a different projection projection_map = anymap.OpenLayersMap(     center=[0, 0],  # [longitude, latitude]     zoom=2,     projection=\"EPSG:4326\",  # WGS84 geographic projection )  projection_map In\u00a0[\u00a0]: Copied! <pre># Create a map for export\nexport_map = anymap.OpenLayersMap(\n    center=[139.6503, 35.6762],  # [longitude, latitude] - Tokyo\n    zoom=10,\n    tile_layer=\"OSM\",\n)\n\n# Add some features\nexport_map.add_marker(\n    [139.6503, 35.6762], popup=\"&lt;b&gt;Tokyo&lt;/b&gt;&lt;br&gt;Capital of Japan\", tooltip=\"Tokyo\"\n)\n\nexport_map.add_circle(\n    [139.6503, 35.6762], radius=5000, color=\"red\", fillColor=\"pink\", fillOpacity=0.3\n)\n\n# Export to HTML\nhtml_content = export_map.to_html(\n    title=\"Tokyo Map - OpenLayers Example\", width=\"100%\", height=\"600px\"\n)\n\n# Save to file\nwith open(\"tokyo_openlayers_map.html\", \"w\") as f:\n    f.write(html_content)\n\nprint(\"Map exported to tokyo_openlayers_map.html\")\nexport_map\n</pre> # Create a map for export export_map = anymap.OpenLayersMap(     center=[139.6503, 35.6762],  # [longitude, latitude] - Tokyo     zoom=10,     tile_layer=\"OSM\", )  # Add some features export_map.add_marker(     [139.6503, 35.6762], popup=\"TokyoCapital of Japan\", tooltip=\"Tokyo\" )  export_map.add_circle(     [139.6503, 35.6762], radius=5000, color=\"red\", fillColor=\"pink\", fillOpacity=0.3 )  # Export to HTML html_content = export_map.to_html(     title=\"Tokyo Map - OpenLayers Example\", width=\"100%\", height=\"600px\" )  # Save to file with open(\"tokyo_openlayers_map.html\", \"w\") as f:     f.write(html_content)  print(\"Map exported to tokyo_openlayers_map.html\") export_map In\u00a0[\u00a0]: Copied! <pre># Create a map for layer management\nlayer_map = anymap.OpenLayersMap(\n    center=[13.4050, 52.5200], zoom=11  # [longitude, latitude] - Berlin\n)\n\n# Add several layers\nmarker_id = layer_map.add_marker(\n    [13.4050, 52.5200], popup=\"Berlin\", tooltip=\"German Capital\"\n)\n\ncircle_id = layer_map.add_circle(\n    [13.4050, 52.5200],\n    radius=3000,\n    color=\"blue\",\n    fillColor=\"lightblue\",\n    fillOpacity=0.2,\n)\n\nprint(f\"Added marker with ID: {marker_id}\")\nprint(f\"Added circle with ID: {circle_id}\")\n\nlayer_map\n</pre> # Create a map for layer management layer_map = anymap.OpenLayersMap(     center=[13.4050, 52.5200], zoom=11  # [longitude, latitude] - Berlin )  # Add several layers marker_id = layer_map.add_marker(     [13.4050, 52.5200], popup=\"Berlin\", tooltip=\"German Capital\" )  circle_id = layer_map.add_circle(     [13.4050, 52.5200],     radius=3000,     color=\"blue\",     fillColor=\"lightblue\",     fillOpacity=0.2, )  print(f\"Added marker with ID: {marker_id}\") print(f\"Added circle with ID: {circle_id}\")  layer_map In\u00a0[\u00a0]: Copied! <pre># Get current layers\nlayers = layer_map.get_layers()\nprint(\"Current layers:\")\nfor layer_id, layer_config in layers.items():\n    print(f\"  {layer_id}: {layer_config['type']}\")\n</pre> # Get current layers layers = layer_map.get_layers() print(\"Current layers:\") for layer_id, layer_config in layers.items():     print(f\"  {layer_id}: {layer_config['type']}\") In\u00a0[\u00a0]: Copied! <pre># Remove a layer\nlayer_map.remove_layer(circle_id)\nprint(f\"Removed circle layer: {circle_id}\")\n</pre> # Remove a layer layer_map.remove_layer(circle_id) print(f\"Removed circle layer: {circle_id}\") In\u00a0[\u00a0]: Copied! <pre># Clear all layers\nlayer_map.clear_layers()\nprint(\"All layers cleared\")\n</pre> # Clear all layers layer_map.clear_layers() print(\"All layers cleared\")"},{"location":"examples/openlayers/openlayers_example/#openlayers-map-examples","title":"OpenLayers Map Examples\u00b6","text":"<p>This notebook demonstrates how to use the OpenLayersMap widget from the anymap package.</p>"},{"location":"examples/openlayers/openlayers_example/#installation","title":"Installation\u00b6","text":"<p>First, make sure you have the anymap package installed:</p> <pre>pip install anymap\n</pre>"},{"location":"examples/openlayers/openlayers_example/#basic-openlayers-map","title":"Basic OpenLayers Map\u00b6","text":"<p>Create a basic OpenLayers map with default settings. Note that OpenLayers uses [longitude, latitude] coordinate order.</p>"},{"location":"examples/openlayers/openlayers_example/#different-tile-layers","title":"Different Tile Layers\u00b6","text":"<p>OpenLayers supports various tile layer providers:</p>"},{"location":"examples/openlayers/openlayers_example/#adding-markers","title":"Adding Markers\u00b6","text":"<p>Add markers to your map with popups and tooltips:</p>"},{"location":"examples/openlayers/openlayers_example/#adding-shapes","title":"Adding Shapes\u00b6","text":"<p>Add various shapes like circles, polygons, and line strings:</p>"},{"location":"examples/openlayers/openlayers_example/#geojson-data","title":"GeoJSON Data\u00b6","text":"<p>Load and display GeoJSON data:</p>"},{"location":"examples/openlayers/openlayers_example/#map-controls-and-interactions","title":"Map Controls and Interactions\u00b6","text":"<p>Demonstrate various map control methods:</p>"},{"location":"examples/openlayers/openlayers_example/#vector-layers","title":"Vector Layers\u00b6","text":"<p>Create vector layers with custom features:</p>"},{"location":"examples/openlayers/openlayers_example/#adding-multiple-tile-layers","title":"Adding Multiple Tile Layers\u00b6","text":"<p>You can add multiple tile layers to the same map:</p>"},{"location":"examples/openlayers/openlayers_example/#projections","title":"Projections\u00b6","text":"<p>OpenLayers supports different projections:</p>"},{"location":"examples/openlayers/openlayers_example/#exporting-to-html","title":"Exporting to HTML\u00b6","text":"<p>Export your map to a standalone HTML file:</p>"},{"location":"examples/openlayers/openlayers_example/#layer-management","title":"Layer Management\u00b6","text":"<p>Demonstrate layer management capabilities:</p>"},{"location":"examples/openlayers/openlayers_example/#openlayers-vs-other-libraries","title":"OpenLayers vs Other Libraries\u00b6","text":"<p>Key differences when using OpenLayers:</p> <ol> <li>Coordinate Order: OpenLayers uses [longitude, latitude] (x, y) order, unlike Leaflet which uses [latitude, longitude]</li> <li>Projections: Built-in support for multiple coordinate systems and projections</li> <li>Vector Layers: Powerful vector layer capabilities with custom styling</li> <li>Performance: Optimized for large datasets and complex geometries</li> <li>Flexibility: Highly modular and customizable architecture</li> </ol>"},{"location":"examples/openlayers/openlayers_example/#conclusion","title":"Conclusion\u00b6","text":"<p>This notebook demonstrated the key features of the OpenLayersMap widget:</p> <ol> <li>Basic map creation with different tile layers</li> <li>Adding markers with popups and tooltips</li> <li>Drawing shapes (circles, polygons, line strings)</li> <li>Loading GeoJSON data</li> <li>Vector layers with custom features</li> <li>Map controls (fly to, set center/zoom, fit extent)</li> <li>Layer management (add, remove, clear)</li> <li>Projection support for different coordinate systems</li> <li>HTML export for sharing standalone maps</li> </ol> <p>The OpenLayersMap widget provides a powerful, flexible mapping solution that integrates seamlessly with Jupyter notebooks and supports OpenLayers' advanced geospatial capabilities.</p>"},{"location":"examples/potree/potree_example/","title":"Potree example","text":"In\u00a0[\u00a0]: Copied! <pre>import os\nfrom anymap import PotreeMap\n\nprint(\"Potree backend loaded successfully!\")\n</pre> import os from anymap import PotreeMap  print(\"Potree backend loaded successfully!\") In\u00a0[\u00a0]: Copied! <pre>url = \"/files/potreelibs/pointclouds/lion_takanawa_las/cloud.js\"\nviewer = PotreeMap(description=\"Lion\", point_cloud_url=url, height=\"400px\")\n\nviewer\n</pre> url = \"/files/potreelibs/pointclouds/lion_takanawa_las/cloud.js\" viewer = PotreeMap(description=\"Lion\", point_cloud_url=url, height=\"400px\")  viewer In\u00a0[\u00a0]: Copied! <pre># Update the description (title)\nviewer.set_description(\"Lion Takanawa\")\n</pre> # Update the description (title) viewer.set_description(\"Lion Takanawa\") In\u00a0[\u00a0]: Copied! <pre>viewer.description = \"Lion\"\n</pre> viewer.description = \"Lion\" In\u00a0[\u00a0]: Copied! <pre># Create a basic Potree viewer\nviewer = PotreeMap(\n    width=\"100%\",\n    height=\"600px\",\n    background_color=\"#1a1a1a\",  # Dark background\n    point_size=1.5,\n    point_size_type=\"adaptive\",  # Adaptive point sizing\n    point_shape=\"square\",\n    camera_position=[0, 0, 50],\n    camera_target=[0, 0, 0],\n    fov=60,\n    edl_enabled=True,  # Eye Dome Lighting for better depth perception\n    show_grid=True,\n    grid_size=10,\n    grid_color=\"#444444\",\n)\n\nviewer\n</pre> # Create a basic Potree viewer viewer = PotreeMap(     width=\"100%\",     height=\"600px\",     background_color=\"#1a1a1a\",  # Dark background     point_size=1.5,     point_size_type=\"adaptive\",  # Adaptive point sizing     point_shape=\"square\",     camera_position=[0, 0, 50],     camera_target=[0, 0, 0],     fov=60,     edl_enabled=True,  # Eye Dome Lighting for better depth perception     show_grid=True,     grid_size=10,     grid_color=\"#444444\", )  viewer In\u00a0[\u00a0]: Copied! <pre># Example of loading a point cloud (requires actual converted data)\n# Replace with the URL to your Potree-converted point cloud metadata.json\n# viewer.load_point_cloud(\n#     \"https://example.com/pointclouds/your_pointcloud/metadata.json\",\n#     \"My Point Cloud\"\n# )\n\nprint(\"To load actual point cloud data, you need a Potree-converted dataset.\")\nprint(\"Point the load_point_cloud method to your metadata.json file.\")\n</pre> # Example of loading a point cloud (requires actual converted data) # Replace with the URL to your Potree-converted point cloud metadata.json # viewer.load_point_cloud( #     \"https://example.com/pointclouds/your_pointcloud/metadata.json\", #     \"My Point Cloud\" # )  print(\"To load actual point cloud data, you need a Potree-converted dataset.\") print(\"Point the load_point_cloud method to your metadata.json file.\") In\u00a0[\u00a0]: Copied! <pre># Adjust point size\nviewer.set_point_size(2.0)\nprint(\"Point size set to 2.0\")\n\n# Change point size type\nviewer.set_point_size_type(\"fixed\")  # Options: \"fixed\", \"adaptive\", \"attenuation\"\nprint(\"Point size type set to fixed\")\n\n# Change point shape\nviewer.set_point_shape(\"circle\")  # Options: \"square\", \"circle\"\nprint(\"Point shape set to circle\")\n</pre> # Adjust point size viewer.set_point_size(2.0) print(\"Point size set to 2.0\")  # Change point size type viewer.set_point_size_type(\"fixed\")  # Options: \"fixed\", \"adaptive\", \"attenuation\" print(\"Point size type set to fixed\")  # Change point shape viewer.set_point_shape(\"circle\")  # Options: \"square\", \"circle\" print(\"Point shape set to circle\") In\u00a0[\u00a0]: Copied! <pre># Set camera position and target\nviewer.set_camera_position(position=[20, 20, 30], target=[0, 0, 0])\nprint(\"Camera position updated\")\n\n# Adjust field of view\nviewer.set_fov(75)\nprint(\"Field of view set to 75 degrees\")\n\n# Set clipping distances\nviewer.set_clip_distances(near=0.1, far=1000)\nprint(\"Clipping distances updated\")\n</pre> # Set camera position and target viewer.set_camera_position(position=[20, 20, 30], target=[0, 0, 0]) print(\"Camera position updated\")  # Adjust field of view viewer.set_fov(75) print(\"Field of view set to 75 degrees\")  # Set clipping distances viewer.set_clip_distances(near=0.1, far=1000) print(\"Clipping distances updated\") In\u00a0[\u00a0]: Copied! <pre># Configure Eye Dome Lighting (EDL) for better depth perception\nviewer.enable_edl(True)\nviewer.set_edl_settings(radius=1.5, strength=1.2)\nprint(\"Eye Dome Lighting configured\")\n\n# Show coordinate grid\nviewer.show_coordinate_grid(show=True, size=20, color=\"#666666\")\nprint(\"Coordinate grid enabled\")\n\n# Change background color\nviewer.set_background_color(\"#2a2a2a\")\nprint(\"Background color changed\")\n</pre> # Configure Eye Dome Lighting (EDL) for better depth perception viewer.enable_edl(True) viewer.set_edl_settings(radius=1.5, strength=1.2) print(\"Eye Dome Lighting configured\")  # Show coordinate grid viewer.show_coordinate_grid(show=True, size=20, color=\"#666666\") print(\"Coordinate grid enabled\")  # Change background color viewer.set_background_color(\"#2a2a2a\") print(\"Background color changed\") In\u00a0[\u00a0]: Copied! <pre># Set rendering quality\nviewer.set_quality(\"high\")  # Options: \"low\", \"medium\", \"high\"\nprint(\"Rendering quality set to high\")\n\n# For large datasets, you might want to use \"medium\" or \"low\" for better performance\n</pre> # Set rendering quality viewer.set_quality(\"high\")  # Options: \"low\", \"medium\", \"high\" print(\"Rendering quality set to high\")  # For large datasets, you might want to use \"medium\" or \"low\" for better performance In\u00a0[\u00a0]: Copied! <pre># Example of loading multiple point clouds\npoint_clouds = [\n    {\n        \"url\": \"https://example.com/pointclouds/scan1/metadata.json\",\n        \"name\": \"Building Scan\",\n    },\n    {\n        \"url\": \"https://example.com/pointclouds/scan2/metadata.json\",\n        \"name\": \"Terrain Scan\",\n    },\n]\n\n# viewer.load_multiple_point_clouds(point_clouds)\nprint(\"Multiple point clouds can be loaded simultaneously\")\n</pre> # Example of loading multiple point clouds point_clouds = [     {         \"url\": \"https://example.com/pointclouds/scan1/metadata.json\",         \"name\": \"Building Scan\",     },     {         \"url\": \"https://example.com/pointclouds/scan2/metadata.json\",         \"name\": \"Terrain Scan\",     }, ]  # viewer.load_multiple_point_clouds(point_clouds) print(\"Multiple point clouds can be loaded simultaneously\") In\u00a0[\u00a0]: Copied! <pre># Filter points by elevation\nviewer.filter_by_elevation(min_elevation=0, max_elevation=50)\nprint(\"Elevation filter applied (0-50 units)\")\n\n# Filter by classification (LAS classification codes)\n# Common classifications: 1=Unclassified, 2=Ground, 3=Low Vegetation, 4=Medium Vegetation, 5=High Vegetation, 6=Building\nclassifications = {\n    1: True,  # Show unclassified\n    2: True,  # Show ground\n    3: False,  # Hide low vegetation\n    4: False,  # Hide medium vegetation\n    5: False,  # Hide high vegetation\n    6: True,  # Show buildings\n}\nviewer.set_classification_visibility(classifications)\nprint(\"Classification filter applied\")\n\n# Clear all filters\n# viewer.clear_filters()\n# print(\"All filters cleared\")\n</pre> # Filter points by elevation viewer.filter_by_elevation(min_elevation=0, max_elevation=50) print(\"Elevation filter applied (0-50 units)\")  # Filter by classification (LAS classification codes) # Common classifications: 1=Unclassified, 2=Ground, 3=Low Vegetation, 4=Medium Vegetation, 5=High Vegetation, 6=Building classifications = {     1: True,  # Show unclassified     2: True,  # Show ground     3: False,  # Hide low vegetation     4: False,  # Hide medium vegetation     5: False,  # Hide high vegetation     6: True,  # Show buildings } viewer.set_classification_visibility(classifications) print(\"Classification filter applied\")  # Clear all filters # viewer.clear_filters() # print(\"All filters cleared\") In\u00a0[\u00a0]: Copied! <pre># Add distance measurement tool\nviewer.add_measurement(\"distance\")\nprint(\"Distance measurement tool added\")\n\n# Add area measurement tool\nviewer.add_measurement(\"area\")\nprint(\"Area measurement tool added\")\n\n# Add volume measurement tool\nviewer.add_measurement(\"volume\")\nprint(\"Volume measurement tool added\")\n\n# Clear all measurements\n# viewer.clear_measurements()\n# print(\"All measurements cleared\")\n</pre> # Add distance measurement tool viewer.add_measurement(\"distance\") print(\"Distance measurement tool added\")  # Add area measurement tool viewer.add_measurement(\"area\") print(\"Area measurement tool added\")  # Add volume measurement tool viewer.add_measurement(\"volume\") print(\"Volume measurement tool added\")  # Clear all measurements # viewer.clear_measurements() # print(\"All measurements cleared\") In\u00a0[\u00a0]: Copied! <pre># Fit point clouds to screen\nviewer.fit_to_screen()\nprint(\"View fitted to point cloud bounds\")\n\n# Take a screenshot\nviewer.take_screenshot()\nprint(\"Screenshot captured\")\n\n# Get current camera position\ncamera_pos = viewer.get_camera_position()\ncamera_target = viewer.get_camera_target()\nprint(f\"Camera position: {camera_pos}\")\nprint(f\"Camera target: {camera_target}\")\n</pre> # Fit point clouds to screen viewer.fit_to_screen() print(\"View fitted to point cloud bounds\")  # Take a screenshot viewer.take_screenshot() print(\"Screenshot captured\")  # Get current camera position camera_pos = viewer.get_camera_position() camera_target = viewer.get_camera_target() print(f\"Camera position: {camera_pos}\") print(f\"Camera target: {camera_target}\") In\u00a0[\u00a0]: Copied! <pre># Display the same viewer instance again\n# This should maintain all the settings and state from above\nviewer\n</pre> # Display the same viewer instance again # This should maintain all the settings and state from above viewer In\u00a0[\u00a0]: Copied! <pre># Change settings while displayed in multiple cells\nviewer.set_background_color(\"#0a0a0a\")\nviewer.set_point_size(3.0)\nviewer.set_point_shape(\"square\")\n\nprint(\"Settings changed! Updates should appear on all viewer instances above.\")\n</pre> # Change settings while displayed in multiple cells viewer.set_background_color(\"#0a0a0a\") viewer.set_point_size(3.0) viewer.set_point_shape(\"square\")  print(\"Settings changed! Updates should appear on all viewer instances above.\") In\u00a0[\u00a0]: Copied! <pre># Create a second, independent viewer with different settings\nviewer2 = PotreeMap(\n    width=\"100%\",\n    height=\"500px\",\n    background_color=\"#003366\",  # Blue background\n    point_size=1.0,\n    point_size_type=\"attenuation\",\n    point_shape=\"circle\",\n    camera_position=[10, 10, 20],\n    edl_enabled=False,\n    show_grid=False,\n)\n\n# Load different point cloud data (if available)\n# viewer2.load_point_cloud(\n#     \"https://example.com/pointclouds/another_scan/metadata.json\",\n#     \"Another Point Cloud\"\n# )\n\nviewer2\n</pre> # Create a second, independent viewer with different settings viewer2 = PotreeMap(     width=\"100%\",     height=\"500px\",     background_color=\"#003366\",  # Blue background     point_size=1.0,     point_size_type=\"attenuation\",     point_shape=\"circle\",     camera_position=[10, 10, 20],     edl_enabled=False,     show_grid=False, )  # Load different point cloud data (if available) # viewer2.load_point_cloud( #     \"https://example.com/pointclouds/another_scan/metadata.json\", #     \"Another Point Cloud\" # )  viewer2 In\u00a0[\u00a0]: Copied! <pre># Clear all point clouds from the first viewer\nviewer.clear_point_clouds()\nprint(\"Point clouds cleared from first viewer\")\n\n# Clear measurements\nviewer.clear_measurements()\nprint(\"Measurements cleared\")\n\n# Clear filters\nviewer.clear_filters()\nprint(\"Filters cleared\")\n</pre> # Clear all point clouds from the first viewer viewer.clear_point_clouds() print(\"Point clouds cleared from first viewer\")  # Clear measurements viewer.clear_measurements() print(\"Measurements cleared\")  # Clear filters viewer.clear_filters() print(\"Filters cleared\")"},{"location":"examples/potree/potree_example/#potree-point-cloud-viewer-example","title":"Potree Point Cloud Viewer Example\u00b6","text":"<p>This notebook demonstrates the capabilities of the anymap PotreeMap widget for creating interactive point cloud visualizations.</p>"},{"location":"examples/potree/potree_example/#what-is-potree","title":"What is Potree?\u00b6","text":"<p>Potree is a free open-source WebGL based point cloud renderer for large point clouds. It's particularly useful for:</p> <ul> <li>LiDAR data visualization</li> <li>3D scanning results</li> <li>Large-scale point cloud datasets</li> <li>Archaeological documentation</li> <li>Building and infrastructure modeling</li> </ul>"},{"location":"examples/potree/potree_example/#setup","title":"Setup\u00b6","text":"<p>First, import the PotreeMap widget from anymap:</p>"},{"location":"examples/potree/potree_example/#working-example","title":"Working example\u00b6","text":"<p>Create a basic Potree viewer.</p> <p>Loads an example that ships with the potree distribution, or use your own point cloud.</p> <p>\u26a0\ufe0f Currently only one Potree viewer can be rendered at a time.</p> <p>Rendering other Potree viewers, or more views of the same viewer will cause conflicts with the controls.</p>"},{"location":"examples/potree/potree_example/#basic-point-cloud-viewer","title":"Basic Point Cloud Viewer\u00b6","text":"<p>Create a basic Potree viewer. Note that you'll need a converted Potree point cloud dataset (with metadata.json) to load actual data:</p>"},{"location":"examples/potree/potree_example/#loading-point-cloud-data","title":"Loading Point Cloud Data\u00b6","text":"<p>To load actual point cloud data, you need a Potree-converted dataset. You can convert LAS/LAZ files using PotreeConverter:</p> <pre># Example conversion command (not run in this notebook)\nPotreeConverter input.las -o output_directory --output-format LAZ\n</pre> <p>For demonstration purposes, here's how you would load a point cloud:</p>"},{"location":"examples/potree/potree_example/#point-rendering-settings","title":"Point Rendering Settings\u00b6","text":"<p>Customize how points are rendered in the viewer:</p>"},{"location":"examples/potree/potree_example/#camera-controls","title":"Camera Controls\u00b6","text":"<p>Control the camera position and viewing angle:</p>"},{"location":"examples/potree/potree_example/#visual-enhancements","title":"Visual Enhancements\u00b6","text":"<p>Configure visual effects and enhancements:</p>"},{"location":"examples/potree/potree_example/#quality-settings","title":"Quality Settings\u00b6","text":"<p>Adjust rendering quality for performance optimization:</p>"},{"location":"examples/potree/potree_example/#multiple-point-clouds","title":"Multiple Point Clouds\u00b6","text":"<p>Load and manage multiple point cloud datasets:</p>"},{"location":"examples/potree/potree_example/#point-cloud-filtering","title":"Point Cloud Filtering\u00b6","text":"<p>Filter points based on various criteria:</p>"},{"location":"examples/potree/potree_example/#measurement-tools","title":"Measurement Tools\u00b6","text":"<p>Add measurement capabilities to the viewer:</p>"},{"location":"examples/potree/potree_example/#utility-functions","title":"Utility Functions\u00b6","text":"<p>Demonstrate various utility functions:</p>"},{"location":"examples/potree/potree_example/#multi-cell-rendering-test","title":"Multi-cell Rendering Test\u00b6","text":"<p>Test that the viewer works correctly when displayed in multiple cells:</p>"},{"location":"examples/potree/potree_example/#creating-a-second-viewer-instance","title":"Creating a Second Viewer Instance\u00b6","text":"<p>Create a separate viewer to verify independence:</p>"},{"location":"examples/potree/potree_example/#cleanup","title":"Cleanup\u00b6","text":"<p>Clear point clouds and reset viewers:</p>"},{"location":"examples/potree/potree_example/#working-with-real-data","title":"Working with Real Data\u00b6","text":"<p>To work with real point cloud data in Potree:</p>"},{"location":"examples/potree/potree_example/#1-convert-your-data","title":"1. Convert your data\u00b6","text":"<p>Use PotreeConverter to convert LAS/LAZ files:</p> <pre>PotreeConverter input.las -o output_directory --output-format LAZ\n</pre>"},{"location":"examples/potree/potree_example/#2-host-the-data","title":"2. Host the data\u00b6","text":"<p>Upload the converted point cloud directory to a web server that supports CORS.</p>"},{"location":"examples/potree/potree_example/#3-load-in-the-viewer","title":"3. Load in the viewer\u00b6","text":"<pre>viewer.load_point_cloud(\n    \"https://your-server.com/pointclouds/your_data/metadata.json\",\n    \"Your Point Cloud Name\"\n)\n</pre>"},{"location":"examples/potree/potree_example/#sample-data-sources","title":"Sample Data Sources\u00b6","text":"<p>You can find sample Potree-compatible datasets at:</p> <ul> <li>Potree Examples</li> <li>OpenTopography</li> <li>3D BAG (Netherlands)</li> </ul>"},{"location":"examples/potree/potree_example/#summary","title":"Summary\u00b6","text":"<p>This notebook demonstrated the key features of the anymap PotreeMap widget:</p> <ol> <li>Point Cloud Visualization: Interactive rendering of large point cloud datasets</li> <li>Rendering Controls: Point size, shape, and quality settings</li> <li>Camera Controls: Position, target, field of view, and clipping</li> <li>Visual Effects: Eye Dome Lighting, coordinate grid, background</li> <li>Data Management: Loading single and multiple point clouds</li> <li>Filtering: Elevation and classification-based filtering</li> <li>Measurements: Distance, area, and volume measurement tools</li> <li>Multi-cell Rendering: Persistent state across notebook cells</li> <li>Multiple Instances: Independent viewer widgets</li> </ol> <p>The PotreeMap widget provides a powerful platform for interactive point cloud visualization with the full capabilities of Potree.js in a Jupyter environment.</p>"}]}